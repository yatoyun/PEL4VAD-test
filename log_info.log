[2023-06-26 10:22:39,411][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': '/data/pyj/feat/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-06-26 10:22:41,974][main.py][line:113][INFO] total params:1.2091M
[2023-06-26 10:22:41,975][main.py][line:116][INFO] Training Mode
[2023-06-26 10:22:41,976][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-06-26 10:22:41,976][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0005
    lr: 0.0005
    weight_decay: 0
)

[2023-06-26 10:23:04,467][main.py][line:57][INFO] Random initialize AUC:0.5444 FAR:0.67905
[2023-06-26 10:28:20,970][main.py][line:74][INFO] [Epoch:1/50]: loss1:0.3674 loss2:1.0960 | AUC:0.8476 FAR:0.00341
[2023-06-26 10:30:40,865][main.py][line:74][INFO] [Epoch:2/50]: loss1:0.1536 loss2:0.8745 | AUC:0.8541 FAR:0.00519
[2023-06-26 10:33:03,047][main.py][line:74][INFO] [Epoch:3/50]: loss1:0.0670 loss2:0.7795 | AUC:0.8590 FAR:0.00314
[2023-06-26 10:35:17,897][main.py][line:74][INFO] [Epoch:4/50]: loss1:0.0374 loss2:0.7048 | AUC:0.8545 FAR:0.00242
[2023-06-26 10:37:32,002][main.py][line:74][INFO] [Epoch:5/50]: loss1:0.0248 loss2:0.6399 | AUC:0.8560 FAR:0.00232
[2023-06-26 10:39:47,095][main.py][line:74][INFO] [Epoch:6/50]: loss1:0.0166 loss2:0.5759 | AUC:0.8636 FAR:0.00580
[2023-06-26 10:42:02,062][main.py][line:74][INFO] [Epoch:7/50]: loss1:0.0365 loss2:0.5461 | AUC:0.8545 FAR:0.00328
[2023-06-26 10:44:15,828][main.py][line:74][INFO] [Epoch:8/50]: loss1:0.0120 loss2:0.4721 | AUC:0.8556 FAR:0.00264
[2023-06-26 10:46:30,014][main.py][line:74][INFO] [Epoch:9/50]: loss1:0.0087 loss2:0.4146 | AUC:0.8574 FAR:0.00259
[2023-06-26 10:48:41,037][main.py][line:74][INFO] [Epoch:10/50]: loss1:0.0081 loss2:0.3630 | AUC:0.8525 FAR:0.00370
[2023-06-26 10:50:55,236][main.py][line:74][INFO] [Epoch:11/50]: loss1:0.0073 loss2:0.3101 | AUC:0.8548 FAR:0.00408
[2023-06-26 10:53:07,085][main.py][line:74][INFO] [Epoch:12/50]: loss1:0.0064 loss2:0.2642 | AUC:0.8562 FAR:0.00235
[2023-06-26 10:55:18,935][main.py][line:74][INFO] [Epoch:13/50]: loss1:0.0161 loss2:0.2371 | AUC:0.8499 FAR:0.00790
[2023-06-26 10:57:37,384][main.py][line:74][INFO] [Epoch:14/50]: loss1:0.0484 loss2:0.2859 | AUC:0.8452 FAR:0.00368
[2023-06-26 11:00:35,001][main.py][line:74][INFO] [Epoch:15/50]: loss1:0.0098 loss2:0.2012 | AUC:0.8551 FAR:0.00304
[2023-06-26 11:03:11,084][main.py][line:74][INFO] [Epoch:16/50]: loss1:0.0094 loss2:0.1679 | AUC:0.8519 FAR:0.00306
[2023-06-26 11:05:38,862][main.py][line:74][INFO] [Epoch:17/50]: loss1:0.0147 loss2:0.1615 | AUC:0.8490 FAR:0.00277
[2023-06-26 11:08:03,205][main.py][line:74][INFO] [Epoch:18/50]: loss1:0.0047 loss2:0.1213 | AUC:0.8487 FAR:0.00227
[2023-06-26 11:10:24,212][main.py][line:74][INFO] [Epoch:19/50]: loss1:0.0036 loss2:0.0989 | AUC:0.8450 FAR:0.00245
[2023-06-26 11:13:19,243][main.py][line:74][INFO] [Epoch:20/50]: loss1:0.0041 loss2:0.0860 | AUC:0.8418 FAR:0.00232
[2023-06-26 11:15:38,669][main.py][line:74][INFO] [Epoch:21/50]: loss1:0.0029 loss2:0.0712 | AUC:0.8417 FAR:0.00200
[2023-06-26 11:18:00,753][main.py][line:74][INFO] [Epoch:22/50]: loss1:0.0024 loss2:0.0606 | AUC:0.8462 FAR:0.00235
[2023-06-26 11:20:18,162][main.py][line:74][INFO] [Epoch:23/50]: loss1:0.0020 loss2:0.0525 | AUC:0.8444 FAR:0.00311
[2023-06-26 11:22:40,464][main.py][line:74][INFO] [Epoch:24/50]: loss1:0.0017 loss2:0.0447 | AUC:0.8455 FAR:0.00232
[2023-06-26 11:24:56,506][main.py][line:74][INFO] [Epoch:25/50]: loss1:0.0018 loss2:0.0381 | AUC:0.8451 FAR:0.00319
[2023-06-26 11:27:15,959][main.py][line:74][INFO] [Epoch:26/50]: loss1:0.0017 loss2:0.0350 | AUC:0.8471 FAR:0.00257
[2023-06-26 11:29:41,893][main.py][line:74][INFO] [Epoch:27/50]: loss1:0.0015 loss2:0.0301 | AUC:0.8467 FAR:0.00232
[2023-06-26 11:32:09,740][main.py][line:74][INFO] [Epoch:28/50]: loss1:0.0014 loss2:0.0269 | AUC:0.8492 FAR:0.00262
[2023-06-26 11:34:33,227][main.py][line:74][INFO] [Epoch:29/50]: loss1:0.0010 loss2:0.0233 | AUC:0.8457 FAR:0.00299
[2023-06-26 11:37:08,390][main.py][line:74][INFO] [Epoch:30/50]: loss1:0.0258 loss2:0.0429 | AUC:0.8526 FAR:0.00294
[2023-06-26 11:39:32,361][main.py][line:74][INFO] [Epoch:31/50]: loss1:0.0112 loss2:0.0495 | AUC:0.8467 FAR:0.00294
[2023-06-26 11:41:57,373][main.py][line:74][INFO] [Epoch:32/50]: loss1:0.0028 loss2:0.0290 | AUC:0.8500 FAR:0.00289
[2023-06-26 11:44:23,142][main.py][line:74][INFO] [Epoch:33/50]: loss1:0.0014 loss2:0.0220 | AUC:0.8508 FAR:0.00319
[2023-06-26 11:46:44,860][main.py][line:74][INFO] [Epoch:34/50]: loss1:0.0010 loss2:0.0189 | AUC:0.8506 FAR:0.00343
[2023-06-26 11:49:10,181][main.py][line:74][INFO] [Epoch:35/50]: loss1:0.0010 loss2:0.0170 | AUC:0.8502 FAR:0.00408
[2023-06-26 11:51:38,606][main.py][line:74][INFO] [Epoch:36/50]: loss1:0.0011 loss2:0.0158 | AUC:0.8518 FAR:0.00314
[2023-06-26 11:53:58,995][main.py][line:74][INFO] [Epoch:37/50]: loss1:0.0029 loss2:0.0195 | AUC:0.8469 FAR:0.00380
[2023-06-26 11:56:12,383][main.py][line:74][INFO] [Epoch:38/50]: loss1:0.0009 loss2:0.0137 | AUC:0.8522 FAR:0.00368
[2023-06-26 11:58:23,435][main.py][line:74][INFO] [Epoch:39/50]: loss1:0.0008 loss2:0.0128 | AUC:0.8518 FAR:0.00366
[2023-06-26 12:00:33,337][main.py][line:74][INFO] [Epoch:40/50]: loss1:0.0006 loss2:0.0113 | AUC:0.8514 FAR:0.00380
[2023-06-26 12:02:45,002][main.py][line:74][INFO] [Epoch:41/50]: loss1:0.0006 loss2:0.0108 | AUC:0.8512 FAR:0.00405
[2023-06-26 12:05:00,560][main.py][line:74][INFO] [Epoch:42/50]: loss1:0.0005 loss2:0.0098 | AUC:0.8499 FAR:0.00316
[2023-06-26 12:07:11,449][main.py][line:74][INFO] [Epoch:43/50]: loss1:0.0005 loss2:0.0097 | AUC:0.8504 FAR:0.00368
[2023-06-26 12:09:23,488][main.py][line:74][INFO] [Epoch:44/50]: loss1:0.0005 loss2:0.0094 | AUC:0.8504 FAR:0.00353
[2023-06-26 12:11:36,193][main.py][line:74][INFO] [Epoch:45/50]: loss1:0.0005 loss2:0.0087 | AUC:0.8506 FAR:0.00385
[2023-06-26 12:13:48,758][main.py][line:74][INFO] [Epoch:46/50]: loss1:0.0004 loss2:0.0086 | AUC:0.8507 FAR:0.00348
[2023-06-26 12:15:58,737][main.py][line:74][INFO] [Epoch:47/50]: loss1:0.0005 loss2:0.0078 | AUC:0.8506 FAR:0.00346
[2023-06-26 12:18:23,042][main.py][line:74][INFO] [Epoch:48/50]: loss1:0.0004 loss2:0.0080 | AUC:0.8501 FAR:0.00326
[2023-06-26 12:20:36,653][main.py][line:74][INFO] [Epoch:49/50]: loss1:0.0004 loss2:0.0074 | AUC:0.8503 FAR:0.00373
[2023-06-26 12:23:07,479][main.py][line:74][INFO] [Epoch:50/50]: loss1:0.0004 loss2:0.0078 | AUC:0.8499 FAR:0.00341
[2023-06-26 12:23:07,491][main.py][line:80][INFO] Training completes in 120m 3s | best AUC:0.8636 FAR:0.00580

[2023-06-26 12:58:17,606][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': '/data/pyj/feat/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-06-26 12:58:19,910][main.py][line:113][INFO] total params:1.2091M
[2023-06-26 12:58:19,910][main.py][line:120][INFO] Test Mode
[2023-06-26 12:58:19,910][main.py][line:26][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-06-26 12:58:32,117][infer.py][line:47][INFO] offline AUC:0.8676 AP:0.3399 FAR:0.0047 | Complete in 0m 12s

[2023-06-26 12:59:02,787][main.py][line:87][INFO] Config:{'dataset': 'xd-violence', 'model_name': 'xd_', 'metrics': 'AP', 'feat_prefix': '/data/pyj/feat/xd-i3d', 'train_list': './list/xd/train.list', 'test_list': './list/xd/test.list', 'token_feat': './list/xd/xd-prompt.npy', 'gt': './list/xd/xd-gt.npy', 'win_size': 9, 'gamma': 0.06, 'bias': 0.02, 'norm': False, 't_step': 3, 'temp': 0.05, 'lamda': 1, 'seed': 4, 'test_bs': 5, 'smooth': 'fixed', 'kappa': 8, 'ckpt_path': './ckpt/xd__8526.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-06-26 12:59:05,198][main.py][line:113][INFO] total params:1.2073M
[2023-06-26 12:59:05,198][main.py][line:116][INFO] Training Mode
[2023-06-26 12:59:05,199][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(3,), stride=(1,))
)

[2023-06-26 12:59:05,200][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0005
    lr: 0.0005
    weight_decay: 0
)

[2023-06-26 12:59:18,902][main.py][line:57][INFO] Random initialize AP:0.2742 FAR:0.44700
[2023-06-26 13:01:57,379][main.py][line:74][INFO] [Epoch:1/50]: loss1:0.3384 loss2:0.5558 | AUC:0.7968 FAR:0.00456
[2023-06-26 13:04:52,989][main.py][line:74][INFO] [Epoch:2/50]: loss1:0.1947 loss2:0.3543 | AUC:0.8526 FAR:0.00625
[2023-06-26 13:07:34,256][main.py][line:74][INFO] [Epoch:3/50]: loss1:0.1335 loss2:0.2872 | AUC:0.8308 FAR:0.00221
[2023-06-26 13:10:18,471][main.py][line:74][INFO] [Epoch:4/50]: loss1:0.0996 loss2:0.2413 | AUC:0.8173 FAR:0.00126
[2023-06-26 13:12:57,282][main.py][line:74][INFO] [Epoch:5/50]: loss1:0.0694 loss2:0.2068 | AUC:0.8211 FAR:0.00284
[2023-06-26 13:15:36,887][main.py][line:74][INFO] [Epoch:6/50]: loss1:0.0557 loss2:0.1810 | AUC:0.7612 FAR:0.00112
[2023-06-26 13:18:18,239][main.py][line:74][INFO] [Epoch:7/50]: loss1:0.0558 loss2:0.1695 | AUC:0.8357 FAR:0.00404
[2023-06-26 13:20:57,396][main.py][line:74][INFO] [Epoch:8/50]: loss1:0.0400 loss2:0.1440 | AUC:0.8156 FAR:0.00363
[2023-06-26 13:23:37,743][main.py][line:74][INFO] [Epoch:9/50]: loss1:0.0278 loss2:0.1172 | AUC:0.7929 FAR:0.00229
[2023-06-26 13:26:19,042][main.py][line:74][INFO] [Epoch:10/50]: loss1:0.0448 loss2:0.1164 | AUC:0.8142 FAR:0.00328
[2023-06-26 13:28:58,999][main.py][line:74][INFO] [Epoch:11/50]: loss1:0.0307 loss2:0.1071 | AUC:0.8013 FAR:0.00066
[2023-06-26 13:31:42,415][main.py][line:74][INFO] [Epoch:12/50]: loss1:0.0209 loss2:0.0798 | AUC:0.8348 FAR:0.00309
[2023-06-26 13:34:19,254][main.py][line:74][INFO] [Epoch:13/50]: loss1:0.0175 loss2:0.0514 | AUC:0.8350 FAR:0.00263
[2023-06-26 13:36:51,850][main.py][line:74][INFO] [Epoch:14/50]: loss1:0.0101 loss2:0.0470 | AUC:0.7933 FAR:0.00080
[2023-06-26 13:39:23,674][main.py][line:74][INFO] [Epoch:15/50]: loss1:0.0108 loss2:0.0437 | AUC:0.8283 FAR:0.00231
[2023-06-26 13:42:20,757][main.py][line:74][INFO] [Epoch:16/50]: loss1:0.0082 loss2:0.0198 | AUC:0.7936 FAR:0.00064
[2023-06-26 13:44:59,435][main.py][line:74][INFO] [Epoch:17/50]: loss1:0.0154 loss2:0.0166 | AUC:0.8021 FAR:0.00121
[2023-06-26 13:47:50,154][main.py][line:74][INFO] [Epoch:18/50]: loss1:0.0185 loss2:0.0014 | AUC:0.8113 FAR:0.00184
[2023-06-26 13:50:30,184][main.py][line:74][INFO] [Epoch:19/50]: loss1:0.0046 loss2:0.0000 | AUC:0.8097 FAR:0.00215
[2023-06-26 13:53:36,445][main.py][line:74][INFO] [Epoch:20/50]: loss1:0.0036 loss2:0.0000 | AUC:0.8255 FAR:0.00179
[2023-06-26 13:56:21,920][main.py][line:74][INFO] [Epoch:21/50]: loss1:0.0255 loss2:0.0442 | AUC:0.7577 FAR:0.00151
[2023-06-26 13:58:58,932][main.py][line:74][INFO] [Epoch:22/50]: loss1:0.0109 loss2:0.0460 | AUC:0.7752 FAR:0.00054
[2023-06-26 14:01:49,618][main.py][line:74][INFO] [Epoch:23/50]: loss1:0.0079 loss2:0.0030 | AUC:0.8155 FAR:0.00156
[2023-06-26 14:04:31,046][main.py][line:74][INFO] [Epoch:24/50]: loss1:0.0082 loss2:0.0057 | AUC:0.8271 FAR:0.00207
[2023-06-26 14:07:17,468][main.py][line:74][INFO] [Epoch:25/50]: loss1:0.0022 loss2:0.0000 | AUC:0.8208 FAR:0.00239
[2023-06-26 14:10:09,596][main.py][line:74][INFO] [Epoch:26/50]: loss1:0.0061 loss2:0.0000 | AUC:0.8141 FAR:0.00144
[2023-06-26 14:13:11,678][main.py][line:74][INFO] [Epoch:27/50]: loss1:0.0033 loss2:0.0000 | AUC:0.8114 FAR:0.00133
[2023-06-26 14:15:41,063][main.py][line:74][INFO] [Epoch:28/50]: loss1:0.0025 loss2:0.0000 | AUC:0.8147 FAR:0.00180
[2023-06-26 14:18:21,049][main.py][line:74][INFO] [Epoch:29/50]: loss1:0.0018 loss2:0.0000 | AUC:0.8146 FAR:0.00144
[2023-06-26 14:21:01,533][main.py][line:74][INFO] [Epoch:30/50]: loss1:0.0010 loss2:0.0000 | AUC:0.8137 FAR:0.00170
[2023-06-26 14:23:50,767][main.py][line:74][INFO] [Epoch:31/50]: loss1:0.0116 loss2:0.0000 | AUC:0.8052 FAR:0.00183
[2023-06-26 14:26:37,664][main.py][line:74][INFO] [Epoch:32/50]: loss1:0.0133 loss2:0.0085 | AUC:0.8202 FAR:0.00126
[2023-06-26 14:29:21,201][main.py][line:74][INFO] [Epoch:33/50]: loss1:0.0022 loss2:0.0000 | AUC:0.8125 FAR:0.00354
[2023-06-26 14:32:20,565][main.py][line:74][INFO] [Epoch:34/50]: loss1:0.0011 loss2:0.0000 | AUC:0.8175 FAR:0.00199
[2023-06-26 14:35:02,375][main.py][line:74][INFO] [Epoch:35/50]: loss1:0.0018 loss2:0.0000 | AUC:0.8223 FAR:0.00252
[2023-06-26 14:37:52,408][main.py][line:74][INFO] [Epoch:36/50]: loss1:0.0009 loss2:0.0000 | AUC:0.8187 FAR:0.00286
[2023-06-26 14:40:35,544][main.py][line:74][INFO] [Epoch:37/50]: loss1:0.0007 loss2:0.0000 | AUC:0.8142 FAR:0.00266
[2023-06-26 14:43:26,219][main.py][line:74][INFO] [Epoch:38/50]: loss1:0.0006 loss2:0.0000 | AUC:0.8145 FAR:0.00217
[2023-06-26 14:46:16,282][main.py][line:74][INFO] [Epoch:39/50]: loss1:0.0006 loss2:0.0000 | AUC:0.8158 FAR:0.00236
[2023-06-26 14:49:05,279][main.py][line:74][INFO] [Epoch:40/50]: loss1:0.0006 loss2:0.0000 | AUC:0.8171 FAR:0.00236
[2023-06-26 14:51:52,563][main.py][line:74][INFO] [Epoch:41/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8156 FAR:0.00224
[2023-06-26 14:54:41,250][main.py][line:74][INFO] [Epoch:42/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8161 FAR:0.00212
[2023-06-26 14:57:32,924][main.py][line:74][INFO] [Epoch:43/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8148 FAR:0.00222
[2023-06-26 15:00:19,503][main.py][line:74][INFO] [Epoch:44/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8143 FAR:0.00239
[2023-06-26 15:03:07,044][main.py][line:74][INFO] [Epoch:45/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8150 FAR:0.00221
[2023-06-26 15:05:51,733][main.py][line:74][INFO] [Epoch:46/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8160 FAR:0.00236
[2023-06-26 15:08:43,028][main.py][line:74][INFO] [Epoch:47/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8150 FAR:0.00204
[2023-06-26 15:11:28,315][main.py][line:74][INFO] [Epoch:48/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8138 FAR:0.00220
[2023-06-26 15:14:14,464][main.py][line:74][INFO] [Epoch:49/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8136 FAR:0.00221
[2023-06-26 15:16:59,857][main.py][line:74][INFO] [Epoch:50/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8146 FAR:0.00222
[2023-06-26 15:16:59,870][main.py][line:80][INFO] Training completes in 137m 41s | best AP:0.8526 FAR:0.00625

[2023-06-26 15:41:47,285][main.py][line:87][INFO] Config:{'dataset': 'xd-violence', 'model_name': 'xd_', 'metrics': 'AP', 'feat_prefix': '/data/pyj/feat/xd-i3d', 'train_list': './list/xd/train.list', 'test_list': './list/xd/test.list', 'token_feat': './list/xd/xd-prompt.npy', 'gt': './list/xd/xd-gt.npy', 'win_size': 9, 'gamma': 0.06, 'bias': 0.02, 'norm': False, 't_step': 3, 'temp': 0.05, 'lamda': 1, 'seed': 4, 'test_bs': 5, 'smooth': 'fixed', 'kappa': 8, 'ckpt_path': './ckpt/xd__8526.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-06-26 15:41:49,642][main.py][line:113][INFO] total params:1.2073M
[2023-06-26 15:41:49,643][main.py][line:120][INFO] Test Mode
[2023-06-26 15:41:49,643][main.py][line:26][INFO] loading pretrained checkpoint from ./ckpt/xd__8526.pkl.
[2023-06-26 15:42:03,950][infer.py][line:47][INFO] offline AUC:0.9494 AP:0.8559 FAR:0.0057 | Complete in 0m 14s

[2023-06-26 15:57:20,503][main.py][line:87][INFO] Config:{'dataset': 'shanghaiTech', 'model_name': 'SH_', 'metrics': 'AUC', 'feat_prefix': '/data/pyj/feat/SHTech-i3d', 'train_list': './list/sh/train.list', 'test_list': './list/sh/test.list', 'token_feat': './list/sh/sh-prompt.npy', 'abn_label': './list/sh/relabel.list', 'gt': './list/sh/sh-gt.npy', 'win_size': 5, 'gamma': 0.08, 'bias': 0.1, 'norm': True, 't_step': 3, 'temp': 0.2, 'lamda': 9, 'seed': 0, 'test_bs': 10, 'smooth': 'slide', 'kappa': 3, 'ckpt_path': './ckpt/SH__98.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-06-26 15:57:22,852][main.py][line:113][INFO] total params:1.2073M
[2023-06-26 15:57:22,852][main.py][line:116][INFO] Training Mode
[2023-06-26 15:57:22,853][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(3,), stride=(1,))
)

[2023-06-26 15:57:22,853][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0005
    lr: 0.0005
    weight_decay: 0
)

[2023-06-26 15:57:28,770][main.py][line:57][INFO] Random initialize AUC:0.5546 FAR:0.00402
[2023-06-26 15:57:47,743][main.py][line:74][INFO] [Epoch:1/50]: loss1:0.4849 loss2:0.7652 | AUC:0.9503 FAR:0.00013
[2023-06-26 15:58:02,767][main.py][line:74][INFO] [Epoch:2/50]: loss1:0.2230 loss2:0.6820 | AUC:0.9743 FAR:0.00013
[2023-06-26 15:58:17,780][main.py][line:74][INFO] [Epoch:3/50]: loss1:0.1478 loss2:0.6645 | AUC:0.9720 FAR:0.00052
[2023-06-26 15:58:33,830][main.py][line:74][INFO] [Epoch:4/50]: loss1:0.1041 loss2:0.6497 | AUC:0.9708 FAR:0.00675
[2023-06-26 15:58:48,718][main.py][line:74][INFO] [Epoch:5/50]: loss1:0.0817 loss2:0.6001 | AUC:0.9727 FAR:0.00117
[2023-06-26 15:59:03,862][main.py][line:74][INFO] [Epoch:6/50]: loss1:0.0786 loss2:0.5964 | AUC:0.9701 FAR:0.00221
[2023-06-26 15:59:25,136][main.py][line:74][INFO] [Epoch:7/50]: loss1:0.0591 loss2:0.5651 | AUC:0.9710 FAR:0.00065
[2023-06-26 15:59:44,337][main.py][line:74][INFO] [Epoch:8/50]: loss1:0.0509 loss2:0.5515 | AUC:0.9725 FAR:0.00039
[2023-06-26 15:59:59,596][main.py][line:74][INFO] [Epoch:9/50]: loss1:0.0404 loss2:0.5450 | AUC:0.9747 FAR:0.00039
[2023-06-26 16:00:16,175][main.py][line:74][INFO] [Epoch:10/50]: loss1:0.0459 loss2:0.5249 | AUC:0.9747 FAR:0.00286
[2023-06-26 16:00:31,393][main.py][line:74][INFO] [Epoch:11/50]: loss1:0.0296 loss2:0.4967 | AUC:0.9746 FAR:0.00026
[2023-06-26 16:00:46,321][main.py][line:74][INFO] [Epoch:12/50]: loss1:0.0291 loss2:0.4867 | AUC:0.9745 FAR:0.00208
[2023-06-26 16:01:01,580][main.py][line:74][INFO] [Epoch:13/50]: loss1:0.0219 loss2:0.4663 | AUC:0.9758 FAR:0.00234
[2023-06-26 16:01:16,639][main.py][line:74][INFO] [Epoch:14/50]: loss1:0.0229 loss2:0.4645 | AUC:0.9757 FAR:0.00013
[2023-06-26 16:01:31,589][main.py][line:74][INFO] [Epoch:15/50]: loss1:0.0174 loss2:0.4635 | AUC:0.9765 FAR:0.00026
[2023-06-26 16:01:46,888][main.py][line:74][INFO] [Epoch:16/50]: loss1:0.0178 loss2:0.4456 | AUC:0.9756 FAR:0.00104
[2023-06-26 16:02:03,523][main.py][line:74][INFO] [Epoch:17/50]: loss1:0.0147 loss2:0.4356 | AUC:0.9780 FAR:0.00039
[2023-06-26 16:02:18,675][main.py][line:74][INFO] [Epoch:18/50]: loss1:0.0140 loss2:0.4257 | AUC:0.9786 FAR:0.00000
[2023-06-26 16:02:33,844][main.py][line:74][INFO] [Epoch:19/50]: loss1:0.0131 loss2:0.4216 | AUC:0.9764 FAR:0.00026
[2023-06-26 16:02:49,216][main.py][line:74][INFO] [Epoch:20/50]: loss1:0.0161 loss2:0.4072 | AUC:0.9791 FAR:0.00013
[2023-06-26 16:03:04,618][main.py][line:74][INFO] [Epoch:21/50]: loss1:0.0127 loss2:0.3953 | AUC:0.9773 FAR:0.00026
[2023-06-26 16:03:20,056][main.py][line:74][INFO] [Epoch:22/50]: loss1:0.0160 loss2:0.4061 | AUC:0.9800 FAR:0.00000
[2023-06-26 16:03:35,280][main.py][line:74][INFO] [Epoch:23/50]: loss1:0.0083 loss2:0.3886 | AUC:0.9787 FAR:0.00052
[2023-06-26 16:03:50,522][main.py][line:74][INFO] [Epoch:24/50]: loss1:0.0090 loss2:0.3822 | AUC:0.9796 FAR:0.00091
[2023-06-26 16:04:05,581][main.py][line:74][INFO] [Epoch:25/50]: loss1:0.0085 loss2:0.3805 | AUC:0.9793 FAR:0.00052
[2023-06-26 16:04:20,777][main.py][line:74][INFO] [Epoch:26/50]: loss1:0.0087 loss2:0.3793 | AUC:0.9785 FAR:0.00026
[2023-06-26 16:04:36,022][main.py][line:74][INFO] [Epoch:27/50]: loss1:0.0082 loss2:0.3715 | AUC:0.9787 FAR:0.00117
[2023-06-26 16:04:51,156][main.py][line:74][INFO] [Epoch:28/50]: loss1:0.0069 loss2:0.3495 | AUC:0.9791 FAR:0.00026
[2023-06-26 16:05:06,556][main.py][line:74][INFO] [Epoch:29/50]: loss1:0.0068 loss2:0.3575 | AUC:0.9794 FAR:0.00026
[2023-06-26 16:05:21,932][main.py][line:74][INFO] [Epoch:30/50]: loss1:0.0066 loss2:0.3542 | AUC:0.9788 FAR:0.00052
[2023-06-26 16:05:37,223][main.py][line:74][INFO] [Epoch:31/50]: loss1:0.0071 loss2:0.3470 | AUC:0.9789 FAR:0.00039
[2023-06-26 16:05:52,259][main.py][line:74][INFO] [Epoch:32/50]: loss1:0.0077 loss2:0.3470 | AUC:0.9764 FAR:0.00026
[2023-06-26 16:06:07,467][main.py][line:74][INFO] [Epoch:33/50]: loss1:0.0122 loss2:0.3454 | AUC:0.9787 FAR:0.00052
[2023-06-26 16:06:26,627][main.py][line:74][INFO] [Epoch:34/50]: loss1:0.0067 loss2:0.3325 | AUC:0.9787 FAR:0.00026
[2023-06-26 16:06:41,889][main.py][line:74][INFO] [Epoch:35/50]: loss1:0.0075 loss2:0.3349 | AUC:0.9791 FAR:0.00078
[2023-06-26 16:06:57,134][main.py][line:74][INFO] [Epoch:36/50]: loss1:0.0073 loss2:0.3387 | AUC:0.9782 FAR:0.00026
[2023-06-26 16:07:12,229][main.py][line:74][INFO] [Epoch:37/50]: loss1:0.0064 loss2:0.3327 | AUC:0.9781 FAR:0.00039
[2023-06-26 16:07:27,618][main.py][line:74][INFO] [Epoch:38/50]: loss1:0.0057 loss2:0.3290 | AUC:0.9792 FAR:0.00026
[2023-06-26 16:07:42,658][main.py][line:74][INFO] [Epoch:39/50]: loss1:0.0060 loss2:0.3263 | AUC:0.9782 FAR:0.00026
[2023-06-26 16:07:57,784][main.py][line:74][INFO] [Epoch:40/50]: loss1:0.0056 loss2:0.3296 | AUC:0.9785 FAR:0.00026
[2023-06-26 16:08:12,894][main.py][line:74][INFO] [Epoch:41/50]: loss1:0.0053 loss2:0.3223 | AUC:0.9791 FAR:0.00026
[2023-06-26 16:08:28,308][main.py][line:74][INFO] [Epoch:42/50]: loss1:0.0051 loss2:0.3198 | AUC:0.9784 FAR:0.00026
[2023-06-26 16:08:43,714][main.py][line:74][INFO] [Epoch:43/50]: loss1:0.0047 loss2:0.3193 | AUC:0.9782 FAR:0.00026
[2023-06-26 16:08:59,230][main.py][line:74][INFO] [Epoch:44/50]: loss1:0.0052 loss2:0.3182 | AUC:0.9784 FAR:0.00013
[2023-06-26 16:09:14,430][main.py][line:74][INFO] [Epoch:45/50]: loss1:0.0055 loss2:0.3144 | AUC:0.9780 FAR:0.00039
[2023-06-26 16:09:29,465][main.py][line:74][INFO] [Epoch:46/50]: loss1:0.0051 loss2:0.3161 | AUC:0.9782 FAR:0.00052
[2023-06-26 16:09:44,569][main.py][line:74][INFO] [Epoch:47/50]: loss1:0.0054 loss2:0.3129 | AUC:0.9780 FAR:0.00026
[2023-06-26 16:09:59,630][main.py][line:74][INFO] [Epoch:48/50]: loss1:0.0052 loss2:0.3086 | AUC:0.9780 FAR:0.00026
[2023-06-26 16:10:14,719][main.py][line:74][INFO] [Epoch:49/50]: loss1:0.0053 loss2:0.3102 | AUC:0.9776 FAR:0.00026
[2023-06-26 16:10:30,256][main.py][line:74][INFO] [Epoch:50/50]: loss1:0.0054 loss2:0.3068 | AUC:0.9778 FAR:0.00026
[2023-06-26 16:10:30,266][main.py][line:80][INFO] Training completes in 13m 1s | best AUC:0.9800 FAR:0.00000

[2023-06-26 16:11:33,636][main.py][line:87][INFO] Config:{'dataset': 'shanghaiTech', 'model_name': 'SH_', 'metrics': 'AUC', 'feat_prefix': '/data/pyj/feat/SHTech-i3d', 'train_list': './list/sh/train.list', 'test_list': './list/sh/test.list', 'token_feat': './list/sh/sh-prompt.npy', 'abn_label': './list/sh/relabel.list', 'gt': './list/sh/sh-gt.npy', 'win_size': 5, 'gamma': 0.08, 'bias': 0.1, 'norm': True, 't_step': 3, 'temp': 0.2, 'lamda': 9, 'seed': 0, 'test_bs': 10, 'smooth': 'slide', 'kappa': 3, 'ckpt_path': './ckpt/SH__98.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-06-26 16:11:36,131][main.py][line:113][INFO] total params:1.2073M
[2023-06-26 16:11:36,132][main.py][line:120][INFO] Test Mode
[2023-06-26 16:11:36,132][main.py][line:26][INFO] loading pretrained checkpoint from ./ckpt/SH__98.pkl.
[2023-06-26 16:11:39,240][infer.py][line:47][INFO] offline AUC:0.9814 AP:0.7256 FAR:0.0000 | Complete in 0m 3s

[2023-07-18 18:54:03,714][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 18:59:39,683][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 18:59:39,770][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 18:59:39,770][main.py][line:116][INFO] Training Mode
[2023-07-18 18:59:39,770][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 18:59:39,770][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 19:00:55,941][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 19:00:56,021][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 19:00:56,021][main.py][line:116][INFO] Training Mode
[2023-07-18 19:00:56,021][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 19:00:56,021][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 19:01:19,432][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 19:01:19,510][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 19:01:19,510][main.py][line:116][INFO] Training Mode
[2023-07-18 19:01:19,510][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 19:01:19,510][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 21:09:03,798][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 21:09:03,867][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 21:09:03,867][main.py][line:116][INFO] Training Mode
[2023-07-18 21:09:03,868][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 21:09:03,868][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 21:10:13,301][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 21:10:13,386][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 21:10:13,386][main.py][line:116][INFO] Training Mode
[2023-07-18 21:10:13,386][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 21:10:13,386][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 21:11:15,753][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 21:11:15,839][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 21:11:15,839][main.py][line:116][INFO] Training Mode
[2023-07-18 21:11:15,839][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 21:11:15,839][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 21:13:07,296][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 21:13:07,372][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 21:13:07,372][main.py][line:116][INFO] Training Mode
[2023-07-18 21:13:07,372][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 21:13:07,372][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 21:19:16,657][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 21:19:16,735][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 21:19:16,735][main.py][line:116][INFO] Training Mode
[2023-07-18 21:19:16,736][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 21:19:16,736][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 11:27:03,988][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 11:27:04,068][main.py][line:113][INFO] total params:1.2091M
[2023-07-19 11:27:04,068][main.py][line:116][INFO] Training Mode
[2023-07-19 11:27:04,068][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-19 11:27:04,068][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 11:27:09,343][main.py][line:57][INFO] Random initialize AUC:0.5444 FAR:0.67905
[2023-07-19 12:21:54,239][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 12:21:54,309][main.py][line:113][INFO] total params:1.2091M
[2023-07-19 12:21:54,309][main.py][line:116][INFO] Training Mode
[2023-07-19 12:21:54,309][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-19 12:21:54,309][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 12:22:00,012][main.py][line:57][INFO] Random initialize AUC:0.5444 FAR:0.67905
[2023-07-19 12:23:08,184][main.py][line:74][INFO] [Epoch:1/50]: loss1:0.3876 loss2:1.1033 | AUC:0.8392 FAR:0.01675
[2023-07-19 12:24:18,179][main.py][line:74][INFO] [Epoch:2/50]: loss1:0.1549 loss2:0.8760 | AUC:0.8480 FAR:0.00432
[2023-07-19 12:25:21,828][main.py][line:74][INFO] [Epoch:3/50]: loss1:0.0676 loss2:0.7808 | AUC:0.8484 FAR:0.00615
[2023-07-19 12:26:25,442][main.py][line:74][INFO] [Epoch:4/50]: loss1:0.0359 loss2:0.7089 | AUC:0.8434 FAR:0.01408
[2023-07-19 12:27:20,958][main.py][line:74][INFO] [Epoch:5/50]: loss1:0.0322 loss2:0.6461 | AUC:0.8439 FAR:0.00445
[2023-07-19 12:28:19,012][main.py][line:74][INFO] [Epoch:6/50]: loss1:0.0299 loss2:0.5980 | AUC:0.8548 FAR:0.00457
[2023-07-19 12:29:19,856][main.py][line:74][INFO] [Epoch:7/50]: loss1:0.0124 loss2:0.5263 | AUC:0.8540 FAR:0.00385
[2023-07-19 12:30:19,107][main.py][line:74][INFO] [Epoch:8/50]: loss1:0.0097 loss2:0.4665 | AUC:0.8489 FAR:0.00336
[2023-07-19 12:31:18,359][main.py][line:74][INFO] [Epoch:9/50]: loss1:0.0145 loss2:0.4156 | AUC:0.8466 FAR:0.02181
[2023-07-19 12:32:18,710][main.py][line:74][INFO] [Epoch:10/50]: loss1:0.0372 loss2:0.4206 | AUC:0.8433 FAR:0.00766
[2023-07-19 12:33:18,271][main.py][line:74][INFO] [Epoch:11/50]: loss1:0.0131 loss2:0.3500 | AUC:0.8461 FAR:0.00257
[2023-07-19 12:34:14,807][main.py][line:74][INFO] [Epoch:12/50]: loss1:0.0120 loss2:0.2901 | AUC:0.8480 FAR:0.00450
[2023-07-19 12:35:12,484][main.py][line:74][INFO] [Epoch:13/50]: loss1:0.0063 loss2:0.2259 | AUC:0.8495 FAR:0.00336
[2023-07-19 12:36:15,644][main.py][line:74][INFO] [Epoch:14/50]: loss1:0.0100 loss2:0.1968 | AUC:0.8492 FAR:0.00454
[2023-07-19 12:37:14,230][main.py][line:74][INFO] [Epoch:15/50]: loss1:0.0049 loss2:0.1675 | AUC:0.8493 FAR:0.00412
[2023-07-19 12:38:15,076][main.py][line:74][INFO] [Epoch:16/50]: loss1:0.0040 loss2:0.1473 | AUC:0.8468 FAR:0.00247
[2023-07-19 12:39:14,637][main.py][line:74][INFO] [Epoch:17/50]: loss1:0.0035 loss2:0.1242 | AUC:0.8470 FAR:0.00346
[2023-07-19 12:40:12,584][main.py][line:74][INFO] [Epoch:18/50]: loss1:0.0032 loss2:0.1100 | AUC:0.8485 FAR:0.00309
[2023-07-19 12:41:10,767][main.py][line:74][INFO] [Epoch:19/50]: loss1:0.0030 loss2:0.0976 | AUC:0.8466 FAR:0.00306
[2023-07-19 12:42:10,567][main.py][line:74][INFO] [Epoch:20/50]: loss1:0.0158 loss2:0.1086 | AUC:0.8364 FAR:0.00232
[2023-07-19 12:43:11,065][main.py][line:74][INFO] [Epoch:21/50]: loss1:0.0228 loss2:0.1320 | AUC:0.8434 FAR:0.00427
[2023-07-19 12:44:10,795][main.py][line:74][INFO] [Epoch:22/50]: loss1:0.0101 loss2:0.1010 | AUC:0.8441 FAR:0.00521
[2023-07-19 12:45:10,883][main.py][line:74][INFO] [Epoch:23/50]: loss1:0.0045 loss2:0.0745 | AUC:0.8465 FAR:0.00370
[2023-07-19 12:46:08,643][main.py][line:74][INFO] [Epoch:24/50]: loss1:0.0030 loss2:0.0618 | AUC:0.8506 FAR:0.00442
[2023-07-19 12:47:08,362][main.py][line:74][INFO] [Epoch:25/50]: loss1:0.0022 loss2:0.0517 | AUC:0.8491 FAR:0.00469
[2023-07-19 12:48:07,082][main.py][line:74][INFO] [Epoch:26/50]: loss1:0.0017 loss2:0.0433 | AUC:0.8502 FAR:0.00383
[2023-07-19 12:49:05,367][main.py][line:74][INFO] [Epoch:27/50]: loss1:0.0015 loss2:0.0376 | AUC:0.8500 FAR:0.00400
[2023-07-19 12:50:05,385][main.py][line:74][INFO] [Epoch:28/50]: loss1:0.0017 loss2:0.0341 | AUC:0.8437 FAR:0.00351
[2023-07-19 12:51:03,628][main.py][line:74][INFO] [Epoch:29/50]: loss1:0.0015 loss2:0.0298 | AUC:0.8479 FAR:0.00390
[2023-07-19 12:52:00,475][main.py][line:74][INFO] [Epoch:30/50]: loss1:0.0013 loss2:0.0263 | AUC:0.8473 FAR:0.00408
[2023-07-19 12:52:58,913][main.py][line:74][INFO] [Epoch:31/50]: loss1:0.0019 loss2:0.0247 | AUC:0.8495 FAR:0.00383
[2023-07-19 12:54:03,204][main.py][line:74][INFO] [Epoch:32/50]: loss1:0.0014 loss2:0.0247 | AUC:0.8509 FAR:0.00333
[2023-07-19 12:55:04,813][main.py][line:74][INFO] [Epoch:33/50]: loss1:0.0011 loss2:0.0219 | AUC:0.8533 FAR:0.00380
[2023-07-19 12:56:03,081][main.py][line:74][INFO] [Epoch:34/50]: loss1:0.0010 loss2:0.0196 | AUC:0.8535 FAR:0.00398
[2023-07-19 12:57:01,575][main.py][line:74][INFO] [Epoch:35/50]: loss1:0.0009 loss2:0.0185 | AUC:0.8520 FAR:0.00351
[2023-07-19 12:57:59,037][main.py][line:74][INFO] [Epoch:36/50]: loss1:0.0008 loss2:0.0169 | AUC:0.8509 FAR:0.00363
[2023-07-19 12:58:56,710][main.py][line:74][INFO] [Epoch:37/50]: loss1:0.0007 loss2:0.0148 | AUC:0.8505 FAR:0.00388
[2023-07-19 12:59:53,102][main.py][line:74][INFO] [Epoch:38/50]: loss1:0.0007 loss2:0.0150 | AUC:0.8505 FAR:0.00341
[2023-07-19 13:00:50,637][main.py][line:74][INFO] [Epoch:39/50]: loss1:0.0007 loss2:0.0135 | AUC:0.8520 FAR:0.00385
[2023-07-19 13:01:46,874][main.py][line:74][INFO] [Epoch:40/50]: loss1:0.0006 loss2:0.0131 | AUC:0.8513 FAR:0.00388
[2023-07-19 13:02:44,088][main.py][line:74][INFO] [Epoch:41/50]: loss1:0.0006 loss2:0.0121 | AUC:0.8509 FAR:0.00338
[2023-07-19 13:03:40,512][main.py][line:74][INFO] [Epoch:42/50]: loss1:0.0007 loss2:0.0123 | AUC:0.8483 FAR:0.00405
[2023-07-19 13:04:39,407][main.py][line:74][INFO] [Epoch:43/50]: loss1:0.0006 loss2:0.0115 | AUC:0.8496 FAR:0.00403
[2023-07-19 13:05:38,419][main.py][line:74][INFO] [Epoch:44/50]: loss1:0.0005 loss2:0.0106 | AUC:0.8506 FAR:0.00383
[2023-07-19 13:06:39,686][main.py][line:74][INFO] [Epoch:45/50]: loss1:0.0005 loss2:0.0100 | AUC:0.8501 FAR:0.00378
[2023-07-19 13:07:36,798][main.py][line:74][INFO] [Epoch:46/50]: loss1:0.0005 loss2:0.0094 | AUC:0.8489 FAR:0.00375
[2023-07-19 13:08:36,666][main.py][line:74][INFO] [Epoch:47/50]: loss1:0.0004 loss2:0.0093 | AUC:0.8492 FAR:0.00378
[2023-07-19 13:09:35,876][main.py][line:74][INFO] [Epoch:48/50]: loss1:0.0005 loss2:0.0092 | AUC:0.8489 FAR:0.00348
[2023-07-19 13:10:34,812][main.py][line:74][INFO] [Epoch:49/50]: loss1:0.0004 loss2:0.0091 | AUC:0.8498 FAR:0.00370
[2023-07-19 13:11:34,259][main.py][line:74][INFO] [Epoch:50/50]: loss1:0.0004 loss2:0.0083 | AUC:0.8498 FAR:0.00366
[2023-07-19 13:11:34,271][main.py][line:80][INFO] Training completes in 49m 34s | best AUC:0.8548 FAR:0.00457

[2023-07-19 13:34:44,147][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 13:34:44,242][main.py][line:113][INFO] total params:1.2091M
[2023-07-19 13:34:44,242][main.py][line:120][INFO] Test Mode
[2023-07-19 13:34:44,242][main.py][line:26][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-19 13:34:49,601][infer.py][line:47][INFO] offline AUC:0.8676 AP:0.3399 FAR:0.0047 | Complete in 0m 5s

[2023-07-19 13:36:37,769][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 13:36:37,837][main.py][line:113][INFO] total params:1.2091M
[2023-07-19 13:36:37,837][main.py][line:120][INFO] Test Mode
[2023-07-19 13:36:37,837][main.py][line:26][INFO] loading pretrained checkpoint from ./ckpt/ucf__8548.pkl.
[2023-07-19 13:36:43,176][infer.py][line:47][INFO] offline AUC:0.8601 AP:0.3172 FAR:0.0036 | Complete in 0m 5s

[2023-07-19 13:44:17,248][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 13:44:17,327][main.py][line:113][INFO] total params:1.2091M
[2023-07-19 13:44:17,327][main.py][line:116][INFO] Training Mode
[2023-07-19 13:44:17,328][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-19 13:44:17,328][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 13:44:22,210][main.py][line:57][INFO] Random initialize AUC:0.5444 FAR:0.67905
[2023-07-19 13:45:12,135][main.py][line:74][INFO] [Epoch:1/50]: loss1:0.3876 loss2:1.1033 | AUC:0.8392 FAR:0.01675
[2023-07-19 13:46:04,114][main.py][line:74][INFO] [Epoch:2/50]: loss1:0.1549 loss2:0.8760 | AUC:0.8480 FAR:0.00432
[2023-07-19 13:46:55,996][main.py][line:74][INFO] [Epoch:3/50]: loss1:0.0676 loss2:0.7808 | AUC:0.8484 FAR:0.00615
[2023-07-19 13:47:46,716][main.py][line:74][INFO] [Epoch:4/50]: loss1:0.0359 loss2:0.7089 | AUC:0.8434 FAR:0.01408
[2023-07-19 13:48:38,106][main.py][line:74][INFO] [Epoch:5/50]: loss1:0.0322 loss2:0.6461 | AUC:0.8439 FAR:0.00445
[2023-07-19 13:49:30,838][main.py][line:74][INFO] [Epoch:6/50]: loss1:0.0299 loss2:0.5980 | AUC:0.8548 FAR:0.00457
[2023-07-19 13:50:22,555][main.py][line:74][INFO] [Epoch:7/50]: loss1:0.0124 loss2:0.5263 | AUC:0.8540 FAR:0.00385
[2023-07-19 13:51:14,730][main.py][line:74][INFO] [Epoch:8/50]: loss1:0.0097 loss2:0.4665 | AUC:0.8489 FAR:0.00336
[2023-07-19 13:52:06,086][main.py][line:74][INFO] [Epoch:9/50]: loss1:0.0145 loss2:0.4156 | AUC:0.8466 FAR:0.02181
[2023-07-19 13:52:58,214][main.py][line:74][INFO] [Epoch:10/50]: loss1:0.0372 loss2:0.4206 | AUC:0.8433 FAR:0.00766
[2023-07-19 13:53:49,869][main.py][line:74][INFO] [Epoch:11/50]: loss1:0.0131 loss2:0.3500 | AUC:0.8461 FAR:0.00257
[2023-07-19 13:54:43,000][main.py][line:74][INFO] [Epoch:12/50]: loss1:0.0120 loss2:0.2901 | AUC:0.8480 FAR:0.00450
[2023-07-19 13:55:34,854][main.py][line:74][INFO] [Epoch:13/50]: loss1:0.0063 loss2:0.2259 | AUC:0.8495 FAR:0.00336
[2023-07-19 13:56:27,173][main.py][line:74][INFO] [Epoch:14/50]: loss1:0.0100 loss2:0.1968 | AUC:0.8492 FAR:0.00454
[2023-07-19 13:57:19,376][main.py][line:74][INFO] [Epoch:15/50]: loss1:0.0049 loss2:0.1675 | AUC:0.8493 FAR:0.00412
[2023-07-19 13:58:11,296][main.py][line:74][INFO] [Epoch:16/50]: loss1:0.0040 loss2:0.1473 | AUC:0.8468 FAR:0.00247
[2023-07-19 13:59:02,315][main.py][line:74][INFO] [Epoch:17/50]: loss1:0.0035 loss2:0.1242 | AUC:0.8470 FAR:0.00346
[2023-07-19 13:59:52,658][main.py][line:74][INFO] [Epoch:18/50]: loss1:0.0032 loss2:0.1100 | AUC:0.8485 FAR:0.00309
[2023-07-19 14:00:43,211][main.py][line:74][INFO] [Epoch:19/50]: loss1:0.0030 loss2:0.0976 | AUC:0.8466 FAR:0.00306
[2023-07-19 14:01:33,752][main.py][line:74][INFO] [Epoch:20/50]: loss1:0.0158 loss2:0.1086 | AUC:0.8364 FAR:0.00232
[2023-07-19 14:02:25,479][main.py][line:74][INFO] [Epoch:21/50]: loss1:0.0228 loss2:0.1320 | AUC:0.8434 FAR:0.00427
[2023-07-19 14:03:17,481][main.py][line:74][INFO] [Epoch:22/50]: loss1:0.0101 loss2:0.1010 | AUC:0.8441 FAR:0.00521
[2023-07-19 14:04:08,212][main.py][line:74][INFO] [Epoch:23/50]: loss1:0.0045 loss2:0.0745 | AUC:0.8465 FAR:0.00370
[2023-07-19 14:04:59,895][main.py][line:74][INFO] [Epoch:24/50]: loss1:0.0030 loss2:0.0618 | AUC:0.8506 FAR:0.00442
[2023-07-19 14:05:51,942][main.py][line:74][INFO] [Epoch:25/50]: loss1:0.0022 loss2:0.0517 | AUC:0.8491 FAR:0.00469
[2023-07-19 14:06:43,910][main.py][line:74][INFO] [Epoch:26/50]: loss1:0.0017 loss2:0.0433 | AUC:0.8502 FAR:0.00383
[2023-07-19 14:07:34,779][main.py][line:74][INFO] [Epoch:27/50]: loss1:0.0015 loss2:0.0376 | AUC:0.8500 FAR:0.00400
[2023-07-19 14:08:26,450][main.py][line:74][INFO] [Epoch:28/50]: loss1:0.0017 loss2:0.0341 | AUC:0.8437 FAR:0.00351
[2023-07-19 14:09:18,383][main.py][line:74][INFO] [Epoch:29/50]: loss1:0.0015 loss2:0.0298 | AUC:0.8479 FAR:0.00390
[2023-07-19 14:10:09,184][main.py][line:74][INFO] [Epoch:30/50]: loss1:0.0013 loss2:0.0263 | AUC:0.8473 FAR:0.00408
[2023-07-19 14:11:00,238][main.py][line:74][INFO] [Epoch:31/50]: loss1:0.0019 loss2:0.0247 | AUC:0.8495 FAR:0.00383
[2023-07-19 14:11:51,064][main.py][line:74][INFO] [Epoch:32/50]: loss1:0.0014 loss2:0.0247 | AUC:0.8509 FAR:0.00333
[2023-07-19 14:12:43,198][main.py][line:74][INFO] [Epoch:33/50]: loss1:0.0011 loss2:0.0219 | AUC:0.8533 FAR:0.00380
[2023-07-19 14:13:33,490][main.py][line:74][INFO] [Epoch:34/50]: loss1:0.0010 loss2:0.0196 | AUC:0.8535 FAR:0.00398
[2023-07-19 14:14:24,571][main.py][line:74][INFO] [Epoch:35/50]: loss1:0.0009 loss2:0.0185 | AUC:0.8520 FAR:0.00351
[2023-07-19 14:15:15,101][main.py][line:74][INFO] [Epoch:36/50]: loss1:0.0008 loss2:0.0169 | AUC:0.8509 FAR:0.00363
[2023-07-19 14:16:06,224][main.py][line:74][INFO] [Epoch:37/50]: loss1:0.0007 loss2:0.0148 | AUC:0.8505 FAR:0.00388
[2023-07-19 14:16:57,093][main.py][line:74][INFO] [Epoch:38/50]: loss1:0.0007 loss2:0.0150 | AUC:0.8505 FAR:0.00341
[2023-07-19 14:17:47,626][main.py][line:74][INFO] [Epoch:39/50]: loss1:0.0007 loss2:0.0135 | AUC:0.8520 FAR:0.00385
[2023-07-19 14:18:39,840][main.py][line:74][INFO] [Epoch:40/50]: loss1:0.0006 loss2:0.0131 | AUC:0.8513 FAR:0.00388
[2023-07-19 14:19:31,497][main.py][line:74][INFO] [Epoch:41/50]: loss1:0.0006 loss2:0.0121 | AUC:0.8509 FAR:0.00338
[2023-07-19 14:20:22,261][main.py][line:74][INFO] [Epoch:42/50]: loss1:0.0007 loss2:0.0123 | AUC:0.8483 FAR:0.00405
[2023-07-19 14:21:14,083][main.py][line:74][INFO] [Epoch:43/50]: loss1:0.0006 loss2:0.0115 | AUC:0.8496 FAR:0.00403
[2023-07-19 14:22:05,324][main.py][line:74][INFO] [Epoch:44/50]: loss1:0.0005 loss2:0.0106 | AUC:0.8506 FAR:0.00383
[2023-07-19 14:22:57,235][main.py][line:74][INFO] [Epoch:45/50]: loss1:0.0005 loss2:0.0100 | AUC:0.8501 FAR:0.00378
[2023-07-19 14:23:47,949][main.py][line:74][INFO] [Epoch:46/50]: loss1:0.0005 loss2:0.0094 | AUC:0.8489 FAR:0.00375
[2023-07-19 14:24:38,447][main.py][line:74][INFO] [Epoch:47/50]: loss1:0.0004 loss2:0.0093 | AUC:0.8492 FAR:0.00378
[2023-07-19 14:25:29,430][main.py][line:74][INFO] [Epoch:48/50]: loss1:0.0005 loss2:0.0092 | AUC:0.8489 FAR:0.00348
[2023-07-19 14:26:20,997][main.py][line:74][INFO] [Epoch:49/50]: loss1:0.0004 loss2:0.0091 | AUC:0.8498 FAR:0.00370
[2023-07-19 14:27:12,147][main.py][line:74][INFO] [Epoch:50/50]: loss1:0.0004 loss2:0.0083 | AUC:0.8498 FAR:0.00366
[2023-07-19 14:27:12,160][main.py][line:80][INFO] Training completes in 42m 50s | best AUC:0.8548 FAR:0.00457

[2023-07-19 14:31:40,316][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 14:31:40,425][main.py][line:113][INFO] total params:1.2091M
[2023-07-19 14:31:40,425][main.py][line:120][INFO] Test Mode
[2023-07-19 14:31:40,425][main.py][line:26][INFO] loading pretrained checkpoint from ./ckpt/ucf__8548.pkl.
[2023-07-19 14:31:46,121][infer.py][line:47][INFO] offline AUC:0.8601 AP:0.3172 FAR:0.0036 | Complete in 0m 6s

[2023-07-19 14:46:54,402][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 14:46:54,485][main.py][line:108][INFO] total params:1.2091M
[2023-07-19 14:46:54,485][main.py][line:111][INFO] Training Mode
[2023-07-19 14:46:54,486][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-19 14:46:54,486][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 14:48:43,190][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 14:48:43,272][main.py][line:108][INFO] total params:1.2091M
[2023-07-19 14:48:43,272][main.py][line:111][INFO] Training Mode
[2023-07-19 14:48:43,272][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-19 14:48:43,272][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 14:58:30,622][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 14:58:30,788][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 14:58:30,788][main.py][line:111][INFO] Training Mode
[2023-07-19 14:58:30,789][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
)

[2023-07-19 14:58:30,789][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:08:44,535][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:08:44,693][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:08:44,693][main.py][line:111][INFO] Training Mode
[2023-07-19 15:08:44,694][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
)

[2023-07-19 15:08:44,694][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:09:58,519][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:09:58,667][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:09:58,667][main.py][line:111][INFO] Training Mode
[2023-07-19 15:09:58,667][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
)

[2023-07-19 15:09:58,667][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:10:41,077][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:11:58,286][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:11:58,446][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:11:58,446][main.py][line:111][INFO] Training Mode
[2023-07-19 15:11:58,446][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
)

[2023-07-19 15:11:58,446][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:12:33,472][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:12:33,631][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:12:33,631][main.py][line:111][INFO] Training Mode
[2023-07-19 15:12:33,632][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:12:33,632][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:13:25,037][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:13:25,201][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:13:25,201][main.py][line:111][INFO] Training Mode
[2023-07-19 15:13:25,201][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:13:25,201][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:13:37,921][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:13:38,078][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:13:38,078][main.py][line:111][INFO] Training Mode
[2023-07-19 15:13:38,079][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:13:38,079][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:14:03,343][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:14:03,506][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:14:03,506][main.py][line:111][INFO] Training Mode
[2023-07-19 15:14:03,506][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:14:03,506][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:39:27,713][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:39:40,531][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:39:40,679][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:39:40,679][main.py][line:111][INFO] Training Mode
[2023-07-19 15:39:40,679][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:39:40,679][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:40:05,811][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:40:05,969][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:40:05,969][main.py][line:111][INFO] Training Mode
[2023-07-19 15:40:05,969][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:40:05,969][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:43:33,112][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:43:33,272][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:43:33,272][main.py][line:111][INFO] Training Mode
[2023-07-19 15:43:33,272][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:43:33,272][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:44:58,268][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:44:58,418][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:44:58,418][main.py][line:111][INFO] Training Mode
[2023-07-19 15:44:58,418][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:44:58,418][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:45:26,066][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:45:26,214][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:45:26,214][main.py][line:111][INFO] Training Mode
[2023-07-19 15:45:26,214][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:45:26,214][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:59:14,813][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:59:14,972][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:59:14,972][main.py][line:111][INFO] Training Mode
[2023-07-19 15:59:14,972][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:59:14,972][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:59:26,260][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:59:26,409][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:59:26,409][main.py][line:111][INFO] Training Mode
[2023-07-19 15:59:26,410][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:59:26,410][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:00:17,464][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:00:17,623][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:00:17,623][main.py][line:111][INFO] Training Mode
[2023-07-19 16:00:17,624][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:00:17,624][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:00:27,960][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:00:28,109][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:00:28,109][main.py][line:111][INFO] Training Mode
[2023-07-19 16:00:28,109][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:00:28,109][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:01:28,931][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:01:29,091][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:01:29,091][main.py][line:111][INFO] Training Mode
[2023-07-19 16:01:29,091][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:01:29,091][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:01:57,114][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:01:57,271][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:01:57,271][main.py][line:111][INFO] Training Mode
[2023-07-19 16:01:57,272][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:01:57,272][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:02:15,599][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:02:15,757][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:02:15,758][main.py][line:111][INFO] Training Mode
[2023-07-19 16:02:15,758][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:02:15,758][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:02:25,387][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:02:25,544][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:02:25,544][main.py][line:111][INFO] Training Mode
[2023-07-19 16:02:25,544][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:02:25,544][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:02:54,098][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:02:54,258][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:02:54,258][main.py][line:111][INFO] Training Mode
[2023-07-19 16:02:54,258][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:02:54,258][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:03:13,069][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:03:13,227][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:03:13,227][main.py][line:111][INFO] Training Mode
[2023-07-19 16:03:13,228][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:03:13,228][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:03:55,900][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:03:56,066][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:03:56,066][main.py][line:111][INFO] Training Mode
[2023-07-19 16:03:56,067][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:03:56,067][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:04:47,740][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:04:47,904][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:04:47,904][main.py][line:111][INFO] Training Mode
[2023-07-19 16:04:47,904][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:04:47,904][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:05:02,269][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:05:02,420][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:05:02,420][main.py][line:111][INFO] Training Mode
[2023-07-19 16:05:02,420][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:05:02,420][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:06:20,525][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:06:20,675][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:06:20,675][main.py][line:111][INFO] Training Mode
[2023-07-19 16:06:20,675][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:06:20,676][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:11:53,816][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:11:53,971][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:11:53,971][main.py][line:111][INFO] Training Mode
[2023-07-19 16:11:53,972][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:11:53,972][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:16:58,189][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:16:58,345][main.py][line:108][INFO] total params:27.0045M
[2023-07-19 16:16:58,345][main.py][line:111][INFO] Training Mode
[2023-07-19 16:16:58,345][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:16:58,345][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:23:34,186][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:23:34,342][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:23:34,342][main.py][line:111][INFO] Training Mode
[2023-07-19 16:23:34,343][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:23:34,343][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:24:25,160][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:24:25,326][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:24:25,326][main.py][line:111][INFO] Training Mode
[2023-07-19 16:24:25,327][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:24:25,327][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:27:12,296][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:27:12,455][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:27:12,455][main.py][line:111][INFO] Training Mode
[2023-07-19 16:27:12,455][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:27:12,455][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:27:24,611][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:27:24,778][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:27:24,778][main.py][line:111][INFO] Training Mode
[2023-07-19 16:27:24,778][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:27:24,778][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:28:41,579][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:28:41,732][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:28:41,732][main.py][line:111][INFO] Training Mode
[2023-07-19 16:28:41,732][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:28:41,732][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:30:16,308][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:30:16,477][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:30:16,477][main.py][line:111][INFO] Training Mode
[2023-07-19 16:30:16,477][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:30:16,478][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:32:44,531][main.py][line:83][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:32:44,694][main.py][line:109][INFO] total params:27.0270M
[2023-07-19 16:32:44,694][main.py][line:112][INFO] Training Mode
[2023-07-19 16:32:44,695][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:32:44,695][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:34:07,788][main.py][line:83][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:34:07,951][main.py][line:109][INFO] total params:27.0270M
[2023-07-19 16:34:07,951][main.py][line:112][INFO] Training Mode
[2023-07-19 16:34:07,951][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:34:07,951][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:34:15,549][main.py][line:52][INFO] Random initialize AUC:initial AUC:0.5452 initial AUC2:0.5444 FAR:0.67905
[2023-07-19 16:36:01,443][main.py][line:83][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:36:01,606][main.py][line:109][INFO] total params:27.0270M
[2023-07-19 16:36:01,606][main.py][line:112][INFO] Training Mode
[2023-07-19 16:36:01,606][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:36:01,606][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:36:09,149][main.py][line:52][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-19 16:38:29,607][main.py][line:83][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:38:29,782][main.py][line:109][INFO] total params:27.0270M
[2023-07-19 16:38:29,782][main.py][line:112][INFO] Training Mode
[2023-07-19 16:38:29,782][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:38:29,782][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:38:37,322][main.py][line:52][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-19 16:39:43,780][main.py][line:70][INFO] [Epoch:1/50]: loss1:0.3749 loss2:1.1640 | AUC:0.8316 AUC2:0.8316 FAR:0.00830
[2023-07-19 16:40:49,846][main.py][line:70][INFO] [Epoch:2/50]: loss1:0.1347 loss2:0.9541 | AUC:0.8518 AUC2:0.8517 FAR:0.00990
[2023-07-19 16:41:56,816][main.py][line:70][INFO] [Epoch:3/50]: loss1:0.0532 loss2:0.8623 | AUC:0.8554 AUC2:0.8553 FAR:0.01148
[2023-07-19 16:43:03,490][main.py][line:70][INFO] [Epoch:4/50]: loss1:0.0257 loss2:0.7901 | AUC:0.8447 AUC2:0.8553 FAR:0.00314
[2023-07-19 16:44:10,005][main.py][line:70][INFO] [Epoch:5/50]: loss1:0.0181 loss2:0.7232 | AUC:0.8501 AUC2:0.8553 FAR:0.00687
[2023-07-19 16:45:16,784][main.py][line:70][INFO] [Epoch:6/50]: loss1:0.0233 loss2:0.6746 | AUC:0.8471 AUC2:0.8553 FAR:0.00531
[2023-07-19 16:46:23,514][main.py][line:70][INFO] [Epoch:7/50]: loss1:0.0070 loss2:0.6079 | AUC:0.8466 AUC2:0.8553 FAR:0.00198
[2023-07-19 16:47:30,262][main.py][line:70][INFO] [Epoch:8/50]: loss1:0.0055 loss2:0.5477 | AUC:0.8531 AUC2:0.8553 FAR:0.00240
[2023-07-19 16:48:36,972][main.py][line:70][INFO] [Epoch:9/50]: loss1:0.0049 loss2:0.4848 | AUC:0.8494 AUC2:0.8553 FAR:0.00230
[2023-07-19 16:49:43,650][main.py][line:70][INFO] [Epoch:10/50]: loss1:0.0044 loss2:0.4338 | AUC:0.8456 AUC2:0.8553 FAR:0.00254
[2023-07-19 16:50:50,242][main.py][line:70][INFO] [Epoch:11/50]: loss1:0.0047 loss2:0.3830 | AUC:0.8392 AUC2:0.8553 FAR:0.00672
[2023-07-19 16:51:56,625][main.py][line:70][INFO] [Epoch:12/50]: loss1:0.0379 loss2:0.4065 | AUC:0.8534 AUC2:0.8553 FAR:0.00926
[2023-07-19 16:53:03,544][main.py][line:70][INFO] [Epoch:13/50]: loss1:0.0222 loss2:0.3520 | AUC:0.8516 AUC2:0.8553 FAR:0.00948
[2023-07-19 16:54:10,193][main.py][line:70][INFO] [Epoch:14/50]: loss1:0.0054 loss2:0.2840 | AUC:0.8504 AUC2:0.8553 FAR:0.00501
[2023-07-19 16:55:17,334][main.py][line:70][INFO] [Epoch:15/50]: loss1:0.0030 loss2:0.2417 | AUC:0.8510 AUC2:0.8553 FAR:0.00511
[2023-07-19 16:56:24,108][main.py][line:70][INFO] [Epoch:16/50]: loss1:0.0024 loss2:0.2048 | AUC:0.8512 AUC2:0.8553 FAR:0.00445
[2023-07-19 16:57:31,159][main.py][line:70][INFO] [Epoch:17/50]: loss1:0.0023 loss2:0.1751 | AUC:0.8478 AUC2:0.8553 FAR:0.00467
[2023-07-19 16:58:37,880][main.py][line:70][INFO] [Epoch:18/50]: loss1:0.0019 loss2:0.1487 | AUC:0.8490 AUC2:0.8553 FAR:0.00462
[2023-07-19 16:59:44,768][main.py][line:70][INFO] [Epoch:19/50]: loss1:0.0018 loss2:0.1273 | AUC:0.8506 AUC2:0.8553 FAR:0.00450
[2023-07-19 17:00:51,397][main.py][line:70][INFO] [Epoch:20/50]: loss1:0.0016 loss2:0.1072 | AUC:0.8478 AUC2:0.8553 FAR:0.00457
[2023-07-19 17:06:51,490][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0001, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 400, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 17:06:51,700][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 17:06:51,700][main.py][line:119][INFO] Training Mode
[2023-07-19 17:06:51,700][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 17:06:51,700][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0
)

[2023-07-19 17:06:59,538][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-19 17:07:54,176][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.4485 loss2:1.2754 main_loss:2.1725 | AUC:0.8194 AUC2:0.8194 FAR:0.02433
[2023-07-19 17:08:50,124][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.2570 loss2:1.1698 main_loss:1.6838 | AUC:0.8389 AUC2:0.8389 FAR:0.01223
[2023-07-19 17:09:46,478][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.1547 loss2:1.0519 main_loss:1.3613 | AUC:0.8474 AUC2:0.8474 FAR:0.00958
[2023-07-19 17:11:39,916][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 17:11:40,109][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 17:11:40,110][main.py][line:119][INFO] Training Mode
[2023-07-19 17:11:40,110][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 17:11:40,110][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0003
    lr: 0.0003
    maximize: False
    weight_decay: 0
)

[2023-07-19 17:11:48,068][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-19 17:13:22,557][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3629 loss2:1.1955 main_loss:1.9213 | AUC:0.8264 AUC2:0.8264 FAR:0.03816
[2023-07-19 17:14:56,395][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1381 loss2:1.0275 main_loss:1.3038 | AUC:0.8410 AUC2:0.8410 FAR:0.02023
[2023-07-19 17:16:26,214][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0442 loss2:0.9445 main_loss:1.0328 | AUC:0.8454 AUC2:0.8454 FAR:0.01319
[2023-07-19 17:17:52,735][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0233 loss2:0.8820 main_loss:0.9287 | AUC:0.8375 AUC2:0.8454 FAR:0.01512
[2023-07-19 17:19:25,363][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0129 loss2:0.8164 main_loss:0.8422 | AUC:0.8473 AUC2:0.8473 FAR:0.01487
[2023-07-19 17:20:49,699][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0100 loss2:0.7686 main_loss:0.7886 | AUC:0.8449 AUC2:0.8473 FAR:0.01218
[2023-07-19 17:22:11,673][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0111 loss2:0.7032 main_loss:0.7253 | AUC:0.8430 AUC2:0.8473 FAR:0.01420
[2023-07-19 17:23:31,803][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0178 loss2:0.6556 main_loss:0.6913 | AUC:0.8475 AUC2:0.8474 FAR:0.02737
[2023-07-19 17:24:46,241][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0074 loss2:0.5936 main_loss:0.6085 | AUC:0.8531 AUC2:0.8531 FAR:0.00489
[2023-07-19 17:26:01,668][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0071 loss2:0.5268 main_loss:0.5410 | AUC:0.8504 AUC2:0.8531 FAR:0.02220
[2023-07-19 17:27:19,595][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.0111 loss2:0.4812 main_loss:0.5035 | AUC:0.8531 AUC2:0.8531 FAR:0.00943
[2023-07-19 17:28:38,521][main.py][line:76][INFO] [Epoch:12/100]: loss1:0.0082 loss2:0.4237 main_loss:0.4400 | AUC:0.8474 AUC2:0.8531 FAR:0.01146
[2023-07-19 17:30:06,568][main.py][line:76][INFO] [Epoch:13/100]: loss1:0.0052 loss2:0.3560 main_loss:0.3663 | AUC:0.8493 AUC2:0.8531 FAR:0.01531
[2023-07-19 17:31:13,212][main.py][line:76][INFO] [Epoch:14/100]: loss1:0.0042 loss2:0.3048 main_loss:0.3132 | AUC:0.8518 AUC2:0.8531 FAR:0.01470
[2023-07-19 17:32:20,754][main.py][line:76][INFO] [Epoch:15/100]: loss1:0.0034 loss2:0.2458 main_loss:0.2527 | AUC:0.8500 AUC2:0.8531 FAR:0.00919
[2023-07-19 17:33:33,166][main.py][line:76][INFO] [Epoch:16/100]: loss1:0.0036 loss2:0.2038 main_loss:0.2110 | AUC:0.8522 AUC2:0.8531 FAR:0.01558
[2023-07-19 17:34:49,879][main.py][line:76][INFO] [Epoch:17/100]: loss1:0.0041 loss2:0.1666 main_loss:0.1748 | AUC:0.8470 AUC2:0.8531 FAR:0.01778
[2023-07-19 17:36:01,448][main.py][line:76][INFO] [Epoch:18/100]: loss1:0.0154 loss2:0.1745 main_loss:0.2052 | AUC:0.8399 AUC2:0.8531 FAR:0.04611
[2023-07-19 17:37:08,646][main.py][line:76][INFO] [Epoch:19/100]: loss1:0.0083 loss2:0.1454 main_loss:0.1620 | AUC:0.8486 AUC2:0.8531 FAR:0.01460
[2023-07-19 17:38:17,270][main.py][line:76][INFO] [Epoch:20/100]: loss1:0.0096 loss2:0.1003 main_loss:0.1195 | AUC:0.8418 AUC2:0.8531 FAR:0.01907
[2023-07-19 17:39:21,493][main.py][line:76][INFO] [Epoch:21/100]: loss1:0.0117 loss2:0.0891 main_loss:0.1125 | AUC:0.8451 AUC2:0.8531 FAR:0.02206
[2023-07-19 17:40:23,342][main.py][line:76][INFO] [Epoch:22/100]: loss1:0.0017 loss2:0.0657 main_loss:0.0690 | AUC:0.8458 AUC2:0.8531 FAR:0.02396
[2023-07-19 17:41:29,408][main.py][line:76][INFO] [Epoch:23/100]: loss1:0.0024 loss2:0.0572 main_loss:0.0620 | AUC:0.8437 AUC2:0.8531 FAR:0.01761
[2023-07-19 17:42:37,390][main.py][line:76][INFO] [Epoch:24/100]: loss1:0.0012 loss2:0.0448 main_loss:0.0472 | AUC:0.8473 AUC2:0.8531 FAR:0.01344
[2023-07-19 17:43:50,878][main.py][line:76][INFO] [Epoch:25/100]: loss1:0.0008 loss2:0.0362 main_loss:0.0378 | AUC:0.8481 AUC2:0.8531 FAR:0.01894
[2023-07-19 17:45:04,074][main.py][line:76][INFO] [Epoch:26/100]: loss1:0.0006 loss2:0.0280 main_loss:0.0293 | AUC:0.8501 AUC2:0.8531 FAR:0.01576
[2023-07-19 17:46:14,035][main.py][line:76][INFO] [Epoch:27/100]: loss1:0.0006 loss2:0.0238 main_loss:0.0250 | AUC:0.8495 AUC2:0.8531 FAR:0.01447
[2023-07-19 17:47:25,870][main.py][line:76][INFO] [Epoch:28/100]: loss1:0.0005 loss2:0.0190 main_loss:0.0199 | AUC:0.8501 AUC2:0.8531 FAR:0.01255
[2023-07-19 17:48:43,655][main.py][line:76][INFO] [Epoch:29/100]: loss1:0.0004 loss2:0.0173 main_loss:0.0181 | AUC:0.8499 AUC2:0.8531 FAR:0.01423
[2023-07-19 17:50:06,776][main.py][line:76][INFO] [Epoch:30/100]: loss1:0.0004 loss2:0.0146 main_loss:0.0154 | AUC:0.8498 AUC2:0.8531 FAR:0.01665
[2023-07-19 17:51:28,772][main.py][line:76][INFO] [Epoch:31/100]: loss1:0.0014 loss2:0.0145 main_loss:0.0173 | AUC:0.8488 AUC2:0.8531 FAR:0.01334
[2023-07-19 17:52:33,413][main.py][line:76][INFO] [Epoch:32/100]: loss1:0.0003 loss2:0.0117 main_loss:0.0124 | AUC:0.8493 AUC2:0.8531 FAR:0.01344
[2023-07-19 17:53:40,997][main.py][line:76][INFO] [Epoch:33/100]: loss1:0.0003 loss2:0.0100 main_loss:0.0106 | AUC:0.8492 AUC2:0.8531 FAR:0.01349
[2023-07-19 17:54:50,752][main.py][line:76][INFO] [Epoch:34/100]: loss1:0.0007 loss2:0.0106 main_loss:0.0121 | AUC:0.8480 AUC2:0.8531 FAR:0.01314
[2023-07-19 17:56:01,694][main.py][line:76][INFO] [Epoch:35/100]: loss1:0.0003 loss2:0.0089 main_loss:0.0094 | AUC:0.8500 AUC2:0.8531 FAR:0.01319
[2023-07-19 17:57:12,364][main.py][line:76][INFO] [Epoch:36/100]: loss1:0.0002 loss2:0.0072 main_loss:0.0077 | AUC:0.8500 AUC2:0.8531 FAR:0.01405
[2023-07-19 17:58:24,434][main.py][line:76][INFO] [Epoch:37/100]: loss1:0.0041 loss2:0.0122 main_loss:0.0204 | AUC:0.8411 AUC2:0.8531 FAR:0.01729
[2023-07-19 17:59:37,657][main.py][line:76][INFO] [Epoch:38/100]: loss1:0.0024 loss2:0.0146 main_loss:0.0195 | AUC:0.8486 AUC2:0.8531 FAR:0.01326
[2023-07-19 18:00:49,750][main.py][line:76][INFO] [Epoch:39/100]: loss1:0.0004 loss2:0.0078 main_loss:0.0086 | AUC:0.8508 AUC2:0.8531 FAR:0.01358
[2023-07-19 18:02:09,513][main.py][line:76][INFO] [Epoch:40/100]: loss1:0.0003 loss2:0.0067 main_loss:0.0074 | AUC:0.8480 AUC2:0.8531 FAR:0.01566
[2023-07-19 18:03:20,202][main.py][line:76][INFO] [Epoch:41/100]: loss1:0.0003 loss2:0.0062 main_loss:0.0068 | AUC:0.8506 AUC2:0.8531 FAR:0.01625
[2023-07-19 18:04:35,435][main.py][line:76][INFO] [Epoch:42/100]: loss1:0.0002 loss2:0.0057 main_loss:0.0062 | AUC:0.8507 AUC2:0.8531 FAR:0.01554
[2023-07-19 18:05:44,239][main.py][line:76][INFO] [Epoch:43/100]: loss1:0.0002 loss2:0.0052 main_loss:0.0056 | AUC:0.8499 AUC2:0.8531 FAR:0.01603
[2023-07-19 18:07:00,009][main.py][line:76][INFO] [Epoch:44/100]: loss1:0.0018 loss2:0.0093 main_loss:0.0128 | AUC:0.8444 AUC2:0.8531 FAR:0.02576
[2023-07-19 18:08:20,508][main.py][line:76][INFO] [Epoch:45/100]: loss1:0.0003 loss2:0.0056 main_loss:0.0061 | AUC:0.8463 AUC2:0.8531 FAR:0.01620
[2023-07-19 18:09:27,513][main.py][line:76][INFO] [Epoch:46/100]: loss1:0.0002 loss2:0.0049 main_loss:0.0053 | AUC:0.8469 AUC2:0.8531 FAR:0.01635
[2023-07-19 18:10:38,493][main.py][line:76][INFO] [Epoch:47/100]: loss1:0.0002 loss2:0.0043 main_loss:0.0046 | AUC:0.8472 AUC2:0.8531 FAR:0.01613
[2023-07-19 18:11:57,701][main.py][line:76][INFO] [Epoch:48/100]: loss1:0.0001 loss2:0.0041 main_loss:0.0044 | AUC:0.8475 AUC2:0.8531 FAR:0.01576
[2023-07-19 18:13:16,841][main.py][line:76][INFO] [Epoch:49/100]: loss1:0.0001 loss2:0.0039 main_loss:0.0042 | AUC:0.8478 AUC2:0.8531 FAR:0.01529
[2023-07-19 18:14:32,305][main.py][line:76][INFO] [Epoch:50/100]: loss1:0.0001 loss2:0.0037 main_loss:0.0040 | AUC:0.8480 AUC2:0.8531 FAR:0.01546
[2023-07-19 18:15:47,656][main.py][line:76][INFO] [Epoch:51/100]: loss1:0.0001 loss2:0.0036 main_loss:0.0038 | AUC:0.8482 AUC2:0.8531 FAR:0.01504
[2023-07-19 18:17:05,706][main.py][line:76][INFO] [Epoch:52/100]: loss1:0.0001 loss2:0.0034 main_loss:0.0036 | AUC:0.8483 AUC2:0.8531 FAR:0.01558
[2023-07-19 18:18:15,379][main.py][line:76][INFO] [Epoch:53/100]: loss1:0.0001 loss2:0.0035 main_loss:0.0037 | AUC:0.8484 AUC2:0.8531 FAR:0.01521
[2023-07-19 18:19:25,668][main.py][line:76][INFO] [Epoch:54/100]: loss1:0.0001 loss2:0.0033 main_loss:0.0036 | AUC:0.8485 AUC2:0.8531 FAR:0.01529
[2023-07-19 18:20:35,727][main.py][line:76][INFO] [Epoch:55/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0035 | AUC:0.8485 AUC2:0.8531 FAR:0.01534
[2023-07-19 18:21:48,012][main.py][line:76][INFO] [Epoch:56/100]: loss1:0.0001 loss2:0.0034 main_loss:0.0036 | AUC:0.8486 AUC2:0.8531 FAR:0.01531
[2023-07-19 18:22:52,817][main.py][line:76][INFO] [Epoch:57/100]: loss1:0.0001 loss2:0.0030 main_loss:0.0033 | AUC:0.8486 AUC2:0.8531 FAR:0.01534
[2023-07-19 18:24:01,597][main.py][line:76][INFO] [Epoch:58/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0034 | AUC:0.8487 AUC2:0.8531 FAR:0.01620
[2023-07-19 18:25:15,296][main.py][line:76][INFO] [Epoch:59/100]: loss1:0.0001 loss2:0.0033 main_loss:0.0035 | AUC:0.8487 AUC2:0.8531 FAR:0.01608
[2023-07-19 18:26:36,903][main.py][line:76][INFO] [Epoch:60/100]: loss1:0.0001 loss2:0.0033 main_loss:0.0035 | AUC:0.8487 AUC2:0.8531 FAR:0.01600
[2023-07-19 18:27:46,452][main.py][line:76][INFO] [Epoch:61/100]: loss1:0.0001 loss2:0.0031 main_loss:0.0033 | AUC:0.8487 AUC2:0.8531 FAR:0.01600
[2023-07-19 18:28:51,162][main.py][line:76][INFO] [Epoch:62/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0034 | AUC:0.8487 AUC2:0.8531 FAR:0.01600
[2023-07-19 18:30:07,543][main.py][line:76][INFO] [Epoch:63/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0035 | AUC:0.8487 AUC2:0.8531 FAR:0.01581
[2023-07-19 18:31:17,366][main.py][line:76][INFO] [Epoch:64/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0034 | AUC:0.8487 AUC2:0.8531 FAR:0.01571
[2023-07-19 18:32:28,097][main.py][line:76][INFO] [Epoch:65/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0034 | AUC:0.8488 AUC2:0.8531 FAR:0.01551
[2023-07-19 18:33:43,775][main.py][line:76][INFO] [Epoch:66/100]: loss1:0.0001 loss2:0.0031 main_loss:0.0033 | AUC:0.8488 AUC2:0.8531 FAR:0.01509
[2023-07-19 18:34:52,319][main.py][line:76][INFO] [Epoch:67/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0034 | AUC:0.8488 AUC2:0.8531 FAR:0.01531
[2023-07-19 18:36:11,436][main.py][line:76][INFO] [Epoch:68/100]: loss1:0.0001 loss2:0.0031 main_loss:0.0033 | AUC:0.8489 AUC2:0.8531 FAR:0.01502
[2023-07-19 18:37:25,506][main.py][line:76][INFO] [Epoch:69/100]: loss1:0.0001 loss2:0.0028 main_loss:0.0030 | AUC:0.8489 AUC2:0.8531 FAR:0.01465
[2023-07-19 18:38:40,558][main.py][line:76][INFO] [Epoch:70/100]: loss1:0.0002 loss2:0.0033 main_loss:0.0036 | AUC:0.8476 AUC2:0.8531 FAR:0.01450
[2023-07-19 18:40:00,807][main.py][line:76][INFO] [Epoch:71/100]: loss1:0.0001 loss2:0.0029 main_loss:0.0031 | AUC:0.8476 AUC2:0.8531 FAR:0.01447
[2023-07-19 18:41:06,392][main.py][line:76][INFO] [Epoch:72/100]: loss1:0.0001 loss2:0.0025 main_loss:0.0027 | AUC:0.8471 AUC2:0.8531 FAR:0.01571
[2023-07-19 18:42:18,240][main.py][line:76][INFO] [Epoch:73/100]: loss1:0.0003 loss2:0.0034 main_loss:0.0040 | AUC:0.8446 AUC2:0.8531 FAR:0.01763
[2023-07-19 18:43:31,400][main.py][line:76][INFO] [Epoch:74/100]: loss1:0.0001 loss2:0.0029 main_loss:0.0031 | AUC:0.8458 AUC2:0.8531 FAR:0.01628
[2023-07-19 18:44:39,476][main.py][line:76][INFO] [Epoch:75/100]: loss1:0.0001 loss2:0.0026 main_loss:0.0028 | AUC:0.8454 AUC2:0.8531 FAR:0.01114
[2023-07-19 18:46:01,233][main.py][line:76][INFO] [Epoch:76/100]: loss1:0.0001 loss2:0.0027 main_loss:0.0029 | AUC:0.8460 AUC2:0.8531 FAR:0.01474
[2023-07-19 18:47:14,436][main.py][line:76][INFO] [Epoch:77/100]: loss1:0.0001 loss2:0.0023 main_loss:0.0025 | AUC:0.8476 AUC2:0.8531 FAR:0.01524
[2023-07-19 18:48:27,219][main.py][line:76][INFO] [Epoch:78/100]: loss1:0.0001 loss2:0.0021 main_loss:0.0022 | AUC:0.8457 AUC2:0.8531 FAR:0.01514
[2023-07-19 18:49:44,929][main.py][line:76][INFO] [Epoch:79/100]: loss1:0.0001 loss2:0.0027 main_loss:0.0030 | AUC:0.8437 AUC2:0.8531 FAR:0.01106
[2023-07-19 18:50:56,390][main.py][line:76][INFO] [Epoch:80/100]: loss1:0.0013 loss2:0.0046 main_loss:0.0071 | AUC:0.8406 AUC2:0.8531 FAR:0.01267
[2023-07-19 18:52:09,394][main.py][line:76][INFO] [Epoch:81/100]: loss1:0.0001 loss2:0.0023 main_loss:0.0025 | AUC:0.8410 AUC2:0.8531 FAR:0.01121
[2023-07-19 18:53:18,676][main.py][line:76][INFO] [Epoch:82/100]: loss1:0.0001 loss2:0.0019 main_loss:0.0021 | AUC:0.8419 AUC2:0.8531 FAR:0.01161
[2023-07-19 18:54:37,585][main.py][line:76][INFO] [Epoch:83/100]: loss1:0.0001 loss2:0.0017 main_loss:0.0018 | AUC:0.8420 AUC2:0.8531 FAR:0.01141
[2023-07-19 18:55:55,349][main.py][line:76][INFO] [Epoch:84/100]: loss1:0.0000 loss2:0.0016 main_loss:0.0017 | AUC:0.8420 AUC2:0.8531 FAR:0.01042
[2023-07-19 18:57:16,231][main.py][line:76][INFO] [Epoch:85/100]: loss1:0.0099 loss2:0.0126 main_loss:0.0324 | AUC:0.8359 AUC2:0.8531 FAR:0.02294
[2023-07-19 18:58:36,771][main.py][line:76][INFO] [Epoch:86/100]: loss1:0.0011 loss2:0.0064 main_loss:0.0086 | AUC:0.8405 AUC2:0.8531 FAR:0.01889
[2023-07-19 19:00:01,733][main.py][line:76][INFO] [Epoch:87/100]: loss1:0.0039 loss2:0.0089 main_loss:0.0166 | AUC:0.8401 AUC2:0.8531 FAR:0.01986
[2023-07-19 19:01:12,801][main.py][line:76][INFO] [Epoch:88/100]: loss1:0.0003 loss2:0.0038 main_loss:0.0044 | AUC:0.8386 AUC2:0.8531 FAR:0.01904
[2023-07-19 19:02:24,944][main.py][line:76][INFO] [Epoch:89/100]: loss1:0.0003 loss2:0.0027 main_loss:0.0034 | AUC:0.8376 AUC2:0.8531 FAR:0.02218
[2023-07-19 19:03:34,789][main.py][line:76][INFO] [Epoch:90/100]: loss1:0.0003 loss2:0.0027 main_loss:0.0032 | AUC:0.8396 AUC2:0.8531 FAR:0.02159
[2023-07-19 19:04:58,918][main.py][line:76][INFO] [Epoch:91/100]: loss1:0.0003 loss2:0.0022 main_loss:0.0027 | AUC:0.8391 AUC2:0.8531 FAR:0.01568
[2023-07-19 19:06:22,645][main.py][line:76][INFO] [Epoch:92/100]: loss1:0.0002 loss2:0.0019 main_loss:0.0023 | AUC:0.8403 AUC2:0.8531 FAR:0.01689
[2023-07-19 19:07:45,054][main.py][line:76][INFO] [Epoch:93/100]: loss1:0.0001 loss2:0.0016 main_loss:0.0019 | AUC:0.8405 AUC2:0.8531 FAR:0.01714
[2023-07-19 19:08:58,211][main.py][line:76][INFO] [Epoch:94/100]: loss1:0.0001 loss2:0.0015 main_loss:0.0016 | AUC:0.8411 AUC2:0.8531 FAR:0.01494
[2023-07-19 19:10:22,884][main.py][line:76][INFO] [Epoch:95/100]: loss1:0.0001 loss2:0.0012 main_loss:0.0013 | AUC:0.8416 AUC2:0.8531 FAR:0.01482
[2023-07-19 19:11:48,900][main.py][line:76][INFO] [Epoch:96/100]: loss1:0.0000 loss2:0.0013 main_loss:0.0014 | AUC:0.8419 AUC2:0.8531 FAR:0.01400
[2023-07-19 19:13:36,554][main.py][line:76][INFO] [Epoch:97/100]: loss1:0.0001 loss2:0.0010 main_loss:0.0011 | AUC:0.8409 AUC2:0.8531 FAR:0.01494
[2023-07-19 19:14:57,196][main.py][line:76][INFO] [Epoch:98/100]: loss1:0.0001 loss2:0.0014 main_loss:0.0015 | AUC:0.8412 AUC2:0.8531 FAR:0.00753
[2023-07-19 19:16:34,649][main.py][line:76][INFO] [Epoch:99/100]: loss1:0.0486 loss2:0.0482 main_loss:0.1455 | AUC:0.8388 AUC2:0.8531 FAR:0.00778
[2023-07-19 19:17:58,102][main.py][line:76][INFO] [Epoch:100/100]: loss1:0.0092 loss2:0.0164 main_loss:0.0348 | AUC:0.8301 AUC2:0.8531 FAR:0.01754
[2023-07-19 19:17:58,104][main.py][line:82][INFO] Training completes in 126m 10s | best AUC:0.8531 FAR:0.00489

[2023-07-19 20:28:54,913][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:28:55,094][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:28:55,095][main.py][line:123][INFO] Test Mode
[2023-07-19 20:31:00,761][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8531.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:31:00,921][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:31:00,921][main.py][line:123][INFO] Test Mode
[2023-07-19 20:32:43,985][main.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8531.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:32:44,145][main.py][line:117][INFO] total params:27.0270M
[2023-07-19 20:32:44,146][main.py][line:124][INFO] Test Mode
[2023-07-19 20:33:15,846][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:33:15,995][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:33:15,996][main.py][line:123][INFO] Test Mode
[2023-07-19 20:33:15,996][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8531.pkl.
[2023-07-19 20:34:48,895][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:34:49,044][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:34:49,044][main.py][line:123][INFO] Test Mode
[2023-07-19 20:34:49,044][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8531.pkl.
[2023-07-19 20:35:46,979][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:35:47,126][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:35:47,127][main.py][line:123][INFO] Test Mode
[2023-07-19 20:35:47,127][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8531.pkl.
[2023-07-19 20:35:55,296][infer_bert.py][line:55][INFO] offline AUC:0.8531 AUC2:0.8568 AP:0.3223 FAR:0.0040 | Complete in 0m 8s

[2023-07-19 20:39:16,844][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:39:17,005][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:39:17,005][main.py][line:123][INFO] Test Mode
[2023-07-19 20:39:17,005][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8531.pkl.
[2023-07-19 20:39:23,634][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:39:23,781][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:39:23,781][main.py][line:119][INFO] Training Mode
[2023-07-19 20:39:23,782][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 20:39:23,782][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0003
    lr: 0.0003
    maximize: False
    weight_decay: 0
)

[2023-07-19 20:39:31,301][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-19 20:40:29,063][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3642 loss2:1.1187 main_loss:1.4829 | AUC:0.8266 AUC2:0.8266 FAR:0.04483
[2023-07-19 20:41:28,490][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1438 loss2:0.9801 main_loss:1.1239 | AUC:0.8429 AUC2:0.8429 FAR:0.01894
[2023-07-19 20:42:27,619][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0586 loss2:0.8905 main_loss:0.9491 | AUC:0.8530 AUC2:0.8530 FAR:0.00773
[2023-07-19 20:43:27,620][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0403 loss2:0.7955 main_loss:0.8359 | AUC:0.8409 AUC2:0.8530 FAR:0.00328
[2023-07-19 20:44:27,087][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0270 loss2:0.7031 main_loss:0.7301 | AUC:0.8427 AUC2:0.8530 FAR:0.01274
[2023-07-19 20:45:24,872][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0271 loss2:0.6249 main_loss:0.6520 | AUC:0.8363 AUC2:0.8530 FAR:0.00882
[2023-07-19 20:46:24,055][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0177 loss2:0.5493 main_loss:0.5670 | AUC:0.8475 AUC2:0.8530 FAR:0.00674
[2023-07-19 20:47:23,770][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0202 loss2:0.4792 main_loss:0.4994 | AUC:0.8384 AUC2:0.8530 FAR:0.00212
[2023-07-19 20:48:23,221][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0240 loss2:0.4227 main_loss:0.4467 | AUC:0.8515 AUC2:0.8530 FAR:0.01168
[2023-07-19 20:49:23,291][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0254 loss2:0.3722 main_loss:0.3975 | AUC:0.8383 AUC2:0.8530 FAR:0.01512
[2023-07-19 20:50:20,328][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 55, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 256, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:50:20,511][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:50:20,511][main.py][line:119][INFO] Training Mode
[2023-07-19 20:50:20,511][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 20:50:20,511][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 20:50:28,781][main.py][line:53][INFO] Random initialize AUC:0.5760 initial_AUC2:0.5763 FAR:0.05021
[2023-07-19 20:54:07,818][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.4335 loss2:1.1767 main_loss:1.6102 | AUC:0.8263 AUC2:0.8263 FAR:0.01336
[2023-07-19 20:57:25,356][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.2136 loss2:0.9531 main_loss:1.1667 | AUC:0.8301 AUC2:0.8301 FAR:0.00635
[2023-07-19 21:00:33,003][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0978 loss2:0.8595 main_loss:0.9573 | AUC:0.8421 AUC2:0.8422 FAR:0.00314
[2023-07-19 21:03:14,116][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0562 loss2:0.8048 main_loss:0.8610 | AUC:0.8359 AUC2:0.8422 FAR:0.00380
[2023-07-19 21:06:23,396][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0304 loss2:0.7535 main_loss:0.7838 | AUC:0.8375 AUC2:0.8422 FAR:0.00148
[2023-07-19 21:09:12,046][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0229 loss2:0.7113 main_loss:0.7341 | AUC:0.8394 AUC2:0.8422 FAR:0.00479
[2023-07-19 21:11:57,250][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0252 loss2:0.6820 main_loss:0.7073 | AUC:0.8199 AUC2:0.8422 FAR:0.00637
[2023-07-19 21:14:37,112][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0161 loss2:0.6451 main_loss:0.6612 | AUC:0.8368 AUC2:0.8422 FAR:0.00405
[2023-07-19 21:17:34,684][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0104 loss2:0.6044 main_loss:0.6149 | AUC:0.8390 AUC2:0.8422 FAR:0.00432
[2023-07-19 21:20:39,798][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0188 loss2:0.5791 main_loss:0.5979 | AUC:0.8356 AUC2:0.8422 FAR:0.00526
[2023-07-19 21:23:35,423][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.0205 loss2:0.5566 main_loss:0.5771 | AUC:0.8469 AUC2:0.8469 FAR:0.00479
[2023-07-19 21:26:19,109][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 21:26:19,301][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 21:26:19,301][main.py][line:119][INFO] Training Mode
[2023-07-19 21:26:19,301][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 21:26:19,301][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 21:26:27,452][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-19 21:28:45,247][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3725 loss2:1.0986 main_loss:1.4711 | AUC:0.8345 AUC2:0.8345 FAR:0.00450
[2023-07-19 21:31:00,212][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1418 loss2:0.8771 main_loss:1.0189 | AUC:0.8550 AUC2:0.8549 FAR:0.01173
[2023-07-19 21:32:50,431][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0635 loss2:0.7803 main_loss:0.8438 | AUC:0.8592 AUC2:0.8592 FAR:0.00200
[2023-07-19 21:34:34,061][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0409 loss2:0.7101 main_loss:0.7510 | AUC:0.8563 AUC2:0.8592 FAR:0.00756
[2023-07-19 21:36:40,099][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0246 loss2:0.6418 main_loss:0.6665 | AUC:0.8490 AUC2:0.8592 FAR:0.02648
[2023-07-19 21:39:00,233][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0297 loss2:0.5912 main_loss:0.6209 | AUC:0.8484 AUC2:0.8592 FAR:0.00462
[2023-07-19 21:41:18,336][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0185 loss2:0.5318 main_loss:0.5502 | AUC:0.8498 AUC2:0.8592 FAR:0.00450
[2023-07-19 21:43:38,854][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0116 loss2:0.4712 main_loss:0.4828 | AUC:0.8494 AUC2:0.8592 FAR:0.00450
[2023-07-19 21:45:19,089][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0098 loss2:0.4143 main_loss:0.4242 | AUC:0.8478 AUC2:0.8592 FAR:0.00254
[2023-07-19 21:47:08,281][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0162 loss2:0.3738 main_loss:0.3900 | AUC:0.8499 AUC2:0.8592 FAR:0.01457
[2023-07-19 21:49:31,350][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0303 loss2:0.3672 main_loss:0.3975 | AUC:0.8432 AUC2:0.8592 FAR:0.00580
[2023-07-19 21:52:01,306][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0184 loss2:0.3154 main_loss:0.3338 | AUC:0.8480 AUC2:0.8592 FAR:0.00321
[2023-07-19 21:53:54,356][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0063 loss2:0.2549 main_loss:0.2612 | AUC:0.8534 AUC2:0.8592 FAR:0.00405
[2023-07-19 21:55:53,513][main.py][line:76][INFO] [Epoch:14/50]: loss1:0.0050 loss2:0.2093 main_loss:0.2143 | AUC:0.8515 AUC2:0.8592 FAR:0.00358
[2023-07-19 21:58:13,411][main.py][line:76][INFO] [Epoch:15/50]: loss1:0.0045 loss2:0.1803 main_loss:0.1848 | AUC:0.8537 AUC2:0.8592 FAR:0.00319
[2023-07-19 22:00:26,459][main.py][line:76][INFO] [Epoch:16/50]: loss1:0.0041 loss2:0.1505 main_loss:0.1546 | AUC:0.8530 AUC2:0.8592 FAR:0.00400
[2023-07-19 22:02:22,186][main.py][line:76][INFO] [Epoch:17/50]: loss1:0.0036 loss2:0.1242 main_loss:0.1278 | AUC:0.8533 AUC2:0.8592 FAR:0.00378
[2023-07-19 22:05:01,623][main.py][line:76][INFO] [Epoch:18/50]: loss1:0.0209 loss2:0.1376 main_loss:0.1585 | AUC:0.8508 AUC2:0.8592 FAR:0.00877
[2023-07-19 22:07:37,911][main.py][line:76][INFO] [Epoch:19/50]: loss1:0.0205 loss2:0.1492 main_loss:0.1697 | AUC:0.8433 AUC2:0.8592 FAR:0.00556
[2023-07-19 22:09:48,582][main.py][line:76][INFO] [Epoch:20/50]: loss1:0.0046 loss2:0.0993 main_loss:0.1039 | AUC:0.8472 AUC2:0.8592 FAR:0.00469
[2023-07-19 22:11:57,487][main.py][line:76][INFO] [Epoch:21/50]: loss1:0.0031 loss2:0.0783 main_loss:0.0814 | AUC:0.8478 AUC2:0.8592 FAR:0.00356
[2023-07-19 22:14:05,746][main.py][line:76][INFO] [Epoch:22/50]: loss1:0.0025 loss2:0.0653 main_loss:0.0678 | AUC:0.8484 AUC2:0.8592 FAR:0.00415
[2023-07-19 22:16:38,353][main.py][line:76][INFO] [Epoch:23/50]: loss1:0.0022 loss2:0.0556 main_loss:0.0578 | AUC:0.8506 AUC2:0.8592 FAR:0.00353
[2023-07-19 22:18:30,701][main.py][line:76][INFO] [Epoch:24/50]: loss1:0.0021 loss2:0.0488 main_loss:0.0509 | AUC:0.8483 AUC2:0.8592 FAR:0.00309
[2023-07-19 22:20:34,902][main.py][line:76][INFO] [Epoch:25/50]: loss1:0.0020 loss2:0.0426 main_loss:0.0446 | AUC:0.8494 AUC2:0.8592 FAR:0.00336
[2023-07-19 22:22:27,756][main.py][line:76][INFO] [Epoch:26/50]: loss1:0.0017 loss2:0.0370 main_loss:0.0387 | AUC:0.8479 AUC2:0.8592 FAR:0.00380
[2023-07-19 22:24:51,858][main.py][line:76][INFO] [Epoch:27/50]: loss1:0.0014 loss2:0.0322 main_loss:0.0336 | AUC:0.8502 AUC2:0.8592 FAR:0.00370
[2023-07-19 22:26:50,108][main.py][line:76][INFO] [Epoch:28/50]: loss1:0.0013 loss2:0.0284 main_loss:0.0296 | AUC:0.8507 AUC2:0.8592 FAR:0.00326
[2023-07-19 22:29:05,625][main.py][line:76][INFO] [Epoch:29/50]: loss1:0.0014 loss2:0.0258 main_loss:0.0272 | AUC:0.8509 AUC2:0.8592 FAR:0.00306
[2023-07-19 22:31:25,037][main.py][line:76][INFO] [Epoch:30/50]: loss1:0.0010 loss2:0.0226 main_loss:0.0236 | AUC:0.8505 AUC2:0.8592 FAR:0.00351
[2023-07-19 22:33:09,828][main.py][line:76][INFO] [Epoch:31/50]: loss1:0.0010 loss2:0.0206 main_loss:0.0217 | AUC:0.8481 AUC2:0.8592 FAR:0.00346
[2023-07-19 22:35:30,957][main.py][line:76][INFO] [Epoch:32/50]: loss1:0.0010 loss2:0.0194 main_loss:0.0204 | AUC:0.8427 AUC2:0.8592 FAR:0.00227
[2023-07-19 22:37:22,930][main.py][line:76][INFO] [Epoch:33/50]: loss1:0.0009 loss2:0.0172 main_loss:0.0180 | AUC:0.8483 AUC2:0.8592 FAR:0.00417
[2023-07-19 22:39:30,077][main.py][line:76][INFO] [Epoch:34/50]: loss1:0.0008 loss2:0.0156 main_loss:0.0164 | AUC:0.8485 AUC2:0.8592 FAR:0.00425
[2023-07-19 22:41:23,668][main.py][line:76][INFO] [Epoch:35/50]: loss1:0.0009 loss2:0.0145 main_loss:0.0154 | AUC:0.8450 AUC2:0.8592 FAR:0.00245
[2023-07-19 22:43:40,817][main.py][line:76][INFO] [Epoch:36/50]: loss1:0.0008 loss2:0.0144 main_loss:0.0153 | AUC:0.8463 AUC2:0.8592 FAR:0.00338
[2023-07-19 22:45:58,384][main.py][line:76][INFO] [Epoch:37/50]: loss1:0.0007 loss2:0.0134 main_loss:0.0141 | AUC:0.8468 AUC2:0.8592 FAR:0.00316
[2023-07-19 22:47:56,321][main.py][line:76][INFO] [Epoch:38/50]: loss1:0.0009 loss2:0.0120 main_loss:0.0129 | AUC:0.8495 AUC2:0.8592 FAR:0.00753
[2023-07-19 22:49:49,275][main.py][line:76][INFO] [Epoch:39/50]: loss1:0.0007 loss2:0.0122 main_loss:0.0129 | AUC:0.8503 AUC2:0.8592 FAR:0.00331
[2023-07-19 22:52:15,879][main.py][line:76][INFO] [Epoch:40/50]: loss1:0.0005 loss2:0.0108 main_loss:0.0113 | AUC:0.8501 AUC2:0.8592 FAR:0.00338
[2023-07-19 22:54:34,549][main.py][line:76][INFO] [Epoch:41/50]: loss1:0.0005 loss2:0.0098 main_loss:0.0102 | AUC:0.8500 AUC2:0.8592 FAR:0.00351
[2023-07-19 22:56:21,810][main.py][line:76][INFO] [Epoch:42/50]: loss1:0.0005 loss2:0.0090 main_loss:0.0094 | AUC:0.8463 AUC2:0.8592 FAR:0.00259
[2023-07-19 22:58:21,596][main.py][line:76][INFO] [Epoch:43/50]: loss1:0.0005 loss2:0.0092 main_loss:0.0097 | AUC:0.8493 AUC2:0.8592 FAR:0.00324
[2023-07-19 23:00:36,589][main.py][line:76][INFO] [Epoch:44/50]: loss1:0.0005 loss2:0.0087 main_loss:0.0091 | AUC:0.8493 AUC2:0.8592 FAR:0.00333
[2023-07-19 23:02:38,542][main.py][line:76][INFO] [Epoch:45/50]: loss1:0.0004 loss2:0.0087 main_loss:0.0091 | AUC:0.8501 AUC2:0.8592 FAR:0.00319
[2023-07-19 23:04:27,142][main.py][line:76][INFO] [Epoch:46/50]: loss1:0.0007 loss2:0.0085 main_loss:0.0092 | AUC:0.8492 AUC2:0.8592 FAR:0.00274
[2023-07-19 23:06:08,470][main.py][line:76][INFO] [Epoch:47/50]: loss1:0.0004 loss2:0.0076 main_loss:0.0080 | AUC:0.8500 AUC2:0.8592 FAR:0.00282
[2023-07-19 23:08:25,323][main.py][line:76][INFO] [Epoch:48/50]: loss1:0.0004 loss2:0.0079 main_loss:0.0083 | AUC:0.8496 AUC2:0.8592 FAR:0.00314
[2023-07-19 23:10:17,999][main.py][line:76][INFO] [Epoch:49/50]: loss1:0.0004 loss2:0.0072 main_loss:0.0076 | AUC:0.8492 AUC2:0.8592 FAR:0.00304
[2023-07-19 23:11:57,878][main.py][line:76][INFO] [Epoch:50/50]: loss1:0.0003 loss2:0.0070 main_loss:0.0074 | AUC:0.8496 AUC2:0.8592 FAR:0.00304
[2023-07-19 23:11:57,879][main.py][line:82][INFO] Training completes in 105m 30s | best AUC:0.8592 FAR:0.00200

[2023-07-20 00:38:12,146][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:38:12,332][main.py][line:116][INFO] total params:27.0270M
[2023-07-20 00:38:12,333][main.py][line:123][INFO] Test Mode
[2023-07-20 00:38:12,333][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8592.pkl.
[2023-07-20 00:38:20,607][infer_bert.py][line:55][INFO] offline AUC:0.8592 AUC2:0.8651 AP:0.3193 FAR:0.0016 | Complete in 0m 8s

[2023-07-20 00:41:10,896][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:41:11,059][main.py][line:116][INFO] total params:27.0270M
[2023-07-20 00:41:11,060][main.py][line:119][INFO] Training Mode
[2023-07-20 00:41:11,060][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 00:41:11,060][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 00:41:18,661][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 00:42:08,444][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:42:08,596][main.py][line:116][INFO] total params:27.0270M
[2023-07-20 00:42:08,596][main.py][line:119][INFO] Training Mode
[2023-07-20 00:42:08,596][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 00:42:08,596][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 00:42:16,228][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 00:43:34,123][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:43:34,286][main.py][line:116][INFO] total params:27.0270M
[2023-07-20 00:43:34,286][main.py][line:119][INFO] Training Mode
[2023-07-20 00:43:34,287][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 00:43:34,287][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 00:43:41,858][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 00:45:18,225][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:45:18,374][main.py][line:116][INFO] total params:27.0270M
[2023-07-20 00:45:18,375][main.py][line:119][INFO] Training Mode
[2023-07-20 00:45:18,375][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 00:45:18,375][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 00:45:25,937][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 00:48:05,720][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:48:05,881][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 00:48:05,881][main.py][line:119][INFO] Training Mode
[2023-07-20 00:48:05,881][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 00:48:05,881][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 00:48:25,167][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 00:51:18,656][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3729 loss2:1.0986 main_loss:1.4714 | AUC:0.8271 AUC2:0.8271 FAR:0.00583
[2023-07-20 00:52:46,800][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:52:46,970][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 00:52:46,970][main.py][line:119][INFO] Training Mode
[2023-07-20 00:52:46,970][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 00:52:46,970][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 00:53:06,469][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 00:54:34,804][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3729 loss2:1.0986 main_loss:1.4714 | AUC:0.8271 AUC2:0.8271 FAR:0.00583
[2023-07-20 00:56:04,999][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1468 loss2:0.8741 main_loss:1.0209 | AUC:0.8501 AUC2:0.8501 FAR:0.00603
[2023-07-20 00:57:33,786][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0684 loss2:0.7777 main_loss:0.8461 | AUC:0.8417 AUC2:0.8501 FAR:0.00832
[2023-07-20 00:59:00,669][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0314 loss2:0.7010 main_loss:0.7324 | AUC:0.8486 AUC2:0.8501 FAR:0.00326
[2023-07-20 01:00:28,883][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0191 loss2:0.6276 main_loss:0.6466 | AUC:0.8481 AUC2:0.8501 FAR:0.00168
[2023-07-20 01:01:56,438][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0402 loss2:0.5925 main_loss:0.6327 | AUC:0.8405 AUC2:0.8501 FAR:0.00440
[2023-07-20 01:04:54,755][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 01:04:54,954][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 01:04:54,954][main.py][line:119][INFO] Training Mode
[2023-07-20 01:04:54,955][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 01:04:54,955][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 01:05:14,596][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 01:06:53,830][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3825 loss2:1.0427 main_loss:1.4681 | AUC:0.8352 AUC2:0.8295 FAR:0.00706
[2023-07-20 01:08:41,923][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1690 loss2:0.8141 main_loss:1.0624 | AUC:0.8464 AUC2:0.8425 FAR:0.00499
[2023-07-20 01:10:22,808][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.1025 loss2:0.7199 main_loss:0.9184 | AUC:0.8554 AUC2:0.8522 FAR:0.00958
[2023-07-20 01:12:05,880][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0625 loss2:0.6487 main_loss:0.8023 | AUC:0.8522 AUC2:0.8522 FAR:0.00405
[2023-07-20 01:13:47,661][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0512 loss2:0.5879 main_loss:0.7336 | AUC:0.8535 AUC2:0.8522 FAR:0.00309
[2023-07-20 01:15:32,146][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0369 loss2:0.5276 main_loss:0.6522 | AUC:0.8450 AUC2:0.8522 FAR:0.00242
[2023-07-20 01:17:12,360][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0727 loss2:0.4973 main_loss:0.6333 | AUC:0.8564 AUC2:0.8466 FAR:0.00210
[2023-07-20 01:19:01,699][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0243 loss2:0.4257 main_loss:0.5225 | AUC:0.8527 AUC2:0.8466 FAR:0.00190
[2023-07-20 01:20:43,282][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0189 loss2:0.3701 main_loss:0.4747 | AUC:0.8585 AUC2:0.8477 FAR:0.00225
[2023-07-20 01:22:30,322][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0158 loss2:0.3204 main_loss:0.4300 | AUC:0.8565 AUC2:0.8477 FAR:0.00133
[2023-07-20 01:24:22,205][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0149 loss2:0.2746 main_loss:0.3767 | AUC:0.8600 AUC2:0.8490 FAR:0.00286
[2023-07-20 01:26:09,383][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0127 loss2:0.2297 main_loss:0.3385 | AUC:0.8550 AUC2:0.8490 FAR:0.00207
[2023-07-20 01:27:46,821][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0435 loss2:0.2312 main_loss:0.3430 | AUC:0.8442 AUC2:0.8490 FAR:0.02149
[2023-07-20 01:29:25,395][main.py][line:76][INFO] [Epoch:14/50]: loss1:0.0543 loss2:0.2415 main_loss:0.3462 | AUC:0.8447 AUC2:0.8490 FAR:0.00353
[2023-07-20 01:31:05,005][main.py][line:76][INFO] [Epoch:15/50]: loss1:0.0214 loss2:0.1784 main_loss:0.2673 | AUC:0.8519 AUC2:0.8490 FAR:0.00499
[2023-07-20 01:32:44,964][main.py][line:76][INFO] [Epoch:16/50]: loss1:0.0118 loss2:0.1409 main_loss:0.2258 | AUC:0.8520 AUC2:0.8490 FAR:0.00284
[2023-07-20 01:34:25,662][main.py][line:76][INFO] [Epoch:17/50]: loss1:0.0092 loss2:0.1146 main_loss:0.1900 | AUC:0.8505 AUC2:0.8490 FAR:0.00232
[2023-07-20 01:36:05,436][main.py][line:76][INFO] [Epoch:18/50]: loss1:0.0073 loss2:0.0936 main_loss:0.1657 | AUC:0.8464 AUC2:0.8490 FAR:0.00210
[2023-07-20 01:37:44,883][main.py][line:76][INFO] [Epoch:19/50]: loss1:0.0071 loss2:0.0786 main_loss:0.1509 | AUC:0.8456 AUC2:0.8490 FAR:0.00153
[2023-07-20 01:39:26,853][main.py][line:76][INFO] [Epoch:20/50]: loss1:0.0058 loss2:0.0673 main_loss:0.1510 | AUC:0.8466 AUC2:0.8490 FAR:0.00170
[2023-07-20 01:41:07,356][main.py][line:76][INFO] [Epoch:21/50]: loss1:0.0049 loss2:0.0566 main_loss:0.1347 | AUC:0.8486 AUC2:0.8490 FAR:0.00205
[2023-07-20 01:42:53,645][main.py][line:76][INFO] [Epoch:22/50]: loss1:0.0046 loss2:0.0485 main_loss:0.1339 | AUC:0.8500 AUC2:0.8490 FAR:0.00198
[2023-07-20 01:44:30,429][main.py][line:76][INFO] [Epoch:23/50]: loss1:0.0042 loss2:0.0425 main_loss:0.1187 | AUC:0.8412 AUC2:0.8490 FAR:0.00205
[2023-07-20 01:46:05,156][main.py][line:76][INFO] [Epoch:24/50]: loss1:0.0037 loss2:0.0371 main_loss:0.1042 | AUC:0.8451 AUC2:0.8490 FAR:0.00220
[2023-07-20 01:47:47,872][main.py][line:76][INFO] [Epoch:25/50]: loss1:0.0034 loss2:0.0323 main_loss:0.0969 | AUC:0.8503 AUC2:0.8490 FAR:0.00237
[2023-07-20 01:49:26,185][main.py][line:76][INFO] [Epoch:26/50]: loss1:0.0032 loss2:0.0283 main_loss:0.0909 | AUC:0.8531 AUC2:0.8490 FAR:0.00203
[2023-07-20 01:51:04,904][main.py][line:76][INFO] [Epoch:27/50]: loss1:0.0026 loss2:0.0250 main_loss:0.0826 | AUC:0.8465 AUC2:0.8490 FAR:0.00188
[2023-07-20 01:52:46,316][main.py][line:76][INFO] [Epoch:28/50]: loss1:0.0028 loss2:0.0223 main_loss:0.0773 | AUC:0.8500 AUC2:0.8490 FAR:0.00212
[2023-07-20 01:54:22,609][main.py][line:76][INFO] [Epoch:29/50]: loss1:0.0023 loss2:0.0205 main_loss:0.0738 | AUC:0.8493 AUC2:0.8490 FAR:0.00222
[2023-07-20 01:55:57,981][main.py][line:76][INFO] [Epoch:30/50]: loss1:0.0022 loss2:0.0183 main_loss:0.0672 | AUC:0.8472 AUC2:0.8490 FAR:0.00301
[2023-07-20 01:57:39,023][main.py][line:76][INFO] [Epoch:31/50]: loss1:0.0128 loss2:0.0314 main_loss:0.0841 | AUC:0.8463 AUC2:0.8490 FAR:0.00059
[2023-07-20 01:59:17,308][main.py][line:76][INFO] [Epoch:32/50]: loss1:0.0338 loss2:0.0733 main_loss:0.1339 | AUC:0.8501 AUC2:0.8490 FAR:0.00543
[2023-07-20 02:00:53,223][main.py][line:76][INFO] [Epoch:33/50]: loss1:0.0056 loss2:0.0267 main_loss:0.0712 | AUC:0.8479 AUC2:0.8490 FAR:0.00395
[2023-07-20 02:02:28,782][main.py][line:76][INFO] [Epoch:34/50]: loss1:0.0032 loss2:0.0189 main_loss:0.0679 | AUC:0.8508 AUC2:0.8490 FAR:0.00333
[2023-07-20 02:04:08,125][main.py][line:76][INFO] [Epoch:35/50]: loss1:0.0025 loss2:0.0157 main_loss:0.0563 | AUC:0.8535 AUC2:0.8490 FAR:0.00311
[2023-07-20 02:05:46,639][main.py][line:76][INFO] [Epoch:36/50]: loss1:0.0031 loss2:0.0150 main_loss:0.0527 | AUC:0.8502 AUC2:0.8490 FAR:0.00412
[2023-07-20 02:07:24,294][main.py][line:76][INFO] [Epoch:37/50]: loss1:0.0025 loss2:0.0136 main_loss:0.0541 | AUC:0.8517 AUC2:0.8490 FAR:0.00286
[2023-07-20 02:09:01,487][main.py][line:76][INFO] [Epoch:38/50]: loss1:0.0018 loss2:0.0123 main_loss:0.0528 | AUC:0.8493 AUC2:0.8490 FAR:0.00279
[2023-07-20 02:10:41,784][main.py][line:76][INFO] [Epoch:39/50]: loss1:0.0017 loss2:0.0113 main_loss:0.0495 | AUC:0.8501 AUC2:0.8490 FAR:0.00262
[2023-07-20 02:12:20,983][main.py][line:76][INFO] [Epoch:40/50]: loss1:0.0017 loss2:0.0104 main_loss:0.0464 | AUC:0.8504 AUC2:0.8490 FAR:0.00286
[2023-07-20 02:13:58,100][main.py][line:76][INFO] [Epoch:41/50]: loss1:0.0016 loss2:0.0100 main_loss:0.0430 | AUC:0.8506 AUC2:0.8490 FAR:0.00264
[2023-07-20 02:15:33,988][main.py][line:76][INFO] [Epoch:42/50]: loss1:0.0016 loss2:0.0096 main_loss:0.0434 | AUC:0.8515 AUC2:0.8490 FAR:0.00274
[2023-07-20 02:17:10,608][main.py][line:76][INFO] [Epoch:43/50]: loss1:0.0014 loss2:0.0091 main_loss:0.0389 | AUC:0.8523 AUC2:0.8490 FAR:0.00269
[2023-07-20 02:18:46,134][main.py][line:76][INFO] [Epoch:44/50]: loss1:0.0013 loss2:0.0087 main_loss:0.0349 | AUC:0.8518 AUC2:0.8490 FAR:0.00284
[2023-07-20 02:20:23,049][main.py][line:76][INFO] [Epoch:45/50]: loss1:0.0011 loss2:0.0082 main_loss:0.0355 | AUC:0.8518 AUC2:0.8490 FAR:0.00279
[2023-07-20 02:22:03,520][main.py][line:76][INFO] [Epoch:46/50]: loss1:0.0012 loss2:0.0079 main_loss:0.0338 | AUC:0.8519 AUC2:0.8490 FAR:0.00262
[2023-07-20 02:23:44,085][main.py][line:76][INFO] [Epoch:47/50]: loss1:0.0012 loss2:0.0077 main_loss:0.0329 | AUC:0.8535 AUC2:0.8490 FAR:0.00279
[2023-07-20 02:25:18,471][main.py][line:76][INFO] [Epoch:48/50]: loss1:0.0011 loss2:0.0075 main_loss:0.0306 | AUC:0.8509 AUC2:0.8490 FAR:0.00279
[2023-07-20 02:26:57,674][main.py][line:76][INFO] [Epoch:49/50]: loss1:0.0013 loss2:0.0072 main_loss:0.0310 | AUC:0.8493 AUC2:0.8490 FAR:0.00284
[2023-07-20 02:28:34,558][main.py][line:76][INFO] [Epoch:50/50]: loss1:0.0010 loss2:0.0071 main_loss:0.0309 | AUC:0.8522 AUC2:0.8490 FAR:0.00286
[2023-07-20 02:28:34,684][main.py][line:82][INFO] Training completes in 83m 20s | best AUC:0.8600 FAR:0.00286

[2023-07-20 03:39:08,526][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 03:39:11,740][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 03:39:11,894][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 03:39:11,894][main.py][line:123][INFO] Test Mode
[2023-07-20 03:39:11,894][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8592.pkl.
[2023-07-20 03:39:11,951][main.py][line:32][INFO] bert.embedding.learnedPosition.pe size mismatch: load torch.Size([1, 33, 1024]) given torch.Size([1, 201, 1024])
[2023-07-20 03:39:34,358][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 03:39:34,518][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 03:39:34,518][main.py][line:123][INFO] Test Mode
[2023-07-20 03:39:34,518][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__86.pkl.
[2023-07-20 03:39:54,300][infer_bert.py][line:55][INFO] offline AUC:0.8600 AUC2:0.8541 AP:0.3277 FAR:0.0022 | Complete in 0m 20s

[2023-07-20 03:42:11,529][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 500, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 03:42:11,696][main.py][line:116][INFO] total params:27.5062M
[2023-07-20 03:42:11,696][main.py][line:119][INFO] Training Mode
[2023-07-20 03:42:11,696][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 03:42:11,696][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 03:42:50,611][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 03:47:11,406][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 500, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 03:47:11,571][main.py][line:116][INFO] total params:27.5062M
[2023-07-20 03:47:11,571][main.py][line:119][INFO] Training Mode
[2023-07-20 03:47:11,572][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 03:47:11,572][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 03:47:49,418][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 03:49:08,328][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 03:49:08,491][main.py][line:116][INFO] total params:27.3014M
[2023-07-20 03:49:08,491][main.py][line:119][INFO] Training Mode
[2023-07-20 03:49:08,491][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 03:49:08,491][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 03:49:33,864][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 03:51:16,449][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.5132 loss2:1.0940 main_loss:1.5696 | AUC:0.8343 AUC2:0.8315 FAR:0.00953
[2023-07-20 03:52:58,978][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.2477 loss2:0.8751 main_loss:1.1400 | AUC:0.8451 AUC2:0.8470 FAR:0.00934
[2023-07-20 03:54:42,505][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.1487 loss2:0.7792 main_loss:0.9739 | AUC:0.8471 AUC2:0.8437 FAR:0.00855
[2023-07-20 03:56:25,494][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0812 loss2:0.7029 main_loss:0.8626 | AUC:0.8469 AUC2:0.8437 FAR:0.00408
[2023-07-20 03:58:08,164][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0551 loss2:0.6406 main_loss:0.7698 | AUC:0.8438 AUC2:0.8437 FAR:0.00304
[2023-07-20 03:59:51,207][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0410 loss2:0.5811 main_loss:0.6909 | AUC:0.8450 AUC2:0.8437 FAR:0.00709
[2023-07-20 04:01:34,188][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0315 loss2:0.5271 main_loss:0.6334 | AUC:0.8507 AUC2:0.8412 FAR:0.01040
[2023-07-20 04:03:17,526][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0273 loss2:0.4768 main_loss:0.5930 | AUC:0.8473 AUC2:0.8412 FAR:0.00664
[2023-07-20 04:05:00,746][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0178 loss2:0.4176 main_loss:0.5344 | AUC:0.8411 AUC2:0.8412 FAR:0.00333
[2023-07-20 04:06:44,380][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0254 loss2:0.3845 main_loss:0.5093 | AUC:0.8334 AUC2:0.8412 FAR:0.00291
[2023-07-20 04:08:27,466][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0151 loss2:0.3326 main_loss:0.4768 | AUC:0.8438 AUC2:0.8412 FAR:0.00435
[2023-07-20 04:10:10,309][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0183 loss2:0.2957 main_loss:0.4374 | AUC:0.8489 AUC2:0.8412 FAR:0.00447
[2023-07-20 04:11:53,502][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0445 loss2:0.2989 main_loss:0.4424 | AUC:0.8290 AUC2:0.8412 FAR:0.01595
[2023-07-20 04:13:36,890][main.py][line:76][INFO] [Epoch:14/50]: loss1:0.0259 loss2:0.2631 main_loss:0.4036 | AUC:0.8307 AUC2:0.8412 FAR:0.00625
[2023-07-20 04:15:20,193][main.py][line:76][INFO] [Epoch:15/50]: loss1:0.0110 loss2:0.2054 main_loss:0.3332 | AUC:0.8404 AUC2:0.8412 FAR:0.00506
[2023-07-20 04:17:03,390][main.py][line:76][INFO] [Epoch:16/50]: loss1:0.0089 loss2:0.1717 main_loss:0.2996 | AUC:0.8327 AUC2:0.8412 FAR:0.00427
[2023-07-20 04:18:46,365][main.py][line:76][INFO] [Epoch:17/50]: loss1:0.0092 loss2:0.1515 main_loss:0.2639 | AUC:0.8383 AUC2:0.8412 FAR:0.00479
[2023-07-20 04:20:29,209][main.py][line:76][INFO] [Epoch:18/50]: loss1:0.0064 loss2:0.1241 main_loss:0.2348 | AUC:0.8400 AUC2:0.8412 FAR:0.00380
[2023-07-20 04:22:12,208][main.py][line:76][INFO] [Epoch:19/50]: loss1:0.0061 loss2:0.1063 main_loss:0.2159 | AUC:0.8340 AUC2:0.8412 FAR:0.00711
[2023-07-20 04:23:55,233][main.py][line:76][INFO] [Epoch:20/50]: loss1:0.0074 loss2:0.0926 main_loss:0.1969 | AUC:0.8406 AUC2:0.8412 FAR:0.00491
[2023-07-20 04:25:38,155][main.py][line:76][INFO] [Epoch:21/50]: loss1:0.0089 loss2:0.0895 main_loss:0.2048 | AUC:0.8262 AUC2:0.8412 FAR:0.00388
[2023-07-20 04:27:21,873][main.py][line:76][INFO] [Epoch:22/50]: loss1:0.0216 loss2:0.1048 main_loss:0.2203 | AUC:0.8363 AUC2:0.8412 FAR:0.00654
[2023-07-20 04:29:05,532][main.py][line:76][INFO] [Epoch:23/50]: loss1:0.0064 loss2:0.0721 main_loss:0.1789 | AUC:0.8201 AUC2:0.8412 FAR:0.01265
[2023-07-20 04:30:48,513][main.py][line:76][INFO] [Epoch:24/50]: loss1:0.0059 loss2:0.0598 main_loss:0.1606 | AUC:0.8199 AUC2:0.8412 FAR:0.00309
[2023-07-20 04:32:31,800][main.py][line:76][INFO] [Epoch:25/50]: loss1:0.0046 loss2:0.0518 main_loss:0.1480 | AUC:0.8196 AUC2:0.8412 FAR:0.01042
[2023-07-20 04:34:14,888][main.py][line:76][INFO] [Epoch:26/50]: loss1:0.0047 loss2:0.0449 main_loss:0.1357 | AUC:0.8318 AUC2:0.8412 FAR:0.00664
[2023-07-20 04:35:58,003][main.py][line:76][INFO] [Epoch:27/50]: loss1:0.0029 loss2:0.0385 main_loss:0.1258 | AUC:0.8149 AUC2:0.8412 FAR:0.00282
[2023-07-20 04:37:40,947][main.py][line:76][INFO] [Epoch:28/50]: loss1:0.0028 loss2:0.0340 main_loss:0.1192 | AUC:0.8223 AUC2:0.8412 FAR:0.00813
[2023-07-20 04:39:24,203][main.py][line:76][INFO] [Epoch:29/50]: loss1:0.0027 loss2:0.0314 main_loss:0.1106 | AUC:0.8130 AUC2:0.8412 FAR:0.00721
[2023-07-20 04:41:06,809][main.py][line:76][INFO] [Epoch:30/50]: loss1:0.0028 loss2:0.0279 main_loss:0.1134 | AUC:0.8238 AUC2:0.8412 FAR:0.00605
[2023-07-20 04:42:50,615][main.py][line:76][INFO] [Epoch:31/50]: loss1:0.0026 loss2:0.0250 main_loss:0.1094 | AUC:0.8157 AUC2:0.8412 FAR:0.00887
[2023-07-20 04:46:13,498][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 04:46:13,687][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 04:46:13,687][main.py][line:119][INFO] Training Mode
[2023-07-20 04:46:13,688][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 04:46:13,688][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 04:48:27,498][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 04:48:27,653][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 04:48:27,653][main.py][line:119][INFO] Training Mode
[2023-07-20 04:48:27,653][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 04:48:27,653][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 04:51:15,542][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 04:51:15,705][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 04:51:15,705][main.py][line:119][INFO] Training Mode
[2023-07-20 04:51:15,706][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 04:51:15,706][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 04:51:49,040][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 04:51:49,196][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 04:51:49,196][main.py][line:119][INFO] Training Mode
[2023-07-20 04:51:49,196][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 04:51:49,196][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 04:52:10,739][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 04:52:10,885][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 04:52:10,885][main.py][line:119][INFO] Training Mode
[2023-07-20 04:52:10,886][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 04:52:10,886][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 04:54:42,532][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 04:54:42,677][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 04:54:42,677][main.py][line:119][INFO] Training Mode
[2023-07-20 04:54:42,677][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 04:54:42,677][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:00:48,367][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:00:48,523][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:00:48,523][main.py][line:119][INFO] Training Mode
[2023-07-20 05:00:48,523][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:00:48,524][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:01:02,545][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:01:02,701][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:01:02,701][main.py][line:119][INFO] Training Mode
[2023-07-20 05:01:02,701][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:01:02,701][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:01:58,555][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:01:58,698][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:01:58,698][main.py][line:119][INFO] Training Mode
[2023-07-20 05:01:58,699][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:01:58,699][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:02:12,582][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:02:12,738][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:02:12,738][main.py][line:119][INFO] Training Mode
[2023-07-20 05:02:12,738][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:02:12,738][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:03:22,983][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:03:23,136][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:03:23,136][main.py][line:119][INFO] Training Mode
[2023-07-20 05:03:23,136][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:03:23,136][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:03:58,043][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:03:58,205][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:03:58,206][main.py][line:119][INFO] Training Mode
[2023-07-20 05:03:58,206][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:03:58,206][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:04:17,673][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:04:17,833][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:04:17,833][main.py][line:119][INFO] Training Mode
[2023-07-20 05:04:17,834][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:04:17,834][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:04:48,733][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:04:48,889][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:04:48,889][main.py][line:119][INFO] Training Mode
[2023-07-20 05:04:48,889][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:04:48,890][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:05:11,063][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:05:11,220][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:05:11,220][main.py][line:119][INFO] Training Mode
[2023-07-20 05:05:11,220][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:05:11,220][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:07:38,827][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:07:38,973][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:07:38,973][main.py][line:119][INFO] Training Mode
[2023-07-20 05:07:38,973][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:07:38,974][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:08:58,932][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:08:59,090][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:08:59,090][main.py][line:119][INFO] Training Mode
[2023-07-20 05:08:59,090][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:08:59,090][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:09:31,927][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:09:32,075][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:09:32,075][main.py][line:119][INFO] Training Mode
[2023-07-20 05:09:32,075][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:09:32,075][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:10:45,224][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:10:45,388][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:10:45,388][main.py][line:119][INFO] Training Mode
[2023-07-20 05:10:45,389][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:10:45,389][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:11:49,602][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:11:49,758][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:11:49,758][main.py][line:119][INFO] Training Mode
[2023-07-20 05:11:49,758][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:11:49,758][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:12:25,527][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:12:25,686][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:12:25,686][main.py][line:119][INFO] Training Mode
[2023-07-20 05:12:25,687][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:12:25,687][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:13:01,198][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:13:01,357][main.py][line:116][INFO] total params:27.3014M
[2023-07-20 05:13:01,357][main.py][line:119][INFO] Training Mode
[2023-07-20 05:13:01,358][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:13:01,358][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:13:57,632][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:13:57,793][main.py][line:116][INFO] total params:27.3014M
[2023-07-20 05:13:57,793][main.py][line:119][INFO] Training Mode
[2023-07-20 05:13:57,793][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:13:57,793][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:14:23,602][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 05:20:15,852][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:20:16,012][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:20:16,012][main.py][line:119][INFO] Training Mode
[2023-07-20 05:20:16,013][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:20:16,013][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:20:37,617][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:20:37,783][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:20:37,783][main.py][line:119][INFO] Training Mode
[2023-07-20 05:20:37,783][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:20:37,783][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:21:09,244][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:21:09,405][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:21:09,405][main.py][line:119][INFO] Training Mode
[2023-07-20 05:21:09,406][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:21:09,406][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:21:37,426][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:21:37,573][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:21:37,573][main.py][line:119][INFO] Training Mode
[2023-07-20 05:21:37,573][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:21:37,573][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:22:15,734][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:22:15,879][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:22:15,879][main.py][line:119][INFO] Training Mode
[2023-07-20 05:22:15,879][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:22:15,879][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:23:35,496][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:23:35,653][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:23:35,653][main.py][line:119][INFO] Training Mode
[2023-07-20 05:23:35,653][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:23:35,653][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:24:32,805][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:24:32,951][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:24:32,951][main.py][line:119][INFO] Training Mode
[2023-07-20 05:24:32,952][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:24:32,952][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:24:41,264][main.py][line:53][INFO] Random initialize AUC:0.5446 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 05:26:59,883][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:27:00,048][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:27:00,048][main.py][line:119][INFO] Training Mode
[2023-07-20 05:27:00,048][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:27:00,048][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:27:08,284][main.py][line:53][INFO] Random initialize AUC:0.5446 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 05:30:02,880][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.5295 loss2:1.1985 main_loss:1.8068 | AUC:0.8353 AUC2:0.8351 FAR:0.01608
[2023-07-20 05:32:58,821][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.2921 loss2:0.9614 main_loss:1.3893 | AUC:0.8337 AUC2:0.8351 FAR:0.01025
[2023-07-20 05:35:38,227][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.1680 loss2:0.8312 main_loss:1.1463 | AUC:0.8372 AUC2:0.8518 FAR:0.00662
[2023-07-20 05:38:25,122][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0906 loss2:0.7292 main_loss:0.9934 | AUC:0.8370 AUC2:0.8518 FAR:0.00605
[2023-07-20 05:41:10,598][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0656 loss2:0.6605 main_loss:0.9070 | AUC:0.8312 AUC2:0.8518 FAR:0.00247
[2023-07-20 05:44:59,155][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:45:37,305][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:45:43,679][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:47:46,735][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:47:59,772][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:48:07,232][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:48:07,392][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 05:48:07,392][main.py][line:119][INFO] Training Mode
[2023-07-20 05:48:07,393][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:48:07,393][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:48:21,136][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:48:21,356][main.py][line:116][INFO] total params:52.3915M
[2023-07-20 05:48:21,356][main.py][line:119][INFO] Training Mode
[2023-07-20 05:48:21,357][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:48:21,357][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:48:42,491][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 05:49:41,975][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:49:42,223][main.py][line:116][INFO] total params:52.3915M
[2023-07-20 05:49:42,223][main.py][line:119][INFO] Training Mode
[2023-07-20 05:49:42,224][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:49:42,224][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:50:02,516][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 05:51:49,821][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3750 loss2:1.0443 main_loss:1.5780 | AUC:0.8327 AUC2:0.8327 FAR:0.00976
[2023-07-20 05:53:37,394][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1707 loss2:0.8155 main_loss:1.2475 | AUC:0.8428 AUC2:0.8428 FAR:0.00304
[2023-07-20 05:55:26,258][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0984 loss2:0.7261 main_loss:1.1219 | AUC:0.8391 AUC2:0.8428 FAR:0.00123
[2023-07-20 05:57:14,800][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0533 loss2:0.6461 main_loss:1.0194 | AUC:0.8495 AUC2:0.8495 FAR:0.00487
[2023-07-20 05:59:03,598][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0396 loss2:0.5823 main_loss:0.9487 | AUC:0.8442 AUC2:0.8495 FAR:0.00437
[2023-07-20 06:00:52,407][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0341 loss2:0.5232 main_loss:0.8867 | AUC:0.8431 AUC2:0.8495 FAR:0.00183
[2023-07-20 06:02:41,042][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0357 loss2:0.4766 main_loss:0.8409 | AUC:0.8474 AUC2:0.8495 FAR:0.00477
[2023-07-20 06:04:30,888][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0293 loss2:0.4206 main_loss:0.7812 | AUC:0.8473 AUC2:0.8495 FAR:0.00249
[2023-07-20 06:06:20,349][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0218 loss2:0.3662 main_loss:0.6621 | AUC:0.8480 AUC2:0.8495 FAR:0.00284
[2023-07-20 06:08:08,906][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0177 loss2:0.3195 main_loss:0.5655 | AUC:0.8486 AUC2:0.8495 FAR:0.00319
[2023-07-20 06:09:58,122][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0133 loss2:0.2680 main_loss:0.4706 | AUC:0.8541 AUC2:0.8479 FAR:0.00338
[2023-07-20 06:11:47,227][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0122 loss2:0.2235 main_loss:0.3941 | AUC:0.8570 AUC2:0.8499 FAR:0.00123
[2023-07-20 06:13:35,800][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0123 loss2:0.1928 main_loss:0.3446 | AUC:0.8549 AUC2:0.8499 FAR:0.00163
[2023-07-20 06:15:24,296][main.py][line:76][INFO] [Epoch:14/50]: loss1:0.0328 loss2:0.2002 main_loss:0.3557 | AUC:0.8497 AUC2:0.8499 FAR:0.00269
[2023-07-20 06:17:13,293][main.py][line:76][INFO] [Epoch:15/50]: loss1:0.0415 loss2:0.2006 main_loss:0.3507 | AUC:0.8567 AUC2:0.8499 FAR:0.00906
[2023-07-20 06:19:02,245][main.py][line:76][INFO] [Epoch:16/50]: loss1:0.0312 loss2:0.1695 main_loss:0.3077 | AUC:0.8569 AUC2:0.8499 FAR:0.00257
[2023-07-20 06:20:51,591][main.py][line:76][INFO] [Epoch:17/50]: loss1:0.0098 loss2:0.1184 main_loss:0.2429 | AUC:0.8584 AUC2:0.8498 FAR:0.00175
[2023-07-20 06:22:40,369][main.py][line:76][INFO] [Epoch:18/50]: loss1:0.0071 loss2:0.0956 main_loss:0.2251 | AUC:0.8576 AUC2:0.8498 FAR:0.00254
[2023-07-20 06:24:29,489][main.py][line:76][INFO] [Epoch:19/50]: loss1:0.0063 loss2:0.0789 main_loss:0.2057 | AUC:0.8578 AUC2:0.8498 FAR:0.00165
[2023-07-20 06:26:18,684][main.py][line:76][INFO] [Epoch:20/50]: loss1:0.0091 loss2:0.0687 main_loss:0.1838 | AUC:0.8522 AUC2:0.8498 FAR:0.00101
[2023-07-20 06:28:08,017][main.py][line:76][INFO] [Epoch:21/50]: loss1:0.0063 loss2:0.0604 main_loss:0.1669 | AUC:0.8544 AUC2:0.8498 FAR:0.00109
[2023-07-20 06:29:57,892][main.py][line:76][INFO] [Epoch:22/50]: loss1:0.0048 loss2:0.0503 main_loss:0.1473 | AUC:0.8529 AUC2:0.8498 FAR:0.00168
[2023-07-20 06:31:46,327][main.py][line:76][INFO] [Epoch:23/50]: loss1:0.0054 loss2:0.0455 main_loss:0.1501 | AUC:0.8548 AUC2:0.8498 FAR:0.00126
[2023-07-20 06:33:35,381][main.py][line:76][INFO] [Epoch:24/50]: loss1:0.0038 loss2:0.0383 main_loss:0.1413 | AUC:0.8552 AUC2:0.8498 FAR:0.00089
[2023-07-20 06:35:23,850][main.py][line:76][INFO] [Epoch:25/50]: loss1:0.0034 loss2:0.0334 main_loss:0.1274 | AUC:0.8555 AUC2:0.8498 FAR:0.00106
[2023-07-20 06:37:12,667][main.py][line:76][INFO] [Epoch:26/50]: loss1:0.0041 loss2:0.0312 main_loss:0.1233 | AUC:0.8530 AUC2:0.8498 FAR:0.00165
[2023-07-20 06:39:01,821][main.py][line:76][INFO] [Epoch:27/50]: loss1:0.0331 loss2:0.0810 main_loss:0.1881 | AUC:0.8563 AUC2:0.8498 FAR:0.00410
[2023-07-20 06:40:51,201][main.py][line:76][INFO] [Epoch:28/50]: loss1:0.0086 loss2:0.0407 main_loss:0.1318 | AUC:0.8526 AUC2:0.8498 FAR:0.00425
[2023-07-20 06:42:39,572][main.py][line:76][INFO] [Epoch:29/50]: loss1:0.0039 loss2:0.0277 main_loss:0.1151 | AUC:0.8535 AUC2:0.8498 FAR:0.00388
[2023-07-20 06:44:28,948][main.py][line:76][INFO] [Epoch:30/50]: loss1:0.0036 loss2:0.0233 main_loss:0.1058 | AUC:0.8514 AUC2:0.8498 FAR:0.00326
[2023-07-20 06:46:17,956][main.py][line:76][INFO] [Epoch:31/50]: loss1:0.0028 loss2:0.0205 main_loss:0.0989 | AUC:0.8525 AUC2:0.8498 FAR:0.00282
[2023-07-20 06:48:06,915][main.py][line:76][INFO] [Epoch:32/50]: loss1:0.0026 loss2:0.0179 main_loss:0.1001 | AUC:0.8527 AUC2:0.8498 FAR:0.00203
[2023-07-20 06:49:55,910][main.py][line:76][INFO] [Epoch:33/50]: loss1:0.0024 loss2:0.0161 main_loss:0.0889 | AUC:0.8521 AUC2:0.8498 FAR:0.00257
[2023-07-20 06:51:44,997][main.py][line:76][INFO] [Epoch:34/50]: loss1:0.0019 loss2:0.0148 main_loss:0.0892 | AUC:0.8523 AUC2:0.8498 FAR:0.00195
[2023-07-20 06:53:33,801][main.py][line:76][INFO] [Epoch:35/50]: loss1:0.0018 loss2:0.0137 main_loss:0.0838 | AUC:0.8527 AUC2:0.8498 FAR:0.00203
[2023-07-20 06:55:22,113][main.py][line:76][INFO] [Epoch:36/50]: loss1:0.0020 loss2:0.0133 main_loss:0.0822 | AUC:0.8517 AUC2:0.8498 FAR:0.00188
[2023-07-20 06:57:10,459][main.py][line:76][INFO] [Epoch:37/50]: loss1:0.0017 loss2:0.0116 main_loss:0.0806 | AUC:0.8514 AUC2:0.8498 FAR:0.00188
[2023-07-20 06:58:59,181][main.py][line:76][INFO] [Epoch:38/50]: loss1:0.0015 loss2:0.0112 main_loss:0.0817 | AUC:0.8544 AUC2:0.8498 FAR:0.00195
[2023-07-20 07:00:48,207][main.py][line:76][INFO] [Epoch:39/50]: loss1:0.0014 loss2:0.0103 main_loss:0.0767 | AUC:0.8535 AUC2:0.8498 FAR:0.00188
[2023-07-20 07:02:36,676][main.py][line:76][INFO] [Epoch:40/50]: loss1:0.0012 loss2:0.0096 main_loss:0.0700 | AUC:0.8535 AUC2:0.8498 FAR:0.00190
[2023-07-20 07:04:26,339][main.py][line:76][INFO] [Epoch:41/50]: loss1:0.0012 loss2:0.0092 main_loss:0.0686 | AUC:0.8503 AUC2:0.8498 FAR:0.00175
[2023-07-20 07:06:14,749][main.py][line:76][INFO] [Epoch:42/50]: loss1:0.0013 loss2:0.0092 main_loss:0.0690 | AUC:0.8520 AUC2:0.8498 FAR:0.00212
[2023-07-20 07:08:03,525][main.py][line:76][INFO] [Epoch:43/50]: loss1:0.0012 loss2:0.0087 main_loss:0.0667 | AUC:0.8534 AUC2:0.8498 FAR:0.00230
[2023-07-20 07:09:53,430][main.py][line:76][INFO] [Epoch:44/50]: loss1:0.0012 loss2:0.0084 main_loss:0.0633 | AUC:0.8525 AUC2:0.8498 FAR:0.00190
[2023-07-20 07:11:42,484][main.py][line:76][INFO] [Epoch:45/50]: loss1:0.0016 loss2:0.0083 main_loss:0.0634 | AUC:0.8509 AUC2:0.8498 FAR:0.00240
[2023-07-20 07:13:30,823][main.py][line:76][INFO] [Epoch:46/50]: loss1:0.0011 loss2:0.0077 main_loss:0.0604 | AUC:0.8519 AUC2:0.8498 FAR:0.00178
[2023-07-20 07:15:19,445][main.py][line:76][INFO] [Epoch:47/50]: loss1:0.0010 loss2:0.0073 main_loss:0.0616 | AUC:0.8529 AUC2:0.8498 FAR:0.00195
[2023-07-20 07:17:08,844][main.py][line:76][INFO] [Epoch:48/50]: loss1:0.0012 loss2:0.0073 main_loss:0.0612 | AUC:0.8509 AUC2:0.8498 FAR:0.00180
[2023-07-20 07:18:57,687][main.py][line:76][INFO] [Epoch:49/50]: loss1:0.0010 loss2:0.0071 main_loss:0.0585 | AUC:0.8524 AUC2:0.8498 FAR:0.00173
[2023-07-20 07:20:47,024][main.py][line:76][INFO] [Epoch:50/50]: loss1:0.0011 loss2:0.0070 main_loss:0.0588 | AUC:0.8530 AUC2:0.8498 FAR:0.00168
[2023-07-20 07:20:47,201][main.py][line:82][INFO] Training completes in 90m 45s | best AUC:0.8584 FAR:0.00175

[2023-07-20 14:12:08,126][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 14:12:08,386][main.py][line:116][INFO] total params:52.4939M
[2023-07-20 14:12:08,386][main.py][line:123][INFO] Test Mode
[2023-07-20 14:12:08,386][main.py][line:37][INFO] Not found pretrained checkpoint file.
[2023-07-20 14:12:42,743][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8584.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 14:12:42,974][main.py][line:116][INFO] total params:52.4939M
[2023-07-20 14:12:42,974][main.py][line:123][INFO] Test Mode
[2023-07-20 14:12:42,974][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8584.pkl.
[2023-07-20 14:12:43,032][main.py][line:32][INFO] bert.embedding.learnedPosition.pe size mismatch: load torch.Size([1, 201, 1024]) given torch.Size([1, 301, 1024])
[2023-07-20 14:13:11,072][infer_bert.py][line:55][INFO] offline AUC:0.8592 AUC2:0.8557 AP:0.3162 FAR:0.0011 | Complete in 0m 28s

[2023-07-20 14:22:07,101][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.5, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8584.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 14:22:07,342][main.py][line:116][INFO] total params:52.2891M
[2023-07-20 14:22:07,342][main.py][line:119][INFO] Training Mode
[2023-07-20 14:22:07,342][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 14:22:07,343][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 14:22:20,401][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 14:23:35,016][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3651 loss2:1.2105 main_loss:1.2431 | AUC:0.8272 AUC2:0.8273 FAR:0.00585
[2023-07-20 14:24:49,839][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1384 loss2:1.0035 main_loss:0.8672 | AUC:0.8501 AUC2:0.8441 FAR:0.00336
[2023-07-20 14:26:05,238][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0547 loss2:0.9084 main_loss:0.6741 | AUC:0.8534 AUC2:0.8487 FAR:0.00422
[2023-07-20 14:27:20,442][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0247 loss2:0.8165 main_loss:0.5637 | AUC:0.8482 AUC2:0.8487 FAR:0.00341
[2023-07-20 14:28:35,593][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0198 loss2:0.7432 main_loss:0.5005 | AUC:0.8494 AUC2:0.8487 FAR:0.00180
[2023-07-20 14:29:51,124][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0172 loss2:0.6822 main_loss:0.4538 | AUC:0.8509 AUC2:0.8487 FAR:0.00731
[2023-07-20 14:31:06,409][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0127 loss2:0.6207 main_loss:0.4130 | AUC:0.8525 AUC2:0.8487 FAR:0.00415
[2023-07-20 14:32:21,688][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0103 loss2:0.5571 main_loss:0.3806 | AUC:0.8450 AUC2:0.8487 FAR:0.00131
[2023-07-20 14:33:37,610][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0077 loss2:0.4899 main_loss:0.3390 | AUC:0.8563 AUC2:0.8470 FAR:0.00245
[2023-07-20 14:34:52,869][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0064 loss2:0.4361 main_loss:0.2934 | AUC:0.8416 AUC2:0.8470 FAR:0.00235
[2023-07-20 14:36:08,298][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0052 loss2:0.3728 main_loss:0.2636 | AUC:0.8379 AUC2:0.8470 FAR:0.00264
[2023-07-20 14:37:24,063][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0042 loss2:0.3249 main_loss:0.2223 | AUC:0.8520 AUC2:0.8470 FAR:0.00242
[2023-07-20 14:38:39,222][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0041 loss2:0.2819 main_loss:0.1958 | AUC:0.8529 AUC2:0.8470 FAR:0.00215
[2023-07-20 14:39:54,619][main.py][line:76][INFO] [Epoch:14/50]: loss1:0.0544 loss2:0.3312 main_loss:0.2756 | AUC:0.8589 AUC2:0.8506 FAR:0.00405
[2023-07-20 14:41:09,817][main.py][line:76][INFO] [Epoch:15/50]: loss1:0.0061 loss2:0.2414 main_loss:0.1759 | AUC:0.8586 AUC2:0.8506 FAR:0.00205
[2023-07-20 14:42:25,183][main.py][line:76][INFO] [Epoch:16/50]: loss1:0.0032 loss2:0.1975 main_loss:0.1506 | AUC:0.8612 AUC2:0.8528 FAR:0.00203
[2023-07-20 14:43:40,520][main.py][line:76][INFO] [Epoch:17/50]: loss1:0.0023 loss2:0.1623 main_loss:0.1225 | AUC:0.8578 AUC2:0.8528 FAR:0.00215
[2023-07-20 14:44:55,846][main.py][line:76][INFO] [Epoch:18/50]: loss1:0.0021 loss2:0.1481 main_loss:0.1219 | AUC:0.8585 AUC2:0.8528 FAR:0.00193
[2023-07-20 14:46:11,179][main.py][line:76][INFO] [Epoch:19/50]: loss1:0.0018 loss2:0.1172 main_loss:0.0975 | AUC:0.8579 AUC2:0.8528 FAR:0.00198
[2023-07-20 14:47:26,279][main.py][line:76][INFO] [Epoch:20/50]: loss1:0.0017 loss2:0.1021 main_loss:0.0863 | AUC:0.8541 AUC2:0.8528 FAR:0.00210
[2023-07-20 14:48:41,890][main.py][line:76][INFO] [Epoch:21/50]: loss1:0.0015 loss2:0.0896 main_loss:0.0807 | AUC:0.8558 AUC2:0.8528 FAR:0.00200
[2023-07-20 14:49:57,390][main.py][line:76][INFO] [Epoch:22/50]: loss1:0.0015 loss2:0.0787 main_loss:0.0726 | AUC:0.8638 AUC2:0.8490 FAR:0.00212
[2023-07-20 14:51:12,829][main.py][line:76][INFO] [Epoch:23/50]: loss1:0.0015 loss2:0.0686 main_loss:0.0630 | AUC:0.8586 AUC2:0.8490 FAR:0.00249
[2023-07-20 14:52:28,436][main.py][line:76][INFO] [Epoch:24/50]: loss1:0.0013 loss2:0.0601 main_loss:0.1247 | AUC:0.8501 AUC2:0.8490 FAR:0.00207
[2023-07-20 14:53:43,801][main.py][line:76][INFO] [Epoch:25/50]: loss1:0.0014 loss2:0.0533 main_loss:0.2221 | AUC:0.8543 AUC2:0.8490 FAR:0.00227
[2023-07-20 14:54:59,158][main.py][line:76][INFO] [Epoch:26/50]: loss1:0.0011 loss2:0.0458 main_loss:0.1437 | AUC:0.8554 AUC2:0.8490 FAR:0.00215
[2023-07-20 14:56:14,700][main.py][line:76][INFO] [Epoch:27/50]: loss1:0.0009 loss2:0.0382 main_loss:0.1172 | AUC:0.8516 AUC2:0.8490 FAR:0.00289
[2023-07-20 14:57:30,061][main.py][line:76][INFO] [Epoch:28/50]: loss1:0.0017 loss2:0.0424 main_loss:0.1018 | AUC:0.8500 AUC2:0.8490 FAR:0.00190
[2023-07-20 14:58:45,034][main.py][line:76][INFO] [Epoch:29/50]: loss1:0.0010 loss2:0.0346 main_loss:0.0842 | AUC:0.8519 AUC2:0.8490 FAR:0.00138
[2023-07-20 15:00:00,422][main.py][line:76][INFO] [Epoch:30/50]: loss1:0.0008 loss2:0.0303 main_loss:0.0776 | AUC:0.8531 AUC2:0.8490 FAR:0.00163
[2023-07-20 15:01:16,209][main.py][line:76][INFO] [Epoch:31/50]: loss1:0.0007 loss2:0.0278 main_loss:0.0737 | AUC:0.8543 AUC2:0.8490 FAR:0.00178
[2023-07-20 15:02:31,500][main.py][line:76][INFO] [Epoch:32/50]: loss1:0.0006 loss2:0.0264 main_loss:0.0764 | AUC:0.8603 AUC2:0.8490 FAR:0.00190
[2023-07-20 15:03:46,580][main.py][line:76][INFO] [Epoch:33/50]: loss1:0.0005 loss2:0.0213 main_loss:0.0918 | AUC:0.8584 AUC2:0.8490 FAR:0.00148
[2023-07-20 15:05:02,030][main.py][line:76][INFO] [Epoch:34/50]: loss1:0.0006 loss2:0.0211 main_loss:0.1323 | AUC:0.8550 AUC2:0.8490 FAR:0.00161
[2023-07-20 15:06:17,522][main.py][line:76][INFO] [Epoch:35/50]: loss1:0.0004 loss2:0.0192 main_loss:0.1724 | AUC:0.8572 AUC2:0.8490 FAR:0.00143
[2023-07-20 15:07:32,847][main.py][line:76][INFO] [Epoch:36/50]: loss1:0.0029 loss2:0.0225 main_loss:0.1524 | AUC:0.8526 AUC2:0.8490 FAR:0.00726
[2023-07-20 15:08:47,917][main.py][line:76][INFO] [Epoch:37/50]: loss1:0.0117 loss2:0.0520 main_loss:0.1695 | AUC:0.8563 AUC2:0.8490 FAR:0.00195
[2023-07-20 15:10:03,300][main.py][line:76][INFO] [Epoch:38/50]: loss1:0.0016 loss2:0.0258 main_loss:0.1673 | AUC:0.8546 AUC2:0.8490 FAR:0.00254
[2023-07-20 15:11:18,556][main.py][line:76][INFO] [Epoch:39/50]: loss1:0.0007 loss2:0.0205 main_loss:0.1581 | AUC:0.8577 AUC2:0.8490 FAR:0.00222
[2023-07-20 15:12:33,990][main.py][line:76][INFO] [Epoch:40/50]: loss1:0.0006 loss2:0.0170 main_loss:0.1495 | AUC:0.8580 AUC2:0.8490 FAR:0.00193
[2023-07-20 15:13:49,291][main.py][line:76][INFO] [Epoch:41/50]: loss1:0.0004 loss2:0.0159 main_loss:0.1399 | AUC:0.8587 AUC2:0.8490 FAR:0.00200
[2023-07-20 15:15:04,329][main.py][line:76][INFO] [Epoch:42/50]: loss1:0.0004 loss2:0.0149 main_loss:0.1291 | AUC:0.8589 AUC2:0.8490 FAR:0.00190
[2023-07-20 15:16:19,518][main.py][line:76][INFO] [Epoch:43/50]: loss1:0.0004 loss2:0.0137 main_loss:0.1243 | AUC:0.8590 AUC2:0.8490 FAR:0.00203
[2023-07-20 15:17:35,133][main.py][line:76][INFO] [Epoch:44/50]: loss1:0.0003 loss2:0.0134 main_loss:0.1171 | AUC:0.8592 AUC2:0.8490 FAR:0.00198
[2023-07-20 15:18:50,397][main.py][line:76][INFO] [Epoch:45/50]: loss1:0.0003 loss2:0.0122 main_loss:0.1165 | AUC:0.8600 AUC2:0.8490 FAR:0.00190
[2023-07-20 15:20:05,802][main.py][line:76][INFO] [Epoch:46/50]: loss1:0.0003 loss2:0.0126 main_loss:0.1114 | AUC:0.8610 AUC2:0.8490 FAR:0.00207
[2023-07-20 15:21:21,038][main.py][line:76][INFO] [Epoch:47/50]: loss1:0.0003 loss2:0.0105 main_loss:0.1082 | AUC:0.8611 AUC2:0.8490 FAR:0.00205
[2023-07-20 15:22:36,431][main.py][line:76][INFO] [Epoch:48/50]: loss1:0.0003 loss2:0.0108 main_loss:0.1048 | AUC:0.8606 AUC2:0.8490 FAR:0.00203
[2023-07-20 15:23:51,905][main.py][line:76][INFO] [Epoch:49/50]: loss1:0.0003 loss2:0.0108 main_loss:0.1032 | AUC:0.8609 AUC2:0.8490 FAR:0.00188
[2023-07-20 15:25:06,990][main.py][line:76][INFO] [Epoch:50/50]: loss1:0.0003 loss2:0.0100 main_loss:0.0983 | AUC:0.8606 AUC2:0.8490 FAR:0.00188
[2023-07-20 15:25:07,118][main.py][line:82][INFO] Training completes in 62m 47s | best AUC:0.8638 FAR:0.00212

[2023-07-20 15:34:00,531][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.5, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 15:34:00,813][main.py][line:116][INFO] total params:52.2891M
[2023-07-20 15:34:00,813][main.py][line:123][INFO] Test Mode
[2023-07-20 15:34:00,813][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-20 15:34:14,614][infer_bert.py][line:55][INFO] offline AUC:0.8638 AUC2:0.8558 AP:0.3289 FAR:0.0014 | Complete in 0m 14s

[2023-07-20 15:35:32,774][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.5, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 15:35:33,011][main.py][line:116][INFO] total params:52.2891M
[2023-07-20 15:35:33,011][main.py][line:119][INFO] Training Mode
[2023-07-20 15:35:33,011][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 15:35:33,012][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 15:35:46,042][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 15:37:00,743][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3684 loss2:1.3709 main_loss:4.6427 | AUC:0.8216 AUC2:0.8233 FAR:0.02131
[2023-07-20 15:38:15,422][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1426 loss2:1.3015 main_loss:2.3037 | AUC:0.8487 AUC2:0.8460 FAR:0.01319
[2023-07-20 15:39:30,790][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0390 loss2:1.2560 main_loss:1.1836 | AUC:0.8428 AUC2:0.8460 FAR:0.00617
[2023-07-20 15:40:46,036][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0236 loss2:1.2090 main_loss:0.9709 | AUC:0.8461 AUC2:0.8460 FAR:0.01452
[2023-07-20 15:42:01,313][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0090 loss2:1.1655 main_loss:0.7813 | AUC:0.8429 AUC2:0.8460 FAR:0.01057
[2023-07-20 15:43:17,120][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0234 loss2:1.1307 main_loss:0.8951 | AUC:0.8425 AUC2:0.8460 FAR:0.00677
[2023-07-20 15:44:32,429][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0025 loss2:1.0662 main_loss:0.6476 | AUC:0.8388 AUC2:0.8460 FAR:0.00916
[2023-07-20 15:45:47,748][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0010 loss2:1.0185 main_loss:0.6106 | AUC:0.8417 AUC2:0.8460 FAR:0.00556
[2023-07-20 15:47:03,275][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0007 loss2:0.9457 main_loss:0.5662 | AUC:0.8468 AUC2:0.8460 FAR:0.00529
[2023-07-20 15:48:18,572][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0007 loss2:0.8906 main_loss:0.5211 | AUC:0.8432 AUC2:0.8460 FAR:0.00450
[2023-07-20 15:49:34,210][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0007 loss2:0.8371 main_loss:0.4973 | AUC:0.8385 AUC2:0.8460 FAR:0.00338
[2023-07-20 15:50:49,955][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0007 loss2:0.7563 main_loss:0.4408 | AUC:0.8473 AUC2:0.8460 FAR:0.00412
[2023-07-20 15:52:05,386][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0006 loss2:0.7114 main_loss:0.4129 | AUC:0.8478 AUC2:0.8460 FAR:0.00304
[2023-07-20 15:53:21,095][main.py][line:76][INFO] [Epoch:14/50]: loss1:0.0007 loss2:0.6177 main_loss:0.3713 | AUC:0.8493 AUC2:0.8467 FAR:0.00316
[2023-07-20 15:54:36,551][main.py][line:76][INFO] [Epoch:15/50]: loss1:0.0006 loss2:0.5304 main_loss:0.3199 | AUC:0.8493 AUC2:0.8484 FAR:0.00316
[2023-07-20 15:55:52,087][main.py][line:76][INFO] [Epoch:16/50]: loss1:0.0005 loss2:0.4756 main_loss:0.2918 | AUC:0.8533 AUC2:0.8496 FAR:0.00368
[2023-07-20 15:57:07,392][main.py][line:76][INFO] [Epoch:17/50]: loss1:0.0006 loss2:0.4529 main_loss:0.2717 | AUC:0.8529 AUC2:0.8496 FAR:0.00336
[2023-07-20 15:58:23,170][main.py][line:76][INFO] [Epoch:18/50]: loss1:0.0455 loss2:0.4921 main_loss:0.7469 | AUC:0.8446 AUC2:0.8496 FAR:0.00161
[2023-07-20 15:59:38,854][main.py][line:76][INFO] [Epoch:19/50]: loss1:0.0306 loss2:0.6235 main_loss:0.6549 | AUC:0.8433 AUC2:0.8496 FAR:0.01642
[2023-07-20 16:00:54,144][main.py][line:76][INFO] [Epoch:20/50]: loss1:0.0044 loss2:0.4530 main_loss:0.3035 | AUC:0.8389 AUC2:0.8496 FAR:0.00709
[2023-07-20 16:02:09,582][main.py][line:76][INFO] [Epoch:21/50]: loss1:0.0007 loss2:0.3035 main_loss:0.1931 | AUC:0.8424 AUC2:0.8496 FAR:0.00531
[2023-07-20 16:03:24,631][main.py][line:76][INFO] [Epoch:22/50]: loss1:0.0004 loss2:0.2555 main_loss:0.1636 | AUC:0.8490 AUC2:0.8496 FAR:0.00494
[2023-07-20 16:04:39,618][main.py][line:76][INFO] [Epoch:23/50]: loss1:0.0004 loss2:0.2559 main_loss:0.1596 | AUC:0.8461 AUC2:0.8496 FAR:0.00489
[2023-07-20 16:05:54,851][main.py][line:76][INFO] [Epoch:24/50]: loss1:0.0004 loss2:0.1888 main_loss:0.1916 | AUC:0.8392 AUC2:0.8496 FAR:0.00482
[2023-07-20 16:07:09,627][main.py][line:76][INFO] [Epoch:25/50]: loss1:0.0003 loss2:0.1495 main_loss:0.2715 | AUC:0.8396 AUC2:0.8496 FAR:0.00531
[2023-07-20 16:08:24,522][main.py][line:76][INFO] [Epoch:26/50]: loss1:0.0002 loss2:0.1257 main_loss:0.1849 | AUC:0.8435 AUC2:0.8496 FAR:0.00435
[2023-07-20 16:08:45,648][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.5, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 16:08:45,903][main.py][line:116][INFO] total params:52.2891M
[2023-07-20 16:08:45,903][main.py][line:119][INFO] Training Mode
[2023-07-20 16:08:45,903][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 16:08:45,903][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-07-20 16:08:59,016][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 16:10:13,864][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3554 loss2:1.1499 main_loss:1.2712 | AUC:0.8341 AUC2:0.8283 FAR:0.00277
[2023-07-20 16:11:28,744][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1050 loss2:0.9077 main_loss:0.8439 | AUC:0.8450 AUC2:0.8417 FAR:0.00351
[2023-07-20 16:12:44,232][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0406 loss2:0.7850 main_loss:0.7339 | AUC:0.8411 AUC2:0.8417 FAR:0.00321
[2023-07-20 16:13:59,660][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0311 loss2:0.6588 main_loss:0.6656 | AUC:0.8230 AUC2:0.8417 FAR:0.00222
[2023-07-20 16:15:15,186][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0268 loss2:0.5569 main_loss:0.5745 | AUC:0.8410 AUC2:0.8417 FAR:0.01203
[2023-07-20 16:16:30,541][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0178 loss2:0.4723 main_loss:0.5150 | AUC:0.8289 AUC2:0.8417 FAR:0.00264
[2023-07-20 16:16:51,311][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.001, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 16:16:51,565][main.py][line:116][INFO] total params:52.3915M
[2023-07-20 16:16:51,565][main.py][line:119][INFO] Training Mode
[2023-07-20 16:16:51,565][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 16:16:51,565][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-07-20 16:17:12,213][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 16:19:04,406][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3464 loss2:1.0336 main_loss:1.9267 | AUC:0.8347 AUC2:0.8310 FAR:0.00437
[2023-07-20 16:21:00,939][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1192 loss2:0.7991 main_loss:1.2829 | AUC:0.8351 AUC2:0.8309 FAR:0.00696
[2023-07-20 16:22:59,313][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0540 loss2:0.6838 main_loss:1.0823 | AUC:0.8465 AUC2:0.8386 FAR:0.00889
[2023-07-20 16:24:51,444][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0542 loss2:0.5902 main_loss:0.9522 | AUC:0.8438 AUC2:0.8386 FAR:0.00699
[2023-07-20 16:26:42,347][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0333 loss2:0.5055 main_loss:0.8395 | AUC:0.8395 AUC2:0.8386 FAR:0.00274
[2023-07-20 16:28:36,398][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0126 loss2:0.3935 main_loss:0.7542 | AUC:0.8490 AUC2:0.8458 FAR:0.00277
[2023-07-20 16:30:29,384][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0146 loss2:0.3005 main_loss:0.6515 | AUC:0.8522 AUC2:0.8376 FAR:0.00645
[2023-07-20 16:32:22,683][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0348 loss2:0.2895 main_loss:0.6443 | AUC:0.8463 AUC2:0.8376 FAR:0.00450
[2023-07-20 16:34:13,710][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0078 loss2:0.1830 main_loss:0.5324 | AUC:0.8455 AUC2:0.8376 FAR:0.00417
[2023-07-20 16:36:04,452][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0073 loss2:0.1310 main_loss:0.4769 | AUC:0.8391 AUC2:0.8376 FAR:0.00099
[2023-07-20 16:37:55,108][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0522 loss2:0.1893 main_loss:0.5910 | AUC:0.8475 AUC2:0.8376 FAR:0.00694
[2023-07-20 16:39:46,729][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0099 loss2:0.1059 main_loss:0.5641 | AUC:0.8408 AUC2:0.8376 FAR:0.00696
[2023-07-20 16:41:38,625][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0045 loss2:0.0603 main_loss:0.5816 | AUC:0.8419 AUC2:0.8376 FAR:0.00761
[2023-07-20 16:41:47,971][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.999, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 16:41:48,233][main.py][line:116][INFO] total params:52.3915M
[2023-07-20 16:41:48,233][main.py][line:119][INFO] Training Mode
[2023-07-20 16:41:48,234][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 16:41:48,234][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-07-20 16:42:08,591][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 16:43:56,618][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3464 loss2:1.0336 main_loss:1.3805 | AUC:0.8305 AUC2:0.8310 FAR:0.00437
[2023-07-20 16:45:45,023][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1192 loss2:0.7991 main_loss:0.9187 | AUC:0.8377 AUC2:0.8309 FAR:0.00696
[2023-07-20 16:47:34,590][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0540 loss2:0.6838 main_loss:0.7382 | AUC:0.8418 AUC2:0.8386 FAR:0.00889
[2023-07-20 16:49:23,658][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0542 loss2:0.5902 main_loss:0.6448 | AUC:0.8385 AUC2:0.8386 FAR:0.00699
[2023-07-20 16:51:12,507][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0333 loss2:0.5055 main_loss:0.5391 | AUC:0.8380 AUC2:0.8386 FAR:0.00274
[2023-07-20 16:53:01,676][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0126 loss2:0.3935 main_loss:0.4064 | AUC:0.8497 AUC2:0.8458 FAR:0.00277
[2023-07-20 16:54:50,746][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0146 loss2:0.3005 main_loss:0.3154 | AUC:0.8493 AUC2:0.8458 FAR:0.00645
[2023-07-20 16:56:40,000][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0348 loss2:0.2895 main_loss:0.3247 | AUC:0.8444 AUC2:0.8458 FAR:0.00450
[2023-07-20 16:58:29,246][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0078 loss2:0.1830 main_loss:0.1911 | AUC:0.8411 AUC2:0.8458 FAR:0.00417
[2023-07-20 17:00:18,290][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0073 loss2:0.1310 main_loss:0.1386 | AUC:0.8383 AUC2:0.8458 FAR:0.00099
[2023-07-20 17:02:07,200][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0522 loss2:0.1893 main_loss:0.2417 | AUC:0.8471 AUC2:0.8458 FAR:0.00694
[2023-07-20 17:03:56,512][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0099 loss2:0.1059 main_loss:0.1161 | AUC:0.8431 AUC2:0.8458 FAR:0.00696
[2023-07-20 17:05:48,810][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0045 loss2:0.0603 main_loss:0.0650 | AUC:0.8446 AUC2:0.8458 FAR:0.00761
[2023-07-20 17:06:18,298][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.99, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 17:06:18,554][main.py][line:116][INFO] total params:52.3915M
[2023-07-20 17:06:18,554][main.py][line:119][INFO] Training Mode
[2023-07-20 17:06:18,555][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 17:06:18,555][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 17:06:39,261][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 17:09:05,867][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3649 loss2:1.0963 main_loss:1.4672 | AUC:0.8341 AUC2:0.8342 FAR:0.00734
[2023-07-20 17:11:45,277][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1498 loss2:0.8753 main_loss:1.0284 | AUC:0.8554 AUC2:0.8502 FAR:0.00462
[2023-07-20 17:14:20,246][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0607 loss2:0.7820 main_loss:0.8452 | AUC:0.8569 AUC2:0.8538 FAR:0.00442
[2023-07-20 17:16:38,267][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0353 loss2:0.7062 main_loss:0.7438 | AUC:0.8552 AUC2:0.8538 FAR:0.00474
[2023-07-20 17:19:15,825][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0349 loss2:0.6479 main_loss:0.6852 | AUC:0.8543 AUC2:0.8538 FAR:0.00810
[2023-07-20 17:21:53,406][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0298 loss2:0.6011 main_loss:0.6346 | AUC:0.8607 AUC2:0.8550 FAR:0.00462
[2023-07-20 17:24:29,926][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0121 loss2:0.5310 main_loss:0.5455 | AUC:0.8617 AUC2:0.8551 FAR:0.00188
[2023-07-20 17:27:13,274][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0100 loss2:0.4704 main_loss:0.4827 | AUC:0.8584 AUC2:0.8551 FAR:0.00237
[2023-07-20 17:29:41,108][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0089 loss2:0.4148 main_loss:0.4257 | AUC:0.8611 AUC2:0.8551 FAR:0.00212
[2023-07-20 17:32:17,550][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0081 loss2:0.3618 main_loss:0.3717 | AUC:0.8593 AUC2:0.8551 FAR:0.00291
[2023-07-20 17:35:07,656][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.0081 loss2:0.3139 main_loss:0.3237 | AUC:0.8593 AUC2:0.8551 FAR:0.00291
[2023-07-20 17:37:50,610][main.py][line:76][INFO] [Epoch:12/100]: loss1:0.0367 loss2:0.3315 main_loss:0.3699 | AUC:0.8551 AUC2:0.8551 FAR:0.00188
[2023-07-20 17:40:34,733][main.py][line:76][INFO] [Epoch:13/100]: loss1:0.0232 loss2:0.2938 main_loss:0.3188 | AUC:0.8477 AUC2:0.8551 FAR:0.00284
[2023-07-20 17:43:05,823][main.py][line:76][INFO] [Epoch:14/100]: loss1:0.0198 loss2:0.2561 main_loss:0.2780 | AUC:0.8483 AUC2:0.8551 FAR:0.00289
[2023-07-20 17:45:49,426][main.py][line:76][INFO] [Epoch:15/100]: loss1:0.0057 loss2:0.1958 main_loss:0.2035 | AUC:0.8534 AUC2:0.8551 FAR:0.00366
[2023-07-20 17:48:33,661][main.py][line:76][INFO] [Epoch:16/100]: loss1:0.0043 loss2:0.1638 main_loss:0.1698 | AUC:0.8519 AUC2:0.8551 FAR:0.00356
[2023-07-20 17:51:11,166][main.py][line:76][INFO] [Epoch:17/100]: loss1:0.0037 loss2:0.1360 main_loss:0.1414 | AUC:0.8489 AUC2:0.8551 FAR:0.00380
[2023-07-20 17:54:02,204][main.py][line:76][INFO] [Epoch:18/100]: loss1:0.0031 loss2:0.1142 main_loss:0.1190 | AUC:0.8494 AUC2:0.8551 FAR:0.00279
[2023-07-20 17:56:42,336][main.py][line:76][INFO] [Epoch:19/100]: loss1:0.0031 loss2:0.0964 main_loss:0.1010 | AUC:0.8508 AUC2:0.8551 FAR:0.00338
[2023-07-20 17:59:30,503][main.py][line:76][INFO] [Epoch:20/100]: loss1:0.0028 loss2:0.0827 main_loss:0.0873 | AUC:0.8533 AUC2:0.8551 FAR:0.00346
[2023-07-20 18:02:07,393][main.py][line:76][INFO] [Epoch:21/100]: loss1:0.0024 loss2:0.0703 main_loss:0.0742 | AUC:0.8502 AUC2:0.8551 FAR:0.00274
[2023-07-20 18:04:44,109][main.py][line:76][INFO] [Epoch:22/100]: loss1:0.0021 loss2:0.0592 main_loss:0.0626 | AUC:0.8488 AUC2:0.8551 FAR:0.00200
[2023-07-20 18:07:24,281][main.py][line:76][INFO] [Epoch:23/100]: loss1:0.0020 loss2:0.0525 main_loss:0.0557 | AUC:0.8504 AUC2:0.8551 FAR:0.00188
[2023-07-20 18:10:02,110][main.py][line:76][INFO] [Epoch:24/100]: loss1:0.0021 loss2:0.0444 main_loss:0.0477 | AUC:0.8485 AUC2:0.8551 FAR:0.00254
[2023-07-20 18:12:56,340][main.py][line:76][INFO] [Epoch:25/100]: loss1:0.0022 loss2:0.0408 main_loss:0.0443 | AUC:0.8542 AUC2:0.8551 FAR:0.00274
[2023-07-20 18:15:35,227][main.py][line:76][INFO] [Epoch:26/100]: loss1:0.0349 loss2:0.0996 main_loss:0.1356 | AUC:0.8534 AUC2:0.8551 FAR:0.00642
[2023-07-20 18:18:19,348][main.py][line:76][INFO] [Epoch:27/100]: loss1:0.0099 loss2:0.0632 main_loss:0.0742 | AUC:0.8464 AUC2:0.8551 FAR:0.00452
[2023-07-20 18:21:16,773][main.py][line:76][INFO] [Epoch:28/100]: loss1:0.0027 loss2:0.0399 main_loss:0.0436 | AUC:0.8487 AUC2:0.8551 FAR:0.00245
[2023-07-20 18:24:55,811][main.py][line:76][INFO] [Epoch:29/100]: loss1:0.0019 loss2:0.0313 main_loss:0.0344 | AUC:0.8465 AUC2:0.8551 FAR:0.00272
[2023-07-20 18:27:55,106][main.py][line:76][INFO] [Epoch:30/100]: loss1:0.0013 loss2:0.0267 main_loss:0.0290 | AUC:0.8490 AUC2:0.8551 FAR:0.00338
[2023-07-20 18:31:54,549][main.py][line:76][INFO] [Epoch:31/100]: loss1:0.0012 loss2:0.0234 main_loss:0.0254 | AUC:0.8447 AUC2:0.8551 FAR:0.00259
[2023-07-20 18:36:50,389][main.py][line:76][INFO] [Epoch:32/100]: loss1:0.0011 loss2:0.0208 main_loss:0.0228 | AUC:0.8465 AUC2:0.8551 FAR:0.00356
[2023-07-20 18:41:14,375][main.py][line:76][INFO] [Epoch:33/100]: loss1:0.0010 loss2:0.0186 main_loss:0.0205 | AUC:0.8512 AUC2:0.8551 FAR:0.00316
[2023-07-20 18:44:55,821][main.py][line:76][INFO] [Epoch:34/100]: loss1:0.0009 loss2:0.0172 main_loss:0.0190 | AUC:0.8489 AUC2:0.8551 FAR:0.00311
[2023-07-20 18:48:40,872][main.py][line:76][INFO] [Epoch:35/100]: loss1:0.0012 loss2:0.0173 main_loss:0.0193 | AUC:0.8479 AUC2:0.8551 FAR:0.00306
[2023-07-20 18:52:22,886][main.py][line:76][INFO] [Epoch:36/100]: loss1:0.0008 loss2:0.0154 main_loss:0.0170 | AUC:0.8493 AUC2:0.8551 FAR:0.00286
[2023-07-20 18:55:23,009][main.py][line:76][INFO] [Epoch:37/100]: loss1:0.0007 loss2:0.0140 main_loss:0.0154 | AUC:0.8516 AUC2:0.8551 FAR:0.00301
[2023-07-20 18:58:39,517][main.py][line:76][INFO] [Epoch:38/100]: loss1:0.0007 loss2:0.0136 main_loss:0.0150 | AUC:0.8509 AUC2:0.8551 FAR:0.00309
[2023-07-20 19:01:26,155][main.py][line:76][INFO] [Epoch:39/100]: loss1:0.0006 loss2:0.0125 main_loss:0.0138 | AUC:0.8478 AUC2:0.8551 FAR:0.00309
[2023-07-20 19:04:49,289][main.py][line:76][INFO] [Epoch:40/100]: loss1:0.0006 loss2:0.0113 main_loss:0.0126 | AUC:0.8469 AUC2:0.8551 FAR:0.00316
[2023-07-20 19:07:22,159][main.py][line:76][INFO] [Epoch:41/100]: loss1:0.0005 loss2:0.0108 main_loss:0.0120 | AUC:0.8491 AUC2:0.8551 FAR:0.00326
[2023-07-20 19:10:03,555][main.py][line:76][INFO] [Epoch:42/100]: loss1:0.0006 loss2:0.0107 main_loss:0.0119 | AUC:0.8498 AUC2:0.8551 FAR:0.00309
[2023-07-20 19:12:55,334][main.py][line:76][INFO] [Epoch:43/100]: loss1:0.0006 loss2:0.0103 main_loss:0.0115 | AUC:0.8515 AUC2:0.8551 FAR:0.00316
[2023-07-20 19:15:51,626][main.py][line:76][INFO] [Epoch:44/100]: loss1:0.0006 loss2:0.0099 main_loss:0.0112 | AUC:0.8507 AUC2:0.8551 FAR:0.00319
[2023-07-20 19:18:37,868][main.py][line:76][INFO] [Epoch:45/100]: loss1:0.0005 loss2:0.0095 main_loss:0.0106 | AUC:0.8517 AUC2:0.8551 FAR:0.00336
[2023-07-20 19:21:50,191][main.py][line:76][INFO] [Epoch:46/100]: loss1:0.0005 loss2:0.0091 main_loss:0.0102 | AUC:0.8521 AUC2:0.8551 FAR:0.00301
[2023-07-20 19:24:37,311][main.py][line:76][INFO] [Epoch:47/100]: loss1:0.0005 loss2:0.0088 main_loss:0.0098 | AUC:0.8520 AUC2:0.8551 FAR:0.00331
[2023-07-20 19:27:15,838][main.py][line:76][INFO] [Epoch:48/100]: loss1:0.0004 loss2:0.0082 main_loss:0.0091 | AUC:0.8518 AUC2:0.8551 FAR:0.00336
[2023-07-20 19:29:56,164][main.py][line:76][INFO] [Epoch:49/100]: loss1:0.0004 loss2:0.0081 main_loss:0.0091 | AUC:0.8518 AUC2:0.8551 FAR:0.00309
[2023-07-20 19:32:23,511][main.py][line:76][INFO] [Epoch:50/100]: loss1:0.0004 loss2:0.0079 main_loss:0.0088 | AUC:0.8519 AUC2:0.8551 FAR:0.00333
[2023-07-20 19:35:26,695][main.py][line:76][INFO] [Epoch:51/100]: loss1:0.0004 loss2:0.0079 main_loss:0.0088 | AUC:0.8523 AUC2:0.8551 FAR:0.00328
[2023-07-20 19:38:21,227][main.py][line:76][INFO] [Epoch:52/100]: loss1:0.0004 loss2:0.0077 main_loss:0.0085 | AUC:0.8531 AUC2:0.8551 FAR:0.00333
[2023-07-20 19:41:12,854][main.py][line:76][INFO] [Epoch:53/100]: loss1:0.0004 loss2:0.0077 main_loss:0.0086 | AUC:0.8528 AUC2:0.8551 FAR:0.00405
[2023-07-20 19:43:57,688][main.py][line:76][INFO] [Epoch:54/100]: loss1:0.0005 loss2:0.0077 main_loss:0.0086 | AUC:0.8527 AUC2:0.8551 FAR:0.00351
[2023-07-20 19:46:36,972][main.py][line:76][INFO] [Epoch:55/100]: loss1:0.0004 loss2:0.0076 main_loss:0.0085 | AUC:0.8529 AUC2:0.8551 FAR:0.00346
[2023-07-20 19:49:19,973][main.py][line:76][INFO] [Epoch:56/100]: loss1:0.0004 loss2:0.0073 main_loss:0.0082 | AUC:0.8528 AUC2:0.8551 FAR:0.00341
[2023-07-20 19:52:10,271][main.py][line:76][INFO] [Epoch:57/100]: loss1:0.0004 loss2:0.0073 main_loss:0.0081 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 19:54:46,514][main.py][line:76][INFO] [Epoch:58/100]: loss1:0.0004 loss2:0.0073 main_loss:0.0082 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 19:57:47,752][main.py][line:76][INFO] [Epoch:59/100]: loss1:0.0004 loss2:0.0075 main_loss:0.0083 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:00:53,481][main.py][line:76][INFO] [Epoch:60/100]: loss1:0.0004 loss2:0.0071 main_loss:0.0079 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:03:33,926][main.py][line:76][INFO] [Epoch:61/100]: loss1:0.0004 loss2:0.0071 main_loss:0.0080 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:06:18,833][main.py][line:76][INFO] [Epoch:62/100]: loss1:0.0004 loss2:0.0072 main_loss:0.0081 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:09:32,790][main.py][line:76][INFO] [Epoch:63/100]: loss1:0.0004 loss2:0.0071 main_loss:0.0079 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:12:48,226][main.py][line:76][INFO] [Epoch:64/100]: loss1:0.0004 loss2:0.0074 main_loss:0.0082 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:15:37,814][main.py][line:76][INFO] [Epoch:65/100]: loss1:0.0004 loss2:0.0074 main_loss:0.0083 | AUC:0.8526 AUC2:0.8551 FAR:0.00343
[2023-07-20 20:18:40,647][main.py][line:76][INFO] [Epoch:66/100]: loss1:0.0004 loss2:0.0073 main_loss:0.0082 | AUC:0.8525 AUC2:0.8551 FAR:0.00341
[2023-07-20 20:21:31,348][main.py][line:76][INFO] [Epoch:67/100]: loss1:0.0004 loss2:0.0074 main_loss:0.0082 | AUC:0.8522 AUC2:0.8551 FAR:0.00343
[2023-07-20 20:24:21,129][main.py][line:76][INFO] [Epoch:68/100]: loss1:0.0004 loss2:0.0070 main_loss:0.0078 | AUC:0.8517 AUC2:0.8551 FAR:0.00326
[2023-07-20 20:27:10,900][main.py][line:76][INFO] [Epoch:69/100]: loss1:0.0004 loss2:0.0072 main_loss:0.0080 | AUC:0.8523 AUC2:0.8551 FAR:0.00289
[2023-07-20 20:29:48,028][main.py][line:76][INFO] [Epoch:70/100]: loss1:0.0003 loss2:0.0068 main_loss:0.0076 | AUC:0.8516 AUC2:0.8551 FAR:0.00304
[2023-07-20 20:32:43,160][main.py][line:76][INFO] [Epoch:71/100]: loss1:0.0003 loss2:0.0067 main_loss:0.0075 | AUC:0.8527 AUC2:0.8551 FAR:0.00304
[2023-07-20 20:35:17,050][main.py][line:76][INFO] [Epoch:72/100]: loss1:0.0004 loss2:0.0067 main_loss:0.0075 | AUC:0.8525 AUC2:0.8551 FAR:0.00311
[2023-07-20 20:37:50,544][main.py][line:76][INFO] [Epoch:73/100]: loss1:0.0003 loss2:0.0064 main_loss:0.0071 | AUC:0.8520 AUC2:0.8551 FAR:0.00299
[2023-07-20 20:41:04,186][main.py][line:76][INFO] [Epoch:74/100]: loss1:0.0005 loss2:0.0063 main_loss:0.0073 | AUC:0.8523 AUC2:0.8551 FAR:0.00314
[2023-07-20 20:43:56,091][main.py][line:76][INFO] [Epoch:75/100]: loss1:0.0008 loss2:0.0068 main_loss:0.0080 | AUC:0.8484 AUC2:0.8551 FAR:0.00267
[2023-07-20 20:46:31,093][main.py][line:76][INFO] [Epoch:76/100]: loss1:0.0004 loss2:0.0061 main_loss:0.0069 | AUC:0.8492 AUC2:0.8551 FAR:0.00324
[2023-07-20 20:48:44,358][main.py][line:76][INFO] [Epoch:77/100]: loss1:0.0004 loss2:0.0058 main_loss:0.0066 | AUC:0.8467 AUC2:0.8551 FAR:0.00331
[2023-07-20 20:50:52,796][main.py][line:76][INFO] [Epoch:78/100]: loss1:0.0004 loss2:0.0052 main_loss:0.0060 | AUC:0.8504 AUC2:0.8551 FAR:0.00301
[2023-07-20 20:52:53,617][main.py][line:76][INFO] [Epoch:79/100]: loss1:0.0003 loss2:0.0049 main_loss:0.0057 | AUC:0.8492 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:54:56,371][main.py][line:76][INFO] [Epoch:80/100]: loss1:0.0090 loss2:0.0216 main_loss:0.0311 | AUC:0.8475 AUC2:0.8551 FAR:0.00721
[2023-07-20 20:56:58,570][main.py][line:76][INFO] [Epoch:81/100]: loss1:0.0029 loss2:0.0122 main_loss:0.0156 | AUC:0.8545 AUC2:0.8551 FAR:0.00425
[2023-07-20 20:58:54,898][main.py][line:76][INFO] [Epoch:82/100]: loss1:0.0008 loss2:0.0061 main_loss:0.0075 | AUC:0.8544 AUC2:0.8551 FAR:0.00358
[2023-07-20 21:00:53,567][main.py][line:76][INFO] [Epoch:83/100]: loss1:0.0006 loss2:0.0051 main_loss:0.0062 | AUC:0.8555 AUC2:0.8551 FAR:0.00440
[2023-07-20 21:02:48,499][main.py][line:76][INFO] [Epoch:84/100]: loss1:0.0005 loss2:0.0044 main_loss:0.0054 | AUC:0.8529 AUC2:0.8551 FAR:0.00454
[2023-07-20 21:04:42,293][main.py][line:76][INFO] [Epoch:85/100]: loss1:0.0003 loss2:0.0041 main_loss:0.0049 | AUC:0.8521 AUC2:0.8551 FAR:0.00430
[2023-07-20 21:06:39,617][main.py][line:76][INFO] [Epoch:86/100]: loss1:0.0003 loss2:0.0035 main_loss:0.0044 | AUC:0.8530 AUC2:0.8551 FAR:0.00417
[2023-07-20 21:08:38,586][main.py][line:76][INFO] [Epoch:87/100]: loss1:0.0003 loss2:0.0033 main_loss:0.0040 | AUC:0.8525 AUC2:0.8551 FAR:0.00442
[2023-07-20 21:10:35,088][main.py][line:76][INFO] [Epoch:88/100]: loss1:0.0004 loss2:0.0035 main_loss:0.0045 | AUC:0.8542 AUC2:0.8551 FAR:0.00427
[2023-07-20 21:12:33,349][main.py][line:76][INFO] [Epoch:89/100]: loss1:0.0203 loss2:0.0314 main_loss:0.0522 | AUC:0.8474 AUC2:0.8551 FAR:0.00412
[2023-07-20 21:14:31,431][main.py][line:76][INFO] [Epoch:90/100]: loss1:0.0191 loss2:0.0362 main_loss:0.0557 | AUC:0.8527 AUC2:0.8551 FAR:0.00701
[2023-07-20 21:16:32,742][main.py][line:76][INFO] [Epoch:91/100]: loss1:0.0024 loss2:0.0104 main_loss:0.0132 | AUC:0.8512 AUC2:0.8551 FAR:0.00398
[2023-07-20 21:18:28,483][main.py][line:76][INFO] [Epoch:92/100]: loss1:0.0012 loss2:0.0060 main_loss:0.0077 | AUC:0.8531 AUC2:0.8551 FAR:0.00437
[2023-07-20 21:20:26,376][main.py][line:76][INFO] [Epoch:93/100]: loss1:0.0009 loss2:0.0051 main_loss:0.0065 | AUC:0.8551 AUC2:0.8551 FAR:0.00506
[2023-07-20 21:22:24,233][main.py][line:76][INFO] [Epoch:94/100]: loss1:0.0005 loss2:0.0036 main_loss:0.0047 | AUC:0.8567 AUC2:0.8551 FAR:0.00467
[2023-07-20 21:24:20,683][main.py][line:76][INFO] [Epoch:95/100]: loss1:0.0046 loss2:0.0086 main_loss:0.0137 | AUC:0.8515 AUC2:0.8551 FAR:0.00632
[2023-07-20 21:26:19,133][main.py][line:76][INFO] [Epoch:96/100]: loss1:0.0013 loss2:0.0052 main_loss:0.0072 | AUC:0.8493 AUC2:0.8551 FAR:0.00314
[2023-07-20 21:28:18,574][main.py][line:76][INFO] [Epoch:97/100]: loss1:0.0007 loss2:0.0033 main_loss:0.0047 | AUC:0.8480 AUC2:0.8551 FAR:0.00328
[2023-07-20 21:30:14,438][main.py][line:76][INFO] [Epoch:98/100]: loss1:0.0005 loss2:0.0027 main_loss:0.0044 | AUC:0.8496 AUC2:0.8551 FAR:0.00348
[2023-07-20 21:32:12,494][main.py][line:76][INFO] [Epoch:99/100]: loss1:0.0003 loss2:0.0021 main_loss:0.0034 | AUC:0.8543 AUC2:0.8551 FAR:0.00336
[2023-07-20 21:34:04,753][main.py][line:76][INFO] [Epoch:100/100]: loss1:0.0004 loss2:0.0023 main_loss:0.0035 | AUC:0.8524 AUC2:0.8551 FAR:0.00301
[2023-07-20 21:34:04,889][main.py][line:82][INFO] Training completes in 267m 25s | best AUC:0.8617 FAR:0.00188

[2023-07-20 22:10:06,816][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.99, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 22:10:07,012][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 22:10:07,012][main.py][line:119][INFO] Training Mode
[2023-07-20 22:10:07,013][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 22:10:07,013][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 22:10:26,209][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 22:11:50,594][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3729 loss2:1.0986 main_loss:1.4758 | AUC:0.8320 AUC2:0.8271 FAR:0.00583
[2023-07-20 22:13:15,472][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1468 loss2:0.8741 main_loss:1.0236 | AUC:0.8540 AUC2:0.8501 FAR:0.00603
[2023-07-20 22:14:42,280][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0684 loss2:0.7777 main_loss:0.8482 | AUC:0.8495 AUC2:0.8501 FAR:0.00832
[2023-07-20 22:16:07,524][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0314 loss2:0.7010 main_loss:0.7343 | AUC:0.8516 AUC2:0.8501 FAR:0.00326
[2023-07-20 22:17:32,113][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0191 loss2:0.6276 main_loss:0.6486 | AUC:0.8504 AUC2:0.8501 FAR:0.00168
[2023-07-20 22:18:57,708][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0402 loss2:0.5925 main_loss:0.6343 | AUC:0.8497 AUC2:0.8501 FAR:0.00440
[2023-07-20 22:20:22,477][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0187 loss2:0.5309 main_loss:0.5512 | AUC:0.8549 AUC2:0.8439 FAR:0.00232
[2023-07-20 22:21:48,210][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0105 loss2:0.4652 main_loss:0.4770 | AUC:0.8560 AUC2:0.8526 FAR:0.00368
[2023-07-20 22:23:13,149][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0180 loss2:0.4175 main_loss:0.4367 | AUC:0.8512 AUC2:0.8526 FAR:0.00701
[2023-07-20 22:24:37,597][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0336 loss2:0.4118 main_loss:0.4466 | AUC:0.8440 AUC2:0.8526 FAR:0.00645
[2023-07-20 22:26:03,201][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.0138 loss2:0.3477 main_loss:0.3626 | AUC:0.8507 AUC2:0.8526 FAR:0.00343
[2023-07-20 22:27:29,468][main.py][line:76][INFO] [Epoch:12/100]: loss1:0.0075 loss2:0.2939 main_loss:0.3025 | AUC:0.8514 AUC2:0.8526 FAR:0.00573
[2023-07-20 22:28:54,938][main.py][line:76][INFO] [Epoch:13/100]: loss1:0.0078 loss2:0.2532 main_loss:0.2621 | AUC:0.8538 AUC2:0.8526 FAR:0.00430
[2023-07-20 22:30:20,972][main.py][line:76][INFO] [Epoch:14/100]: loss1:0.0058 loss2:0.2097 main_loss:0.2174 | AUC:0.8455 AUC2:0.8526 FAR:0.01151
[2023-07-20 22:31:47,246][main.py][line:76][INFO] [Epoch:15/100]: loss1:0.0078 loss2:0.1895 main_loss:0.1994 | AUC:0.8484 AUC2:0.8526 FAR:0.00309
[2023-07-20 22:33:12,356][main.py][line:76][INFO] [Epoch:16/100]: loss1:0.0040 loss2:0.1521 main_loss:0.1578 | AUC:0.8548 AUC2:0.8526 FAR:0.00388
[2023-07-20 22:34:37,211][main.py][line:76][INFO] [Epoch:17/100]: loss1:0.0033 loss2:0.1268 main_loss:0.1319 | AUC:0.8517 AUC2:0.8526 FAR:0.00467
[2023-07-20 22:36:02,719][main.py][line:76][INFO] [Epoch:18/100]: loss1:0.0032 loss2:0.1065 main_loss:0.1119 | AUC:0.8516 AUC2:0.8526 FAR:0.00351
[2023-07-20 22:37:27,711][main.py][line:76][INFO] [Epoch:19/100]: loss1:0.0027 loss2:0.0887 main_loss:0.0931 | AUC:0.8491 AUC2:0.8526 FAR:0.00279
[2023-07-20 22:38:53,564][main.py][line:76][INFO] [Epoch:20/100]: loss1:0.0025 loss2:0.0751 main_loss:0.0792 | AUC:0.8510 AUC2:0.8526 FAR:0.00249
[2023-07-20 22:40:18,063][main.py][line:76][INFO] [Epoch:21/100]: loss1:0.0022 loss2:0.0629 main_loss:0.0664 | AUC:0.8493 AUC2:0.8526 FAR:0.00477
[2023-07-20 22:41:42,837][main.py][line:76][INFO] [Epoch:22/100]: loss1:0.0020 loss2:0.0540 main_loss:0.0572 | AUC:0.8466 AUC2:0.8526 FAR:0.00230
[2023-07-20 22:43:08,164][main.py][line:76][INFO] [Epoch:23/100]: loss1:0.0229 loss2:0.0840 main_loss:0.1081 | AUC:0.8453 AUC2:0.8526 FAR:0.00664
[2023-07-20 22:44:32,913][main.py][line:76][INFO] [Epoch:24/100]: loss1:0.0318 loss2:0.1159 main_loss:0.1490 | AUC:0.8461 AUC2:0.8526 FAR:0.00420
[2023-07-20 22:45:58,918][main.py][line:76][INFO] [Epoch:25/100]: loss1:0.0115 loss2:0.0764 main_loss:0.0891 | AUC:0.8450 AUC2:0.8526 FAR:0.00820
[2023-07-20 22:47:25,792][main.py][line:76][INFO] [Epoch:26/100]: loss1:0.0032 loss2:0.0489 main_loss:0.0531 | AUC:0.8506 AUC2:0.8526 FAR:0.00437
[2023-07-20 22:48:51,865][main.py][line:76][INFO] [Epoch:27/100]: loss1:0.0020 loss2:0.0387 main_loss:0.0417 | AUC:0.8470 AUC2:0.8526 FAR:0.00445
[2023-07-20 22:50:17,637][main.py][line:76][INFO] [Epoch:28/100]: loss1:0.0016 loss2:0.0321 main_loss:0.0348 | AUC:0.8488 AUC2:0.8526 FAR:0.00459
[2023-07-20 22:51:43,156][main.py][line:76][INFO] [Epoch:29/100]: loss1:0.0015 loss2:0.0288 main_loss:0.0314 | AUC:0.8514 AUC2:0.8526 FAR:0.00427
[2023-07-20 22:53:11,052][main.py][line:76][INFO] [Epoch:30/100]: loss1:0.0013 loss2:0.0248 main_loss:0.0270 | AUC:0.8510 AUC2:0.8526 FAR:0.00311
[2023-07-20 22:54:38,279][main.py][line:76][INFO] [Epoch:31/100]: loss1:0.0012 loss2:0.0227 main_loss:0.0249 | AUC:0.8517 AUC2:0.8526 FAR:0.00370
[2023-07-20 22:56:05,408][main.py][line:76][INFO] [Epoch:32/100]: loss1:0.0009 loss2:0.0198 main_loss:0.0216 | AUC:0.8531 AUC2:0.8526 FAR:0.00410
[2023-07-20 22:57:31,188][main.py][line:76][INFO] [Epoch:33/100]: loss1:0.0009 loss2:0.0185 main_loss:0.0203 | AUC:0.8527 AUC2:0.8526 FAR:0.00403
[2023-07-20 22:58:56,635][main.py][line:76][INFO] [Epoch:34/100]: loss1:0.0008 loss2:0.0169 main_loss:0.0186 | AUC:0.8564 AUC2:0.8459 FAR:0.00432
[2023-07-20 23:00:24,219][main.py][line:76][INFO] [Epoch:35/100]: loss1:0.0007 loss2:0.0146 main_loss:0.0162 | AUC:0.8497 AUC2:0.8459 FAR:0.00353
[2023-07-20 23:01:51,598][main.py][line:76][INFO] [Epoch:36/100]: loss1:0.0008 loss2:0.0140 main_loss:0.0157 | AUC:0.8517 AUC2:0.8459 FAR:0.00390
[2023-07-20 23:03:17,900][main.py][line:76][INFO] [Epoch:37/100]: loss1:0.0008 loss2:0.0131 main_loss:0.0148 | AUC:0.8540 AUC2:0.8459 FAR:0.00437
[2023-07-20 23:04:44,058][main.py][line:76][INFO] [Epoch:38/100]: loss1:0.0006 loss2:0.0119 main_loss:0.0133 | AUC:0.8527 AUC2:0.8459 FAR:0.00361
[2023-07-20 23:06:08,698][main.py][line:76][INFO] [Epoch:39/100]: loss1:0.0006 loss2:0.0117 main_loss:0.0130 | AUC:0.8512 AUC2:0.8459 FAR:0.00309
[2023-07-20 23:07:34,120][main.py][line:76][INFO] [Epoch:40/100]: loss1:0.0006 loss2:0.0108 main_loss:0.0122 | AUC:0.8566 AUC2:0.8468 FAR:0.00410
[2023-07-20 23:09:00,163][main.py][line:76][INFO] [Epoch:41/100]: loss1:0.0006 loss2:0.0104 main_loss:0.0117 | AUC:0.8555 AUC2:0.8468 FAR:0.00363
[2023-07-20 23:10:25,603][main.py][line:76][INFO] [Epoch:42/100]: loss1:0.0005 loss2:0.0096 main_loss:0.0108 | AUC:0.8551 AUC2:0.8468 FAR:0.00361
[2023-07-20 23:11:51,787][main.py][line:76][INFO] [Epoch:43/100]: loss1:0.0005 loss2:0.0092 main_loss:0.0104 | AUC:0.8557 AUC2:0.8468 FAR:0.00328
[2023-07-20 23:13:17,603][main.py][line:76][INFO] [Epoch:44/100]: loss1:0.0005 loss2:0.0091 main_loss:0.0103 | AUC:0.8555 AUC2:0.8468 FAR:0.00321
[2023-07-20 23:14:42,929][main.py][line:76][INFO] [Epoch:45/100]: loss1:0.0008 loss2:0.0092 main_loss:0.0106 | AUC:0.8559 AUC2:0.8468 FAR:0.00321
[2023-07-20 23:16:10,078][main.py][line:76][INFO] [Epoch:46/100]: loss1:0.0005 loss2:0.0083 main_loss:0.0093 | AUC:0.8564 AUC2:0.8468 FAR:0.00321
[2023-07-20 23:17:37,640][main.py][line:76][INFO] [Epoch:47/100]: loss1:0.0005 loss2:0.0080 main_loss:0.0090 | AUC:0.8555 AUC2:0.8468 FAR:0.00319
[2023-07-20 23:19:03,550][main.py][line:76][INFO] [Epoch:48/100]: loss1:0.0004 loss2:0.0079 main_loss:0.0089 | AUC:0.8560 AUC2:0.8468 FAR:0.00294
[2023-07-20 23:20:29,251][main.py][line:76][INFO] [Epoch:49/100]: loss1:0.0004 loss2:0.0073 main_loss:0.0082 | AUC:0.8530 AUC2:0.8468 FAR:0.00299
[2023-07-20 23:21:55,458][main.py][line:76][INFO] [Epoch:50/100]: loss1:0.0004 loss2:0.0075 main_loss:0.0085 | AUC:0.8541 AUC2:0.8468 FAR:0.00316
[2023-07-20 23:23:21,101][main.py][line:76][INFO] [Epoch:51/100]: loss1:0.0004 loss2:0.0070 main_loss:0.0078 | AUC:0.8542 AUC2:0.8468 FAR:0.00319
[2023-07-20 23:24:47,887][main.py][line:76][INFO] [Epoch:52/100]: loss1:0.0004 loss2:0.0072 main_loss:0.0081 | AUC:0.8544 AUC2:0.8468 FAR:0.00319
[2023-07-20 23:26:14,324][main.py][line:76][INFO] [Epoch:53/100]: loss1:0.0004 loss2:0.0072 main_loss:0.0080 | AUC:0.8538 AUC2:0.8468 FAR:0.00284
[2023-07-20 23:27:40,211][main.py][line:76][INFO] [Epoch:54/100]: loss1:0.0004 loss2:0.0065 main_loss:0.0073 | AUC:0.8546 AUC2:0.8468 FAR:0.00301
[2023-07-20 23:29:06,769][main.py][line:76][INFO] [Epoch:55/100]: loss1:0.0003 loss2:0.0065 main_loss:0.0074 | AUC:0.8547 AUC2:0.8468 FAR:0.00309
[2023-07-20 23:30:34,617][main.py][line:76][INFO] [Epoch:56/100]: loss1:0.0003 loss2:0.0063 main_loss:0.0072 | AUC:0.8548 AUC2:0.8468 FAR:0.00309
[2023-07-20 23:32:02,763][main.py][line:76][INFO] [Epoch:57/100]: loss1:0.0003 loss2:0.0065 main_loss:0.0073 | AUC:0.8545 AUC2:0.8468 FAR:0.00286
[2023-07-20 23:33:29,492][main.py][line:76][INFO] [Epoch:58/100]: loss1:0.0004 loss2:0.0065 main_loss:0.0073 | AUC:0.8545 AUC2:0.8468 FAR:0.00286
[2023-07-20 23:34:55,572][main.py][line:76][INFO] [Epoch:59/100]: loss1:0.0004 loss2:0.0069 main_loss:0.0078 | AUC:0.8544 AUC2:0.8468 FAR:0.00286
[2023-07-20 23:36:22,011][main.py][line:76][INFO] [Epoch:60/100]: loss1:0.0004 loss2:0.0064 main_loss:0.0073 | AUC:0.8544 AUC2:0.8468 FAR:0.00286
[2023-07-20 23:37:47,670][main.py][line:76][INFO] [Epoch:61/100]: loss1:0.0004 loss2:0.0067 main_loss:0.0075 | AUC:0.8544 AUC2:0.8468 FAR:0.00286
[2023-07-20 23:39:14,467][main.py][line:76][INFO] [Epoch:62/100]: loss1:0.0004 loss2:0.0066 main_loss:0.0074 | AUC:0.8544 AUC2:0.8468 FAR:0.00286
[2023-07-20 23:40:40,550][main.py][line:76][INFO] [Epoch:63/100]: loss1:0.0004 loss2:0.0064 main_loss:0.0073 | AUC:0.8544 AUC2:0.8468 FAR:0.00296
[2023-07-20 23:42:07,975][main.py][line:76][INFO] [Epoch:64/100]: loss1:0.0003 loss2:0.0065 main_loss:0.0073 | AUC:0.8543 AUC2:0.8468 FAR:0.00301
[2023-07-20 23:43:34,789][main.py][line:76][INFO] [Epoch:65/100]: loss1:0.0004 loss2:0.0066 main_loss:0.0074 | AUC:0.8543 AUC2:0.8468 FAR:0.00309
[2023-07-20 23:45:00,932][main.py][line:76][INFO] [Epoch:66/100]: loss1:0.0003 loss2:0.0063 main_loss:0.0071 | AUC:0.8542 AUC2:0.8468 FAR:0.00304
[2023-07-20 23:46:27,519][main.py][line:76][INFO] [Epoch:67/100]: loss1:0.0003 loss2:0.0064 main_loss:0.0072 | AUC:0.8538 AUC2:0.8468 FAR:0.00304
[2023-07-20 23:47:54,072][main.py][line:76][INFO] [Epoch:68/100]: loss1:0.0004 loss2:0.0066 main_loss:0.0074 | AUC:0.8540 AUC2:0.8468 FAR:0.00314
[2023-07-20 23:49:18,404][main.py][line:76][INFO] [Epoch:69/100]: loss1:0.0004 loss2:0.0068 main_loss:0.0076 | AUC:0.8545 AUC2:0.8468 FAR:0.00314
[2023-07-20 23:50:44,485][main.py][line:76][INFO] [Epoch:70/100]: loss1:0.0004 loss2:0.0064 main_loss:0.0073 | AUC:0.8555 AUC2:0.8468 FAR:0.00306
[2023-07-20 23:52:11,276][main.py][line:76][INFO] [Epoch:71/100]: loss1:0.0003 loss2:0.0060 main_loss:0.0067 | AUC:0.8567 AUC2:0.8475 FAR:0.00309
[2023-07-20 23:53:38,196][main.py][line:76][INFO] [Epoch:72/100]: loss1:0.0003 loss2:0.0058 main_loss:0.0066 | AUC:0.8564 AUC2:0.8475 FAR:0.00311
[2023-07-20 23:55:04,959][main.py][line:76][INFO] [Epoch:73/100]: loss1:0.0004 loss2:0.0064 main_loss:0.0072 | AUC:0.8524 AUC2:0.8475 FAR:0.00269
[2023-07-20 23:56:30,494][main.py][line:76][INFO] [Epoch:74/100]: loss1:0.0004 loss2:0.0061 main_loss:0.0070 | AUC:0.8538 AUC2:0.8475 FAR:0.00284
[2023-07-20 23:57:57,094][main.py][line:76][INFO] [Epoch:75/100]: loss1:0.0003 loss2:0.0056 main_loss:0.0064 | AUC:0.8548 AUC2:0.8475 FAR:0.00282
[2023-07-20 23:59:24,338][main.py][line:76][INFO] [Epoch:76/100]: loss1:0.0004 loss2:0.0058 main_loss:0.0066 | AUC:0.8520 AUC2:0.8475 FAR:0.00222
[2023-07-21 00:00:51,908][main.py][line:76][INFO] [Epoch:77/100]: loss1:0.0003 loss2:0.0050 main_loss:0.0058 | AUC:0.8558 AUC2:0.8475 FAR:0.00336
[2023-07-21 00:02:18,468][main.py][line:76][INFO] [Epoch:78/100]: loss1:0.0003 loss2:0.0046 main_loss:0.0053 | AUC:0.8578 AUC2:0.8462 FAR:0.00390
[2023-07-21 00:03:45,478][main.py][line:76][INFO] [Epoch:79/100]: loss1:0.0003 loss2:0.0046 main_loss:0.0055 | AUC:0.8536 AUC2:0.8462 FAR:0.00279
[2023-07-21 00:05:12,306][main.py][line:76][INFO] [Epoch:80/100]: loss1:0.0002 loss2:0.0037 main_loss:0.0044 | AUC:0.8566 AUC2:0.8462 FAR:0.00257
[2023-07-21 00:07:19,291][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.9, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.01, 'dropout': 0.7, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 00:07:19,480][main.py][line:116][INFO] total params:27.1990M
[2023-07-21 00:07:19,480][main.py][line:119][INFO] Training Mode
[2023-07-21 00:07:19,481][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.7, inplace=False)
    (dropout2): Dropout(p=0.7, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 00:07:19,481][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    weight_decay: 0
)

[2023-07-21 00:07:39,057][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 00:09:11,409][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.8998 loss2:1.3436 main_loss:2.3135 | AUC:0.7824 AUC2:0.7820 FAR:0.07370
[2023-07-21 00:10:43,575][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.6268 loss2:1.2556 main_loss:1.9515 | AUC:0.7244 AUC2:0.7820 FAR:0.28909
[2023-07-21 00:12:20,057][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.6203 loss2:1.2129 main_loss:1.9028 | AUC:0.7705 AUC2:0.7820 FAR:0.10269
[2023-07-21 00:13:58,633][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.5557 loss2:1.1780 main_loss:1.8033 | AUC:0.7720 AUC2:0.7820 FAR:0.11514
[2023-07-21 00:15:37,382][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.4971 loss2:1.1395 main_loss:1.7061 | AUC:0.7931 AUC2:0.7931 FAR:0.08785
[2023-07-21 00:17:14,649][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.5410 loss2:1.1643 main_loss:1.7747 | AUC:0.8166 AUC2:0.8166 FAR:0.02159
[2023-07-21 00:18:49,209][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.5975 loss2:1.1909 main_loss:1.8578 | AUC:0.8235 AUC2:0.8235 FAR:0.00000
[2023-07-21 00:20:27,016][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.6054 loss2:1.2629 main_loss:1.9377 | AUC:0.8240 AUC2:0.8240 FAR:0.03354
[2023-07-21 00:21:59,779][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.4657 loss2:1.1555 main_loss:1.6905 | AUC:0.8190 AUC2:0.8240 FAR:0.00200
[2023-07-21 00:23:34,149][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.4374 loss2:1.0944 main_loss:1.6011 | AUC:0.8173 AUC2:0.8240 FAR:0.00089
[2023-07-21 00:25:16,146][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.4410 loss2:1.1013 main_loss:1.6116 | AUC:0.8277 AUC2:0.8277 FAR:0.00650
[2023-07-21 00:26:54,749][main.py][line:76][INFO] [Epoch:12/100]: loss1:0.4040 loss2:1.0806 main_loss:1.5539 | AUC:0.8150 AUC2:0.8277 FAR:0.00245
[2023-07-21 00:28:36,847][main.py][line:76][INFO] [Epoch:13/100]: loss1:0.4098 loss2:1.0789 main_loss:1.5581 | AUC:0.7989 AUC2:0.8277 FAR:0.00022
[2023-07-21 00:30:16,966][main.py][line:76][INFO] [Epoch:14/100]: loss1:0.4110 loss2:1.0726 main_loss:1.5529 | AUC:0.8220 AUC2:0.8277 FAR:0.00000
[2023-07-21 00:31:56,666][main.py][line:76][INFO] [Epoch:15/100]: loss1:0.3934 loss2:1.0688 main_loss:1.5316 | AUC:0.8239 AUC2:0.8277 FAR:0.00037
[2023-07-21 00:33:38,429][main.py][line:76][INFO] [Epoch:16/100]: loss1:0.3795 loss2:1.0626 main_loss:1.5115 | AUC:0.8248 AUC2:0.8277 FAR:0.00000
[2023-07-21 00:35:15,424][main.py][line:76][INFO] [Epoch:17/100]: loss1:0.3950 loss2:1.0641 main_loss:1.5286 | AUC:0.8057 AUC2:0.8277 FAR:0.00000
[2023-07-21 00:36:48,110][main.py][line:76][INFO] [Epoch:18/100]: loss1:0.3754 loss2:1.0583 main_loss:1.5032 | AUC:0.8227 AUC2:0.8277 FAR:0.00000
[2023-07-21 00:38:28,801][main.py][line:76][INFO] [Epoch:19/100]: loss1:0.3654 loss2:1.0476 main_loss:1.4825 | AUC:0.8328 AUC2:0.8327 FAR:0.00000
[2023-07-21 00:40:06,082][main.py][line:76][INFO] [Epoch:20/100]: loss1:0.3736 loss2:1.0447 main_loss:1.4878 | AUC:0.8003 AUC2:0.8327 FAR:0.00000
[2023-07-21 00:41:41,216][main.py][line:76][INFO] [Epoch:21/100]: loss1:0.3865 loss2:1.0238 main_loss:1.4797 | AUC:0.8405 AUC2:0.8405 FAR:0.00000
[2023-07-21 00:43:16,706][main.py][line:76][INFO] [Epoch:22/100]: loss1:0.3583 loss2:1.0492 main_loss:1.4768 | AUC:0.8398 AUC2:0.8405 FAR:0.00007
[2023-07-21 00:44:47,099][main.py][line:76][INFO] [Epoch:23/100]: loss1:0.3621 loss2:1.0528 main_loss:1.4843 | AUC:0.8344 AUC2:0.8405 FAR:0.00000
[2023-07-21 00:46:20,914][main.py][line:76][INFO] [Epoch:24/100]: loss1:0.3684 loss2:1.0548 main_loss:1.4926 | AUC:0.8359 AUC2:0.8405 FAR:0.00000
[2023-07-21 00:48:00,989][main.py][line:76][INFO] [Epoch:25/100]: loss1:0.3432 loss2:1.0431 main_loss:1.4557 | AUC:0.8092 AUC2:0.8405 FAR:0.00037
[2023-07-21 00:49:38,492][main.py][line:76][INFO] [Epoch:26/100]: loss1:0.3441 loss2:1.0427 main_loss:1.4561 | AUC:0.8411 AUC2:0.8411 FAR:0.00007
[2023-07-21 00:51:11,194][main.py][line:76][INFO] [Epoch:27/100]: loss1:0.3348 loss2:1.0350 main_loss:1.4391 | AUC:0.8196 AUC2:0.8411 FAR:0.00000
[2023-07-21 00:52:48,223][main.py][line:76][INFO] [Epoch:28/100]: loss1:0.3458 loss2:1.0408 main_loss:1.4559 | AUC:0.8167 AUC2:0.8411 FAR:0.00000
[2023-07-21 00:54:23,141][main.py][line:76][INFO] [Epoch:29/100]: loss1:0.3267 loss2:1.0351 main_loss:1.4312 | AUC:0.8148 AUC2:0.8411 FAR:0.00000
[2023-07-21 00:56:01,029][main.py][line:76][INFO] [Epoch:30/100]: loss1:0.9663 loss2:1.0637 main_loss:2.0993 | AUC:0.6786 AUC2:0.8411 FAR:0.00000
[2023-07-21 00:57:35,602][main.py][line:76][INFO] [Epoch:31/100]: loss1:0.6455 loss2:1.1963 main_loss:1.9112 | AUC:0.6740 AUC2:0.8411 FAR:0.00000
[2023-07-21 00:59:10,769][main.py][line:76][INFO] [Epoch:32/100]: loss1:0.4749 loss2:1.0931 main_loss:1.6374 | AUC:0.6979 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:00:49,232][main.py][line:76][INFO] [Epoch:33/100]: loss1:0.4291 loss2:1.0770 main_loss:1.5754 | AUC:0.7419 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:02:32,385][main.py][line:76][INFO] [Epoch:34/100]: loss1:0.3971 loss2:1.0707 main_loss:1.5371 | AUC:0.6181 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:04:10,644][main.py][line:76][INFO] [Epoch:35/100]: loss1:0.3828 loss2:1.0567 main_loss:1.5088 | AUC:0.6787 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:05:51,786][main.py][line:76][INFO] [Epoch:36/100]: loss1:0.3715 loss2:1.0447 main_loss:1.4855 | AUC:0.6937 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:07:30,177][main.py][line:76][INFO] [Epoch:37/100]: loss1:0.3503 loss2:1.0456 main_loss:1.4653 | AUC:0.6879 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:09:15,046][main.py][line:76][INFO] [Epoch:38/100]: loss1:0.3385 loss2:1.0313 main_loss:1.4392 | AUC:0.7207 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:10:49,962][main.py][line:76][INFO] [Epoch:39/100]: loss1:0.3318 loss2:1.0346 main_loss:1.4357 | AUC:0.6993 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:12:23,365][main.py][line:76][INFO] [Epoch:40/100]: loss1:0.3227 loss2:1.0294 main_loss:1.4215 | AUC:0.8309 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:14:01,624][main.py][line:76][INFO] [Epoch:41/100]: loss1:0.3160 loss2:1.0282 main_loss:1.4135 | AUC:0.8338 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:15:34,659][main.py][line:76][INFO] [Epoch:42/100]: loss1:0.3091 loss2:1.0218 main_loss:1.4003 | AUC:0.8365 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:17:06,960][main.py][line:76][INFO] [Epoch:43/100]: loss1:0.3038 loss2:1.0206 main_loss:1.3937 | AUC:0.8322 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:18:36,329][main.py][line:76][INFO] [Epoch:44/100]: loss1:0.2924 loss2:1.0079 main_loss:1.3697 | AUC:0.8320 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:20:14,187][main.py][line:76][INFO] [Epoch:45/100]: loss1:0.2822 loss2:1.0133 main_loss:1.3649 | AUC:0.8365 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:21:46,326][main.py][line:76][INFO] [Epoch:46/100]: loss1:0.2724 loss2:0.9959 main_loss:1.3376 | AUC:0.8363 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:23:20,305][main.py][line:76][INFO] [Epoch:47/100]: loss1:0.2743 loss2:1.0053 main_loss:1.3490 | AUC:0.8352 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:24:59,473][main.py][line:76][INFO] [Epoch:48/100]: loss1:0.2604 loss2:1.0047 main_loss:1.3344 | AUC:0.8345 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:26:33,126][main.py][line:76][INFO] [Epoch:49/100]: loss1:0.2477 loss2:0.9956 main_loss:1.3126 | AUC:0.8325 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:28:03,439][main.py][line:76][INFO] [Epoch:50/100]: loss1:0.2459 loss2:0.9955 main_loss:1.3108 | AUC:0.8294 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:29:35,863][main.py][line:76][INFO] [Epoch:51/100]: loss1:0.2380 loss2:0.9829 main_loss:1.2902 | AUC:0.8306 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:31:10,862][main.py][line:76][INFO] [Epoch:52/100]: loss1:0.2366 loss2:0.9917 main_loss:1.2975 | AUC:0.8322 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:32:49,965][main.py][line:76][INFO] [Epoch:53/100]: loss1:0.2296 loss2:0.9891 main_loss:1.2880 | AUC:0.8313 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:34:28,358][main.py][line:76][INFO] [Epoch:54/100]: loss1:0.2293 loss2:0.9864 main_loss:1.2850 | AUC:0.8290 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:36:05,348][main.py][line:76][INFO] [Epoch:55/100]: loss1:0.2250 loss2:0.9852 main_loss:1.2795 | AUC:0.8285 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:37:34,957][main.py][line:76][INFO] [Epoch:56/100]: loss1:0.2219 loss2:0.9833 main_loss:1.2745 | AUC:0.8282 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:39:14,660][main.py][line:76][INFO] [Epoch:57/100]: loss1:0.2227 loss2:0.9819 main_loss:1.2739 | AUC:0.8290 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:40:41,834][main.py][line:76][INFO] [Epoch:58/100]: loss1:0.2221 loss2:0.9832 main_loss:1.2746 | AUC:0.8274 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:42:10,424][main.py][line:76][INFO] [Epoch:59/100]: loss1:0.2175 loss2:0.9832 main_loss:1.2700 | AUC:0.8275 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:43:40,058][main.py][line:76][INFO] [Epoch:60/100]: loss1:0.2201 loss2:0.9816 main_loss:1.2710 | AUC:0.8275 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:45:04,907][main.py][line:76][INFO] [Epoch:61/100]: loss1:0.2230 loss2:0.9797 main_loss:1.2721 | AUC:0.8275 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:46:31,333][main.py][line:76][INFO] [Epoch:62/100]: loss1:0.2200 loss2:0.9808 main_loss:1.2701 | AUC:0.8274 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:47:58,089][main.py][line:76][INFO] [Epoch:63/100]: loss1:0.2224 loss2:0.9839 main_loss:1.2756 | AUC:0.8279 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:49:24,631][main.py][line:76][INFO] [Epoch:64/100]: loss1:0.2178 loss2:0.9813 main_loss:1.2684 | AUC:0.8275 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:50:56,200][main.py][line:76][INFO] [Epoch:65/100]: loss1:0.2193 loss2:0.9806 main_loss:1.2692 | AUC:0.8272 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:52:21,828][main.py][line:76][INFO] [Epoch:66/100]: loss1:0.2211 loss2:0.9800 main_loss:1.2704 | AUC:0.8294 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:53:48,620][main.py][line:76][INFO] [Epoch:67/100]: loss1:0.2189 loss2:0.9830 main_loss:1.2712 | AUC:0.8291 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:55:17,716][main.py][line:76][INFO] [Epoch:68/100]: loss1:0.2211 loss2:0.9822 main_loss:1.2726 | AUC:0.8259 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:56:47,463][main.py][line:76][INFO] [Epoch:69/100]: loss1:0.2203 loss2:0.9822 main_loss:1.2718 | AUC:0.8251 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:58:16,346][main.py][line:76][INFO] [Epoch:70/100]: loss1:0.2221 loss2:0.9760 main_loss:1.2674 | AUC:0.8248 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:59:44,256][main.py][line:76][INFO] [Epoch:71/100]: loss1:0.2163 loss2:0.9797 main_loss:1.2654 | AUC:0.8223 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:01:09,814][main.py][line:76][INFO] [Epoch:72/100]: loss1:0.2246 loss2:0.9748 main_loss:1.2688 | AUC:0.8240 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:02:37,307][main.py][line:76][INFO] [Epoch:73/100]: loss1:0.2180 loss2:0.9800 main_loss:1.2673 | AUC:0.8205 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:04:04,033][main.py][line:76][INFO] [Epoch:74/100]: loss1:0.2254 loss2:0.9840 main_loss:1.2787 | AUC:0.8213 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:05:32,076][main.py][line:76][INFO] [Epoch:75/100]: loss1:0.2188 loss2:0.9776 main_loss:1.2657 | AUC:0.8222 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:07:00,426][main.py][line:76][INFO] [Epoch:76/100]: loss1:0.2122 loss2:0.9814 main_loss:1.2630 | AUC:0.8206 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:08:28,573][main.py][line:76][INFO] [Epoch:77/100]: loss1:0.2180 loss2:0.9809 main_loss:1.2682 | AUC:0.8118 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:09:55,028][main.py][line:76][INFO] [Epoch:78/100]: loss1:0.2355 loss2:0.9884 main_loss:1.2932 | AUC:0.8125 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:11:25,046][main.py][line:76][INFO] [Epoch:79/100]: loss1:0.2176 loss2:0.9730 main_loss:1.2599 | AUC:0.8180 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:12:51,041][main.py][line:76][INFO] [Epoch:80/100]: loss1:0.2210 loss2:0.9627 main_loss:1.2531 | AUC:0.8194 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:14:22,236][main.py][line:76][INFO] [Epoch:81/100]: loss1:0.2236 loss2:0.9841 main_loss:1.2770 | AUC:0.8296 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:15:47,916][main.py][line:76][INFO] [Epoch:82/100]: loss1:0.2098 loss2:0.9763 main_loss:1.2554 | AUC:0.8255 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:17:16,291][main.py][line:76][INFO] [Epoch:83/100]: loss1:0.2079 loss2:0.9704 main_loss:1.2477 | AUC:0.8241 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:18:43,800][main.py][line:76][INFO] [Epoch:84/100]: loss1:0.2160 loss2:0.9746 main_loss:1.2600 | AUC:0.8028 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:20:10,911][main.py][line:76][INFO] [Epoch:85/100]: loss1:0.1960 loss2:0.9618 main_loss:1.2272 | AUC:0.8068 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:21:39,597][main.py][line:76][INFO] [Epoch:86/100]: loss1:0.2060 loss2:0.9706 main_loss:1.2459 | AUC:0.7689 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:23:07,053][main.py][line:76][INFO] [Epoch:87/100]: loss1:0.2165 loss2:0.9744 main_loss:1.2602 | AUC:0.7710 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:24:33,235][main.py][line:76][INFO] [Epoch:88/100]: loss1:0.2271 loss2:0.9838 main_loss:1.2804 | AUC:0.7344 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:26:01,278][main.py][line:76][INFO] [Epoch:89/100]: loss1:0.2045 loss2:0.9696 main_loss:1.2435 | AUC:0.7663 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:27:28,398][main.py][line:76][INFO] [Epoch:90/100]: loss1:0.1962 loss2:0.9569 main_loss:1.2225 | AUC:0.6980 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:28:55,426][main.py][line:76][INFO] [Epoch:91/100]: loss1:0.2169 loss2:0.9764 main_loss:1.2628 | AUC:0.6207 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:30:23,231][main.py][line:76][INFO] [Epoch:92/100]: loss1:0.2004 loss2:0.9620 main_loss:1.2320 | AUC:0.7438 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:31:48,744][main.py][line:76][INFO] [Epoch:93/100]: loss1:0.2409 loss2:0.9891 main_loss:1.2994 | AUC:0.7477 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:33:15,328][main.py][line:76][INFO] [Epoch:94/100]: loss1:0.2448 loss2:1.0021 main_loss:1.3162 | AUC:0.6361 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:34:46,153][main.py][line:76][INFO] [Epoch:95/100]: loss1:0.3872 loss2:1.0493 main_loss:1.5059 | AUC:0.5861 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:36:13,505][main.py][line:76][INFO] [Epoch:96/100]: loss1:0.2966 loss2:1.0213 main_loss:1.3872 | AUC:0.5754 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:37:38,969][main.py][line:76][INFO] [Epoch:97/100]: loss1:0.2610 loss2:1.0074 main_loss:1.3378 | AUC:0.5068 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:39:04,630][main.py][line:76][INFO] [Epoch:98/100]: loss1:0.2694 loss2:1.0143 main_loss:1.3531 | AUC:0.5118 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:40:32,506][main.py][line:76][INFO] [Epoch:99/100]: loss1:0.2808 loss2:1.0180 main_loss:1.3681 | AUC:0.5554 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:41:59,684][main.py][line:76][INFO] [Epoch:100/100]: loss1:0.2762 loss2:1.0143 main_loss:1.3599 | AUC:0.5292 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:41:59,808][main.py][line:82][INFO] Training completes in 154m 21s | best AUC:0.8411 FAR:0.00007

[2023-07-21 07:09:52,700][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.01, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:09:52,883][main.py][line:116][INFO] total params:27.1990M
[2023-07-21 07:09:52,883][main.py][line:119][INFO] Training Mode
[2023-07-21 07:09:52,883][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:09:52,883][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:10:12,326][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 07:11:37,049][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.7744 loss2:1.2974 main_loss:2.4210 | AUC:0.8082 AUC2:0.8082 FAR:0.02208
[2023-07-21 07:13:02,633][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.4365 loss2:1.1233 main_loss:1.9065 | AUC:0.7915 AUC2:0.8082 FAR:0.04535
[2023-07-21 07:14:28,635][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.4073 loss2:1.0743 main_loss:1.8282 | AUC:0.7899 AUC2:0.8082 FAR:0.02114
[2023-07-21 07:14:35,571][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:14:35,756][main.py][line:116][INFO] total params:27.1990M
[2023-07-21 07:14:35,756][main.py][line:119][INFO] Training Mode
[2023-07-21 07:14:35,757][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:14:35,757][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:14:55,361][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 07:16:31,730][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3729 loss2:1.0986 main_loss:1.7109 | AUC:0.8270 AUC2:0.8271 FAR:0.00583
[2023-07-21 07:18:08,419][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1468 loss2:0.8741 main_loss:1.1814 | AUC:0.8538 AUC2:0.8501 FAR:0.00603
[2023-07-21 07:19:44,625][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0684 loss2:0.7777 main_loss:0.9736 | AUC:0.8485 AUC2:0.8501 FAR:0.00832
[2023-07-21 07:21:17,937][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0314 loss2:0.7010 main_loss:0.8391 | AUC:0.8548 AUC2:0.8486 FAR:0.00326
[2023-07-21 07:22:55,214][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0191 loss2:0.6276 main_loss:0.7481 | AUC:0.8519 AUC2:0.8486 FAR:0.00168
[2023-07-21 07:24:38,573][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0402 loss2:0.5925 main_loss:0.7369 | AUC:0.8527 AUC2:0.8486 FAR:0.00440
[2023-07-21 07:26:16,110][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0187 loss2:0.5309 main_loss:0.6517 | AUC:0.8555 AUC2:0.8439 FAR:0.00232
[2023-07-21 07:26:53,106][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:26:53,290][main.py][line:116][INFO] total params:27.1990M
[2023-07-21 07:26:53,291][main.py][line:123][INFO] Test Mode
[2023-07-21 07:26:53,291][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-21 07:26:53,397][main.py][line:32][INFO] bert.embedding.learnedPosition.pe size mismatch: load torch.Size([1, 101, 1024]) given torch.Size([1, 201, 1024])
[2023-07-21 07:26:53,397][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.0.weight not found in model dict.
[2023-07-21 07:26:53,397][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.0.bias not found in model dict.
[2023-07-21 07:26:53,397][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.1.weight not found in model dict.
[2023-07-21 07:26:53,397][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.1.bias not found in model dict.
[2023-07-21 07:26:53,397][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.2.weight not found in model dict.
[2023-07-21 07:26:53,397][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.2.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.attention.output_linear.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.attention.output_linear.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_1.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_1.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_2.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_2.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.input_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.input_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.output_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.output_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.0.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.0.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.1.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.1.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.2.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.2.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.output_linear.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.output_linear.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_1.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_1.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_2.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_2.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.input_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.input_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.output_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.output_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:29:19,714][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8617.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:29:19,864][main.py][line:116][INFO] total params:27.1990M
[2023-07-21 07:29:19,865][main.py][line:123][INFO] Test Mode
[2023-07-21 07:29:19,865][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8617.pkl.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.0.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.0.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.1.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.1.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.2.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.2.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.output_linear.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.output_linear.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_1.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_1.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_2.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_2.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.input_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.input_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.output_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.output_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.0.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.0.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.1.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.1.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.2.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.2.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.output_linear.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.output_linear.bias not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_1.weight not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_1.bias not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_2.weight not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_2.bias not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.input_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.input_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.output_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.output_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:29:39,551][infer_bert.py][line:65][INFO] offline AUC:0.8623 AUC2:0.8623 AP:0.3394 FAR:0.0011 | Complete in 0m 20s

[2023-07-21 07:31:12,970][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:31:13,205][main.py][line:116][INFO] total params:52.3915M
[2023-07-21 07:31:13,205][main.py][line:123][INFO] Test Mode
[2023-07-21 07:31:13,205][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-21 07:31:13,267][main.py][line:32][INFO] bert.embedding.learnedPosition.pe size mismatch: load torch.Size([1, 101, 1024]) given torch.Size([1, 201, 1024])
[2023-07-21 07:31:34,493][infer_bert.py][line:65][INFO] offline AUC:0.8601 AUC2:0.8558 AP:0.3281 FAR:0.0014 | Complete in 0m 21s

[2023-07-21 07:32:37,754][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:32:37,978][main.py][line:116][INFO] total params:52.2891M
[2023-07-21 07:32:37,978][main.py][line:123][INFO] Test Mode
[2023-07-21 07:32:37,978][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-21 07:32:51,628][infer_bert.py][line:65][INFO] offline AUC:0.8638 AUC2:0.8558 AP:0.3289 FAR:0.0014 | Complete in 0m 14s

[2023-07-21 07:36:38,085][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:36:38,319][main.py][line:116][INFO] total params:52.2891M
[2023-07-21 07:36:38,319][main.py][line:123][INFO] Test Mode
[2023-07-21 07:36:38,319][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-21 07:36:52,072][infer_bert.py][line:66][INFO] offline AUC:0.8638 AUC2:0.8558 AP:0.3289 FAR:0.0014 | Complete in 0m 14s

[2023-07-21 07:39:31,241][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:39:31,463][main.py][line:116][INFO] total params:52.2891M
[2023-07-21 07:39:31,464][main.py][line:123][INFO] Test Mode
[2023-07-21 07:39:31,464][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-21 07:42:36,303][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:42:36,527][main.py][line:116][INFO] total params:52.2891M
[2023-07-21 07:42:36,527][main.py][line:123][INFO] Test Mode
[2023-07-21 07:42:36,527][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-21 07:45:10,554][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:45:10,770][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:45:10,770][main.py][line:119][INFO] Training Mode
[2023-07-21 07:45:10,771][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:45:10,771][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:45:45,073][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:45:45,305][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:45:45,305][main.py][line:119][INFO] Training Mode
[2023-07-21 07:45:45,306][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:45:45,306][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:46:13,025][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:46:13,253][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:46:13,253][main.py][line:119][INFO] Training Mode
[2023-07-21 07:46:13,254][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:46:13,254][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:47:29,414][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:47:29,631][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:47:29,631][main.py][line:119][INFO] Training Mode
[2023-07-21 07:47:29,631][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:47:29,631][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:47:37,174][main.py][line:53][INFO] Random initialize AUC:0.5445 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 07:51:23,960][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:51:24,193][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:51:24,193][main.py][line:119][INFO] Training Mode
[2023-07-21 07:51:24,193][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:51:24,193][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:52:24,654][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:52:24,892][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:52:24,892][main.py][line:119][INFO] Training Mode
[2023-07-21 07:52:24,893][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:52:24,893][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:52:32,510][main.py][line:53][INFO] Random initialize AUC:0.5445 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 07:53:40,428][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:53:40,652][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:53:40,652][main.py][line:119][INFO] Training Mode
[2023-07-21 07:53:40,652][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:53:40,652][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:53:48,151][main.py][line:53][INFO] Random initialize AUC:0.5445 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 07:55:50,690][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:55:50,930][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:55:50,930][main.py][line:119][INFO] Training Mode
[2023-07-21 07:55:50,931][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:55:50,931][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:55:58,500][main.py][line:53][INFO] Random initialize AUC:0.5445 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 07:57:03,192][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3674 loss2:1.0975 main_loss:1.7620 | AUC:0.8312 AUC2:0.8341 FAR:0.00632
[2023-07-21 07:58:07,551][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1423 loss2:0.8743 main_loss:1.1856 | AUC:0.8502 AUC2:0.8497 FAR:0.00491
[2023-07-21 07:59:12,432][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0602 loss2:0.7808 main_loss:1.0242 | AUC:0.8416 AUC2:0.8497 FAR:0.00235
[2023-07-21 08:00:18,535][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0475 loss2:0.7119 main_loss:0.9152 | AUC:0.8495 AUC2:0.8497 FAR:0.00595
[2023-07-21 08:01:26,665][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0257 loss2:0.6487 main_loss:0.8159 | AUC:0.8558 AUC2:0.8514 FAR:0.00185
[2023-07-21 08:02:33,454][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0211 loss2:0.5865 main_loss:0.7438 | AUC:0.8531 AUC2:0.8514 FAR:0.00961
[2023-07-21 08:03:37,377][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0152 loss2:0.5311 main_loss:0.6717 | AUC:0.8501 AUC2:0.8514 FAR:0.00519
[2023-07-21 08:04:40,253][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0155 loss2:0.4769 main_loss:0.6136 | AUC:0.8447 AUC2:0.8514 FAR:0.00593
[2023-07-21 08:05:46,919][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0231 loss2:0.4407 main_loss:0.5780 | AUC:0.8545 AUC2:0.8514 FAR:0.00696
[2023-07-21 08:06:55,159][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0127 loss2:0.3883 main_loss:0.5159 | AUC:0.8424 AUC2:0.8514 FAR:0.00291
[2023-07-21 08:08:00,282][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.0078 loss2:0.3309 main_loss:0.4446 | AUC:0.8492 AUC2:0.8514 FAR:0.00306
[2023-07-21 08:09:06,910][main.py][line:76][INFO] [Epoch:12/100]: loss1:0.0064 loss2:0.2811 main_loss:0.3884 | AUC:0.8443 AUC2:0.8514 FAR:0.00126
[2023-07-21 08:10:11,947][main.py][line:76][INFO] [Epoch:13/100]: loss1:0.0067 loss2:0.2447 main_loss:0.3535 | AUC:0.8505 AUC2:0.8514 FAR:0.00326
[2023-07-21 08:11:19,804][main.py][line:76][INFO] [Epoch:14/100]: loss1:0.0053 loss2:0.2033 main_loss:0.3156 | AUC:0.8492 AUC2:0.8514 FAR:0.00393
[2023-07-21 08:12:27,146][main.py][line:76][INFO] [Epoch:15/100]: loss1:0.0047 loss2:0.1689 main_loss:0.2876 | AUC:0.8520 AUC2:0.8514 FAR:0.00336
[2023-07-21 08:13:32,940][main.py][line:76][INFO] [Epoch:16/100]: loss1:0.0046 loss2:0.1405 main_loss:0.2417 | AUC:0.8478 AUC2:0.8514 FAR:0.00237
[2023-07-21 08:14:38,298][main.py][line:76][INFO] [Epoch:17/100]: loss1:0.0053 loss2:0.1200 main_loss:0.2177 | AUC:0.8474 AUC2:0.8514 FAR:0.00247
[2023-07-21 08:15:42,761][main.py][line:76][INFO] [Epoch:18/100]: loss1:0.0549 loss2:0.2049 main_loss:0.3492 | AUC:0.8378 AUC2:0.8514 FAR:0.00393
[2023-07-21 08:16:45,499][main.py][line:76][INFO] [Epoch:19/100]: loss1:0.0133 loss2:0.1330 main_loss:0.2316 | AUC:0.8444 AUC2:0.8514 FAR:0.00511
[2023-07-21 08:17:50,153][main.py][line:76][INFO] [Epoch:20/100]: loss1:0.0170 loss2:0.1153 main_loss:0.2154 | AUC:0.8443 AUC2:0.8514 FAR:0.00309
[2023-07-21 08:18:55,819][main.py][line:76][INFO] [Epoch:21/100]: loss1:0.0035 loss2:0.0713 main_loss:0.1533 | AUC:0.8440 AUC2:0.8514 FAR:0.00301
[2023-07-21 08:20:02,027][main.py][line:76][INFO] [Epoch:22/100]: loss1:0.0024 loss2:0.0573 main_loss:0.1412 | AUC:0.8466 AUC2:0.8514 FAR:0.00388
[2023-07-21 08:21:05,546][main.py][line:76][INFO] [Epoch:23/100]: loss1:0.0021 loss2:0.0515 main_loss:0.1280 | AUC:0.8450 AUC2:0.8514 FAR:0.00358
[2023-07-21 09:18:34,480][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 09:18:34,749][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 09:18:34,749][main.py][line:119][INFO] Training Mode
[2023-07-21 09:18:34,749][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 09:18:34,749][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 09:19:35,800][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 09:19:36,035][main.py][line:116][INFO] total params:52.2195M
[2023-07-21 09:19:36,035][main.py][line:119][INFO] Training Mode
[2023-07-21 09:19:36,035][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 09:19:36,035][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 09:19:57,275][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 09:19:57,510][main.py][line:116][INFO] total params:52.2195M
[2023-07-21 09:19:57,510][main.py][line:119][INFO] Training Mode
[2023-07-21 09:19:57,511][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 09:19:57,511][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 09:20:18,725][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 09:20:18,957][main.py][line:116][INFO] total params:52.2195M
[2023-07-21 09:20:18,958][main.py][line:119][INFO] Training Mode
[2023-07-21 09:20:18,958][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 09:20:18,958][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 09:20:27,190][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 09:21:21,093][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3930 loss2:1.1859 main_loss:1.9055 | AUC:0.8045 AUC2:0.8102 FAR:0.01499
[2023-07-21 09:22:14,818][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1667 loss2:0.9458 main_loss:1.4324 | AUC:0.8342 AUC2:0.8332 FAR:0.00563
[2023-07-21 09:23:09,000][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0713 loss2:0.8367 main_loss:1.1644 | AUC:0.8362 AUC2:0.8328 FAR:0.00237
[2023-07-21 09:24:03,497][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0419 loss2:0.7443 main_loss:0.9675 | AUC:0.8446 AUC2:0.8394 FAR:0.00193
[2023-07-21 09:24:57,712][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0287 loss2:0.6708 main_loss:0.8435 | AUC:0.8523 AUC2:0.8473 FAR:0.00121
[2023-07-21 09:25:51,635][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0238 loss2:0.6029 main_loss:0.7490 | AUC:0.8517 AUC2:0.8473 FAR:0.00259
[2023-07-21 09:26:45,682][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0182 loss2:0.5426 main_loss:0.6660 | AUC:0.8505 AUC2:0.8473 FAR:0.00143
[2023-07-21 09:27:39,810][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0146 loss2:0.4737 main_loss:0.5836 | AUC:0.8460 AUC2:0.8473 FAR:0.00306
[2023-07-21 09:28:34,163][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0156 loss2:0.4290 main_loss:0.5333 | AUC:0.8535 AUC2:0.8443 FAR:0.00131
[2023-07-21 09:29:28,086][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0129 loss2:0.3660 main_loss:0.4684 | AUC:0.8502 AUC2:0.8443 FAR:0.00163
[2023-07-21 09:30:22,157][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.0112 loss2:0.3342 main_loss:0.4228 | AUC:0.8472 AUC2:0.8443 FAR:0.00215
[2023-07-21 09:31:17,036][main.py][line:76][INFO] [Epoch:12/100]: loss1:0.0099 loss2:0.2940 main_loss:0.4149 | AUC:0.8533 AUC2:0.8443 FAR:0.00237
[2023-07-21 09:32:11,066][main.py][line:76][INFO] [Epoch:13/100]: loss1:0.0077 loss2:0.2522 main_loss:0.3523 | AUC:0.8476 AUC2:0.8443 FAR:0.00116
[2023-07-21 09:33:05,658][main.py][line:76][INFO] [Epoch:14/100]: loss1:0.0085 loss2:0.2193 main_loss:0.2988 | AUC:0.8579 AUC2:0.8462 FAR:0.00106
[2023-07-21 09:33:59,988][main.py][line:76][INFO] [Epoch:15/100]: loss1:0.0100 loss2:0.1900 main_loss:0.2637 | AUC:0.8447 AUC2:0.8462 FAR:0.00044
[2023-07-21 09:34:54,318][main.py][line:76][INFO] [Epoch:16/100]: loss1:0.0274 loss2:0.2005 main_loss:0.2879 | AUC:0.8539 AUC2:0.8462 FAR:0.00111
[2023-07-21 09:35:48,318][main.py][line:76][INFO] [Epoch:17/100]: loss1:0.0060 loss2:0.1352 main_loss:0.1914 | AUC:0.8521 AUC2:0.8462 FAR:0.00077
[2023-07-21 09:36:42,565][main.py][line:76][INFO] [Epoch:18/100]: loss1:0.0046 loss2:0.1112 main_loss:0.1618 | AUC:0.8563 AUC2:0.8462 FAR:0.00116
[2023-07-21 09:37:36,771][main.py][line:76][INFO] [Epoch:19/100]: loss1:0.0038 loss2:0.0980 main_loss:0.1390 | AUC:0.8555 AUC2:0.8462 FAR:0.00077
[2023-07-21 09:38:30,857][main.py][line:76][INFO] [Epoch:20/100]: loss1:0.0039 loss2:0.0823 main_loss:0.1175 | AUC:0.8536 AUC2:0.8462 FAR:0.00133
[2023-07-21 09:39:25,208][main.py][line:76][INFO] [Epoch:21/100]: loss1:0.0064 loss2:0.0801 main_loss:0.1189 | AUC:0.8557 AUC2:0.8462 FAR:0.00133
[2023-07-21 09:40:19,740][main.py][line:76][INFO] [Epoch:22/100]: loss1:0.0038 loss2:0.0646 main_loss:0.1000 | AUC:0.8591 AUC2:0.8525 FAR:0.00099
[2023-07-21 09:41:13,936][main.py][line:76][INFO] [Epoch:23/100]: loss1:0.0043 loss2:0.0571 main_loss:0.0927 | AUC:0.8525 AUC2:0.8525 FAR:0.00091
[2023-07-21 09:42:08,273][main.py][line:76][INFO] [Epoch:24/100]: loss1:0.0030 loss2:0.0484 main_loss:0.1361 | AUC:0.8481 AUC2:0.8525 FAR:0.00089
[2023-07-21 09:43:02,133][main.py][line:76][INFO] [Epoch:25/100]: loss1:0.0020 loss2:0.0434 main_loss:0.0984 | AUC:0.8546 AUC2:0.8525 FAR:0.00074
[2023-07-21 09:43:56,149][main.py][line:76][INFO] [Epoch:26/100]: loss1:0.0024 loss2:0.0388 main_loss:0.0811 | AUC:0.8518 AUC2:0.8525 FAR:0.00077
[2023-07-21 09:44:49,970][main.py][line:76][INFO] [Epoch:27/100]: loss1:0.0026 loss2:0.0372 main_loss:0.1137 | AUC:0.8518 AUC2:0.8525 FAR:0.00082
[2023-07-21 09:45:43,979][main.py][line:76][INFO] [Epoch:28/100]: loss1:0.0017 loss2:0.0330 main_loss:0.0909 | AUC:0.8500 AUC2:0.8525 FAR:0.00089
[2023-07-21 09:46:38,038][main.py][line:76][INFO] [Epoch:29/100]: loss1:0.0011 loss2:0.0264 main_loss:0.0666 | AUC:0.8526 AUC2:0.8525 FAR:0.00079
[2023-07-21 09:47:31,992][main.py][line:76][INFO] [Epoch:30/100]: loss1:0.0010 loss2:0.0249 main_loss:0.0630 | AUC:0.8490 AUC2:0.8525 FAR:0.00096
[2023-07-21 09:48:25,853][main.py][line:76][INFO] [Epoch:31/100]: loss1:0.0017 loss2:0.0249 main_loss:0.0625 | AUC:0.8519 AUC2:0.8525 FAR:0.00114
[2023-07-21 09:49:19,886][main.py][line:76][INFO] [Epoch:32/100]: loss1:0.0012 loss2:0.0222 main_loss:0.0565 | AUC:0.8522 AUC2:0.8525 FAR:0.00094
[2023-07-21 09:50:13,768][main.py][line:76][INFO] [Epoch:33/100]: loss1:0.0013 loss2:0.0190 main_loss:0.0464 | AUC:0.8529 AUC2:0.8525 FAR:0.00188
[2023-07-21 09:51:07,723][main.py][line:76][INFO] [Epoch:34/100]: loss1:0.0016 loss2:0.0210 main_loss:0.0480 | AUC:0.8559 AUC2:0.8525 FAR:0.00109
[2023-07-21 09:52:02,144][main.py][line:76][INFO] [Epoch:35/100]: loss1:0.0029 loss2:0.0242 main_loss:0.0515 | AUC:0.8538 AUC2:0.8525 FAR:0.00165
[2023-07-21 09:52:56,033][main.py][line:76][INFO] [Epoch:36/100]: loss1:0.0016 loss2:0.0199 main_loss:0.0497 | AUC:0.8501 AUC2:0.8525 FAR:0.00084
[2023-07-21 09:53:49,924][main.py][line:76][INFO] [Epoch:37/100]: loss1:0.0010 loss2:0.0170 main_loss:0.0441 | AUC:0.8501 AUC2:0.8525 FAR:0.00153
[2023-07-21 09:54:43,625][main.py][line:76][INFO] [Epoch:38/100]: loss1:0.0007 loss2:0.0131 main_loss:0.0360 | AUC:0.8497 AUC2:0.8525 FAR:0.00089
[2023-07-21 09:55:37,556][main.py][line:76][INFO] [Epoch:39/100]: loss1:0.0007 loss2:0.0145 main_loss:0.0362 | AUC:0.8513 AUC2:0.8525 FAR:0.00091
[2023-07-21 09:56:31,557][main.py][line:76][INFO] [Epoch:40/100]: loss1:0.0006 loss2:0.0115 main_loss:0.0308 | AUC:0.8511 AUC2:0.8525 FAR:0.00089
[2023-07-21 09:57:25,658][main.py][line:76][INFO] [Epoch:41/100]: loss1:0.0005 loss2:0.0103 main_loss:0.0299 | AUC:0.8499 AUC2:0.8525 FAR:0.00074
[2023-07-21 09:58:19,318][main.py][line:76][INFO] [Epoch:42/100]: loss1:0.0006 loss2:0.0118 main_loss:0.0284 | AUC:0.8524 AUC2:0.8525 FAR:0.00096
[2023-07-21 09:59:13,132][main.py][line:76][INFO] [Epoch:43/100]: loss1:0.0010 loss2:0.0113 main_loss:0.0294 | AUC:0.8474 AUC2:0.8525 FAR:0.00146
[2023-07-21 10:00:07,668][main.py][line:76][INFO] [Epoch:44/100]: loss1:0.0005 loss2:0.0102 main_loss:0.0271 | AUC:0.8482 AUC2:0.8525 FAR:0.00091
[2023-07-21 10:01:01,547][main.py][line:76][INFO] [Epoch:45/100]: loss1:0.0005 loss2:0.0100 main_loss:0.0251 | AUC:0.8495 AUC2:0.8525 FAR:0.00099
[2023-07-21 10:01:55,378][main.py][line:76][INFO] [Epoch:46/100]: loss1:0.0004 loss2:0.0099 main_loss:0.0244 | AUC:0.8510 AUC2:0.8525 FAR:0.00089
[2023-07-21 10:02:49,524][main.py][line:76][INFO] [Epoch:47/100]: loss1:0.0004 loss2:0.0093 main_loss:0.0255 | AUC:0.8507 AUC2:0.8525 FAR:0.00091
[2023-07-21 10:03:43,680][main.py][line:76][INFO] [Epoch:48/100]: loss1:0.0004 loss2:0.0087 main_loss:0.0226 | AUC:0.8517 AUC2:0.8525 FAR:0.00099
[2023-07-21 10:04:37,608][main.py][line:76][INFO] [Epoch:49/100]: loss1:0.0004 loss2:0.0079 main_loss:0.0208 | AUC:0.8490 AUC2:0.8525 FAR:0.00074
[2023-07-21 10:05:31,589][main.py][line:76][INFO] [Epoch:50/100]: loss1:0.0004 loss2:0.0084 main_loss:0.0219 | AUC:0.8507 AUC2:0.8525 FAR:0.00079
[2023-07-21 10:06:25,412][main.py][line:76][INFO] [Epoch:51/100]: loss1:0.0004 loss2:0.0087 main_loss:0.0220 | AUC:0.8510 AUC2:0.8525 FAR:0.00089
[2023-07-21 10:07:19,456][main.py][line:76][INFO] [Epoch:52/100]: loss1:0.0004 loss2:0.0090 main_loss:0.0200 | AUC:0.8498 AUC2:0.8525 FAR:0.00077
[2023-07-21 10:08:13,786][main.py][line:76][INFO] [Epoch:53/100]: loss1:0.0004 loss2:0.0083 main_loss:0.0201 | AUC:0.8504 AUC2:0.8525 FAR:0.00086
[2023-07-21 10:09:07,621][main.py][line:76][INFO] [Epoch:54/100]: loss1:0.0003 loss2:0.0081 main_loss:0.0195 | AUC:0.8510 AUC2:0.8525 FAR:0.00086
[2023-07-21 10:10:01,789][main.py][line:76][INFO] [Epoch:55/100]: loss1:0.0003 loss2:0.0091 main_loss:0.0207 | AUC:0.8508 AUC2:0.8525 FAR:0.00086
[2023-07-21 10:10:56,634][main.py][line:76][INFO] [Epoch:56/100]: loss1:0.0004 loss2:0.0071 main_loss:0.0182 | AUC:0.8511 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:11:50,877][main.py][line:76][INFO] [Epoch:57/100]: loss1:0.0003 loss2:0.0078 main_loss:0.0184 | AUC:0.8510 AUC2:0.8525 FAR:0.00086
[2023-07-21 10:12:44,697][main.py][line:76][INFO] [Epoch:58/100]: loss1:0.0003 loss2:0.0083 main_loss:0.0191 | AUC:0.8511 AUC2:0.8525 FAR:0.00082
[2023-07-21 10:13:38,848][main.py][line:76][INFO] [Epoch:59/100]: loss1:0.0003 loss2:0.0082 main_loss:0.0186 | AUC:0.8511 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:14:32,741][main.py][line:76][INFO] [Epoch:60/100]: loss1:0.0003 loss2:0.0075 main_loss:0.0186 | AUC:0.8511 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:15:26,831][main.py][line:76][INFO] [Epoch:61/100]: loss1:0.0003 loss2:0.0079 main_loss:0.0188 | AUC:0.8511 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:16:21,254][main.py][line:76][INFO] [Epoch:62/100]: loss1:0.0003 loss2:0.0082 main_loss:0.0191 | AUC:0.8511 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:17:15,153][main.py][line:76][INFO] [Epoch:63/100]: loss1:0.0003 loss2:0.0083 main_loss:0.0186 | AUC:0.8510 AUC2:0.8525 FAR:0.00086
[2023-07-21 10:18:09,031][main.py][line:76][INFO] [Epoch:64/100]: loss1:0.0003 loss2:0.0080 main_loss:0.0185 | AUC:0.8508 AUC2:0.8525 FAR:0.00077
[2023-07-21 10:19:03,030][main.py][line:76][INFO] [Epoch:65/100]: loss1:0.0003 loss2:0.0074 main_loss:0.0187 | AUC:0.8509 AUC2:0.8525 FAR:0.00089
[2023-07-21 10:19:57,013][main.py][line:76][INFO] [Epoch:66/100]: loss1:0.0003 loss2:0.0077 main_loss:0.0183 | AUC:0.8508 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:20:50,899][main.py][line:76][INFO] [Epoch:67/100]: loss1:0.0003 loss2:0.0075 main_loss:0.0186 | AUC:0.8505 AUC2:0.8525 FAR:0.00074
[2023-07-21 10:21:44,821][main.py][line:76][INFO] [Epoch:68/100]: loss1:0.0003 loss2:0.0066 main_loss:0.0190 | AUC:0.8515 AUC2:0.8525 FAR:0.00091
[2023-07-21 10:22:38,812][main.py][line:76][INFO] [Epoch:69/100]: loss1:0.0004 loss2:0.0065 main_loss:0.0179 | AUC:0.8512 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:23:33,065][main.py][line:76][INFO] [Epoch:70/100]: loss1:0.0003 loss2:0.0073 main_loss:0.0178 | AUC:0.8511 AUC2:0.8525 FAR:0.00086
[2023-07-21 10:24:27,106][main.py][line:76][INFO] [Epoch:71/100]: loss1:0.0003 loss2:0.0068 main_loss:0.0185 | AUC:0.8527 AUC2:0.8525 FAR:0.00091
[2023-07-21 10:25:21,327][main.py][line:76][INFO] [Epoch:72/100]: loss1:0.0004 loss2:0.0079 main_loss:0.0173 | AUC:0.8504 AUC2:0.8525 FAR:0.00082
[2023-07-21 10:26:15,608][main.py][line:76][INFO] [Epoch:73/100]: loss1:0.0004 loss2:0.0076 main_loss:0.0183 | AUC:0.8523 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:27:09,780][main.py][line:76][INFO] [Epoch:74/100]: loss1:0.0005 loss2:0.0074 main_loss:0.0215 | AUC:0.8517 AUC2:0.8525 FAR:0.00089
[2023-07-21 10:28:03,815][main.py][line:76][INFO] [Epoch:75/100]: loss1:0.0004 loss2:0.0055 main_loss:0.0166 | AUC:0.8533 AUC2:0.8525 FAR:0.00094
[2023-07-21 10:28:58,129][main.py][line:76][INFO] [Epoch:76/100]: loss1:0.0008 loss2:0.0052 main_loss:0.0180 | AUC:0.8555 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:29:52,156][main.py][line:76][INFO] [Epoch:77/100]: loss1:0.0012 loss2:0.0108 main_loss:0.0236 | AUC:0.8531 AUC2:0.8525 FAR:0.00074
[2023-07-21 10:30:46,142][main.py][line:76][INFO] [Epoch:78/100]: loss1:0.0004 loss2:0.0071 main_loss:0.0172 | AUC:0.8498 AUC2:0.8525 FAR:0.00044
[2023-07-21 10:31:04,712][main.py][line:118][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 10:31:05,090][main.py][line:144][INFO] total params:52.2195M
[2023-07-21 10:31:05,090][main.py][line:147][INFO] Training Mode
[2023-07-21 10:32:07,909][main.py][line:118][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 10:32:08,246][main.py][line:144][INFO] total params:52.2195M
[2023-07-21 10:32:08,246][main.py][line:147][INFO] Training Mode
[2023-07-21 10:32:08,247][main.py][line:73][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 10:32:08,247][main.py][line:74][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 2
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 10:32:08,247][main.py][line:75][INFO] Optimizer_bert:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0

Parameter Group 2
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0

Parameter Group 3
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0
)

[2023-07-21 10:32:16,429][main.py][line:79][INFO] Random initialize AUC:0.6173 initial_AUC2:0.6194 FAR:0.02739
[2023-07-21 10:33:11,936][main.py][line:104][INFO] [Epoch:1/100]: loss1:0.3887 loss2:1.1476 main_loss:1.5362 | AUC:0.8213 AUC2:0.8190 FAR:0.00373
[2023-07-21 10:34:09,680][main.py][line:104][INFO] [Epoch:2/100]: loss1:0.1699 loss2:0.9332 main_loss:1.1031 | AUC:0.8308 AUC2:0.8277 FAR:0.00269
[2023-07-21 10:35:05,940][main.py][line:104][INFO] [Epoch:3/100]: loss1:0.0681 loss2:0.8294 main_loss:0.8975 | AUC:0.8470 AUC2:0.8370 FAR:0.00267
[2023-07-21 10:36:04,019][main.py][line:104][INFO] [Epoch:4/100]: loss1:0.0391 loss2:0.7387 main_loss:0.7778 | AUC:0.8359 AUC2:0.8370 FAR:0.00067
[2023-07-21 10:37:00,015][main.py][line:104][INFO] [Epoch:5/100]: loss1:0.0278 loss2:0.6635 main_loss:0.6913 | AUC:0.8391 AUC2:0.8370 FAR:0.00215
[2023-07-21 10:37:55,044][main.py][line:104][INFO] [Epoch:6/100]: loss1:0.0222 loss2:0.5996 main_loss:0.6218 | AUC:0.8330 AUC2:0.8370 FAR:0.00247
[2023-07-21 10:38:51,410][main.py][line:104][INFO] [Epoch:7/100]: loss1:0.0173 loss2:0.5342 main_loss:0.5515 | AUC:0.8353 AUC2:0.8370 FAR:0.00163
[2023-07-21 10:39:47,834][main.py][line:104][INFO] [Epoch:8/100]: loss1:0.0157 loss2:0.4846 main_loss:0.5004 | AUC:0.8234 AUC2:0.8370 FAR:0.00082
[2023-07-21 10:40:44,137][main.py][line:104][INFO] [Epoch:9/100]: loss1:0.0170 loss2:0.4337 main_loss:0.4507 | AUC:0.8350 AUC2:0.8370 FAR:0.00282
[2023-07-21 10:41:21,919][main.py][line:118][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 10:41:22,301][main.py][line:144][INFO] total params:52.2195M
[2023-07-21 10:41:22,301][main.py][line:147][INFO] Training Mode
[2023-07-21 10:41:22,310][main.py][line:73][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 10:41:22,310][main.py][line:74][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 2
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 10:41:22,310][main.py][line:75][INFO] Optimizer_bert:Adagrad (
Parameter Group 0
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513

Parameter Group 1
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513

Parameter Group 2
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513

Parameter Group 3
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513
)

[2023-07-21 10:41:31,509][main.py][line:79][INFO] Random initialize AUC:0.6173 initial_AUC2:0.6194 FAR:0.02739
[2023-07-21 10:42:35,059][main.py][line:104][INFO] [Epoch:1/100]: loss1:0.3887 loss2:1.1476 main_loss:1.5362 | AUC:0.8206 AUC2:0.8190 FAR:0.00373
[2023-07-21 10:43:38,581][main.py][line:104][INFO] [Epoch:2/100]: loss1:0.1699 loss2:0.9332 main_loss:1.1031 | AUC:0.8306 AUC2:0.8277 FAR:0.00269
[2023-07-21 10:44:43,329][main.py][line:104][INFO] [Epoch:3/100]: loss1:0.0681 loss2:0.8294 main_loss:0.8975 | AUC:0.8407 AUC2:0.8370 FAR:0.00267
[2023-07-21 10:45:47,146][main.py][line:104][INFO] [Epoch:4/100]: loss1:0.0391 loss2:0.7387 main_loss:0.7778 | AUC:0.8341 AUC2:0.8370 FAR:0.00067
[2023-07-21 10:46:52,733][main.py][line:104][INFO] [Epoch:5/100]: loss1:0.0278 loss2:0.6635 main_loss:0.6913 | AUC:0.8388 AUC2:0.8370 FAR:0.00215
[2023-07-21 10:47:54,386][main.py][line:104][INFO] [Epoch:6/100]: loss1:0.0222 loss2:0.5996 main_loss:0.6218 | AUC:0.8354 AUC2:0.8370 FAR:0.00247
[2023-07-21 10:48:56,829][main.py][line:104][INFO] [Epoch:7/100]: loss1:0.0173 loss2:0.5342 main_loss:0.5515 | AUC:0.8390 AUC2:0.8370 FAR:0.00163
[2023-07-21 10:49:59,302][main.py][line:104][INFO] [Epoch:8/100]: loss1:0.0157 loss2:0.4846 main_loss:0.5004 | AUC:0.8322 AUC2:0.8370 FAR:0.00082
[2023-07-21 10:50:06,734][main.py][line:118][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 10:50:07,110][main.py][line:144][INFO] total params:52.3915M
[2023-07-21 10:50:07,110][main.py][line:147][INFO] Training Mode
[2023-07-21 10:50:07,119][main.py][line:73][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 10:50:07,119][main.py][line:74][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 2
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 10:50:07,119][main.py][line:75][INFO] Optimizer_bert:Adagrad (
Parameter Group 0
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513

Parameter Group 1
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513

Parameter Group 2
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513

Parameter Group 3
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513
)

[2023-07-21 10:50:27,766][main.py][line:79][INFO] Random initialize AUC:0.6172 initial_AUC2:0.6194 FAR:0.02739
[2023-07-21 10:52:25,267][main.py][line:104][INFO] [Epoch:1/100]: loss1:0.3669 loss2:1.0650 main_loss:1.4319 | AUC:0.8283 AUC2:0.8286 FAR:0.01242
[2023-07-21 10:54:32,214][main.py][line:104][INFO] [Epoch:2/100]: loss1:0.1425 loss2:0.8575 main_loss:1.0000 | AUC:0.8376 AUC2:0.8338 FAR:0.00220
[2023-07-21 10:56:46,426][main.py][line:104][INFO] [Epoch:3/100]: loss1:0.0624 loss2:0.7667 main_loss:0.8291 | AUC:0.8480 AUC2:0.8458 FAR:0.01097
[2023-07-21 10:58:51,953][main.py][line:104][INFO] [Epoch:4/100]: loss1:0.0381 loss2:0.6961 main_loss:0.7342 | AUC:0.8472 AUC2:0.8458 FAR:0.00294
[2023-07-21 11:00:58,932][main.py][line:104][INFO] [Epoch:5/100]: loss1:0.0275 loss2:0.6346 main_loss:0.6621 | AUC:0.8454 AUC2:0.8458 FAR:0.00188
[2023-07-21 11:03:05,773][main.py][line:104][INFO] [Epoch:6/100]: loss1:0.0161 loss2:0.5695 main_loss:0.5855 | AUC:0.8407 AUC2:0.8458 FAR:0.00190
[2023-07-21 11:22:57,879][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 11:22:58,243][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 11:22:58,243][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 11:22:58,243][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 11:22:58,255][main_bert_v2.py][line:56][INFO] Model:BertModel(
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 11:22:58,255][main_bert_v2.py][line:57][INFO] Optimizer:Adagrad (
Parameter Group 0
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513
)

[2023-07-21 11:23:19,600][main_bert_v2.py][line:60][INFO] Random initialize AUC:0.8632 initial_AUC2:0.8635 FAR:0.00620
[2023-07-21 11:25:19,932][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 11:25:20,277][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 11:25:20,277][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 11:25:20,277][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 11:25:20,286][main_bert_v2.py][line:56][INFO] Model:BertModel(
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 11:25:20,286][main_bert_v2.py][line:57][INFO] Optimizer:Adagrad (
Parameter Group 0
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513
)

[2023-07-21 11:25:40,699][main_bert_v2.py][line:60][INFO] Random initialize AUC:0.8632 initial_AUC2:0.8635 FAR:0.00620
[2023-07-21 11:27:01,163][main_bert_v2.py][line:77][INFO] [Epoch:1/100]: loss:0.4221 | AUC:0.8614 AUC2:0.8632 FAR:0.00622
[2023-07-21 11:28:28,119][main_bert_v2.py][line:77][INFO] [Epoch:2/100]: loss:0.3021 | AUC:0.8619 AUC2:0.8634 FAR:0.00605
[2023-07-21 11:30:02,078][main_bert_v2.py][line:77][INFO] [Epoch:3/100]: loss:0.2497 | AUC:0.8634 AUC2:0.8634 FAR:0.00613
[2023-07-21 11:31:32,117][main_bert_v2.py][line:77][INFO] [Epoch:4/100]: loss:0.2055 | AUC:0.8604 AUC2:0.8634 FAR:0.00622
[2023-07-21 11:33:07,122][main_bert_v2.py][line:77][INFO] [Epoch:5/100]: loss:0.1723 | AUC:0.8636 AUC2:0.8630 FAR:0.00637
[2023-07-21 11:34:31,500][main_bert_v2.py][line:77][INFO] [Epoch:6/100]: loss:0.1488 | AUC:0.8639 AUC2:0.8630 FAR:0.00605
[2023-07-21 11:36:02,252][main_bert_v2.py][line:77][INFO] [Epoch:7/100]: loss:0.1259 | AUC:0.8634 AUC2:0.8630 FAR:0.00615
[2023-07-21 11:37:35,404][main_bert_v2.py][line:77][INFO] [Epoch:8/100]: loss:0.1096 | AUC:0.8648 AUC2:0.8631 FAR:0.00625
[2023-07-21 11:39:07,112][main_bert_v2.py][line:77][INFO] [Epoch:9/100]: loss:0.0971 | AUC:0.8645 AUC2:0.8631 FAR:0.00608
[2023-07-21 11:40:37,911][main_bert_v2.py][line:77][INFO] [Epoch:10/100]: loss:0.0833 | AUC:0.8641 AUC2:0.8631 FAR:0.00605
[2023-07-21 11:42:04,388][main_bert_v2.py][line:77][INFO] [Epoch:11/100]: loss:0.0769 | AUC:0.8649 AUC2:0.8634 FAR:0.00627
[2023-07-21 11:43:29,072][main_bert_v2.py][line:77][INFO] [Epoch:12/100]: loss:0.0672 | AUC:0.8640 AUC2:0.8634 FAR:0.00647
[2023-07-21 11:44:54,760][main_bert_v2.py][line:77][INFO] [Epoch:13/100]: loss:0.0640 | AUC:0.8646 AUC2:0.8634 FAR:0.00627
[2023-07-21 11:46:33,040][main_bert_v2.py][line:77][INFO] [Epoch:14/100]: loss:0.0559 | AUC:0.8641 AUC2:0.8634 FAR:0.00613
[2023-07-21 11:47:54,192][main_bert_v2.py][line:77][INFO] [Epoch:15/100]: loss:0.0525 | AUC:0.8638 AUC2:0.8634 FAR:0.00650
[2023-07-21 11:49:28,451][main_bert_v2.py][line:77][INFO] [Epoch:16/100]: loss:0.0473 | AUC:0.8646 AUC2:0.8634 FAR:0.00632
[2023-07-21 11:51:05,548][main_bert_v2.py][line:77][INFO] [Epoch:17/100]: loss:0.0454 | AUC:0.8638 AUC2:0.8634 FAR:0.00617
[2023-07-21 11:52:37,344][main_bert_v2.py][line:77][INFO] [Epoch:18/100]: loss:0.0401 | AUC:0.8645 AUC2:0.8634 FAR:0.00620
[2023-07-21 11:54:03,999][main_bert_v2.py][line:77][INFO] [Epoch:19/100]: loss:0.0362 | AUC:0.8631 AUC2:0.8634 FAR:0.00605
[2023-07-21 11:55:34,457][main_bert_v2.py][line:77][INFO] [Epoch:20/100]: loss:0.0349 | AUC:0.8642 AUC2:0.8634 FAR:0.00605
[2023-07-21 11:57:00,297][main_bert_v2.py][line:77][INFO] [Epoch:21/100]: loss:0.0303 | AUC:0.8648 AUC2:0.8634 FAR:0.00613
[2023-07-21 11:58:45,875][main_bert_v2.py][line:77][INFO] [Epoch:22/100]: loss:0.0296 | AUC:0.8639 AUC2:0.8634 FAR:0.00603
[2023-07-21 12:00:19,824][main_bert_v2.py][line:77][INFO] [Epoch:23/100]: loss:0.0293 | AUC:0.8633 AUC2:0.8634 FAR:0.00645
[2023-07-21 12:01:57,359][main_bert_v2.py][line:77][INFO] [Epoch:24/100]: loss:0.0270 | AUC:0.8633 AUC2:0.8634 FAR:0.00613
[2023-07-21 12:03:10,606][main_bert_v2.py][line:77][INFO] [Epoch:25/100]: loss:0.0253 | AUC:0.8639 AUC2:0.8634 FAR:0.00605
[2023-07-21 12:04:23,636][main_bert_v2.py][line:77][INFO] [Epoch:26/100]: loss:0.0224 | AUC:0.8638 AUC2:0.8634 FAR:0.00595
[2023-07-21 12:05:45,357][main_bert_v2.py][line:77][INFO] [Epoch:27/100]: loss:0.0211 | AUC:0.8636 AUC2:0.8634 FAR:0.00627
[2023-07-21 12:10:18,807][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 12:10:19,178][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 12:10:19,178][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 12:10:19,178][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 12:10:19,192][main_bert_v2.py][line:56][INFO] Model:BertModel(
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 12:10:19,192][main_bert_v2.py][line:57][INFO] Optimizer:Adagrad (
Parameter Group 0
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513
)

[2023-07-21 12:10:39,916][main_bert_v2.py][line:60][INFO] Random initialize AUC:0.8632 initial_AUC2:0.8635 FAR:0.00620
[2023-07-21 12:11:49,155][main_bert_v2.py][line:77][INFO] [Epoch:1/100]: loss:0.4221 | AUC:0.8618 AUC2:0.8632 FAR:0.00622
[2023-07-21 12:13:00,472][main_bert_v2.py][line:77][INFO] [Epoch:2/100]: loss:0.3021 | AUC:0.8622 AUC2:0.8634 FAR:0.00605
[2023-07-21 12:14:16,661][main_bert_v2.py][line:77][INFO] [Epoch:3/100]: loss:0.2497 | AUC:0.8637 AUC2:0.8634 FAR:0.00613
[2023-07-21 12:15:35,593][main_bert_v2.py][line:77][INFO] [Epoch:4/100]: loss:0.2055 | AUC:0.8609 AUC2:0.8634 FAR:0.00622
[2023-07-21 12:16:48,682][main_bert_v2.py][line:77][INFO] [Epoch:5/100]: loss:0.1723 | AUC:0.8637 AUC2:0.8634 FAR:0.00637
[2023-07-21 12:18:04,078][main_bert_v2.py][line:77][INFO] [Epoch:6/100]: loss:0.1488 | AUC:0.8641 AUC2:0.8630 FAR:0.00605
[2023-07-21 12:19:17,052][main_bert_v2.py][line:77][INFO] [Epoch:7/100]: loss:0.1259 | AUC:0.8633 AUC2:0.8630 FAR:0.00615
[2023-07-21 12:20:33,945][main_bert_v2.py][line:77][INFO] [Epoch:8/100]: loss:0.1096 | AUC:0.8648 AUC2:0.8631 FAR:0.00625
[2023-07-21 12:21:49,245][main_bert_v2.py][line:77][INFO] [Epoch:9/100]: loss:0.0971 | AUC:0.8644 AUC2:0.8631 FAR:0.00608
[2023-07-21 12:23:06,691][main_bert_v2.py][line:77][INFO] [Epoch:10/100]: loss:0.0833 | AUC:0.8638 AUC2:0.8631 FAR:0.00605
[2023-07-21 12:24:22,233][main_bert_v2.py][line:77][INFO] [Epoch:11/100]: loss:0.0769 | AUC:0.8647 AUC2:0.8631 FAR:0.00627
[2023-07-21 12:25:36,995][main_bert_v2.py][line:77][INFO] [Epoch:12/100]: loss:0.0672 | AUC:0.8641 AUC2:0.8631 FAR:0.00647
[2023-07-21 12:26:55,316][main_bert_v2.py][line:77][INFO] [Epoch:13/100]: loss:0.0640 | AUC:0.8646 AUC2:0.8631 FAR:0.00627
[2023-07-21 12:28:14,837][main_bert_v2.py][line:77][INFO] [Epoch:14/100]: loss:0.0559 | AUC:0.8641 AUC2:0.8631 FAR:0.00613
[2023-07-21 12:29:26,429][main_bert_v2.py][line:77][INFO] [Epoch:15/100]: loss:0.0525 | AUC:0.8631 AUC2:0.8631 FAR:0.00650
[2023-07-21 12:30:46,305][main_bert_v2.py][line:77][INFO] [Epoch:16/100]: loss:0.0473 | AUC:0.8645 AUC2:0.8631 FAR:0.00632
[2023-07-21 12:32:08,301][main_bert_v2.py][line:77][INFO] [Epoch:17/100]: loss:0.0454 | AUC:0.8641 AUC2:0.8631 FAR:0.00617
[2023-07-21 12:33:25,809][main_bert_v2.py][line:77][INFO] [Epoch:18/100]: loss:0.0401 | AUC:0.8654 AUC2:0.8633 FAR:0.00620
[2023-07-21 12:34:38,302][main_bert_v2.py][line:77][INFO] [Epoch:19/100]: loss:0.0362 | AUC:0.8630 AUC2:0.8633 FAR:0.00605
[2023-07-21 12:35:53,679][main_bert_v2.py][line:77][INFO] [Epoch:20/100]: loss:0.0349 | AUC:0.8645 AUC2:0.8633 FAR:0.00605
[2023-07-21 12:37:08,452][main_bert_v2.py][line:77][INFO] [Epoch:21/100]: loss:0.0303 | AUC:0.8649 AUC2:0.8633 FAR:0.00613
[2023-07-21 12:38:26,095][main_bert_v2.py][line:77][INFO] [Epoch:22/100]: loss:0.0296 | AUC:0.8645 AUC2:0.8633 FAR:0.00603
[2023-07-21 12:39:38,170][main_bert_v2.py][line:77][INFO] [Epoch:23/100]: loss:0.0293 | AUC:0.8639 AUC2:0.8633 FAR:0.00645
[2023-07-21 12:40:57,825][main_bert_v2.py][line:77][INFO] [Epoch:24/100]: loss:0.0270 | AUC:0.8637 AUC2:0.8633 FAR:0.00613
[2023-07-21 12:42:13,320][main_bert_v2.py][line:77][INFO] [Epoch:25/100]: loss:0.0253 | AUC:0.8639 AUC2:0.8633 FAR:0.00605
[2023-07-21 12:43:27,084][main_bert_v2.py][line:77][INFO] [Epoch:26/100]: loss:0.0224 | AUC:0.8639 AUC2:0.8633 FAR:0.00595
[2023-07-21 12:44:48,822][main_bert_v2.py][line:77][INFO] [Epoch:27/100]: loss:0.0211 | AUC:0.8639 AUC2:0.8633 FAR:0.00627
[2023-07-21 12:46:03,003][main_bert_v2.py][line:77][INFO] [Epoch:28/100]: loss:0.0213 | AUC:0.8642 AUC2:0.8633 FAR:0.00610
[2023-07-21 12:47:20,929][main_bert_v2.py][line:77][INFO] [Epoch:29/100]: loss:0.0207 | AUC:0.8647 AUC2:0.8633 FAR:0.00613
[2023-07-21 12:48:37,354][main_bert_v2.py][line:77][INFO] [Epoch:30/100]: loss:0.0191 | AUC:0.8640 AUC2:0.8633 FAR:0.00615
[2023-07-21 12:49:58,085][main_bert_v2.py][line:77][INFO] [Epoch:31/100]: loss:0.0166 | AUC:0.8652 AUC2:0.8633 FAR:0.00613
[2023-07-21 12:51:15,001][main_bert_v2.py][line:77][INFO] [Epoch:32/100]: loss:0.0167 | AUC:0.8642 AUC2:0.8633 FAR:0.00603
[2023-07-21 12:52:30,839][main_bert_v2.py][line:77][INFO] [Epoch:33/100]: loss:0.0153 | AUC:0.8640 AUC2:0.8633 FAR:0.00620
[2023-07-21 12:53:42,291][main_bert_v2.py][line:77][INFO] [Epoch:34/100]: loss:0.0134 | AUC:0.8641 AUC2:0.8633 FAR:0.00635
[2023-07-21 12:54:55,279][main_bert_v2.py][line:77][INFO] [Epoch:35/100]: loss:0.0140 | AUC:0.8623 AUC2:0.8633 FAR:0.00610
[2023-07-21 12:56:10,793][main_bert_v2.py][line:77][INFO] [Epoch:36/100]: loss:0.0123 | AUC:0.8634 AUC2:0.8633 FAR:0.00620
[2023-07-21 12:57:24,189][main_bert_v2.py][line:77][INFO] [Epoch:37/100]: loss:0.0126 | AUC:0.8634 AUC2:0.8633 FAR:0.00615
[2023-07-21 12:58:44,226][main_bert_v2.py][line:77][INFO] [Epoch:38/100]: loss:0.0119 | AUC:0.8620 AUC2:0.8633 FAR:0.00603
[2023-07-21 13:00:00,323][main_bert_v2.py][line:77][INFO] [Epoch:39/100]: loss:0.0095 | AUC:0.8627 AUC2:0.8633 FAR:0.00615
[2023-07-21 13:01:15,377][main_bert_v2.py][line:77][INFO] [Epoch:40/100]: loss:0.0091 | AUC:0.8615 AUC2:0.8633 FAR:0.00647
[2023-07-21 13:02:35,897][main_bert_v2.py][line:77][INFO] [Epoch:41/100]: loss:0.0090 | AUC:0.8613 AUC2:0.8633 FAR:0.00637
[2023-07-21 13:03:50,985][main_bert_v2.py][line:77][INFO] [Epoch:42/100]: loss:0.0078 | AUC:0.8621 AUC2:0.8633 FAR:0.00620
[2023-07-21 13:05:05,282][main_bert_v2.py][line:77][INFO] [Epoch:43/100]: loss:0.0077 | AUC:0.8630 AUC2:0.8633 FAR:0.00615
[2023-07-21 13:06:23,773][main_bert_v2.py][line:77][INFO] [Epoch:44/100]: loss:0.0077 | AUC:0.8633 AUC2:0.8633 FAR:0.00625
[2023-07-21 13:07:42,038][main_bert_v2.py][line:77][INFO] [Epoch:45/100]: loss:0.0076 | AUC:0.8621 AUC2:0.8633 FAR:0.00635
[2023-07-21 13:09:00,992][main_bert_v2.py][line:77][INFO] [Epoch:46/100]: loss:0.0080 | AUC:0.8609 AUC2:0.8633 FAR:0.00598
[2023-07-21 13:10:19,820][main_bert_v2.py][line:77][INFO] [Epoch:47/100]: loss:0.0072 | AUC:0.8608 AUC2:0.8633 FAR:0.00630
[2023-07-21 13:11:32,110][main_bert_v2.py][line:77][INFO] [Epoch:48/100]: loss:0.0065 | AUC:0.8623 AUC2:0.8633 FAR:0.00630
[2023-07-21 13:12:43,274][main_bert_v2.py][line:77][INFO] [Epoch:49/100]: loss:0.0063 | AUC:0.8616 AUC2:0.8633 FAR:0.00627
[2023-07-21 13:14:07,146][main_bert_v2.py][line:77][INFO] [Epoch:50/100]: loss:0.0064 | AUC:0.8621 AUC2:0.8633 FAR:0.00608
[2023-07-21 13:15:24,131][main_bert_v2.py][line:77][INFO] [Epoch:51/100]: loss:0.0061 | AUC:0.8619 AUC2:0.8633 FAR:0.00613
[2023-07-21 13:16:43,668][main_bert_v2.py][line:77][INFO] [Epoch:52/100]: loss:0.0062 | AUC:0.8619 AUC2:0.8633 FAR:0.00605
[2023-07-21 13:17:56,111][main_bert_v2.py][line:77][INFO] [Epoch:53/100]: loss:0.0058 | AUC:0.8619 AUC2:0.8633 FAR:0.00595
[2023-07-21 13:19:22,414][main_bert_v2.py][line:77][INFO] [Epoch:54/100]: loss:0.0059 | AUC:0.8624 AUC2:0.8633 FAR:0.00625
[2023-07-21 13:20:34,040][main_bert_v2.py][line:77][INFO] [Epoch:55/100]: loss:0.0055 | AUC:0.8627 AUC2:0.8633 FAR:0.00617
[2023-07-21 13:21:50,759][main_bert_v2.py][line:77][INFO] [Epoch:56/100]: loss:0.0054 | AUC:0.8623 AUC2:0.8633 FAR:0.00615
[2023-07-21 13:23:11,155][main_bert_v2.py][line:77][INFO] [Epoch:57/100]: loss:0.0057 | AUC:0.8622 AUC2:0.8633 FAR:0.00615
[2023-07-21 13:24:28,553][main_bert_v2.py][line:77][INFO] [Epoch:58/100]: loss:0.0054 | AUC:0.8623 AUC2:0.8633 FAR:0.00598
[2023-07-21 13:25:38,015][main_bert_v2.py][line:77][INFO] [Epoch:59/100]: loss:0.0057 | AUC:0.8623 AUC2:0.8633 FAR:0.00650
[2023-07-21 13:26:56,183][main_bert_v2.py][line:77][INFO] [Epoch:60/100]: loss:0.0059 | AUC:0.8624 AUC2:0.8633 FAR:0.00640
[2023-07-21 13:28:17,323][main_bert_v2.py][line:77][INFO] [Epoch:61/100]: loss:0.0059 | AUC:0.8628 AUC2:0.8633 FAR:0.00608
[2023-07-21 13:29:30,246][main_bert_v2.py][line:77][INFO] [Epoch:62/100]: loss:0.0056 | AUC:0.8628 AUC2:0.8633 FAR:0.00615
[2023-07-21 13:30:45,683][main_bert_v2.py][line:77][INFO] [Epoch:63/100]: loss:0.0055 | AUC:0.8628 AUC2:0.8633 FAR:0.00625
[2023-07-21 13:31:59,473][main_bert_v2.py][line:77][INFO] [Epoch:64/100]: loss:0.0059 | AUC:0.8625 AUC2:0.8633 FAR:0.00605
[2023-07-21 13:33:15,335][main_bert_v2.py][line:77][INFO] [Epoch:65/100]: loss:0.0057 | AUC:0.8626 AUC2:0.8633 FAR:0.00598
[2023-07-21 13:36:44,123][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:36:44,500][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:36:44,500][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:36:44,500][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:36:44,506][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:37:01,026][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:37:01,361][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:37:01,361][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:37:01,361][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:37:01,364][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:37:35,773][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:37:36,095][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:37:36,095][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:37:36,095][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:37:36,098][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:38:12,482][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:38:12,807][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:38:12,807][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:38:12,807][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:38:12,809][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:38:29,800][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:38:30,135][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:38:30,135][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:38:30,135][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:38:30,138][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:39:02,876][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:39:03,216][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:39:03,216][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:39:03,216][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:39:03,218][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:39:20,767][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:39:21,100][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:39:21,100][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:39:21,100][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:39:21,102][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:39:42,610][infer_bert_v2.py][line:70][INFO] offline AUC:0.8681 AUC2:0.8676 AP:0.3320 FAR:0.0050 | Complete in 0m 21s

[2023-07-22 11:44:14,991][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-22 11:44:15,325][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-22 11:44:15,325][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-22 11:44:15,325][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-22 11:44:15,327][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-22 11:44:41,184][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-22 11:44:41,521][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-22 11:44:41,521][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-22 11:44:41,521][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-22 11:44:41,524][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-22 11:45:02,663][infer_bert_v2.py][line:71][INFO] offline AUC:0.8667 AUC2:0.8676 AP:0.3294 FAR:0.0050 | Complete in 0m 21s

[2023-07-22 11:46:43,072][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-22 11:46:43,399][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-22 11:46:43,400][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-22 11:46:43,400][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-22 11:46:43,402][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-22 11:47:04,663][infer_bert_v2.py][line:70][INFO] offline AUC:0.8681 AUC2:0.8676 AP:0.3320 FAR:0.0050 | Complete in 0m 21s

[2023-08-21 18:10:41,056][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:10:41,157][main.py][line:120][INFO] total params:1.2091M
[2023-08-21 18:10:41,157][main.py][line:123][INFO] Training Mode
[2023-08-21 18:10:41,157][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 18:10:41,157][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 18:11:33,067][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:11:33,160][main.py][line:120][INFO] total params:1.2091M
[2023-08-21 18:11:33,160][main.py][line:123][INFO] Training Mode
[2023-08-21 18:11:33,161][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 18:11:33,161][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 18:42:46,239][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:43:34,870][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:45:12,918][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:46:06,383][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:46:24,920][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:47:05,726][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:48:16,614][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:48:16,689][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 18:48:16,689][main.py][line:129][INFO] Training Mode
[2023-08-21 20:49:21,258][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 20:49:21,330][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 20:49:21,330][main.py][line:129][INFO] Training Mode
[2023-08-21 20:49:21,330][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 20:49:21,330][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 20:55:09,587][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 20:55:09,663][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 20:55:09,664][main.py][line:129][INFO] Training Mode
[2023-08-21 20:55:09,664][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 20:55:09,664][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 20:58:58,676][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 20:58:58,751][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 20:58:58,751][main.py][line:129][INFO] Training Mode
[2023-08-21 20:58:58,751][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 20:58:58,751][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 20:59:34,705][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 20:59:34,776][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 20:59:34,776][main.py][line:129][INFO] Training Mode
[2023-08-21 20:59:34,777][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 20:59:34,777][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 21:00:49,663][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 21:00:49,736][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 21:00:49,736][main.py][line:129][INFO] Training Mode
[2023-08-21 21:00:49,736][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 21:00:49,736][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 21:01:05,612][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 21:01:05,705][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 21:01:05,705][main.py][line:129][INFO] Training Mode
[2023-08-21 21:01:05,705][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 21:01:05,705][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 21:01:10,471][main.py][line:58][INFO] Random initialize AUCAUC:0.4984 Anomaly AUC:0.51606
[2023-08-21 21:01:25,712][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 21:01:25,797][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 21:01:25,797][main.py][line:129][INFO] Training Mode
[2023-08-21 21:01:25,797][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 21:01:25,797][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 21:01:31,054][main.py][line:58][INFO] Random initialize AUCAUC:0.4984 Anomaly AUC:0.51606
[2023-08-21 21:04:44,119][main.py][line:79][INFO] [Epoch:1/100]: loss1:0.4626 loss2:1.2024 | AUC:0.8174 Anomaly AUC:0.6256
[2023-08-21 21:07:50,306][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 21:07:50,411][main.py][line:126][INFO] total params:1.2091M
[2023-08-21 21:07:50,411][main.py][line:129][INFO] Training Mode
[2023-08-21 21:07:50,411][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 21:07:50,411][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 21:07:57,117][main.py][line:58][INFO] Random initialize AUCAUC:0.5444 Anomaly AUC:0.53443
[2023-08-21 21:09:08,992][main.py][line:79][INFO] [Epoch:1/100]: loss1:0.3366 loss2:1.0685 | AUC:0.8315 Anomaly AUC:0.6543
[2023-08-21 21:09:59,396][main.py][line:79][INFO] [Epoch:2/100]: loss1:0.1250 loss2:0.7849 | AUC:0.8364 Anomaly AUC:0.6499
[2023-08-21 21:10:51,534][main.py][line:79][INFO] [Epoch:3/100]: loss1:0.0539 loss2:0.6563 | AUC:0.8493 Anomaly AUC:0.6732
[2023-08-21 21:11:41,092][main.py][line:79][INFO] [Epoch:4/100]: loss1:0.0427 loss2:0.5588 | AUC:0.8462 Anomaly AUC:0.6737
[2023-08-21 21:12:37,708][main.py][line:79][INFO] [Epoch:5/100]: loss1:0.0229 loss2:0.4578 | AUC:0.8386 Anomaly AUC:0.6760
[2023-08-21 21:13:43,294][main.py][line:79][INFO] [Epoch:6/100]: loss1:0.0144 loss2:0.3663 | AUC:0.8453 Anomaly AUC:0.6733
[2023-08-21 21:14:47,188][main.py][line:79][INFO] [Epoch:7/100]: loss1:0.0263 loss2:0.2968 | AUC:0.8472 Anomaly AUC:0.6736
[2023-08-21 21:15:41,436][main.py][line:79][INFO] [Epoch:8/100]: loss1:0.0574 loss2:0.2714 | AUC:0.8369 Anomaly AUC:0.6742
[2023-08-21 21:16:29,087][main.py][line:79][INFO] [Epoch:9/100]: loss1:0.0127 loss2:0.1906 | AUC:0.8404 Anomaly AUC:0.6762
[2023-08-21 21:17:29,845][main.py][line:79][INFO] [Epoch:10/100]: loss1:0.0054 loss2:0.1243 | AUC:0.8458 Anomaly AUC:0.6842
[2023-08-21 21:18:24,022][main.py][line:79][INFO] [Epoch:11/100]: loss1:0.0042 loss2:0.0863 | AUC:0.8439 Anomaly AUC:0.6832
[2023-08-21 21:19:23,438][main.py][line:79][INFO] [Epoch:12/100]: loss1:0.0362 loss2:0.0881 | AUC:0.8327 Anomaly AUC:0.6650
[2023-08-21 21:20:09,829][main.py][line:79][INFO] [Epoch:13/100]: loss1:0.0355 loss2:0.1113 | AUC:0.8353 Anomaly AUC:0.6659
[2023-08-21 21:21:05,556][main.py][line:79][INFO] [Epoch:14/100]: loss1:0.0084 loss2:0.0572 | AUC:0.8442 Anomaly AUC:0.6780
[2023-08-21 21:21:54,361][main.py][line:79][INFO] [Epoch:15/100]: loss1:0.0034 loss2:0.0339 | AUC:0.8385 Anomaly AUC:0.6704
[2023-08-21 21:22:52,837][main.py][line:79][INFO] [Epoch:16/100]: loss1:0.0020 loss2:0.0224 | AUC:0.8348 Anomaly AUC:0.6702
[2023-08-21 21:23:52,318][main.py][line:79][INFO] [Epoch:17/100]: loss1:0.0018 loss2:0.0183 | AUC:0.8449 Anomaly AUC:0.6826
[2023-08-21 21:24:38,397][main.py][line:79][INFO] [Epoch:18/100]: loss1:0.0012 loss2:0.0130 | AUC:0.8427 Anomaly AUC:0.6795
[2023-08-21 21:25:37,275][main.py][line:79][INFO] [Epoch:19/100]: loss1:0.0012 loss2:0.0108 | AUC:0.8382 Anomaly AUC:0.6770
[2023-08-21 21:26:26,963][main.py][line:79][INFO] [Epoch:20/100]: loss1:0.0178 loss2:0.0370 | AUC:0.8336 Anomaly AUC:0.6821
[2023-08-21 21:27:20,921][main.py][line:79][INFO] [Epoch:21/100]: loss1:0.0320 loss2:0.0692 | AUC:0.8288 Anomaly AUC:0.6550
[2023-08-21 21:28:28,370][main.py][line:79][INFO] [Epoch:22/100]: loss1:0.0070 loss2:0.0212 | AUC:0.8351 Anomaly AUC:0.6676
[2023-08-21 21:29:33,088][main.py][line:79][INFO] [Epoch:23/100]: loss1:0.0032 loss2:0.0125 | AUC:0.8418 Anomaly AUC:0.6813
[2023-08-21 21:30:31,686][main.py][line:79][INFO] [Epoch:24/100]: loss1:0.0012 loss2:0.0077 | AUC:0.8442 Anomaly AUC:0.6816
[2023-08-21 21:31:49,098][main.py][line:79][INFO] [Epoch:25/100]: loss1:0.0014 loss2:0.0068 | AUC:0.8431 Anomaly AUC:0.6786
[2023-08-21 21:32:47,413][main.py][line:79][INFO] [Epoch:26/100]: loss1:0.0011 loss2:0.0062 | AUC:0.8448 Anomaly AUC:0.6805
[2023-08-21 21:33:52,751][main.py][line:79][INFO] [Epoch:27/100]: loss1:0.0006 loss2:0.0048 | AUC:0.8458 Anomaly AUC:0.6815
[2023-08-21 21:34:43,746][main.py][line:79][INFO] [Epoch:28/100]: loss1:0.0006 loss2:0.0040 | AUC:0.8468 Anomaly AUC:0.6815
[2023-08-21 21:35:31,864][main.py][line:79][INFO] [Epoch:29/100]: loss1:0.0005 loss2:0.0035 | AUC:0.8456 Anomaly AUC:0.6795
[2023-08-21 21:36:32,262][main.py][line:79][INFO] [Epoch:30/100]: loss1:0.0009 loss2:0.0039 | AUC:0.8454 Anomaly AUC:0.6796
[2023-08-21 21:37:37,272][main.py][line:79][INFO] [Epoch:31/100]: loss1:0.0011 loss2:0.0037 | AUC:0.8390 Anomaly AUC:0.6713
[2023-08-21 21:38:34,665][main.py][line:79][INFO] [Epoch:32/100]: loss1:0.0021 loss2:0.0053 | AUC:0.8396 Anomaly AUC:0.6740
[2023-08-21 21:39:27,859][main.py][line:79][INFO] [Epoch:33/100]: loss1:0.0204 loss2:0.0270 | AUC:0.8449 Anomaly AUC:0.6851
[2023-08-21 21:40:18,511][main.py][line:79][INFO] [Epoch:34/100]: loss1:0.0180 loss2:0.0233 | AUC:0.8383 Anomaly AUC:0.6715
[2023-08-21 21:41:07,438][main.py][line:79][INFO] [Epoch:35/100]: loss1:0.0020 loss2:0.0063 | AUC:0.8388 Anomaly AUC:0.6756
[2023-08-21 21:42:12,290][main.py][line:79][INFO] [Epoch:36/100]: loss1:0.0007 loss2:0.0034 | AUC:0.8397 Anomaly AUC:0.6750
[2023-08-21 21:43:12,682][main.py][line:79][INFO] [Epoch:37/100]: loss1:0.0006 loss2:0.0032 | AUC:0.8407 Anomaly AUC:0.6770
[2023-08-21 21:44:16,445][main.py][line:79][INFO] [Epoch:38/100]: loss1:0.0013 loss2:0.0046 | AUC:0.8371 Anomaly AUC:0.6764
[2023-08-21 21:45:09,606][main.py][line:79][INFO] [Epoch:39/100]: loss1:0.0008 loss2:0.0033 | AUC:0.8407 Anomaly AUC:0.6771
[2023-08-21 21:46:07,405][main.py][line:79][INFO] [Epoch:40/100]: loss1:0.0004 loss2:0.0024 | AUC:0.8407 Anomaly AUC:0.6770
[2023-08-21 21:47:00,869][main.py][line:79][INFO] [Epoch:41/100]: loss1:0.0004 loss2:0.0024 | AUC:0.8389 Anomaly AUC:0.6753
[2023-08-21 21:47:51,161][main.py][line:79][INFO] [Epoch:42/100]: loss1:0.0003 loss2:0.0021 | AUC:0.8395 Anomaly AUC:0.6755
[2023-08-21 21:48:37,310][main.py][line:79][INFO] [Epoch:43/100]: loss1:0.0003 loss2:0.0022 | AUC:0.8400 Anomaly AUC:0.6756
[2023-08-21 21:49:36,293][main.py][line:79][INFO] [Epoch:44/100]: loss1:0.0009 loss2:0.0026 | AUC:0.8364 Anomaly AUC:0.6727
[2023-08-21 21:50:36,070][main.py][line:79][INFO] [Epoch:45/100]: loss1:0.0013 loss2:0.0025 | AUC:0.8371 Anomaly AUC:0.6706
[2023-08-21 21:51:39,438][main.py][line:79][INFO] [Epoch:46/100]: loss1:0.0004 loss2:0.0021 | AUC:0.8388 Anomaly AUC:0.6720
[2023-08-21 21:52:35,727][main.py][line:79][INFO] [Epoch:47/100]: loss1:0.0003 loss2:0.0019 | AUC:0.8389 Anomaly AUC:0.6723
[2023-08-21 21:53:39,237][main.py][line:79][INFO] [Epoch:48/100]: loss1:0.0002 loss2:0.0019 | AUC:0.8390 Anomaly AUC:0.6724
[2023-08-21 21:54:30,594][main.py][line:79][INFO] [Epoch:49/100]: loss1:0.0002 loss2:0.0017 | AUC:0.8394 Anomaly AUC:0.6731
[2023-08-21 21:55:26,494][main.py][line:79][INFO] [Epoch:50/100]: loss1:0.0002 loss2:0.0020 | AUC:0.8374 Anomaly AUC:0.6699
[2023-08-21 21:56:13,604][main.py][line:79][INFO] [Epoch:51/100]: loss1:0.0002 loss2:0.0018 | AUC:0.8387 Anomaly AUC:0.6715
[2023-08-21 21:57:31,084][main.py][line:79][INFO] [Epoch:52/100]: loss1:0.0002 loss2:0.0014 | AUC:0.8389 Anomaly AUC:0.6722
[2023-08-21 21:58:20,736][main.py][line:79][INFO] [Epoch:53/100]: loss1:0.0002 loss2:0.0016 | AUC:0.8392 Anomaly AUC:0.6722
[2023-08-21 21:59:30,424][main.py][line:79][INFO] [Epoch:54/100]: loss1:0.0002 loss2:0.0014 | AUC:0.8391 Anomaly AUC:0.6719
[2023-08-21 22:00:19,558][main.py][line:79][INFO] [Epoch:55/100]: loss1:0.0002 loss2:0.0013 | AUC:0.8392 Anomaly AUC:0.6721
[2023-08-21 22:01:15,660][main.py][line:79][INFO] [Epoch:56/100]: loss1:0.0002 loss2:0.0014 | AUC:0.8395 Anomaly AUC:0.6725
[2023-08-21 22:02:02,454][main.py][line:79][INFO] [Epoch:57/100]: loss1:0.0002 loss2:0.0013 | AUC:0.8396 Anomaly AUC:0.6727
[2023-08-21 22:02:56,631][main.py][line:79][INFO] [Epoch:58/100]: loss1:0.0002 loss2:0.0015 | AUC:0.8395 Anomaly AUC:0.6724
[2023-08-21 22:03:57,567][main.py][line:79][INFO] [Epoch:59/100]: loss1:0.0002 loss2:0.0013 | AUC:0.8396 Anomaly AUC:0.6725
[2023-08-21 22:04:49,610][main.py][line:79][INFO] [Epoch:60/100]: loss1:0.0002 loss2:0.0013 | AUC:0.8396 Anomaly AUC:0.6725
[2023-08-21 22:05:32,754][main.py][line:79][INFO] [Epoch:61/100]: loss1:0.0002 loss2:0.0013 | AUC:0.8396 Anomaly AUC:0.6725
[2023-08-21 22:06:19,706][main.py][line:79][INFO] [Epoch:62/100]: loss1:0.0002 loss2:0.0013 | AUC:0.8396 Anomaly AUC:0.6726
[2023-08-21 22:07:04,406][main.py][line:79][INFO] [Epoch:63/100]: loss1:0.0002 loss2:0.0013 | AUC:0.8397 Anomaly AUC:0.6727
[2023-08-21 22:08:18,526][main.py][line:79][INFO] [Epoch:64/100]: loss1:0.0001 loss2:0.0014 | AUC:0.8398 Anomaly AUC:0.6730
[2023-08-21 22:09:14,245][main.py][line:79][INFO] [Epoch:65/100]: loss1:0.0002 loss2:0.0014 | AUC:0.8400 Anomaly AUC:0.6733
[2023-08-21 22:10:12,190][main.py][line:79][INFO] [Epoch:66/100]: loss1:0.0001 loss2:0.0014 | AUC:0.8400 Anomaly AUC:0.6734
[2023-08-21 22:10:54,825][main.py][line:79][INFO] [Epoch:67/100]: loss1:0.0001 loss2:0.0013 | AUC:0.8403 Anomaly AUC:0.6742
[2023-08-21 22:11:47,832][main.py][line:79][INFO] [Epoch:68/100]: loss1:0.0001 loss2:0.0013 | AUC:0.8405 Anomaly AUC:0.6751
[2023-08-21 22:12:29,084][main.py][line:79][INFO] [Epoch:69/100]: loss1:0.0001 loss2:0.0015 | AUC:0.8406 Anomaly AUC:0.6744
[2023-08-21 22:13:24,524][main.py][line:79][INFO] [Epoch:70/100]: loss1:0.0002 loss2:0.0016 | AUC:0.8400 Anomaly AUC:0.6738
[2023-08-21 22:14:08,934][main.py][line:79][INFO] [Epoch:71/100]: loss1:0.0001 loss2:0.0015 | AUC:0.8397 Anomaly AUC:0.6732
[2023-08-21 22:14:36,084][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 22:14:36,201][main.py][line:126][INFO] total params:1.2091M
[2023-08-21 22:14:36,201][main.py][line:129][INFO] Training Mode
[2023-08-21 22:14:36,202][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 22:14:36,202][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 22:14:44,649][main.py][line:58][INFO] Random initialize AUCAUC:0.5444 Anomaly AUC:0.53443
[2023-08-21 22:15:32,487][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 22:15:32,579][main.py][line:126][INFO] total params:1.2091M
[2023-08-21 22:15:32,579][main.py][line:129][INFO] Training Mode
[2023-08-21 22:15:32,579][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 22:15:32,579][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 22:15:38,300][main.py][line:58][INFO] Random initialize AUCAUC:0.5444 Anomaly AUC:0.53443
[2023-08-21 22:16:47,517][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 22:16:47,593][main.py][line:126][INFO] total params:1.2091M
[2023-08-21 22:16:47,593][main.py][line:129][INFO] Training Mode
[2023-08-21 22:16:47,594][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 22:16:47,594][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 22:43:12,850][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 22:43:12,937][main.py][line:126][INFO] total params:1.2091M
[2023-08-21 22:43:12,937][main.py][line:129][INFO] Training Mode
[2023-08-21 22:43:12,937][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 22:43:12,937][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 22:43:30,925][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 22:43:31,013][main.py][line:126][INFO] total params:1.2091M
[2023-08-21 22:43:31,013][main.py][line:129][INFO] Training Mode
[2023-08-21 22:43:31,013][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 22:43:31,013][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 23:51:18,169][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 23:51:18,245][main.py][line:126][INFO] total params:1.2091M
[2023-08-21 23:51:18,245][main.py][line:129][INFO] Training Mode
[2023-08-21 23:51:18,245][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 23:51:18,245][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 23:51:33,625][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 23:51:33,702][main.py][line:126][INFO] total params:1.2091M
[2023-08-21 23:51:33,702][main.py][line:129][INFO] Training Mode
[2023-08-21 23:51:33,702][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 23:51:33,702][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 23:53:25,133][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 23:53:25,219][main.py][line:126][INFO] total params:1.2091M
[2023-08-21 23:53:25,219][main.py][line:129][INFO] Training Mode
[2023-08-21 23:53:25,219][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 23:53:25,219][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 23:53:48,587][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 23:53:48,678][main.py][line:126][INFO] total params:1.2091M
[2023-08-21 23:53:48,678][main.py][line:129][INFO] Training Mode
[2023-08-21 23:53:48,678][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 23:53:48,678][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:15:03,101][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:15:03,175][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:15:03,175][main.py][line:129][INFO] Training Mode
[2023-08-22 14:15:03,175][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:15:03,175][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:15:17,234][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:15:17,309][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:15:17,309][main.py][line:129][INFO] Training Mode
[2023-08-22 14:15:17,310][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:15:17,310][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:15:29,645][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:15:29,741][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:15:29,741][main.py][line:129][INFO] Training Mode
[2023-08-22 14:15:29,741][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:15:29,741][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:15:55,510][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:15:55,600][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:15:55,601][main.py][line:129][INFO] Training Mode
[2023-08-22 14:15:55,601][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:15:55,601][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:16:01,068][main.py][line:58][INFO] Random initialize AUCAUC:0.5444 Anomaly AUC:0.53443
[2023-08-22 14:17:29,826][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:17:29,914][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:17:29,914][main.py][line:129][INFO] Training Mode
[2023-08-22 14:17:29,914][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:17:29,914][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:17:35,655][main.py][line:58][INFO] Random initialize AUCAUC:0.5444 Anomaly AUC:0.53443
[2023-08-22 14:21:28,515][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:21:28,591][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:21:28,591][main.py][line:129][INFO] Training Mode
[2023-08-22 14:21:28,591][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:21:28,591][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:21:34,038][main.py][line:58][INFO] Random initialize AUCAUC:0.5444 Anomaly AUC:0.53443
[2023-08-22 14:33:44,271][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:33:44,362][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:33:44,363][main.py][line:129][INFO] Training Mode
[2023-08-22 14:33:44,363][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:33:44,363][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:44:40,677][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:44:40,751][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:44:40,751][main.py][line:129][INFO] Training Mode
[2023-08-22 14:44:40,751][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:44:40,751][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:45:26,739][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:45:26,822][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:45:26,823][main.py][line:129][INFO] Training Mode
[2023-08-22 14:45:26,823][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:45:26,823][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:46:26,120][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:46:26,214][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:46:26,214][main.py][line:129][INFO] Training Mode
[2023-08-22 14:46:26,214][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:46:26,214][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:46:41,612][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:46:41,697][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:46:41,698][main.py][line:129][INFO] Training Mode
[2023-08-22 14:46:41,698][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:46:41,698][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:47:19,590][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:47:19,663][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:47:19,663][main.py][line:129][INFO] Training Mode
[2023-08-22 14:47:19,663][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:47:19,663][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:58:55,623][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:58:55,723][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:58:55,723][main.py][line:129][INFO] Training Mode
[2023-08-22 14:58:55,723][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:58:55,724][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 14:59:53,137][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 14:59:53,224][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 14:59:53,224][main.py][line:129][INFO] Training Mode
[2023-08-22 14:59:53,224][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 14:59:53,224][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 15:24:59,800][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 15:24:59,890][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 15:24:59,890][main.py][line:129][INFO] Training Mode
[2023-08-22 15:24:59,890][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 15:24:59,890][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 15:25:18,793][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 15:25:18,877][main.py][line:126][INFO] total params:1.2091M
[2023-08-22 15:25:18,877][main.py][line:129][INFO] Training Mode
[2023-08-22 15:25:18,877][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 15:25:18,877][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 15:31:03,186][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 15:31:03,402][main.py][line:126][INFO] total params:29.6643M
[2023-08-22 15:31:03,402][main.py][line:129][INFO] Training Mode
[2023-08-22 15:31:03,403][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 15:31:03,403][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 15:31:25,132][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 15:31:25,359][main.py][line:126][INFO] total params:29.6643M
[2023-08-22 15:31:25,359][main.py][line:129][INFO] Training Mode
[2023-08-22 15:31:25,360][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 15:31:25,360][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 15:32:30,787][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 15:32:31,018][main.py][line:126][INFO] total params:29.6643M
[2023-08-22 15:32:31,018][main.py][line:129][INFO] Training Mode
[2023-08-22 15:32:31,019][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 15:32:31,019][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 15:32:55,369][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 15:32:55,587][main.py][line:126][INFO] total params:29.6643M
[2023-08-22 15:32:55,587][main.py][line:129][INFO] Training Mode
[2023-08-22 15:32:55,588][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 15:32:55,588][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 15:33:12,547][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 15:33:12,777][main.py][line:126][INFO] total params:29.6643M
[2023-08-22 15:33:12,777][main.py][line:129][INFO] Training Mode
[2023-08-22 15:33:12,778][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 15:33:12,778][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-22 15:34:16,415][main.py][line:79][INFO] [Epoch:1/50]: loss1:0.5291 loss2:1.1079 | AUC:0.7878 Anomaly AUC:0.5955
[2023-08-22 15:35:33,222][main.py][line:79][INFO] [Epoch:2/50]: loss1:0.2797 loss2:0.9397 | AUC:0.8299 Anomaly AUC:0.6277
[2023-08-22 15:36:51,435][main.py][line:79][INFO] [Epoch:3/50]: loss1:0.2284 loss2:0.8902 | AUC:0.8146 Anomaly AUC:0.6305
[2023-08-22 15:38:03,392][main.py][line:79][INFO] [Epoch:4/50]: loss1:0.1698 loss2:0.8393 | AUC:0.8225 Anomaly AUC:0.6173
[2023-08-22 15:39:22,837][main.py][line:79][INFO] [Epoch:5/50]: loss1:0.1352 loss2:0.8013 | AUC:0.8001 Anomaly AUC:0.5925
[2023-08-22 15:40:42,534][main.py][line:79][INFO] [Epoch:6/50]: loss1:0.1091 loss2:0.7481 | AUC:0.8121 Anomaly AUC:0.6450
[2023-08-22 15:42:03,536][main.py][line:79][INFO] [Epoch:7/50]: loss1:0.0863 loss2:0.7036 | AUC:0.7751 Anomaly AUC:0.6031
[2023-08-22 15:43:26,839][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 15:43:27,096][main.py][line:126][INFO] total params:29.6643M
[2023-08-22 15:43:27,096][main.py][line:129][INFO] Training Mode
[2023-08-22 15:43:27,097][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 15:43:27,097][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-22 15:43:42,326][main.py][line:58][INFO] Random initialize AUCAUC:0.5207 Anomaly AUC:0.49284
[2023-08-22 15:45:09,309][main.py][line:79][INFO] [Epoch:1/50]: loss1:0.5284 loss2:1.1158 | AUC:0.7895 Anomaly AUC:0.6070
[2023-08-22 15:46:31,387][main.py][line:79][INFO] [Epoch:2/50]: loss1:0.2972 loss2:0.9482 | AUC:0.8030 Anomaly AUC:0.6189
[2023-08-22 15:48:24,060][main.py][line:79][INFO] [Epoch:3/50]: loss1:0.2318 loss2:0.8927 | AUC:0.8057 Anomaly AUC:0.6106
[2023-08-22 15:49:45,231][main.py][line:79][INFO] [Epoch:4/50]: loss1:0.1893 loss2:0.8514 | AUC:0.8126 Anomaly AUC:0.6227
[2023-08-22 15:51:44,901][main.py][line:79][INFO] [Epoch:5/50]: loss1:0.1677 loss2:0.8316 | AUC:0.8143 Anomaly AUC:0.6164
[2023-08-22 15:54:10,612][main.py][line:79][INFO] [Epoch:6/50]: loss1:0.1285 loss2:0.7901 | AUC:0.8204 Anomaly AUC:0.6360
[2023-08-22 15:57:02,359][main.py][line:79][INFO] [Epoch:7/50]: loss1:0.1470 loss2:0.8084 | AUC:0.8240 Anomaly AUC:0.6357
[2023-08-22 15:59:52,520][main.py][line:79][INFO] [Epoch:8/50]: loss1:0.0994 loss2:0.7644 | AUC:0.8214 Anomaly AUC:0.6447
[2023-08-22 16:02:44,358][main.py][line:79][INFO] [Epoch:9/50]: loss1:0.2130 loss2:0.8535 | AUC:0.8159 Anomaly AUC:0.6351
[2023-08-22 16:05:48,470][main.py][line:79][INFO] [Epoch:10/50]: loss1:0.0958 loss2:0.7714 | AUC:0.8145 Anomaly AUC:0.6175
[2023-08-22 16:07:27,091][main.py][line:79][INFO] [Epoch:11/50]: loss1:0.0680 loss2:0.7473 | AUC:0.8207 Anomaly AUC:0.6292
[2023-08-22 16:09:21,036][main.py][line:79][INFO] [Epoch:12/50]: loss1:0.0686 loss2:0.7400 | AUC:0.8148 Anomaly AUC:0.6264
[2023-08-22 16:10:10,946][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 16:10:11,195][main.py][line:126][INFO] total params:29.6643M
[2023-08-22 16:10:11,195][main.py][line:129][INFO] Training Mode
[2023-08-22 16:10:11,196][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 16:10:11,196][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-22 16:10:26,665][main.py][line:58][INFO] Random initialize AUCAUC:0.4799 Anomaly AUC:0.48599
[2023-08-22 16:11:41,367][main.py][line:79][INFO] [Epoch:1/50]: loss1:0.4653 loss2:1.0844 | AUC:0.8193 Anomaly AUC:0.6050
[2023-08-22 16:12:46,103][main.py][line:79][INFO] [Epoch:2/50]: loss1:0.2521 loss2:0.9401 | AUC:0.8317 Anomaly AUC:0.6113
[2023-08-22 16:13:45,193][main.py][line:79][INFO] [Epoch:3/50]: loss1:0.2027 loss2:0.8953 | AUC:0.8134 Anomaly AUC:0.5985
[2023-08-22 16:14:47,537][main.py][line:79][INFO] [Epoch:4/50]: loss1:0.1585 loss2:0.8505 | AUC:0.8192 Anomaly AUC:0.6002
[2023-08-22 16:15:48,389][main.py][line:79][INFO] [Epoch:5/50]: loss1:0.1353 loss2:0.8321 | AUC:0.8213 Anomaly AUC:0.6078
[2023-08-22 16:17:33,354][main.py][line:79][INFO] [Epoch:6/50]: loss1:0.1075 loss2:0.8016 | AUC:0.8234 Anomaly AUC:0.6184
[2023-08-22 16:18:54,738][main.py][line:79][INFO] [Epoch:7/50]: loss1:0.1007 loss2:0.7958 | AUC:0.7887 Anomaly AUC:0.5715
[2023-08-22 16:19:11,351][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 16:19:11,620][main.py][line:126][INFO] total params:29.6643M
[2023-08-22 16:19:11,620][main.py][line:129][INFO] Training Mode
[2023-08-22 16:19:11,621][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 16:19:11,621][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-22 16:19:28,156][main.py][line:58][INFO] Random initialize AUCAUC:0.4799 Anomaly AUC:0.48599
[2023-08-22 16:21:00,035][main.py][line:79][INFO] [Epoch:1/50]: loss1:0.4653 loss2:1.0844 | AUC:0.8193 Anomaly AUC:0.6050
[2023-08-22 16:22:00,015][main.py][line:79][INFO] [Epoch:2/50]: loss1:0.2525 loss2:0.9398 | AUC:0.8275 Anomaly AUC:0.6164
[2023-08-22 16:22:56,587][main.py][line:79][INFO] [Epoch:3/50]: loss1:0.1939 loss2:0.8851 | AUC:0.7909 Anomaly AUC:0.5909
[2023-08-22 16:23:52,841][main.py][line:79][INFO] [Epoch:4/50]: loss1:0.1698 loss2:0.8617 | AUC:0.8185 Anomaly AUC:0.5991
[2023-08-22 16:24:54,427][main.py][line:79][INFO] [Epoch:5/50]: loss1:0.1382 loss2:0.8301 | AUC:0.8020 Anomaly AUC:0.5949
[2023-08-22 16:25:56,518][main.py][line:79][INFO] [Epoch:6/50]: loss1:0.1133 loss2:0.8035 | AUC:0.7570 Anomaly AUC:0.5827
[2023-08-22 16:26:58,836][main.py][line:79][INFO] [Epoch:7/50]: loss1:0.0960 loss2:0.7933 | AUC:0.7882 Anomaly AUC:0.5825
[2023-08-22 16:28:01,080][main.py][line:79][INFO] [Epoch:8/50]: loss1:0.0842 loss2:0.7790 | AUC:0.7950 Anomaly AUC:0.5973
[2023-08-22 16:29:00,570][main.py][line:79][INFO] [Epoch:9/50]: loss1:0.0736 loss2:0.7715 | AUC:0.7032 Anomaly AUC:0.5236
[2023-08-22 16:30:16,135][main.py][line:79][INFO] [Epoch:10/50]: loss1:0.0679 loss2:0.7622 | AUC:0.7361 Anomaly AUC:0.5550
[2023-08-22 16:31:25,493][main.py][line:79][INFO] [Epoch:11/50]: loss1:0.0616 loss2:0.7598 | AUC:0.8188 Anomaly AUC:0.5961
[2023-08-22 16:32:37,494][main.py][line:79][INFO] [Epoch:12/50]: loss1:0.0563 loss2:0.7531 | AUC:0.7694 Anomaly AUC:0.5834
[2023-08-22 16:33:46,372][main.py][line:79][INFO] [Epoch:13/50]: loss1:0.0541 loss2:0.7462 | AUC:0.7896 Anomaly AUC:0.5704
[2023-08-22 16:35:01,388][main.py][line:79][INFO] [Epoch:14/50]: loss1:0.0498 loss2:0.7446 | AUC:0.7626 Anomaly AUC:0.5686
[2023-08-22 16:35:58,388][main.py][line:79][INFO] [Epoch:15/50]: loss1:0.0432 loss2:0.7372 | AUC:0.7018 Anomaly AUC:0.5250
[2023-08-22 16:36:57,424][main.py][line:79][INFO] [Epoch:16/50]: loss1:0.0289 loss2:0.7181 | AUC:0.7141 Anomaly AUC:0.5372
[2023-08-22 16:37:56,009][main.py][line:79][INFO] [Epoch:17/50]: loss1:0.0435 loss2:0.7147 | AUC:0.6209 Anomaly AUC:0.5287
[2023-08-22 16:39:00,810][main.py][line:79][INFO] [Epoch:18/50]: loss1:0.0288 loss2:0.6796 | AUC:0.7296 Anomaly AUC:0.5608
[2023-08-22 16:40:00,471][main.py][line:79][INFO] [Epoch:19/50]: loss1:0.0267 loss2:0.7138 | AUC:0.6997 Anomaly AUC:0.5538
[2023-08-22 16:41:02,929][main.py][line:79][INFO] [Epoch:20/50]: loss1:0.0337 loss2:0.3968 | AUC:0.6351 Anomaly AUC:0.5293
[2023-08-22 16:42:01,620][main.py][line:79][INFO] [Epoch:21/50]: loss1:0.0357 loss2:0.4270 | AUC:0.7870 Anomaly AUC:0.5884
[2023-08-22 16:42:55,778][main.py][line:79][INFO] [Epoch:22/50]: loss1:0.0315 loss2:0.7139 | AUC:0.7658 Anomaly AUC:0.5745
[2023-08-22 16:43:54,755][main.py][line:79][INFO] [Epoch:23/50]: loss1:0.0372 loss2:0.7153 | AUC:0.7096 Anomaly AUC:0.5381
[2023-08-22 16:44:58,445][main.py][line:79][INFO] [Epoch:24/50]: loss1:0.0172 loss2:0.6971 | AUC:0.6917 Anomaly AUC:0.5371
[2023-08-22 16:46:06,180][main.py][line:79][INFO] [Epoch:25/50]: loss1:0.0212 loss2:0.6937 | AUC:0.7009 Anomaly AUC:0.5524
[2023-08-22 16:47:11,957][main.py][line:79][INFO] [Epoch:26/50]: loss1:0.0221 loss2:0.6843 | AUC:0.6903 Anomaly AUC:0.5040
[2023-08-22 16:48:12,953][main.py][line:79][INFO] [Epoch:27/50]: loss1:0.0258 loss2:0.6939 | AUC:0.7496 Anomaly AUC:0.5617
[2023-08-22 16:49:16,792][main.py][line:79][INFO] [Epoch:28/50]: loss1:0.0165 loss2:0.3971 | AUC:0.7166 Anomaly AUC:0.5498
[2023-08-22 16:50:24,675][main.py][line:79][INFO] [Epoch:29/50]: loss1:0.0244 loss2:0.6573 | AUC:0.6108 Anomaly AUC:0.5172
[2023-08-22 16:51:26,759][main.py][line:79][INFO] [Epoch:30/50]: loss1:0.0140 loss2:0.0854 | AUC:0.7101 Anomaly AUC:0.5694
[2023-08-22 16:52:29,628][main.py][line:79][INFO] [Epoch:31/50]: loss1:0.0058 loss2:0.0000 | AUC:0.7177 Anomaly AUC:0.5592
[2023-08-22 16:53:36,748][main.py][line:79][INFO] [Epoch:32/50]: loss1:0.0053 loss2:0.0000 | AUC:0.7165 Anomaly AUC:0.5615
[2023-08-22 16:54:40,805][main.py][line:79][INFO] [Epoch:33/50]: loss1:0.0303 loss2:0.1773 | AUC:0.6839 Anomaly AUC:0.5333
[2023-08-22 16:55:50,390][main.py][line:79][INFO] [Epoch:34/50]: loss1:0.0150 loss2:0.0328 | AUC:0.7414 Anomaly AUC:0.5647
[2023-08-22 16:57:05,273][main.py][line:79][INFO] [Epoch:35/50]: loss1:0.0095 loss2:0.1357 | AUC:0.7135 Anomaly AUC:0.5320
[2023-08-22 16:58:18,149][main.py][line:79][INFO] [Epoch:36/50]: loss1:0.0214 loss2:0.5387 | AUC:0.7551 Anomaly AUC:0.5697
[2023-08-22 16:59:16,671][main.py][line:79][INFO] [Epoch:37/50]: loss1:0.0267 loss2:0.5094 | AUC:0.8103 Anomaly AUC:0.6045
[2023-08-22 17:00:23,683][main.py][line:79][INFO] [Epoch:38/50]: loss1:0.0240 loss2:0.6549 | AUC:0.7330 Anomaly AUC:0.5538
[2023-08-22 17:01:34,196][main.py][line:79][INFO] [Epoch:39/50]: loss1:0.0178 loss2:0.1634 | AUC:0.7818 Anomaly AUC:0.5913
[2023-08-22 17:02:39,222][main.py][line:79][INFO] [Epoch:40/50]: loss1:0.0082 loss2:0.0000 | AUC:0.7503 Anomaly AUC:0.5663
[2023-08-22 17:03:43,802][main.py][line:79][INFO] [Epoch:41/50]: loss1:0.0032 loss2:0.0000 | AUC:0.7637 Anomaly AUC:0.5617
[2023-08-22 17:04:38,684][main.py][line:79][INFO] [Epoch:42/50]: loss1:0.0100 loss2:0.0058 | AUC:0.7976 Anomaly AUC:0.5814
[2023-08-22 17:05:37,188][main.py][line:79][INFO] [Epoch:43/50]: loss1:0.0122 loss2:0.0000 | AUC:0.6854 Anomaly AUC:0.5290
[2023-08-22 17:06:39,172][main.py][line:79][INFO] [Epoch:44/50]: loss1:0.0078 loss2:0.0000 | AUC:0.8014 Anomaly AUC:0.5856
[2023-08-22 17:07:43,899][main.py][line:79][INFO] [Epoch:45/50]: loss1:0.0163 loss2:0.1228 | AUC:0.6047 Anomaly AUC:0.5057
[2023-08-22 17:08:45,101][main.py][line:79][INFO] [Epoch:46/50]: loss1:0.0261 loss2:0.3563 | AUC:0.7133 Anomaly AUC:0.5738
[2023-08-22 17:10:02,337][main.py][line:79][INFO] [Epoch:47/50]: loss1:0.0165 loss2:0.2264 | AUC:0.7102 Anomaly AUC:0.5779
[2023-08-22 17:11:08,294][main.py][line:79][INFO] [Epoch:48/50]: loss1:0.0171 loss2:0.4511 | AUC:0.7006 Anomaly AUC:0.5404
[2023-08-22 17:12:23,264][main.py][line:79][INFO] [Epoch:49/50]: loss1:0.0231 loss2:0.2798 | AUC:0.6701 Anomaly AUC:0.5261
[2023-08-22 17:13:29,103][main.py][line:79][INFO] [Epoch:50/50]: loss1:0.0107 loss2:0.1794 | AUC:0.6652 Anomaly AUC:0.5235
[2023-08-22 17:13:29,184][main.py][line:87][INFO] Training completes in 54m 1s | best AUCAUC:0.8275 Anomaly AUC:0.6164

[2023-08-22 21:28:01,399][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 21:28:01,658][main.py][line:126][INFO] total params:31.7625M
[2023-08-22 21:28:01,658][main.py][line:129][INFO] Training Mode
[2023-08-22 21:28:01,659][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 21:28:01,659][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-22 22:21:10,443][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 22:21:10,681][main.py][line:126][INFO] total params:31.7625M
[2023-08-22 22:21:10,681][main.py][line:129][INFO] Training Mode
[2023-08-22 22:21:10,682][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 22:21:10,682][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-22 22:21:27,690][main.py][line:58][INFO] Random initialize AUCAUC:0.5448 Anomaly AUC:0.46826
[2023-08-22 22:23:01,323][main.py][line:79][INFO] [Epoch:1/50]: loss1:0.7651 loss2:1.3625 | AUC:0.6168 Anomaly AUC:0.5372
[2023-08-22 22:24:20,255][main.py][line:79][INFO] [Epoch:2/50]: loss1:0.6975 loss2:1.3257 | AUC:0.5417 Anomaly AUC:0.4861
[2023-08-22 22:25:42,783][main.py][line:79][INFO] [Epoch:3/50]: loss1:0.6950 loss2:1.3233 | AUC:0.4876 Anomaly AUC:0.4996
[2023-08-22 22:26:52,998][main.py][line:79][INFO] [Epoch:4/50]: loss1:0.6981 loss2:1.3540 | AUC:0.5729 Anomaly AUC:0.5137
[2023-08-22 22:28:18,624][main.py][line:79][INFO] [Epoch:5/50]: loss1:0.7021 loss2:1.3698 | AUC:0.3997 Anomaly AUC:0.4822
[2023-08-22 22:29:28,636][main.py][line:79][INFO] [Epoch:6/50]: loss1:0.6938 loss2:1.3674 | AUC:0.6133 Anomaly AUC:0.5533
[2023-08-22 22:30:47,265][main.py][line:79][INFO] [Epoch:7/50]: loss1:0.6933 loss2:1.3644 | AUC:0.6042 Anomaly AUC:0.5290
[2023-08-22 22:31:13,263][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 22:31:13,541][main.py][line:126][INFO] total params:31.7625M
[2023-08-22 22:31:13,541][main.py][line:129][INFO] Training Mode
[2023-08-22 22:31:13,542][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 22:31:13,542][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-22 22:31:28,826][main.py][line:58][INFO] Random initialize AUCAUC:0.5448 Anomaly AUC:0.46826
[2023-08-22 22:32:50,271][main.py][line:79][INFO] [Epoch:1/50]: loss1:0.7651 loss2:1.3625 | AUC:0.6168 Anomaly AUC:0.5372
[2023-08-22 22:34:10,953][main.py][line:79][INFO] [Epoch:2/50]: loss1:0.6975 loss2:1.3257 | AUC:0.5417 Anomaly AUC:0.4861
[2023-08-22 22:35:36,778][main.py][line:79][INFO] [Epoch:3/50]: loss1:0.6950 loss2:1.3233 | AUC:0.4876 Anomaly AUC:0.4996
[2023-08-22 22:36:50,104][main.py][line:79][INFO] [Epoch:4/50]: loss1:0.6981 loss2:1.3540 | AUC:0.5729 Anomaly AUC:0.5137
[2023-08-22 22:38:25,261][main.py][line:79][INFO] [Epoch:5/50]: loss1:0.7021 loss2:1.3698 | AUC:0.3997 Anomaly AUC:0.4822
[2023-08-22 22:39:39,069][main.py][line:79][INFO] [Epoch:6/50]: loss1:0.6938 loss2:1.3674 | AUC:0.6133 Anomaly AUC:0.5533
[2023-08-22 22:54:31,529][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 22:54:31,797][main.py][line:126][INFO] total params:31.7625M
[2023-08-22 22:54:31,797][main.py][line:129][INFO] Training Mode
[2023-08-22 22:54:31,798][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 22:54:31,798][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-22 22:54:36,207][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 22:54:36,446][main.py][line:126][INFO] total params:31.7625M
[2023-08-22 22:54:36,447][main.py][line:129][INFO] Training Mode
[2023-08-22 22:54:36,447][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 22:54:36,447][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-22 22:54:49,111][main.py][line:58][INFO] Random initialize AUCAUC:0.5015 Anomaly AUC:0.46777
[2023-08-22 22:56:00,870][main.py][line:79][INFO] [Epoch:1/50]: loss1:0.5957 loss2:1.1727 | AUC:0.7856 Anomaly AUC:0.5994
[2023-08-22 22:57:08,881][main.py][line:79][INFO] [Epoch:2/50]: loss1:0.3159 loss2:1.0080 | AUC:0.8204 Anomaly AUC:0.6148
[2023-08-22 22:58:39,875][main.py][line:79][INFO] [Epoch:3/50]: loss1:0.4640 loss2:1.0691 | AUC:0.2166 Anomaly AUC:0.3722
[2023-08-22 22:59:49,518][main.py][line:79][INFO] [Epoch:4/50]: loss1:0.7066 loss2:1.3956 | AUC:0.2594 Anomaly AUC:0.4255
[2023-08-22 23:00:15,637][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 23:00:15,908][main.py][line:126][INFO] total params:31.7625M
[2023-08-22 23:00:15,908][main.py][line:129][INFO] Training Mode
[2023-08-22 23:00:15,909][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 23:00:15,909][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-22 23:00:30,637][main.py][line:58][INFO] Random initialize AUCAUC:0.4867 Anomaly AUC:0.45064
[2023-08-22 23:01:41,623][main.py][line:79][INFO] [Epoch:1/50]: loss1:0.7299 loss2:1.2352 | AUC:0.4333 Anomaly AUC:0.5232
[2023-08-22 23:03:15,178][main.py][line:79][INFO] [Epoch:2/50]: loss1:0.6949 loss2:1.1918 | AUC:0.5297 Anomaly AUC:0.5097
[2023-08-22 23:04:47,037][main.py][line:79][INFO] [Epoch:3/50]: loss1:0.7035 loss2:1.2269 | AUC:0.5202 Anomaly AUC:0.5244
[2023-08-22 23:05:56,294][main.py][line:79][INFO] [Epoch:4/50]: loss1:0.7038 loss2:1.2389 | AUC:0.5190 Anomaly AUC:0.5241
[2023-08-22 23:07:06,195][main.py][line:79][INFO] [Epoch:5/50]: loss1:0.6960 loss2:1.2351 | AUC:0.5101 Anomaly AUC:0.5208
[2023-08-22 23:08:22,068][main.py][line:79][INFO] [Epoch:6/50]: loss1:0.6962 loss2:1.2255 | AUC:0.5223 Anomaly AUC:0.5293
[2023-08-22 23:09:28,571][main.py][line:79][INFO] [Epoch:7/50]: loss1:0.7108 loss2:1.2588 | AUC:0.5087 Anomaly AUC:0.5186
[2023-08-22 23:10:24,853][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 23:10:25,123][main.py][line:132][INFO] total params:31.7625M
[2023-08-22 23:10:25,123][main.py][line:135][INFO] Training Mode
[2023-08-22 23:10:58,946][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 23:10:59,173][main.py][line:132][INFO] total params:31.7625M
[2023-08-22 23:10:59,174][main.py][line:135][INFO] Training Mode
[2023-08-22 23:11:23,979][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 23:11:24,206][main.py][line:132][INFO] total params:31.7625M
[2023-08-22 23:11:24,206][main.py][line:135][INFO] Training Mode
[2023-08-22 23:11:24,207][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 23:11:24,207][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-22 23:12:09,677][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 23:12:09,916][main.py][line:132][INFO] total params:31.7625M
[2023-08-22 23:12:09,916][main.py][line:135][INFO] Training Mode
[2023-08-22 23:12:09,916][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 23:12:09,916][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-22 23:12:19,154][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 23:12:19,395][main.py][line:132][INFO] total params:31.7625M
[2023-08-22 23:12:19,395][main.py][line:135][INFO] Training Mode
[2023-08-22 23:12:19,395][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 23:12:19,396][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-22 23:12:33,855][main.py][line:64][INFO] Random initialize AUCAUC:0.4850 Anomaly AUC:0.44875
[2023-08-22 23:14:04,149][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.7289 loss2:1.2727 | AUC:0.7528 Anomaly AUC:0.6237
[2023-08-22 23:15:31,768][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.6964 loss2:1.2416 | AUC:0.6945 Anomaly AUC:0.5584
[2023-08-22 23:16:48,333][main.py][line:85][INFO] [Epoch:3/50]: loss1:0.4665 loss2:1.0619 | AUC:0.8103 Anomaly AUC:0.6125
[2023-08-22 23:18:16,906][main.py][line:85][INFO] [Epoch:4/50]: loss1:0.3042 loss2:0.9422 | AUC:0.7844 Anomaly AUC:0.5919
[2023-08-22 23:19:44,676][main.py][line:85][INFO] [Epoch:5/50]: loss1:0.2382 loss2:0.8985 | AUC:0.8111 Anomaly AUC:0.6076
[2023-08-22 23:21:03,203][main.py][line:85][INFO] [Epoch:6/50]: loss1:0.2085 loss2:0.8806 | AUC:0.7899 Anomaly AUC:0.5961
[2023-08-22 23:22:15,843][main.py][line:85][INFO] [Epoch:7/50]: loss1:0.1593 loss2:0.8428 | AUC:0.7848 Anomaly AUC:0.5910
[2023-08-22 23:23:33,089][main.py][line:85][INFO] [Epoch:8/50]: loss1:0.1393 loss2:0.8164 | AUC:0.7867 Anomaly AUC:0.5848
[2023-08-22 23:24:49,469][main.py][line:85][INFO] [Epoch:9/50]: loss1:0.1168 loss2:0.7976 | AUC:0.7988 Anomaly AUC:0.5798
[2023-08-22 23:26:14,525][main.py][line:85][INFO] [Epoch:10/50]: loss1:0.0973 loss2:0.7758 | AUC:0.7974 Anomaly AUC:0.6075
[2023-08-22 23:28:16,467][main.py][line:85][INFO] [Epoch:11/50]: loss1:0.0947 loss2:0.7753 | AUC:0.7853 Anomaly AUC:0.6025
[2023-08-22 23:29:41,136][main.py][line:85][INFO] [Epoch:12/50]: loss1:0.0694 loss2:0.7551 | AUC:0.7752 Anomaly AUC:0.5947
[2023-08-22 23:31:05,768][main.py][line:85][INFO] [Epoch:13/50]: loss1:0.0684 loss2:0.7411 | AUC:0.7741 Anomaly AUC:0.5918
[2023-08-22 23:31:58,348][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-22 23:31:58,617][main.py][line:132][INFO] total params:31.8628M
[2023-08-22 23:31:58,617][main.py][line:135][INFO] Training Mode
[2023-08-22 23:31:58,618][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-22 23:31:58,618][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-22 23:32:11,825][main.py][line:64][INFO] Random initialize AUCAUC:0.5067 Anomaly AUC:0.48278
[2023-08-22 23:33:46,364][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.5412 loss2:1.1277 | AUC:0.7916 Anomaly AUC:0.6048
[2023-08-22 23:35:22,275][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.2703 loss2:0.9359 | AUC:0.8089 Anomaly AUC:0.6005
[2023-08-22 23:36:42,478][main.py][line:85][INFO] [Epoch:3/50]: loss1:0.2175 loss2:0.8859 | AUC:0.7935 Anomaly AUC:0.5938
[2023-08-22 23:38:02,245][main.py][line:85][INFO] [Epoch:4/50]: loss1:0.1836 loss2:0.8635 | AUC:0.8129 Anomaly AUC:0.5935
[2023-08-22 23:40:15,147][main.py][line:85][INFO] [Epoch:5/50]: loss1:0.1458 loss2:0.8063 | AUC:0.8077 Anomaly AUC:0.5787
[2023-08-22 23:41:59,311][main.py][line:85][INFO] [Epoch:6/50]: loss1:0.1202 loss2:0.7640 | AUC:0.8103 Anomaly AUC:0.5900
[2023-08-22 23:43:43,548][main.py][line:85][INFO] [Epoch:7/50]: loss1:0.0936 loss2:0.7193 | AUC:0.8144 Anomaly AUC:0.5965
[2023-08-22 23:45:26,799][main.py][line:85][INFO] [Epoch:8/50]: loss1:0.0780 loss2:0.6740 | AUC:0.8097 Anomaly AUC:0.5915
[2023-08-22 23:47:03,893][main.py][line:85][INFO] [Epoch:9/50]: loss1:0.0750 loss2:0.6518 | AUC:0.8173 Anomaly AUC:0.5940
[2023-08-22 23:48:21,968][main.py][line:85][INFO] [Epoch:10/50]: loss1:0.0634 loss2:0.6219 | AUC:0.8263 Anomaly AUC:0.6016
[2023-08-22 23:50:02,215][main.py][line:85][INFO] [Epoch:11/50]: loss1:0.0519 loss2:0.5833 | AUC:0.8099 Anomaly AUC:0.5992
[2023-08-22 23:51:30,303][main.py][line:85][INFO] [Epoch:12/50]: loss1:0.0407 loss2:0.5432 | AUC:0.8100 Anomaly AUC:0.5945
[2023-08-22 23:52:37,037][main.py][line:85][INFO] [Epoch:13/50]: loss1:0.0487 loss2:0.5281 | AUC:0.8095 Anomaly AUC:0.6017
[2023-08-22 23:53:53,253][main.py][line:85][INFO] [Epoch:14/50]: loss1:0.0439 loss2:0.5056 | AUC:0.8174 Anomaly AUC:0.5920
[2023-08-22 23:54:54,500][main.py][line:85][INFO] [Epoch:15/50]: loss1:0.0352 loss2:0.4784 | AUC:0.8112 Anomaly AUC:0.5747
[2023-08-22 23:56:11,311][main.py][line:85][INFO] [Epoch:16/50]: loss1:0.0331 loss2:0.4534 | AUC:0.8087 Anomaly AUC:0.5891
[2023-08-22 23:57:36,012][main.py][line:85][INFO] [Epoch:17/50]: loss1:0.0315 loss2:0.4341 | AUC:0.8187 Anomaly AUC:0.5884
[2023-08-22 23:59:08,409][main.py][line:85][INFO] [Epoch:18/50]: loss1:0.0333 loss2:0.4212 | AUC:0.8134 Anomaly AUC:0.6090
[2023-08-23 00:00:38,588][main.py][line:85][INFO] [Epoch:19/50]: loss1:0.0277 loss2:0.4011 | AUC:0.8165 Anomaly AUC:0.5939
[2023-08-23 00:02:13,208][main.py][line:85][INFO] [Epoch:20/50]: loss1:0.0263 loss2:0.3888 | AUC:0.8157 Anomaly AUC:0.6002
[2023-08-23 00:03:30,646][main.py][line:85][INFO] [Epoch:21/50]: loss1:0.0292 loss2:0.3796 | AUC:0.8118 Anomaly AUC:0.5993
[2023-08-23 00:04:39,894][main.py][line:85][INFO] [Epoch:22/50]: loss1:0.0186 loss2:0.3502 | AUC:0.8050 Anomaly AUC:0.5947
[2023-08-23 00:05:59,675][main.py][line:85][INFO] [Epoch:23/50]: loss1:0.0256 loss2:0.3406 | AUC:0.8227 Anomaly AUC:0.6084
[2023-08-23 00:07:18,011][main.py][line:85][INFO] [Epoch:24/50]: loss1:0.0235 loss2:0.3356 | AUC:0.8147 Anomaly AUC:0.6049
[2023-08-23 00:08:30,618][main.py][line:85][INFO] [Epoch:25/50]: loss1:0.0201 loss2:0.3037 | AUC:0.8090 Anomaly AUC:0.5800
[2023-08-23 00:09:47,156][main.py][line:85][INFO] [Epoch:26/50]: loss1:0.0201 loss2:0.3108 | AUC:0.8005 Anomaly AUC:0.5900
[2023-08-23 00:11:15,618][main.py][line:85][INFO] [Epoch:27/50]: loss1:0.0186 loss2:0.2865 | AUC:0.8204 Anomaly AUC:0.5966
[2023-08-23 00:12:44,011][main.py][line:85][INFO] [Epoch:28/50]: loss1:0.0212 loss2:0.2759 | AUC:0.8215 Anomaly AUC:0.6058
[2023-08-23 00:14:05,006][main.py][line:85][INFO] [Epoch:29/50]: loss1:0.0198 loss2:0.2665 | AUC:0.8214 Anomaly AUC:0.6053
[2023-08-23 00:15:24,976][main.py][line:85][INFO] [Epoch:30/50]: loss1:0.0134 loss2:0.2578 | AUC:0.8169 Anomaly AUC:0.5932
[2023-08-23 00:17:02,227][main.py][line:85][INFO] [Epoch:31/50]: loss1:0.0134 loss2:0.2327 | AUC:0.8193 Anomaly AUC:0.5931
[2023-08-23 00:18:58,137][main.py][line:85][INFO] [Epoch:32/50]: loss1:0.0133 loss2:0.2256 | AUC:0.8156 Anomaly AUC:0.5966
[2023-08-23 00:20:23,981][main.py][line:85][INFO] [Epoch:33/50]: loss1:0.0168 loss2:0.2075 | AUC:0.8161 Anomaly AUC:0.5901
[2023-08-23 00:21:56,547][main.py][line:85][INFO] [Epoch:34/50]: loss1:0.0086 loss2:0.0711 | AUC:0.8160 Anomaly AUC:0.5937
[2023-08-23 00:23:23,267][main.py][line:85][INFO] [Epoch:35/50]: loss1:0.0204 loss2:0.2308 | AUC:0.8194 Anomaly AUC:0.5912
[2023-08-23 00:25:02,546][main.py][line:85][INFO] [Epoch:36/50]: loss1:0.0152 loss2:0.2013 | AUC:0.8104 Anomaly AUC:0.6015
[2023-08-23 00:26:28,160][main.py][line:85][INFO] [Epoch:37/50]: loss1:0.0249 loss2:0.2853 | AUC:0.8175 Anomaly AUC:0.6054
[2023-08-23 00:27:48,133][main.py][line:85][INFO] [Epoch:38/50]: loss1:0.0122 loss2:0.2486 | AUC:0.7953 Anomaly AUC:0.5811
[2023-08-23 00:29:13,234][main.py][line:85][INFO] [Epoch:39/50]: loss1:0.0146 loss2:0.2102 | AUC:0.8179 Anomaly AUC:0.5889
[2023-08-23 00:30:33,688][main.py][line:85][INFO] [Epoch:40/50]: loss1:0.0089 loss2:0.1883 | AUC:0.8056 Anomaly AUC:0.5965
[2023-08-23 00:32:03,358][main.py][line:85][INFO] [Epoch:41/50]: loss1:0.0115 loss2:0.1740 | AUC:0.8054 Anomaly AUC:0.5830
[2023-08-23 00:33:20,422][main.py][line:85][INFO] [Epoch:42/50]: loss1:0.0084 loss2:0.1403 | AUC:0.8195 Anomaly AUC:0.5893
[2023-08-23 00:34:40,794][main.py][line:85][INFO] [Epoch:43/50]: loss1:0.0067 loss2:0.0541 | AUC:0.8230 Anomaly AUC:0.5974
[2023-08-23 00:35:54,182][main.py][line:85][INFO] [Epoch:44/50]: loss1:0.0075 loss2:0.1510 | AUC:0.8173 Anomaly AUC:0.6110
[2023-08-23 00:37:27,428][main.py][line:85][INFO] [Epoch:45/50]: loss1:0.0074 loss2:0.1461 | AUC:0.8096 Anomaly AUC:0.5767
[2023-08-23 00:38:47,201][main.py][line:85][INFO] [Epoch:46/50]: loss1:0.0127 loss2:0.1416 | AUC:0.8161 Anomaly AUC:0.5889
[2023-08-23 00:40:01,160][main.py][line:85][INFO] [Epoch:47/50]: loss1:0.0073 loss2:0.1353 | AUC:0.8161 Anomaly AUC:0.5935
[2023-08-23 00:41:20,846][main.py][line:85][INFO] [Epoch:48/50]: loss1:0.0086 loss2:0.1361 | AUC:0.8192 Anomaly AUC:0.5996
[2023-08-23 00:42:51,281][main.py][line:85][INFO] [Epoch:49/50]: loss1:0.0055 loss2:0.1093 | AUC:0.8148 Anomaly AUC:0.5890
[2023-08-23 00:44:09,013][main.py][line:85][INFO] [Epoch:50/50]: loss1:0.0100 loss2:0.1236 | AUC:0.8094 Anomaly AUC:0.5883
[2023-08-23 00:44:09,099][main.py][line:93][INFO] Training completes in 71m 57s | best AUCAUC:0.8263 Anomaly AUC:0.6016

[2023-08-23 10:06:58,585][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:06:58,882][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:06:58,883][main.py][line:135][INFO] Training Mode
[2023-08-23 10:06:58,883][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-23 10:06:58,883][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:08:50,897][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:08:51,129][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:08:51,129][main.py][line:135][INFO] Training Mode
[2023-08-23 10:08:51,129][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-23 10:08:51,129][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:09:45,782][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:09:46,027][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:09:46,027][main.py][line:135][INFO] Training Mode
[2023-08-23 10:09:46,028][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-23 10:09:46,028][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:10:41,492][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:10:41,727][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:10:41,727][main.py][line:135][INFO] Training Mode
[2023-08-23 10:10:41,728][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-23 10:10:41,728][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:11:09,362][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:11:09,608][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:11:09,608][main.py][line:135][INFO] Training Mode
[2023-08-23 10:11:09,609][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-23 10:11:09,609][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:12:31,546][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:12:31,795][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:12:31,795][main.py][line:135][INFO] Training Mode
[2023-08-23 10:12:31,796][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-23 10:12:31,796][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:14:20,618][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:14:20,859][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:14:20,859][main.py][line:135][INFO] Training Mode
[2023-08-23 10:14:20,859][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-23 10:14:20,859][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:16:04,560][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:16:04,806][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:16:04,806][main.py][line:135][INFO] Training Mode
[2023-08-23 10:16:04,806][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-23 10:16:04,806][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:16:31,855][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:16:32,097][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:16:32,097][main.py][line:135][INFO] Training Mode
[2023-08-23 10:16:32,098][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-23 10:16:32,098][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:19:55,155][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:19:55,395][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:19:55,395][main.py][line:135][INFO] Training Mode
[2023-08-23 10:19:55,395][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-23 10:19:55,395][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:20:04,091][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 10:22:33,987][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:22:34,221][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:22:34,221][main.py][line:135][INFO] Training Mode
[2023-08-23 10:22:34,222][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-23 10:22:34,222][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:22:42,829][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 10:24:19,101][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:24:19,336][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:24:19,336][main.py][line:135][INFO] Training Mode
[2023-08-23 10:24:19,337][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-23 10:24:19,337][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:24:27,869][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 10:26:51,283][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:26:51,535][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:26:51,535][main.py][line:135][INFO] Training Mode
[2023-08-23 10:26:51,536][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-23 10:26:51,536][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:26:59,734][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 10:32:25,830][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:32:26,072][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:32:26,072][main.py][line:135][INFO] Training Mode
[2023-08-23 10:32:26,073][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 10:32:26,073][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:32:34,639][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 10:35:36,168][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:35:36,415][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:35:36,415][main.py][line:135][INFO] Training Mode
[2023-08-23 10:35:36,415][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 10:35:36,415][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:35:44,579][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 10:38:08,768][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:38:09,007][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:38:09,007][main.py][line:135][INFO] Training Mode
[2023-08-23 10:38:09,007][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 10:38:09,007][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:38:17,201][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 10:43:15,165][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:43:15,412][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:43:15,412][main.py][line:135][INFO] Training Mode
[2023-08-23 10:43:15,412][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 10:43:15,413][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:43:24,019][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 10:46:50,178][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 10:46:50,423][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 10:46:50,423][main.py][line:135][INFO] Training Mode
[2023-08-23 10:46:50,423][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 10:46:50,423][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 10:46:59,011][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:10:03,009][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:10:03,265][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 11:10:03,265][main.py][line:135][INFO] Training Mode
[2023-08-23 11:10:03,266][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:10:03,266][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:10:11,808][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:12:56,387][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:12:56,632][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 11:12:56,632][main.py][line:135][INFO] Training Mode
[2023-08-23 11:12:56,633][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:12:56,633][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:13:04,835][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:20:38,261][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:20:38,518][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 11:20:38,518][main.py][line:135][INFO] Training Mode
[2023-08-23 11:20:38,519][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:20:38,519][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:20:46,756][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:21:32,733][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:21:32,988][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 11:21:32,988][main.py][line:135][INFO] Training Mode
[2023-08-23 11:21:32,989][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:21:32,989][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:21:41,271][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:24:28,950][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:24:29,194][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 11:24:29,194][main.py][line:135][INFO] Training Mode
[2023-08-23 11:24:29,195][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:24:29,195][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:24:37,661][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:31:52,042][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:31:52,270][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 11:31:52,270][main.py][line:135][INFO] Training Mode
[2023-08-23 11:31:52,271][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:31:52,271][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:32:00,562][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:34:01,706][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:34:01,953][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 11:34:01,953][main.py][line:135][INFO] Training Mode
[2023-08-23 11:34:01,954][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:34:01,954][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:34:10,457][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:36:08,660][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:36:08,893][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 11:36:08,893][main.py][line:135][INFO] Training Mode
[2023-08-23 11:36:08,893][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:36:08,894][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:36:17,379][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:42:35,070][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:42:35,313][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 11:42:35,313][main.py][line:135][INFO] Training Mode
[2023-08-23 11:42:35,314][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:42:35,314][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:42:43,788][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:47:41,027][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:47:41,271][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 11:47:41,271][main.py][line:135][INFO] Training Mode
[2023-08-23 11:47:41,272][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:47:41,272][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:47:49,881][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:48:29,948][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:48:30,196][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 11:48:30,196][main.py][line:135][INFO] Training Mode
[2023-08-23 11:48:30,197][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:48:30,197][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:48:38,731][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:51:56,260][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:51:56,494][main.py][line:135][INFO] total params:31.8628M
[2023-08-23 11:51:56,494][main.py][line:138][INFO] Training Mode
[2023-08-23 11:51:56,494][main.py][line:63][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:51:56,494][main.py][line:64][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:52:06,355][main.py][line:67][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:55:17,139][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:55:17,386][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 11:55:17,386][main.py][line:135][INFO] Training Mode
[2023-08-23 11:55:17,387][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:55:17,387][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:55:26,168][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 11:58:47,480][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 11:58:47,725][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 11:58:47,725][main.py][line:135][INFO] Training Mode
[2023-08-23 11:58:47,725][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 11:58:47,725][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 11:58:56,265][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 12:00:04,864][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:00:05,099][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 12:00:05,099][main.py][line:135][INFO] Training Mode
[2023-08-23 12:00:05,099][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:00:05,099][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:00:13,590][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 12:04:31,253][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:04:31,492][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 12:04:31,492][main.py][line:135][INFO] Training Mode
[2023-08-23 12:04:31,493][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:04:31,493][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:04:40,534][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 12:05:01,328][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:05:01,565][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 12:05:01,565][main.py][line:135][INFO] Training Mode
[2023-08-23 12:05:01,566][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:05:01,566][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:05:09,693][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 12:05:50,111][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:05:50,355][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 12:05:50,355][main.py][line:135][INFO] Training Mode
[2023-08-23 12:05:50,355][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:05:50,355][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:05:59,114][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 12:06:50,819][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:06:51,065][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 12:06:51,065][main.py][line:135][INFO] Training Mode
[2023-08-23 12:06:51,065][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:06:51,065][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:06:59,815][main.py][line:64][INFO] Random initialize AUCAUC:0.5079 Anomaly AUC:0.48225
[2023-08-23 12:09:02,390][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:09:02,643][main.py][line:132][INFO] total params:31.8628M
[2023-08-23 12:09:02,643][main.py][line:135][INFO] Training Mode
[2023-08-23 12:09:02,644][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 384, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:09:02,644][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:09:11,086][main.py][line:64][INFO] Random initialize AUCAUC:0.5087 Anomaly AUC:0.51898
[2023-08-23 12:10:44,562][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:10:44,798][main.py][line:132][INFO] total params:31.7625M
[2023-08-23 12:10:44,798][main.py][line:135][INFO] Training Mode
[2023-08-23 12:10:44,799][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:10:44,799][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:10:54,132][main.py][line:64][INFO] Random initialize AUCAUC:0.4951 Anomaly AUC:0.42579
[2023-08-23 12:10:59,539][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:10:59,771][main.py][line:132][INFO] total params:31.7625M
[2023-08-23 12:10:59,771][main.py][line:135][INFO] Training Mode
[2023-08-23 12:10:59,772][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:10:59,772][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:11:08,888][main.py][line:64][INFO] Random initialize AUCAUC:0.4951 Anomaly AUC:0.42579
[2023-08-23 12:11:36,721][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:11:36,963][main.py][line:132][INFO] total params:31.7625M
[2023-08-23 12:11:36,963][main.py][line:135][INFO] Training Mode
[2023-08-23 12:11:36,964][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:11:36,964][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:11:41,814][main.py][line:64][INFO] Random initialize AUCAUC:0.5380 Anomaly AUC:0.46431
[2023-08-23 12:12:05,777][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:12:06,029][main.py][line:132][INFO] total params:31.7625M
[2023-08-23 12:12:06,029][main.py][line:135][INFO] Training Mode
[2023-08-23 12:12:06,030][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:12:06,030][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:12:11,423][main.py][line:64][INFO] Random initialize AUCAUC:0.5380 Anomaly AUC:0.46431
[2023-08-23 12:12:37,125][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:12:37,370][main.py][line:132][INFO] total params:31.7625M
[2023-08-23 12:12:37,370][main.py][line:135][INFO] Training Mode
[2023-08-23 12:12:37,371][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:12:37,371][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:12:42,273][main.py][line:64][INFO] Random initialize AUCAUC:0.5380 Anomaly AUC:0.46431
[2023-08-23 12:23:56,160][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:23:56,408][main.py][line:132][INFO] total params:31.7625M
[2023-08-23 12:23:56,408][main.py][line:135][INFO] Training Mode
[2023-08-23 12:23:56,408][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:23:56,408][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:24:01,098][main.py][line:64][INFO] Random initialize AUCAUC:0.5380 Anomaly AUC:0.46431
[2023-08-23 12:27:00,188][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:27:00,430][main.py][line:132][INFO] total params:31.7625M
[2023-08-23 12:27:00,430][main.py][line:135][INFO] Training Mode
[2023-08-23 12:27:00,431][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:27:00,431][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:27:06,007][main.py][line:64][INFO] Random initialize AUCAUC:0.5380 Anomaly AUC:0.46431
[2023-08-23 12:28:49,289][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:28:49,536][main.py][line:132][INFO] total params:31.7625M
[2023-08-23 12:28:49,536][main.py][line:135][INFO] Training Mode
[2023-08-23 12:28:49,537][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:28:49,537][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:28:54,246][main.py][line:64][INFO] Random initialize AUCAUC:0.5380 Anomaly AUC:0.46431
[2023-08-23 12:29:22,118][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:29:22,359][main.py][line:132][INFO] total params:31.7625M
[2023-08-23 12:29:22,359][main.py][line:135][INFO] Training Mode
[2023-08-23 12:29:22,360][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:29:22,360][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:29:27,116][main.py][line:64][INFO] Random initialize AUCAUC:0.5380 Anomaly AUC:0.46431
[2023-08-23 12:30:20,465][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.3283 loss2:0.9883 | AUC:0.8307 Anomaly AUC:0.6599
[2023-08-23 12:31:15,326][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.1163 loss2:0.7613 | AUC:0.8246 Anomaly AUC:0.6487
[2023-08-23 12:32:26,361][main.py][line:85][INFO] [Epoch:3/50]: loss1:0.0523 loss2:0.6460 | AUC:0.8289 Anomaly AUC:0.6505
[2023-08-23 12:33:11,522][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:33:11,786][main.py][line:132][INFO] total params:31.7625M
[2023-08-23 12:33:11,787][main.py][line:135][INFO] Training Mode
[2023-08-23 12:33:11,787][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:33:11,788][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:33:18,862][main.py][line:64][INFO] Random initialize AUCAUC:0.5380 Anomaly AUC:0.46431
[2023-08-23 12:33:42,574][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 12:33:42,827][main.py][line:132][INFO] total params:31.7625M
[2023-08-23 12:33:42,827][main.py][line:135][INFO] Training Mode
[2023-08-23 12:33:42,827][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 12:33:42,827][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 12:33:54,789][main.py][line:64][INFO] Random initialize AUCAUC:0.4951 Anomaly AUC:0.42579
[2023-08-23 12:35:11,550][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.4526 loss2:1.0572 | AUC:0.8180 Anomaly AUC:0.6408
[2023-08-23 12:36:24,419][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.2722 loss2:0.9257 | AUC:0.8366 Anomaly AUC:0.6615
[2023-08-23 12:37:55,188][main.py][line:85][INFO] [Epoch:3/50]: loss1:0.2043 loss2:0.8762 | AUC:0.8234 Anomaly AUC:0.6336
[2023-08-23 12:39:09,427][main.py][line:85][INFO] [Epoch:4/50]: loss1:0.1645 loss2:0.8418 | AUC:0.8253 Anomaly AUC:0.6332
[2023-08-23 12:40:57,322][main.py][line:85][INFO] [Epoch:5/50]: loss1:0.1287 loss2:0.8114 | AUC:0.8349 Anomaly AUC:0.6591
[2023-08-23 12:42:35,077][main.py][line:85][INFO] [Epoch:6/50]: loss1:0.1156 loss2:0.7760 | AUC:0.8441 Anomaly AUC:0.6770
[2023-08-23 12:44:26,024][main.py][line:85][INFO] [Epoch:7/50]: loss1:0.0994 loss2:0.7288 | AUC:0.8364 Anomaly AUC:0.6547
[2023-08-23 12:45:59,181][main.py][line:85][INFO] [Epoch:8/50]: loss1:0.0926 loss2:0.6939 | AUC:0.8418 Anomaly AUC:0.6545
[2023-08-23 12:47:22,424][main.py][line:85][INFO] [Epoch:9/50]: loss1:0.0805 loss2:0.6599 | AUC:0.8440 Anomaly AUC:0.6691
[2023-08-23 12:48:40,623][main.py][line:85][INFO] [Epoch:10/50]: loss1:0.0656 loss2:0.6315 | AUC:0.8363 Anomaly AUC:0.6521
[2023-08-23 12:50:27,315][main.py][line:85][INFO] [Epoch:11/50]: loss1:0.0680 loss2:0.6213 | AUC:0.8292 Anomaly AUC:0.6376
[2023-08-23 12:51:39,829][main.py][line:85][INFO] [Epoch:12/50]: loss1:0.0545 loss2:0.5922 | AUC:0.8441 Anomaly AUC:0.6534
[2023-08-23 12:53:16,843][main.py][line:85][INFO] [Epoch:13/50]: loss1:0.0456 loss2:0.5663 | AUC:0.8385 Anomaly AUC:0.6509
[2023-08-23 12:55:01,404][main.py][line:85][INFO] [Epoch:14/50]: loss1:0.0468 loss2:0.5530 | AUC:0.8316 Anomaly AUC:0.6464
[2023-08-23 12:56:07,298][main.py][line:85][INFO] [Epoch:15/50]: loss1:0.0422 loss2:0.5420 | AUC:0.8251 Anomaly AUC:0.6524
[2023-08-23 12:57:46,729][main.py][line:85][INFO] [Epoch:16/50]: loss1:0.0381 loss2:0.5264 | AUC:0.8348 Anomaly AUC:0.6513
[2023-08-23 12:59:36,446][main.py][line:85][INFO] [Epoch:17/50]: loss1:0.0364 loss2:0.5150 | AUC:0.8113 Anomaly AUC:0.6403
[2023-08-23 13:01:04,218][main.py][line:85][INFO] [Epoch:18/50]: loss1:0.0349 loss2:0.4926 | AUC:0.8391 Anomaly AUC:0.6511
[2023-08-23 13:03:32,343][main.py][line:85][INFO] [Epoch:19/50]: loss1:0.0253 loss2:0.2780 | AUC:0.8063 Anomaly AUC:0.6414
[2023-08-23 13:04:57,617][main.py][line:85][INFO] [Epoch:20/50]: loss1:0.0422 loss2:0.4752 | AUC:0.7996 Anomaly AUC:0.6305
[2023-08-23 13:06:25,599][main.py][line:85][INFO] [Epoch:21/50]: loss1:0.0304 loss2:0.4516 | AUC:0.8195 Anomaly AUC:0.6405
[2023-08-23 13:07:55,798][main.py][line:85][INFO] [Epoch:22/50]: loss1:0.0257 loss2:0.4317 | AUC:0.8308 Anomaly AUC:0.6484
[2023-08-23 13:09:32,449][main.py][line:85][INFO] [Epoch:23/50]: loss1:0.0250 loss2:0.4057 | AUC:0.8264 Anomaly AUC:0.6323
[2023-08-23 13:10:06,477][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 13:10:06,751][main.py][line:132][INFO] total params:31.7625M
[2023-08-23 13:10:06,751][main.py][line:135][INFO] Training Mode
[2023-08-23 13:10:06,752][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 13:10:06,752][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 13:10:15,831][main.py][line:64][INFO] Random initialize AUCAUC:0.4951 Anomaly AUC:0.42579
[2023-08-23 13:11:46,964][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.4526 loss2:1.0572 | AUC:0.8180 Anomaly AUC:0.6408
[2023-08-23 13:13:05,615][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.2778 loss2:0.9282 | AUC:0.8294 Anomaly AUC:0.6475
[2023-08-23 13:14:22,539][main.py][line:85][INFO] [Epoch:3/50]: loss1:0.2129 loss2:0.8841 | AUC:0.8240 Anomaly AUC:0.6346
[2023-08-23 13:15:31,022][main.py][line:85][INFO] [Epoch:4/50]: loss1:0.1666 loss2:0.8454 | AUC:0.8332 Anomaly AUC:0.6453
[2023-08-23 13:16:40,233][main.py][line:85][INFO] [Epoch:5/50]: loss1:0.1250 loss2:0.8134 | AUC:0.8363 Anomaly AUC:0.6453
[2023-08-23 13:17:44,651][main.py][line:85][INFO] [Epoch:6/50]: loss1:0.1053 loss2:0.7923 | AUC:0.8232 Anomaly AUC:0.6744
[2023-08-23 13:18:53,995][main.py][line:85][INFO] [Epoch:7/50]: loss1:0.1172 loss2:0.7657 | AUC:0.8442 Anomaly AUC:0.6587
[2023-08-23 13:20:05,850][main.py][line:85][INFO] [Epoch:8/50]: loss1:0.0858 loss2:0.7160 | AUC:0.8338 Anomaly AUC:0.6486
[2023-08-23 13:21:29,042][main.py][line:85][INFO] [Epoch:9/50]: loss1:0.0766 loss2:0.6784 | AUC:0.8239 Anomaly AUC:0.6378
[2023-08-23 13:23:05,838][main.py][line:85][INFO] [Epoch:10/50]: loss1:0.0644 loss2:0.6510 | AUC:0.8432 Anomaly AUC:0.6679
[2023-08-23 13:24:13,376][main.py][line:85][INFO] [Epoch:11/50]: loss1:0.0476 loss2:0.6195 | AUC:0.8442 Anomaly AUC:0.6706
[2023-08-23 13:25:26,818][main.py][line:85][INFO] [Epoch:12/50]: loss1:0.0492 loss2:0.6079 | AUC:0.8376 Anomaly AUC:0.6736
[2023-08-23 13:26:51,107][main.py][line:85][INFO] [Epoch:13/50]: loss1:0.0382 loss2:0.5744 | AUC:0.8380 Anomaly AUC:0.6636
[2023-08-23 13:28:10,854][main.py][line:85][INFO] [Epoch:14/50]: loss1:0.0346 loss2:0.5567 | AUC:0.8439 Anomaly AUC:0.6841
[2023-08-23 13:29:11,713][main.py][line:85][INFO] [Epoch:15/50]: loss1:0.0294 loss2:0.5388 | AUC:0.8498 Anomaly AUC:0.6777
[2023-08-23 13:30:31,014][main.py][line:85][INFO] [Epoch:16/50]: loss1:0.0283 loss2:0.5247 | AUC:0.8266 Anomaly AUC:0.6517
[2023-08-23 13:32:05,880][main.py][line:85][INFO] [Epoch:17/50]: loss1:0.0210 loss2:0.4944 | AUC:0.8152 Anomaly AUC:0.6501
[2023-08-23 13:33:13,962][main.py][line:85][INFO] [Epoch:18/50]: loss1:0.0313 loss2:0.4869 | AUC:0.8319 Anomaly AUC:0.6466
[2023-08-23 13:34:20,211][main.py][line:85][INFO] [Epoch:19/50]: loss1:0.0229 loss2:0.4618 | AUC:0.8498 Anomaly AUC:0.6691
[2023-08-23 13:35:35,425][main.py][line:85][INFO] [Epoch:20/50]: loss1:0.0221 loss2:0.4330 | AUC:0.8399 Anomaly AUC:0.6739
[2023-08-23 13:36:46,010][main.py][line:85][INFO] [Epoch:21/50]: loss1:0.0222 loss2:0.4139 | AUC:0.8318 Anomaly AUC:0.6580
[2023-08-23 13:37:55,925][main.py][line:85][INFO] [Epoch:22/50]: loss1:0.0184 loss2:0.3837 | AUC:0.8477 Anomaly AUC:0.6728
[2023-08-23 13:39:09,798][main.py][line:85][INFO] [Epoch:23/50]: loss1:0.0124 loss2:0.3497 | AUC:0.8264 Anomaly AUC:0.6485
[2023-08-23 13:40:29,734][main.py][line:85][INFO] [Epoch:24/50]: loss1:0.0110 loss2:0.3362 | AUC:0.8343 Anomaly AUC:0.6653
[2023-08-23 13:42:10,623][main.py][line:85][INFO] [Epoch:25/50]: loss1:0.0096 loss2:0.3059 | AUC:0.8345 Anomaly AUC:0.6562
[2023-08-23 13:43:06,282][main.py][line:85][INFO] [Epoch:26/50]: loss1:0.0104 loss2:0.2847 | AUC:0.8344 Anomaly AUC:0.6700
[2023-08-23 13:44:33,177][main.py][line:85][INFO] [Epoch:27/50]: loss1:0.0115 loss2:0.2725 | AUC:0.8512 Anomaly AUC:0.6789
[2023-08-23 13:46:16,422][main.py][line:85][INFO] [Epoch:28/50]: loss1:0.0123 loss2:0.2452 | AUC:0.8466 Anomaly AUC:0.6736
[2023-08-23 13:47:17,125][main.py][line:85][INFO] [Epoch:29/50]: loss1:0.0117 loss2:0.2375 | AUC:0.8418 Anomaly AUC:0.6663
[2023-08-23 13:48:36,918][main.py][line:85][INFO] [Epoch:30/50]: loss1:0.0099 loss2:0.2187 | AUC:0.8402 Anomaly AUC:0.6589
[2023-08-23 13:49:56,139][main.py][line:85][INFO] [Epoch:31/50]: loss1:0.0085 loss2:0.1983 | AUC:0.8397 Anomaly AUC:0.6612
[2023-08-23 13:51:07,655][main.py][line:85][INFO] [Epoch:32/50]: loss1:0.0065 loss2:0.1808 | AUC:0.8462 Anomaly AUC:0.6696
[2023-08-23 13:52:14,641][main.py][line:85][INFO] [Epoch:33/50]: loss1:0.0043 loss2:0.1559 | AUC:0.8479 Anomaly AUC:0.6716
[2023-08-23 13:53:27,379][main.py][line:85][INFO] [Epoch:34/50]: loss1:0.0031 loss2:0.1447 | AUC:0.8418 Anomaly AUC:0.6602
[2023-08-23 13:54:24,310][main.py][line:85][INFO] [Epoch:35/50]: loss1:0.0059 loss2:0.1420 | AUC:0.8435 Anomaly AUC:0.6685
[2023-08-23 13:55:30,669][main.py][line:85][INFO] [Epoch:36/50]: loss1:0.0058 loss2:0.1289 | AUC:0.8468 Anomaly AUC:0.6704
[2023-08-23 13:56:31,910][main.py][line:85][INFO] [Epoch:37/50]: loss1:0.0055 loss2:0.1129 | AUC:0.8418 Anomaly AUC:0.6676
[2023-08-23 13:57:41,121][main.py][line:85][INFO] [Epoch:38/50]: loss1:0.0032 loss2:0.1036 | AUC:0.8449 Anomaly AUC:0.6675
[2023-08-23 13:59:12,671][main.py][line:85][INFO] [Epoch:39/50]: loss1:0.0024 loss2:0.0925 | AUC:0.8491 Anomaly AUC:0.6774
[2023-08-23 14:00:13,325][main.py][line:85][INFO] [Epoch:40/50]: loss1:0.0034 loss2:0.0860 | AUC:0.8457 Anomaly AUC:0.6706
[2023-08-23 14:01:55,067][main.py][line:85][INFO] [Epoch:41/50]: loss1:0.0023 loss2:0.0746 | AUC:0.8460 Anomaly AUC:0.6723
[2023-08-23 14:02:56,796][main.py][line:85][INFO] [Epoch:42/50]: loss1:0.0016 loss2:0.0639 | AUC:0.8456 Anomaly AUC:0.6729
[2023-08-23 14:04:00,223][main.py][line:85][INFO] [Epoch:43/50]: loss1:0.0013 loss2:0.0508 | AUC:0.8391 Anomaly AUC:0.6632
[2023-08-23 14:05:12,322][main.py][line:85][INFO] [Epoch:44/50]: loss1:0.0015 loss2:0.0490 | AUC:0.8442 Anomaly AUC:0.6674
[2023-08-23 14:06:15,939][main.py][line:85][INFO] [Epoch:45/50]: loss1:0.0017 loss2:0.0446 | AUC:0.8456 Anomaly AUC:0.6713
[2023-08-23 14:07:31,933][main.py][line:85][INFO] [Epoch:46/50]: loss1:0.0014 loss2:0.0397 | AUC:0.8447 Anomaly AUC:0.6700
[2023-08-23 14:09:02,415][main.py][line:85][INFO] [Epoch:47/50]: loss1:0.0013 loss2:0.0356 | AUC:0.8440 Anomaly AUC:0.6672
[2023-08-23 14:10:06,756][main.py][line:85][INFO] [Epoch:48/50]: loss1:0.0015 loss2:0.0316 | AUC:0.8445 Anomaly AUC:0.6697
[2023-08-23 14:11:11,127][main.py][line:85][INFO] [Epoch:49/50]: loss1:0.0011 loss2:0.0291 | AUC:0.8474 Anomaly AUC:0.6714
[2023-08-23 14:12:19,293][main.py][line:85][INFO] [Epoch:50/50]: loss1:0.0008 loss2:0.0256 | AUC:0.8443 Anomaly AUC:0.6707
[2023-08-23 14:12:19,384][main.py][line:93][INFO] Training completes in 62m 3s | best AUCAUC:0.8512 Anomaly AUC:0.6789

[2023-08-23 14:13:29,131][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 14:13:29,390][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 14:13:44,779][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 14:13:45,011][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 14:13:45,011][main.py][line:139][INFO] Test Mode
[2023-08-23 14:13:45,012][main.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-08-23 14:14:01,094][infer.py][line:47][INFO] offline AUC:0.4178 AP:0.0605 FAR:0.7759 | Complete in 0m 16s

[2023-08-23 14:14:48,685][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 14:14:48,909][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 14:14:48,909][main.py][line:139][INFO] Test Mode
[2023-08-23 14:14:48,909][main.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8512.pkl.
[2023-08-23 14:14:48,946][main.py][line:40][INFO] self_attention.concat.weight not found in model dict.
[2023-08-23 14:14:48,946][main.py][line:40][INFO] self_attention.concat.bias not found in model dict.
[2023-08-23 14:15:03,775][infer.py][line:47][INFO] offline AUC:0.8500 AP:0.2825 FAR:0.0082 | Complete in 0m 15s

[2023-08-23 14:16:38,631][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'fixed', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 14:16:38,854][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 14:16:38,854][main.py][line:135][INFO] Training Mode
[2023-08-23 14:16:38,854][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 14:16:38,855][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 14:16:52,109][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 14:18:13,198][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.7414 loss2:1.2705 | AUC:0.7595 Anomaly AUC:0.5646
[2023-08-23 14:19:18,785][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.3728 loss2:1.0045 | AUC:0.8189 Anomaly AUC:0.6231
[2023-08-23 14:20:32,242][main.py][line:85][INFO] [Epoch:3/50]: loss1:0.2502 loss2:0.9108 | AUC:0.7978 Anomaly AUC:0.5998
[2023-08-23 14:21:43,481][main.py][line:85][INFO] [Epoch:4/50]: loss1:0.1882 loss2:0.8702 | AUC:0.8226 Anomaly AUC:0.6137
[2023-08-23 14:23:00,682][main.py][line:85][INFO] [Epoch:5/50]: loss1:0.1474 loss2:0.8428 | AUC:0.7908 Anomaly AUC:0.5421
[2023-08-23 14:23:14,385][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 14:23:14,643][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 14:23:14,643][main.py][line:135][INFO] Training Mode
[2023-08-23 14:23:14,644][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 14:23:14,644][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 14:23:28,424][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 14:24:36,718][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.7414 loss2:1.2705 | AUC:0.7595 Anomaly AUC:0.5646
[2023-08-23 14:25:42,490][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.3728 loss2:1.0045 | AUC:0.8189 Anomaly AUC:0.6231
[2023-08-23 14:26:43,646][main.py][line:85][INFO] [Epoch:3/50]: loss1:0.2502 loss2:0.9108 | AUC:0.7978 Anomaly AUC:0.5998
[2023-08-23 14:27:46,418][main.py][line:85][INFO] [Epoch:4/50]: loss1:0.1882 loss2:0.8702 | AUC:0.8226 Anomaly AUC:0.6137
[2023-08-23 14:28:59,735][main.py][line:85][INFO] [Epoch:5/50]: loss1:0.1474 loss2:0.8428 | AUC:0.7908 Anomaly AUC:0.5421
[2023-08-23 14:30:25,092][main.py][line:85][INFO] [Epoch:6/50]: loss1:0.1164 loss2:0.8120 | AUC:0.8317 Anomaly AUC:0.6236
[2023-08-23 14:32:01,516][main.py][line:85][INFO] [Epoch:7/50]: loss1:0.0924 loss2:0.7898 | AUC:0.8393 Anomaly AUC:0.6325
[2023-08-23 14:33:27,178][main.py][line:85][INFO] [Epoch:8/50]: loss1:0.0729 loss2:0.7697 | AUC:0.7842 Anomaly AUC:0.5910
[2023-08-23 14:35:08,850][main.py][line:85][INFO] [Epoch:9/50]: loss1:0.0728 loss2:0.7678 | AUC:0.8355 Anomaly AUC:0.6372
[2023-08-23 14:37:09,837][main.py][line:85][INFO] [Epoch:10/50]: loss1:0.0629 loss2:0.7566 | AUC:0.8112 Anomaly AUC:0.6096
[2023-08-23 14:38:29,233][main.py][line:85][INFO] [Epoch:11/50]: loss1:0.0609 loss2:0.7588 | AUC:0.8278 Anomaly AUC:0.6081
[2023-08-23 14:39:23,489][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 14:39:23,740][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 14:39:23,740][main.py][line:135][INFO] Training Mode
[2023-08-23 14:39:23,741][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 14:39:23,741][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 14:39:36,640][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 14:41:05,002][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.7414 loss2:1.2705 | AUC:0.7595 Anomaly AUC:0.5646
[2023-08-23 14:41:09,287][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 14:41:09,523][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 14:41:09,523][main.py][line:135][INFO] Training Mode
[2023-08-23 14:41:09,524][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 14:41:09,524][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 14:41:23,437][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 14:42:43,246][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.7414 loss2:1.2705 | AUC:0.7595 Anomaly AUC:0.5646
[2023-08-23 14:44:06,145][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.3728 loss2:1.0045 | AUC:0.8189 Anomaly AUC:0.6231
[2023-08-23 14:45:21,723][main.py][line:85][INFO] [Epoch:3/50]: loss1:0.2502 loss2:0.9108 | AUC:0.7978 Anomaly AUC:0.5998
[2023-08-23 14:46:32,399][main.py][line:85][INFO] [Epoch:4/50]: loss1:0.1882 loss2:0.8702 | AUC:0.8226 Anomaly AUC:0.6137
[2023-08-23 14:48:14,898][main.py][line:85][INFO] [Epoch:5/50]: loss1:0.1474 loss2:0.8428 | AUC:0.7908 Anomaly AUC:0.5421
[2023-08-23 14:49:35,639][main.py][line:85][INFO] [Epoch:6/50]: loss1:0.1164 loss2:0.8120 | AUC:0.8317 Anomaly AUC:0.6236
[2023-08-23 14:52:01,255][main.py][line:85][INFO] [Epoch:7/50]: loss1:0.0924 loss2:0.7898 | AUC:0.8393 Anomaly AUC:0.6325
[2023-08-23 14:53:26,457][main.py][line:85][INFO] [Epoch:8/50]: loss1:0.0729 loss2:0.7697 | AUC:0.7842 Anomaly AUC:0.5910
[2023-08-23 14:55:47,959][main.py][line:85][INFO] [Epoch:9/50]: loss1:0.0728 loss2:0.7678 | AUC:0.8355 Anomaly AUC:0.6372
[2023-08-23 14:58:05,882][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 14:58:06,141][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 14:58:06,141][main.py][line:135][INFO] Training Mode
[2023-08-23 14:58:06,142][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 14:58:06,142][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 14:58:19,764][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 14:59:37,099][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.7414 loss2:1.2705 | AUC:0.7595 Anomaly AUC:0.5646
[2023-08-23 15:00:54,988][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.3728 loss2:1.0045 | AUC:0.8189 Anomaly AUC:0.6231
[2023-08-23 15:02:09,035][main.py][line:85][INFO] [Epoch:3/50]: loss1:0.2502 loss2:0.9108 | AUC:0.7978 Anomaly AUC:0.5998
[2023-08-23 15:03:33,805][main.py][line:85][INFO] [Epoch:4/50]: loss1:0.1882 loss2:0.8702 | AUC:0.8226 Anomaly AUC:0.6137
[2023-08-23 15:05:10,986][main.py][line:85][INFO] [Epoch:5/50]: loss1:0.1474 loss2:0.8428 | AUC:0.7908 Anomaly AUC:0.5421
[2023-08-23 15:06:36,724][main.py][line:85][INFO] [Epoch:6/50]: loss1:0.1164 loss2:0.8120 | AUC:0.8317 Anomaly AUC:0.6236
[2023-08-23 15:08:07,176][main.py][line:85][INFO] [Epoch:7/50]: loss1:0.0924 loss2:0.7898 | AUC:0.8393 Anomaly AUC:0.6325
[2023-08-23 15:09:32,420][main.py][line:85][INFO] [Epoch:8/50]: loss1:0.0729 loss2:0.7697 | AUC:0.7842 Anomaly AUC:0.5910
[2023-08-23 15:10:55,325][main.py][line:85][INFO] [Epoch:9/50]: loss1:0.0728 loss2:0.7678 | AUC:0.8355 Anomaly AUC:0.6372
[2023-08-23 15:12:34,651][main.py][line:85][INFO] [Epoch:10/50]: loss1:0.0629 loss2:0.7566 | AUC:0.8112 Anomaly AUC:0.6096
[2023-08-23 15:13:50,979][main.py][line:85][INFO] [Epoch:11/50]: loss1:0.0609 loss2:0.7588 | AUC:0.8278 Anomaly AUC:0.6081
[2023-08-23 15:15:15,086][main.py][line:85][INFO] [Epoch:12/50]: loss1:0.0496 loss2:0.7422 | AUC:0.8112 Anomaly AUC:0.6022
[2023-08-23 15:16:40,944][main.py][line:85][INFO] [Epoch:13/50]: loss1:0.0677 loss2:0.7713 | AUC:0.8355 Anomaly AUC:0.6253
[2023-08-23 15:18:22,819][main.py][line:85][INFO] [Epoch:14/50]: loss1:0.0390 loss2:0.7396 | AUC:0.8016 Anomaly AUC:0.5937
[2023-08-23 15:19:46,870][main.py][line:85][INFO] [Epoch:15/50]: loss1:0.0420 loss2:0.7513 | AUC:0.8110 Anomaly AUC:0.5968
[2023-08-23 15:21:30,291][main.py][line:85][INFO] [Epoch:16/50]: loss1:0.0263 loss2:0.7251 | AUC:0.8300 Anomaly AUC:0.6094
[2023-08-23 15:22:53,225][main.py][line:85][INFO] [Epoch:17/50]: loss1:0.0236 loss2:0.7098 | AUC:0.8053 Anomaly AUC:0.5769
[2023-08-23 15:24:14,938][main.py][line:85][INFO] [Epoch:18/50]: loss1:0.0297 loss2:0.7117 | AUC:0.8250 Anomaly AUC:0.5884
[2023-08-23 15:25:32,612][main.py][line:85][INFO] [Epoch:19/50]: loss1:0.0257 loss2:0.7024 | AUC:0.8412 Anomaly AUC:0.6078
[2023-08-23 15:27:00,561][main.py][line:85][INFO] [Epoch:20/50]: loss1:0.0255 loss2:0.6906 | AUC:0.8223 Anomaly AUC:0.6047
[2023-08-23 15:28:22,015][main.py][line:85][INFO] [Epoch:21/50]: loss1:0.0230 loss2:0.6824 | AUC:0.8290 Anomaly AUC:0.5963
[2023-08-23 15:29:54,073][main.py][line:85][INFO] [Epoch:22/50]: loss1:0.0203 loss2:0.6693 | AUC:0.8228 Anomaly AUC:0.6165
[2023-08-23 15:31:24,484][main.py][line:85][INFO] [Epoch:23/50]: loss1:0.0218 loss2:0.6599 | AUC:0.8451 Anomaly AUC:0.6176
[2023-08-23 15:31:40,196][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 15:31:40,464][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 15:31:40,464][main.py][line:135][INFO] Training Mode
[2023-08-23 15:31:40,465][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 15:31:40,465][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 15:31:56,249][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 15:33:26,170][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.7414 loss2:1.2705 | AUC:0.7595 Anomaly AUC:0.5646
[2023-08-23 15:34:42,227][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.3728 loss2:1.0045 | AUC:0.8189 Anomaly AUC:0.6231
[2023-08-23 15:35:57,787][main.py][line:85][INFO] [Epoch:3/50]: loss1:0.2502 loss2:0.9108 | AUC:0.7978 Anomaly AUC:0.5998
[2023-08-23 15:37:05,094][main.py][line:85][INFO] [Epoch:4/50]: loss1:0.1882 loss2:0.8702 | AUC:0.8226 Anomaly AUC:0.6137
[2023-08-23 15:38:14,966][main.py][line:85][INFO] [Epoch:5/50]: loss1:0.1474 loss2:0.8428 | AUC:0.7908 Anomaly AUC:0.5421
[2023-08-23 15:39:27,598][main.py][line:85][INFO] [Epoch:6/50]: loss1:0.1164 loss2:0.8120 | AUC:0.8317 Anomaly AUC:0.6236
[2023-08-23 15:40:48,348][main.py][line:85][INFO] [Epoch:7/50]: loss1:0.0924 loss2:0.7898 | AUC:0.8393 Anomaly AUC:0.6325
[2023-08-23 15:42:08,676][main.py][line:85][INFO] [Epoch:8/50]: loss1:0.0729 loss2:0.7697 | AUC:0.7842 Anomaly AUC:0.5910
[2023-08-23 15:42:43,601][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 15:42:43,863][main.py][line:132][INFO] total params:31.7625M
[2023-08-23 15:42:43,863][main.py][line:135][INFO] Training Mode
[2023-08-23 15:42:43,864][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
    (concat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 15:42:43,864][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 15:43:01,588][main.py][line:64][INFO] Random initialize AUCAUC:0.4951 Anomaly AUC:0.42579
[2023-08-23 15:44:34,271][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.4526 loss2:1.0572 | AUC:0.8180 Anomaly AUC:0.6408
[2023-08-23 15:45:57,498][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.2778 loss2:0.9282 | AUC:0.8294 Anomaly AUC:0.6475
[2023-08-23 15:47:46,034][main.py][line:85][INFO] [Epoch:3/50]: loss1:0.2129 loss2:0.8841 | AUC:0.8240 Anomaly AUC:0.6346
[2023-08-23 15:49:14,265][main.py][line:85][INFO] [Epoch:4/50]: loss1:0.1666 loss2:0.8454 | AUC:0.8332 Anomaly AUC:0.6453
[2023-08-23 15:50:34,587][main.py][line:85][INFO] [Epoch:5/50]: loss1:0.1250 loss2:0.8134 | AUC:0.8363 Anomaly AUC:0.6453
[2023-08-23 15:53:04,001][main.py][line:85][INFO] [Epoch:6/50]: loss1:0.1053 loss2:0.7923 | AUC:0.8232 Anomaly AUC:0.6744
[2023-08-23 15:55:05,793][main.py][line:85][INFO] [Epoch:7/50]: loss1:0.1172 loss2:0.7657 | AUC:0.8442 Anomaly AUC:0.6587
[2023-08-23 15:57:01,202][main.py][line:85][INFO] [Epoch:8/50]: loss1:0.0858 loss2:0.7160 | AUC:0.8338 Anomaly AUC:0.6486
[2023-08-23 15:58:32,526][main.py][line:85][INFO] [Epoch:9/50]: loss1:0.0766 loss2:0.6784 | AUC:0.8239 Anomaly AUC:0.6378
[2023-08-23 16:00:14,991][main.py][line:85][INFO] [Epoch:10/50]: loss1:0.0644 loss2:0.6510 | AUC:0.8432 Anomaly AUC:0.6679
[2023-08-23 16:02:18,566][main.py][line:85][INFO] [Epoch:11/50]: loss1:0.0476 loss2:0.6195 | AUC:0.8442 Anomaly AUC:0.6706
[2023-08-23 16:03:44,663][main.py][line:85][INFO] [Epoch:12/50]: loss1:0.0492 loss2:0.6079 | AUC:0.8376 Anomaly AUC:0.6736
[2023-08-23 16:05:42,344][main.py][line:85][INFO] [Epoch:13/50]: loss1:0.0382 loss2:0.5744 | AUC:0.8380 Anomaly AUC:0.6636
[2023-08-23 16:07:33,921][main.py][line:85][INFO] [Epoch:14/50]: loss1:0.0346 loss2:0.5567 | AUC:0.8439 Anomaly AUC:0.6841
[2023-08-23 16:09:18,911][main.py][line:85][INFO] [Epoch:15/50]: loss1:0.0294 loss2:0.5388 | AUC:0.8498 Anomaly AUC:0.6777
[2023-08-23 16:11:47,877][main.py][line:85][INFO] [Epoch:16/50]: loss1:0.0283 loss2:0.5247 | AUC:0.8266 Anomaly AUC:0.6517
[2023-08-23 16:12:43,840][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 16:12:44,090][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 16:12:44,090][main.py][line:135][INFO] Training Mode
[2023-08-23 16:12:44,091][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 16:12:44,091][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 16:13:07,034][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 16:13:07,259][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 16:13:07,259][main.py][line:135][INFO] Training Mode
[2023-08-23 16:13:07,260][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 16:13:07,260][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 16:13:27,647][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 16:16:32,469][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 16:16:32,691][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 16:16:32,691][main.py][line:135][INFO] Training Mode
[2023-08-23 16:16:32,692][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 16:16:32,692][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 16:16:54,605][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 20:21:26,334][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 20:21:26,570][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 20:21:26,570][main.py][line:135][INFO] Training Mode
[2023-08-23 20:21:26,570][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 20:21:26,570][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 20:21:35,969][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 20:35:35,427][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 20:35:35,653][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 20:35:35,653][main.py][line:135][INFO] Training Mode
[2023-08-23 20:35:35,654][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 20:35:35,654][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 20:35:45,315][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 20:36:03,472][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 20:36:03,704][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 20:36:03,704][main.py][line:135][INFO] Training Mode
[2023-08-23 20:36:03,705][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 20:36:03,705][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 20:36:13,402][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 20:36:17,597][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 20:36:17,824][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 20:36:17,824][main.py][line:135][INFO] Training Mode
[2023-08-23 20:36:17,825][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 20:36:17,825][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 20:36:27,392][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 20:37:03,315][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 20:37:03,550][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 20:37:03,550][main.py][line:135][INFO] Training Mode
[2023-08-23 20:37:03,551][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 20:37:03,551][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 20:37:13,205][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 20:39:48,352][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 20:39:48,576][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 20:39:48,576][main.py][line:135][INFO] Training Mode
[2023-08-23 20:39:48,577][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 20:39:48,577][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 20:39:58,343][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 20:41:10,872][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 20:41:11,111][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 20:41:11,111][main.py][line:135][INFO] Training Mode
[2023-08-23 20:41:11,112][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 20:41:11,112][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 20:41:20,522][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 20:41:37,892][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 20:41:38,119][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 20:41:38,119][main.py][line:135][INFO] Training Mode
[2023-08-23 20:41:38,120][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 20:41:38,120][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 20:41:47,001][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 23:40:01,040][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 23:40:01,281][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 23:40:01,281][main.py][line:135][INFO] Training Mode
[2023-08-23 23:40:01,282][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 23:40:01,282][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 23:40:19,747][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 23:41:09,206][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 23:41:09,440][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 23:41:09,440][main.py][line:135][INFO] Training Mode
[2023-08-23 23:41:09,441][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 23:41:09,441][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 23:41:30,221][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 23:43:49,954][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 23:43:50,184][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 23:43:50,184][main.py][line:135][INFO] Training Mode
[2023-08-23 23:43:50,185][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 23:43:50,185][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 23:43:59,213][main.py][line:64][INFO] Random initialize AUCAUC:0.4063 Anomaly AUC:0.45062
[2023-08-23 23:49:45,256][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 23:49:45,489][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 23:49:45,489][main.py][line:135][INFO] Training Mode
[2023-08-23 23:49:45,489][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 23:49:45,490][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 23:50:03,596][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 23:50:03,828][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 23:50:03,828][main.py][line:135][INFO] Training Mode
[2023-08-23 23:50:03,829][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 23:50:03,829][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 23:50:22,848][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 23:50:23,078][main.py][line:132][INFO] total params:29.6643M
[2023-08-23 23:50:23,078][main.py][line:135][INFO] Training Mode
[2023-08-23 23:50:23,079][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 23:50:23,079][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 23:51:26,165][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.8372 loss2:1.3623 | AUC:0.4006 Anomaly AUC:0.4915
[2023-08-23 23:52:32,759][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.7829 loss2:1.3646 | AUC:0.4396 Anomaly AUC:0.4910
[2023-08-23 23:53:43,501][main.py][line:85][INFO] [Epoch:3/50]: loss1:0.7754 loss2:1.3621 | AUC:0.3802 Anomaly AUC:0.4527
[2023-08-23 23:54:20,640][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 23:54:20,917][main.py][line:132][INFO] total params:33.1046M
[2023-08-23 23:54:20,917][main.py][line:135][INFO] Training Mode
[2023-08-23 23:54:20,918][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 23:54:20,918][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 23:54:34,705][main.py][line:64][INFO] Random initialize AUCAUC:0.5525 Anomaly AUC:0.54508
[2023-08-23 23:55:52,129][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.8231 loss2:1.3628 | AUC:0.5189 Anomaly AUC:0.4953
[2023-08-23 23:57:07,085][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.7788 loss2:1.3645 | AUC:0.5000 Anomaly AUC:0.4649
[2023-08-23 23:57:46,123][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 23:57:46,393][main.py][line:132][INFO] total params:33.1046M
[2023-08-23 23:57:46,393][main.py][line:135][INFO] Training Mode
[2023-08-23 23:57:46,393][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 23:57:46,394][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 23:58:01,219][main.py][line:64][INFO] Random initialize AUCAUC:0.5525 Anomaly AUC:0.54508
[2023-08-23 23:58:43,672][main.py][line:100][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-23 23:58:43,908][main.py][line:132][INFO] total params:33.1046M
[2023-08-23 23:58:43,908][main.py][line:135][INFO] Training Mode
[2023-08-23 23:58:43,909][main.py][line:60][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-23 23:58:43,909][main.py][line:61][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-23 23:58:58,197][main.py][line:64][INFO] Random initialize AUCAUC:0.5525 Anomaly AUC:0.54508
[2023-08-24 00:00:29,790][main.py][line:85][INFO] [Epoch:1/50]: loss1:0.8767 loss2:1.3670 loss3:130.0225 | AUC:0.3420 Anomaly AUC:0.3604
[2023-08-24 00:01:37,525][main.py][line:85][INFO] [Epoch:2/50]: loss1:0.7915 loss2:1.3684 loss3:4.3023 | AUC:0.3806 Anomaly AUC:0.3818
[2023-08-24 00:02:42,235][main.py][line:85][INFO] [Epoch:3/50]: loss1:0.7774 loss2:1.3695 loss3:0.6928 | AUC:0.4105 Anomaly AUC:0.3926
[2023-08-24 00:04:01,188][main.py][line:85][INFO] [Epoch:4/50]: loss1:0.7738 loss2:1.3649 loss3:0.6444 | AUC:0.4215 Anomaly AUC:0.4052
[2023-08-24 00:05:18,812][main.py][line:85][INFO] [Epoch:5/50]: loss1:0.7733 loss2:1.3666 loss3:0.5813 | AUC:0.4251 Anomaly AUC:0.4158
[2023-08-24 00:05:29,713][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 00:05:30,002][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 00:05:30,002][main.py][line:136][INFO] Training Mode
[2023-08-24 00:05:30,003][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 00:05:30,003][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-24 00:05:43,385][main.py][line:65][INFO] Random initialize AUCAUC:0.5525 Anomaly AUC:0.54508
[2023-08-24 00:07:05,599][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.8244 loss2:1.3628 loss3:70.7159 | AUC:0.4055 Anomaly AUC:0.4500
[2023-08-24 00:08:19,205][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.7735 loss2:1.3645 loss3:31.9993 | AUC:0.3996 Anomaly AUC:0.4697
[2023-08-24 00:09:22,196][main.py][line:86][INFO] [Epoch:3/50]: loss1:0.7709 loss2:1.3646 loss3:14.3353 | AUC:0.3843 Anomaly AUC:0.4894
[2023-08-24 00:10:29,834][main.py][line:86][INFO] [Epoch:4/50]: loss1:0.7658 loss2:1.3600 loss3:11.1641 | AUC:0.3712 Anomaly AUC:0.4666
[2023-08-24 00:11:36,841][main.py][line:86][INFO] [Epoch:5/50]: loss1:0.7600 loss2:1.3633 loss3:17.6810 | AUC:0.3600 Anomaly AUC:0.4473
[2023-08-24 00:12:20,670][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 00:12:20,938][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 00:12:20,938][main.py][line:136][INFO] Training Mode
[2023-08-24 00:12:20,939][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 00:12:20,939][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-24 00:12:35,186][main.py][line:65][INFO] Random initialize AUCAUC:0.5525 Anomaly AUC:0.54508
[2023-08-24 00:12:53,397][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 00:12:53,636][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 00:12:53,636][main.py][line:136][INFO] Training Mode
[2023-08-24 00:12:53,637][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 00:12:53,637][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-24 00:13:10,305][main.py][line:65][INFO] Random initialize AUCAUC:0.5525 Anomaly AUC:0.54508
[2023-08-24 00:14:25,738][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 00:14:25,989][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 00:14:25,989][main.py][line:136][INFO] Training Mode
[2023-08-24 00:14:25,990][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 00:14:25,990][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-24 00:14:39,755][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 00:14:40,004][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 00:14:40,004][main.py][line:136][INFO] Training Mode
[2023-08-24 00:14:40,005][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 00:14:40,005][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-24 00:14:54,739][main.py][line:65][INFO] Random initialize AUCAUC:0.5525 Anomaly AUC:0.54508
[2023-08-24 00:16:37,638][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.4924 loss2:1.0877 loss3:0.0000 | AUC:0.8103 Anomaly AUC:0.6490
[2023-08-24 00:17:52,926][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.2977 loss2:0.9143 loss3:0.0000 | AUC:0.8237 Anomaly AUC:0.6434
[2023-08-24 00:19:04,439][main.py][line:86][INFO] [Epoch:3/50]: loss1:0.2416 loss2:0.8692 loss3:0.0000 | AUC:0.8361 Anomaly AUC:0.6642
[2023-08-24 00:20:07,493][main.py][line:86][INFO] [Epoch:4/50]: loss1:0.1900 loss2:0.8299 loss3:0.0000 | AUC:0.8464 Anomaly AUC:0.6708
[2023-08-24 00:21:23,198][main.py][line:86][INFO] [Epoch:5/50]: loss1:0.1573 loss2:0.8029 loss3:0.0000 | AUC:0.8253 Anomaly AUC:0.6573
[2023-08-24 00:22:29,131][main.py][line:86][INFO] [Epoch:6/50]: loss1:0.1610 loss2:0.8087 loss3:0.0000 | AUC:0.8381 Anomaly AUC:0.6559
[2023-08-24 00:23:37,691][main.py][line:86][INFO] [Epoch:7/50]: loss1:0.1175 loss2:0.7704 loss3:0.0000 | AUC:0.8336 Anomaly AUC:0.6591
[2023-08-24 00:25:11,022][main.py][line:86][INFO] [Epoch:8/50]: loss1:0.1070 loss2:0.6287 loss3:0.0000 | AUC:0.8276 Anomaly AUC:0.6590
[2023-08-24 00:26:42,652][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 00:26:42,937][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 00:26:42,937][main.py][line:136][INFO] Training Mode
[2023-08-24 00:26:42,938][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 00:26:42,938][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-24 00:26:59,074][main.py][line:65][INFO] Random initialize AUCAUC:0.5525 Anomaly AUC:0.54508
[2023-08-24 00:28:15,101][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.4924 loss2:1.0877 loss3:0.0000 | AUC:0.8103 Anomaly AUC:0.6490
[2023-08-24 00:29:32,058][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.2856 loss2:0.9073 loss3:0.0000 | AUC:0.8375 Anomaly AUC:0.6653
[2023-08-24 00:30:53,776][main.py][line:86][INFO] [Epoch:3/50]: loss1:0.2280 loss2:0.8611 loss3:0.0000 | AUC:0.8237 Anomaly AUC:0.6456
[2023-08-24 00:32:26,717][main.py][line:86][INFO] [Epoch:4/50]: loss1:0.1953 loss2:0.8347 loss3:0.0000 | AUC:0.8364 Anomaly AUC:0.6556
[2023-08-24 00:33:57,271][main.py][line:86][INFO] [Epoch:5/50]: loss1:0.1683 loss2:0.8132 loss3:0.0000 | AUC:0.8347 Anomaly AUC:0.6543
[2023-08-24 00:35:23,567][main.py][line:86][INFO] [Epoch:6/50]: loss1:0.1535 loss2:0.7885 loss3:0.0000 | AUC:0.8245 Anomaly AUC:0.6412
[2023-08-24 00:37:01,853][main.py][line:86][INFO] [Epoch:7/50]: loss1:0.1337 loss2:0.7653 loss3:0.0000 | AUC:0.8286 Anomaly AUC:0.6409
[2023-08-24 00:38:37,008][main.py][line:86][INFO] [Epoch:8/50]: loss1:0.1162 loss2:0.7081 loss3:0.0000 | AUC:0.7105 Anomaly AUC:0.5791
[2023-08-24 00:40:28,476][main.py][line:86][INFO] [Epoch:9/50]: loss1:0.0956 loss2:0.6530 loss3:0.0000 | AUC:0.7854 Anomaly AUC:0.6361
[2023-08-24 00:42:13,767][main.py][line:86][INFO] [Epoch:10/50]: loss1:0.0588 loss2:0.0968 loss3:0.0000 | AUC:0.7965 Anomaly AUC:0.6271
[2023-08-24 00:44:42,770][main.py][line:86][INFO] [Epoch:11/50]: loss1:0.0591 loss2:0.5062 loss3:0.0000 | AUC:0.7732 Anomaly AUC:0.6147
[2023-08-24 00:46:17,118][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 00:46:17,398][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 00:46:17,399][main.py][line:136][INFO] Training Mode
[2023-08-24 00:46:17,399][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 00:46:17,399][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-24 00:46:31,248][main.py][line:65][INFO] Random initialize AUCAUC:0.5525 Anomaly AUC:0.54508
[2023-08-24 00:47:52,883][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.7311 loss2:1.3631 loss3:0.0000 | AUC:0.6047 Anomaly AUC:0.5156
[2023-08-24 00:50:18,527][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.6954 loss2:1.3651 loss3:0.0000 | AUC:0.5938 Anomaly AUC:0.4978
[2023-08-24 00:51:41,243][main.py][line:86][INFO] [Epoch:3/50]: loss1:0.6942 loss2:1.3652 loss3:0.0000 | AUC:0.5225 Anomaly AUC:0.4752
[2023-08-24 00:52:39,456][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 00:52:39,717][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 00:52:39,717][main.py][line:136][INFO] Training Mode
[2023-08-24 00:52:39,718][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 00:52:39,718][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-24 00:52:53,613][main.py][line:65][INFO] Random initialize AUCAUC:0.5525 Anomaly AUC:0.54508
[2023-08-24 00:54:27,308][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.7311 loss2:1.3631 loss3:6.9438 | AUC:0.6047 Anomaly AUC:0.5156
[2023-08-24 00:56:58,027][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.6954 loss2:1.3651 loss3:3.7214 | AUC:0.5938 Anomaly AUC:0.4978
[2023-08-24 00:57:52,827][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 00:57:53,104][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 00:57:53,104][main.py][line:136][INFO] Training Mode
[2023-08-24 00:57:53,105][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 00:57:53,105][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-24 00:58:10,374][main.py][line:65][INFO] Random initialize AUCAUC:0.5525 Anomaly AUC:0.54508
[2023-08-24 00:59:51,951][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.6929 loss2:1.2011 loss3:0.0941 | AUC:0.8136 Anomaly AUC:0.6271
[2023-08-24 01:01:20,540][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.3362 loss2:0.9693 loss3:0.0695 | AUC:0.8036 Anomaly AUC:0.6307
[2023-08-24 01:03:32,752][main.py][line:86][INFO] [Epoch:3/50]: loss1:0.2652 loss2:0.8991 loss3:0.0598 | AUC:0.8067 Anomaly AUC:0.6507
[2023-08-24 01:04:17,443][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 01:04:17,712][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 01:04:17,712][main.py][line:136][INFO] Training Mode
[2023-08-24 01:04:17,713][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 01:04:17,713][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-24 01:04:27,359][main.py][line:65][INFO] Random initialize AUCAUC:0.6143 Anomaly AUC:0.58483
[2023-08-24 01:05:29,645][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.4297 loss2:1.0381 loss3:0.0860 | AUC:0.8130 Anomaly AUC:0.6581
[2023-08-24 01:06:33,232][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.3021 loss2:0.9350 loss3:0.0650 | AUC:0.7851 Anomaly AUC:0.6225
[2023-08-24 01:07:34,740][main.py][line:86][INFO] [Epoch:3/50]: loss1:0.2439 loss2:0.8846 loss3:0.0567 | AUC:0.8149 Anomaly AUC:0.6326
[2023-08-24 01:08:41,877][main.py][line:86][INFO] [Epoch:4/50]: loss1:0.2082 loss2:0.8511 loss3:0.0478 | AUC:0.7689 Anomaly AUC:0.6392
[2023-08-24 01:09:49,970][main.py][line:86][INFO] [Epoch:5/50]: loss1:0.1683 loss2:0.8149 loss3:0.0432 | AUC:0.7471 Anomaly AUC:0.6340
[2023-08-24 01:11:05,099][main.py][line:86][INFO] [Epoch:6/50]: loss1:0.1565 loss2:0.7756 loss3:0.0419 | AUC:0.7882 Anomaly AUC:0.6490
[2023-08-24 01:12:34,023][main.py][line:86][INFO] [Epoch:7/50]: loss1:0.1232 loss2:0.7246 loss3:0.0360 | AUC:0.8293 Anomaly AUC:0.6420
[2023-08-24 01:14:05,624][main.py][line:86][INFO] [Epoch:8/50]: loss1:0.1029 loss2:0.6830 loss3:0.0324 | AUC:0.7812 Anomaly AUC:0.6175
[2023-08-24 01:15:12,113][main.py][line:86][INFO] [Epoch:9/50]: loss1:0.0823 loss2:0.6499 loss3:0.0284 | AUC:0.6624 Anomaly AUC:0.6173
[2023-08-24 01:16:46,243][main.py][line:86][INFO] [Epoch:10/50]: loss1:0.0723 loss2:0.5876 loss3:0.0263 | AUC:0.7500 Anomaly AUC:0.6285
[2023-08-24 01:17:48,098][main.py][line:86][INFO] [Epoch:11/50]: loss1:0.0525 loss2:0.5885 loss3:0.0237 | AUC:0.7611 Anomaly AUC:0.6416
[2023-08-24 01:19:09,209][main.py][line:86][INFO] [Epoch:12/50]: loss1:0.0460 loss2:0.5739 loss3:0.0212 | AUC:0.7288 Anomaly AUC:0.6073
[2023-08-24 01:20:39,963][main.py][line:86][INFO] [Epoch:13/50]: loss1:0.0473 loss2:0.5566 loss3:0.0216 | AUC:0.8260 Anomaly AUC:0.6603
[2023-08-24 01:21:59,630][main.py][line:86][INFO] [Epoch:14/50]: loss1:0.0439 loss2:0.5236 loss3:0.0213 | AUC:0.7372 Anomaly AUC:0.6185
[2023-08-24 01:23:20,252][main.py][line:86][INFO] [Epoch:15/50]: loss1:0.0419 loss2:0.4730 loss3:0.0198 | AUC:0.7539 Anomaly AUC:0.6263
[2023-08-24 01:24:49,133][main.py][line:86][INFO] [Epoch:16/50]: loss1:0.0265 loss2:0.4265 loss3:0.0177 | AUC:0.7376 Anomaly AUC:0.6319
[2023-08-24 01:25:59,626][main.py][line:86][INFO] [Epoch:17/50]: loss1:0.0267 loss2:0.3142 loss3:0.0169 | AUC:0.8201 Anomaly AUC:0.6450
[2023-08-24 01:27:11,941][main.py][line:86][INFO] [Epoch:18/50]: loss1:0.0269 loss2:0.4103 loss3:0.0170 | AUC:0.7255 Anomaly AUC:0.6271
[2023-08-24 01:28:19,028][main.py][line:86][INFO] [Epoch:19/50]: loss1:0.0266 loss2:0.3900 loss3:0.0166 | AUC:0.7366 Anomaly AUC:0.6281
[2023-08-24 01:29:40,693][main.py][line:86][INFO] [Epoch:20/50]: loss1:0.0194 loss2:0.3652 loss3:0.0152 | AUC:0.8135 Anomaly AUC:0.6513
[2023-08-24 01:30:54,168][main.py][line:86][INFO] [Epoch:21/50]: loss1:0.0313 loss2:0.3306 loss3:0.0169 | AUC:0.7350 Anomaly AUC:0.6362
[2023-08-24 01:32:10,071][main.py][line:86][INFO] [Epoch:22/50]: loss1:0.0147 loss2:0.3491 loss3:0.0135 | AUC:0.6987 Anomaly AUC:0.6236
[2023-08-24 01:33:22,544][main.py][line:86][INFO] [Epoch:23/50]: loss1:0.0180 loss2:0.3277 loss3:0.0134 | AUC:0.7576 Anomaly AUC:0.6441
[2023-08-24 01:34:34,425][main.py][line:86][INFO] [Epoch:24/50]: loss1:0.0138 loss2:0.2756 loss3:0.0128 | AUC:0.7333 Anomaly AUC:0.6075
[2023-08-24 01:36:03,050][main.py][line:86][INFO] [Epoch:25/50]: loss1:0.0332 loss2:0.2078 loss3:0.0178 | AUC:0.7356 Anomaly AUC:0.6270
[2023-08-24 01:37:13,712][main.py][line:86][INFO] [Epoch:26/50]: loss1:0.0103 loss2:0.2969 loss3:0.0127 | AUC:0.6971 Anomaly AUC:0.6211
[2023-08-24 01:38:29,783][main.py][line:86][INFO] [Epoch:27/50]: loss1:0.0166 loss2:0.2622 loss3:0.0125 | AUC:0.6549 Anomaly AUC:0.6083
[2023-08-24 01:39:49,298][main.py][line:86][INFO] [Epoch:28/50]: loss1:0.0142 loss2:0.2722 loss3:0.0115 | AUC:0.7490 Anomaly AUC:0.6232
[2023-08-24 01:40:58,684][main.py][line:86][INFO] [Epoch:29/50]: loss1:0.0121 loss2:0.2358 loss3:0.0121 | AUC:0.6929 Anomaly AUC:0.6143
[2023-08-24 01:42:24,210][main.py][line:86][INFO] [Epoch:30/50]: loss1:0.0103 loss2:0.2071 loss3:0.0114 | AUC:0.7646 Anomaly AUC:0.6224
[2023-08-24 01:43:29,891][main.py][line:86][INFO] [Epoch:31/50]: loss1:0.0185 loss2:0.1169 loss3:0.0135 | AUC:0.6579 Anomaly AUC:0.5656
[2023-08-24 01:44:40,825][main.py][line:86][INFO] [Epoch:32/50]: loss1:0.0216 loss2:0.2104 loss3:0.0138 | AUC:0.7273 Anomaly AUC:0.6123
[2023-08-24 01:45:56,137][main.py][line:86][INFO] [Epoch:33/50]: loss1:0.0067 loss2:0.1904 loss3:0.0103 | AUC:0.6534 Anomaly AUC:0.5718
[2023-08-24 01:47:23,046][main.py][line:86][INFO] [Epoch:34/50]: loss1:0.0100 loss2:0.1849 loss3:0.0111 | AUC:0.6208 Anomaly AUC:0.5597
[2023-08-24 01:48:34,277][main.py][line:86][INFO] [Epoch:35/50]: loss1:0.0148 loss2:0.0900 loss3:0.0115 | AUC:0.7562 Anomaly AUC:0.6233
[2023-08-24 01:49:38,863][main.py][line:86][INFO] [Epoch:36/50]: loss1:0.0116 loss2:0.1745 loss3:0.0128 | AUC:0.6892 Anomaly AUC:0.6129
[2023-08-24 01:50:58,841][main.py][line:86][INFO] [Epoch:37/50]: loss1:0.0154 loss2:0.1366 loss3:0.0115 | AUC:0.7242 Anomaly AUC:0.6208
[2023-08-24 01:52:17,119][main.py][line:86][INFO] [Epoch:38/50]: loss1:0.0114 loss2:0.1816 loss3:0.0111 | AUC:0.8138 Anomaly AUC:0.6522
[2023-08-24 01:53:30,860][main.py][line:86][INFO] [Epoch:39/50]: loss1:0.0112 loss2:0.1496 loss3:0.0114 | AUC:0.7800 Anomaly AUC:0.6481
[2023-08-24 01:54:49,637][main.py][line:86][INFO] [Epoch:40/50]: loss1:0.0082 loss2:0.1544 loss3:0.0103 | AUC:0.6947 Anomaly AUC:0.5942
[2023-08-24 01:55:58,762][main.py][line:86][INFO] [Epoch:41/50]: loss1:0.0061 loss2:0.1445 loss3:0.0108 | AUC:0.7746 Anomaly AUC:0.6424
[2023-08-24 01:57:14,613][main.py][line:86][INFO] [Epoch:42/50]: loss1:0.0071 loss2:0.1326 loss3:0.0106 | AUC:0.7904 Anomaly AUC:0.6499
[2023-08-24 01:58:21,768][main.py][line:86][INFO] [Epoch:43/50]: loss1:0.0108 loss2:0.1198 loss3:0.0108 | AUC:0.8040 Anomaly AUC:0.6367
[2023-08-24 01:59:57,697][main.py][line:86][INFO] [Epoch:44/50]: loss1:0.0112 loss2:0.0757 loss3:0.0108 | AUC:0.7890 Anomaly AUC:0.6465
[2023-08-24 02:01:14,036][main.py][line:86][INFO] [Epoch:45/50]: loss1:0.0058 loss2:0.0941 loss3:0.0091 | AUC:0.6735 Anomaly AUC:0.6039
[2023-08-24 02:02:33,278][main.py][line:86][INFO] [Epoch:46/50]: loss1:0.0055 loss2:0.0933 loss3:0.0094 | AUC:0.7404 Anomaly AUC:0.6227
[2023-08-24 02:03:56,822][main.py][line:86][INFO] [Epoch:47/50]: loss1:0.0179 loss2:0.0976 loss3:0.0117 | AUC:0.6789 Anomaly AUC:0.5974
[2023-08-24 02:05:08,714][main.py][line:86][INFO] [Epoch:48/50]: loss1:0.0152 loss2:0.1081 loss3:0.0124 | AUC:0.7119 Anomaly AUC:0.6149
[2023-08-24 02:06:33,822][main.py][line:86][INFO] [Epoch:49/50]: loss1:0.0032 loss2:0.0818 loss3:0.0078 | AUC:0.7129 Anomaly AUC:0.6110
[2023-08-24 02:07:48,896][main.py][line:86][INFO] [Epoch:50/50]: loss1:0.0048 loss2:0.0877 loss3:0.0083 | AUC:0.6390 Anomaly AUC:0.5932
[2023-08-24 02:07:49,058][main.py][line:94][INFO] Training completes in 63m 22s | best AUCAUC:0.8293 Anomaly AUC:0.6420

[2023-08-24 11:12:53,052][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 11:12:53,314][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 11:12:53,314][main.py][line:136][INFO] Training Mode
[2023-08-24 11:12:53,315][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 11:12:53,315][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-24 11:13:03,435][main.py][line:65][INFO] Random initialize AUCAUC:0.6143 Anomaly AUC:0.58483
[2023-08-24 11:14:22,077][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.4266 loss2:1.0636 loss3:9.8777 | AUC:0.8128 Anomaly AUC:0.6397
[2023-08-24 11:15:37,746][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.2718 loss2:0.9309 loss3:5.8223 | AUC:0.8355 Anomaly AUC:0.6530
[2023-08-24 11:16:53,473][main.py][line:86][INFO] [Epoch:3/50]: loss1:0.2052 loss2:0.8790 loss3:3.8110 | AUC:0.8436 Anomaly AUC:0.6620
[2023-08-24 11:18:13,821][main.py][line:86][INFO] [Epoch:4/50]: loss1:0.1897 loss2:0.8637 loss3:3.4181 | AUC:0.8186 Anomaly AUC:0.6383
[2023-08-24 11:19:36,529][main.py][line:86][INFO] [Epoch:5/50]: loss1:0.1509 loss2:0.8272 loss3:2.3678 | AUC:0.8100 Anomaly AUC:0.6487
[2023-08-24 11:20:48,260][main.py][line:86][INFO] [Epoch:6/50]: loss1:0.1229 loss2:0.7835 loss3:0.8246 | AUC:0.7785 Anomaly AUC:0.6381
[2023-08-24 11:22:21,257][main.py][line:86][INFO] [Epoch:7/50]: loss1:0.1033 loss2:0.7380 loss3:0.5844 | AUC:0.8282 Anomaly AUC:0.6609
[2023-08-24 11:23:34,823][main.py][line:86][INFO] [Epoch:8/50]: loss1:0.0956 loss2:0.7119 loss3:0.4397 | AUC:0.7317 Anomaly AUC:0.6142
[2023-08-24 11:24:49,831][main.py][line:86][INFO] [Epoch:9/50]: loss1:0.0811 loss2:0.6759 loss3:0.3929 | AUC:0.7968 Anomaly AUC:0.6320
[2023-08-24 11:24:54,327][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 11:24:54,588][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 11:24:54,588][main.py][line:136][INFO] Training Mode
[2023-08-24 11:24:54,589][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 11:24:54,589][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-24 11:25:10,124][main.py][line:65][INFO] Random initialize AUCAUC:0.6143 Anomaly AUC:0.58483
[2023-08-24 11:26:40,039][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.4413 loss2:1.0750 loss3:2.6328 | AUC:0.8175 Anomaly AUC:0.6370
[2023-08-24 11:27:46,031][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.2754 loss2:0.9368 loss3:2.2506 | AUC:0.8325 Anomaly AUC:0.6420
[2023-08-24 11:28:59,299][main.py][line:86][INFO] [Epoch:3/50]: loss1:0.2110 loss2:0.8834 loss3:1.5978 | AUC:0.8375 Anomaly AUC:0.6568
[2023-08-24 11:30:24,155][main.py][line:86][INFO] [Epoch:4/50]: loss1:0.1718 loss2:0.8459 loss3:1.5268 | AUC:0.8331 Anomaly AUC:0.6701
[2023-08-24 11:31:34,516][main.py][line:86][INFO] [Epoch:5/50]: loss1:0.1348 loss2:0.8033 loss3:1.0052 | AUC:0.8339 Anomaly AUC:0.6757
[2023-08-24 11:32:47,274][main.py][line:86][INFO] [Epoch:6/50]: loss1:0.1174 loss2:0.7718 loss3:0.8542 | AUC:0.8325 Anomaly AUC:0.6832
[2023-08-24 11:34:01,884][main.py][line:86][INFO] [Epoch:7/50]: loss1:0.0954 loss2:0.7262 loss3:1.1347 | AUC:0.8350 Anomaly AUC:0.6720
[2023-08-24 11:35:35,633][main.py][line:86][INFO] [Epoch:8/50]: loss1:0.0821 loss2:0.6815 loss3:1.1260 | AUC:0.8326 Anomaly AUC:0.6647
[2023-08-24 11:36:40,285][main.py][line:86][INFO] [Epoch:9/50]: loss1:0.0704 loss2:0.6437 loss3:1.0620 | AUC:0.8350 Anomaly AUC:0.6887
[2023-08-24 11:38:06,278][main.py][line:86][INFO] [Epoch:10/50]: loss1:0.0737 loss2:0.6209 loss3:1.3017 | AUC:0.8263 Anomaly AUC:0.6707
[2023-08-24 11:39:25,989][main.py][line:86][INFO] [Epoch:11/50]: loss1:0.0646 loss2:0.5874 loss3:1.5445 | AUC:0.8491 Anomaly AUC:0.6777
[2023-08-24 11:40:37,086][main.py][line:86][INFO] [Epoch:12/50]: loss1:0.0513 loss2:0.5467 loss3:1.2927 | AUC:0.8308 Anomaly AUC:0.6601
[2023-08-24 11:41:46,612][main.py][line:86][INFO] [Epoch:13/50]: loss1:0.0518 loss2:0.5333 loss3:1.4075 | AUC:0.8064 Anomaly AUC:0.6561
[2023-08-24 11:42:41,201][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 11:42:41,467][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 11:42:41,467][main.py][line:136][INFO] Training Mode
[2023-08-24 11:42:41,468][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 11:42:41,468][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.005
    lr: 0.005
    maximize: False
    weight_decay: 0
)

[2023-08-24 11:42:55,559][main.py][line:65][INFO] Random initialize AUCAUC:0.6143 Anomaly AUC:0.58483
[2023-08-24 11:44:26,354][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.7356 loss2:1.3626 loss3:0.8016 | AUC:0.5695 Anomaly AUC:0.5454
[2023-08-24 11:45:32,649][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.4798 loss2:1.1922 loss3:4.7718 | AUC:0.8179 Anomaly AUC:0.6475
[2023-08-24 11:46:54,168][main.py][line:86][INFO] [Epoch:3/50]: loss1:0.3154 loss2:1.0415 loss3:2.6776 | AUC:0.8151 Anomaly AUC:0.6489
[2023-08-24 11:48:43,896][main.py][line:86][INFO] [Epoch:4/50]: loss1:0.2951 loss2:1.0069 loss3:2.9946 | AUC:0.8198 Anomaly AUC:0.6335
[2023-08-24 11:50:17,426][main.py][line:86][INFO] [Epoch:5/50]: loss1:0.2721 loss2:0.9862 loss3:6.1035 | AUC:0.8241 Anomaly AUC:0.6474
[2023-08-24 11:51:34,175][main.py][line:86][INFO] [Epoch:6/50]: loss1:0.2337 loss2:0.9520 loss3:6.6279 | AUC:0.8229 Anomaly AUC:0.6525
[2023-08-24 11:53:21,815][main.py][line:86][INFO] [Epoch:7/50]: loss1:0.1908 loss2:0.9022 loss3:7.0849 | AUC:0.8223 Anomaly AUC:0.6635
[2023-08-24 11:54:58,435][main.py][line:86][INFO] [Epoch:8/50]: loss1:0.1623 loss2:0.8527 loss3:6.8297 | AUC:0.8416 Anomaly AUC:0.6905
[2023-08-24 11:56:42,891][main.py][line:86][INFO] [Epoch:9/50]: loss1:0.1533 loss2:0.8405 loss3:10.2995 | AUC:0.8214 Anomaly AUC:0.6828
[2023-08-24 11:58:23,797][main.py][line:86][INFO] [Epoch:10/50]: loss1:0.1171 loss2:0.8058 loss3:8.5518 | AUC:0.8310 Anomaly AUC:0.6889
[2023-08-24 12:00:29,458][main.py][line:86][INFO] [Epoch:11/50]: loss1:0.0922 loss2:0.7883 loss3:6.5858 | AUC:0.8305 Anomaly AUC:0.6869
[2023-08-24 12:01:55,580][main.py][line:86][INFO] [Epoch:12/50]: loss1:0.0838 loss2:0.7815 loss3:5.5844 | AUC:0.8338 Anomaly AUC:0.6792
[2023-08-24 12:03:14,917][main.py][line:86][INFO] [Epoch:13/50]: loss1:0.0706 loss2:0.7743 loss3:5.7199 | AUC:0.8338 Anomaly AUC:0.6793
[2023-08-24 12:04:41,979][main.py][line:86][INFO] [Epoch:14/50]: loss1:0.0584 loss2:0.7635 loss3:4.8520 | AUC:0.8288 Anomaly AUC:0.6921
[2023-08-24 12:06:00,607][main.py][line:86][INFO] [Epoch:15/50]: loss1:0.0573 loss2:0.7612 loss3:5.4772 | AUC:0.8420 Anomaly AUC:0.7004
[2023-08-24 12:07:15,565][main.py][line:86][INFO] [Epoch:16/50]: loss1:0.0476 loss2:0.7524 loss3:3.9879 | AUC:0.8403 Anomaly AUC:0.7025
[2023-08-24 12:09:16,855][main.py][line:86][INFO] [Epoch:17/50]: loss1:0.0527 loss2:0.7536 loss3:3.5919 | AUC:0.8267 Anomaly AUC:0.6858
[2023-08-24 12:10:42,568][main.py][line:86][INFO] [Epoch:18/50]: loss1:0.0450 loss2:0.7495 loss3:3.1058 | AUC:0.8423 Anomaly AUC:0.6893
[2023-08-24 12:11:50,818][main.py][line:86][INFO] [Epoch:19/50]: loss1:0.0532 loss2:0.7551 loss3:3.5232 | AUC:0.8283 Anomaly AUC:0.6688
[2023-08-24 12:13:15,204][main.py][line:86][INFO] [Epoch:20/50]: loss1:0.0486 loss2:0.7496 loss3:3.3942 | AUC:0.8376 Anomaly AUC:0.6742
[2023-08-24 12:14:48,197][main.py][line:86][INFO] [Epoch:21/50]: loss1:0.0317 loss2:0.7345 loss3:2.1571 | AUC:0.8340 Anomaly AUC:0.6769
[2023-08-24 12:16:24,487][main.py][line:86][INFO] [Epoch:22/50]: loss1:0.0438 loss2:0.7405 loss3:3.5391 | AUC:0.8360 Anomaly AUC:0.6717
[2023-08-24 12:17:37,767][main.py][line:86][INFO] [Epoch:23/50]: loss1:0.0347 loss2:0.7336 loss3:2.8642 | AUC:0.8427 Anomaly AUC:0.6799
[2023-08-24 12:19:26,824][main.py][line:86][INFO] [Epoch:24/50]: loss1:0.0274 loss2:0.7223 loss3:2.2579 | AUC:0.8404 Anomaly AUC:0.6692
[2023-08-24 12:21:25,487][main.py][line:86][INFO] [Epoch:25/50]: loss1:0.0264 loss2:0.7218 loss3:1.9061 | AUC:0.8169 Anomaly AUC:0.6527
[2023-08-24 12:22:51,025][main.py][line:86][INFO] [Epoch:26/50]: loss1:0.0274 loss2:0.7161 loss3:1.9684 | AUC:0.8364 Anomaly AUC:0.6713
[2023-08-24 12:24:38,968][main.py][line:86][INFO] [Epoch:27/50]: loss1:0.0230 loss2:0.7094 loss3:1.7238 | AUC:0.8208 Anomaly AUC:0.6602
[2023-08-24 12:26:07,806][main.py][line:86][INFO] [Epoch:28/50]: loss1:0.0245 loss2:0.7119 loss3:1.6434 | AUC:0.8252 Anomaly AUC:0.6637
[2023-08-24 12:27:52,803][main.py][line:86][INFO] [Epoch:29/50]: loss1:0.0244 loss2:0.7009 loss3:1.6920 | AUC:0.8316 Anomaly AUC:0.6841
[2023-08-24 12:29:11,584][main.py][line:86][INFO] [Epoch:30/50]: loss1:0.0247 loss2:0.7078 loss3:1.3264 | AUC:0.8218 Anomaly AUC:0.6624
[2023-08-24 12:30:41,732][main.py][line:86][INFO] [Epoch:31/50]: loss1:0.0215 loss2:0.7010 loss3:1.6958 | AUC:0.8383 Anomaly AUC:0.6751
[2023-08-24 12:32:24,974][main.py][line:86][INFO] [Epoch:32/50]: loss1:0.0212 loss2:0.6968 loss3:1.3279 | AUC:0.8302 Anomaly AUC:0.6724
[2023-08-24 12:33:53,159][main.py][line:86][INFO] [Epoch:33/50]: loss1:0.0176 loss2:0.6786 loss3:1.1573 | AUC:0.8137 Anomaly AUC:0.6525
[2023-08-24 12:35:03,369][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 12:35:03,643][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 12:35:03,643][main.py][line:136][INFO] Training Mode
[2023-08-24 12:35:03,644][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 12:35:03,644][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.005
    lr: 0.005
    maximize: False
    weight_decay: 0
)

[2023-08-24 12:35:20,480][main.py][line:65][INFO] Random initialize AUCAUC:0.6143 Anomaly AUC:0.58483
[2023-08-24 12:37:17,391][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.6147 loss2:1.2621 loss3:2.4868 | AUC:0.7473 Anomaly AUC:0.6073
[2023-08-24 12:39:12,375][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.3261 loss2:0.9876 loss3:6.6096 | AUC:0.8188 Anomaly AUC:0.6418
[2023-08-24 12:40:51,409][main.py][line:86][INFO] [Epoch:3/50]: loss1:0.2680 loss2:0.9260 loss3:6.0100 | AUC:0.8248 Anomaly AUC:0.6575
[2023-08-24 12:42:35,720][main.py][line:86][INFO] [Epoch:4/50]: loss1:0.2328 loss2:0.8860 loss3:6.4154 | AUC:0.8190 Anomaly AUC:0.6405
[2023-08-24 12:44:32,005][main.py][line:86][INFO] [Epoch:5/50]: loss1:0.2060 loss2:0.8618 loss3:7.2182 | AUC:0.8335 Anomaly AUC:0.6595
[2023-08-24 12:46:19,280][main.py][line:86][INFO] [Epoch:6/50]: loss1:0.1808 loss2:0.8335 loss3:7.5785 | AUC:0.8422 Anomaly AUC:0.6685
[2023-08-24 12:48:27,296][main.py][line:86][INFO] [Epoch:7/50]: loss1:0.1486 loss2:0.8137 loss3:6.7784 | AUC:0.8306 Anomaly AUC:0.6640
[2023-08-24 12:50:01,970][main.py][line:86][INFO] [Epoch:8/50]: loss1:0.1246 loss2:0.7959 loss3:6.9324 | AUC:0.8367 Anomaly AUC:0.6543
[2023-08-24 12:51:38,958][main.py][line:86][INFO] [Epoch:9/50]: loss1:0.1116 loss2:0.7843 loss3:6.6179 | AUC:0.8311 Anomaly AUC:0.6584
[2023-08-24 12:53:39,164][main.py][line:86][INFO] [Epoch:10/50]: loss1:0.0903 loss2:0.7652 loss3:5.5816 | AUC:0.8329 Anomaly AUC:0.6723
[2023-08-24 12:54:14,362][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 12:54:14,641][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 12:54:14,641][main.py][line:136][INFO] Training Mode
[2023-08-24 12:54:14,642][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 12:54:14,642][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.005
    lr: 0.005
    maximize: False
    weight_decay: 0
)

[2023-08-24 12:54:30,717][main.py][line:65][INFO] Random initialize AUCAUC:0.6143 Anomaly AUC:0.58483
[2023-08-24 12:56:00,298][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.7402 loss2:1.3491 loss3:0.3008 | AUC:0.3521 Anomaly AUC:0.4160
[2023-08-24 12:57:12,625][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.5131 loss2:1.1973 loss3:0.2659 | AUC:0.8115 Anomaly AUC:0.6267
[2023-08-24 12:58:29,993][main.py][line:86][INFO] [Epoch:3/50]: loss1:0.3483 loss2:1.0807 loss3:0.1090 | AUC:0.8248 Anomaly AUC:0.6279
[2023-08-24 12:59:47,729][main.py][line:86][INFO] [Epoch:4/50]: loss1:0.2919 loss2:1.0147 loss3:0.0870 | AUC:0.8177 Anomaly AUC:0.6337
[2023-08-24 13:01:14,784][main.py][line:86][INFO] [Epoch:5/50]: loss1:0.2400 loss2:0.9687 loss3:0.0767 | AUC:0.8261 Anomaly AUC:0.6695
[2023-08-24 13:02:26,699][main.py][line:86][INFO] [Epoch:6/50]: loss1:0.1865 loss2:0.9275 loss3:0.0668 | AUC:0.8349 Anomaly AUC:0.6735
[2023-08-24 13:03:44,382][main.py][line:86][INFO] [Epoch:7/50]: loss1:0.1613 loss2:0.9051 loss3:0.0636 | AUC:0.8275 Anomaly AUC:0.6543
[2023-08-24 13:05:08,813][main.py][line:86][INFO] [Epoch:8/50]: loss1:0.1288 loss2:0.8797 loss3:0.0549 | AUC:0.8311 Anomaly AUC:0.6781
[2023-08-24 13:06:17,782][main.py][line:86][INFO] [Epoch:9/50]: loss1:0.1065 loss2:0.8715 loss3:0.0512 | AUC:0.8097 Anomaly AUC:0.6759
[2023-08-24 13:07:51,641][main.py][line:86][INFO] [Epoch:10/50]: loss1:0.0937 loss2:0.8629 loss3:0.0497 | AUC:0.8202 Anomaly AUC:0.6667
[2023-08-24 13:09:28,612][main.py][line:86][INFO] [Epoch:11/50]: loss1:0.0782 loss2:0.8563 loss3:0.0450 | AUC:0.8080 Anomaly AUC:0.6668
[2023-08-24 13:10:59,687][main.py][line:86][INFO] [Epoch:12/50]: loss1:0.0750 loss2:0.8545 loss3:0.0427 | AUC:0.8235 Anomaly AUC:0.6878
[2023-08-24 13:12:03,664][main.py][line:86][INFO] [Epoch:13/50]: loss1:0.0641 loss2:0.8478 loss3:0.0409 | AUC:0.8258 Anomaly AUC:0.6829
[2023-08-24 13:14:03,616][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 13:14:03,891][main.py][line:133][INFO] total params:33.1046M
[2023-08-24 13:14:03,892][main.py][line:136][INFO] Training Mode
[2023-08-24 13:14:03,892][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 13:14:03,893][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 13:14:10,523][main.py][line:65][INFO] Random initialize AUCAUC:0.5163 Anomaly AUC:0.51203
[2023-08-24 13:15:16,792][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.3323 loss2:0.9888 loss3:1.7664 | AUC:0.8233 Anomaly AUC:0.6335
[2023-08-24 13:16:27,059][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.1161 loss2:0.7668 loss3:1.6040 | AUC:0.8388 Anomaly AUC:0.6695
[2023-08-24 13:17:53,354][main.py][line:86][INFO] [Epoch:3/50]: loss1:0.0490 loss2:0.6488 loss3:1.6170 | AUC:0.8013 Anomaly AUC:0.6472
[2023-08-24 13:19:06,502][main.py][line:86][INFO] [Epoch:4/50]: loss1:0.0343 loss2:0.5562 loss3:1.5597 | AUC:0.8152 Anomaly AUC:0.6514
[2023-08-24 13:20:36,289][main.py][line:86][INFO] [Epoch:5/50]: loss1:0.0189 loss2:0.4567 loss3:1.5423 | AUC:0.8122 Anomaly AUC:0.6492
[2023-08-24 13:21:46,674][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 13:21:46,790][main.py][line:133][INFO] total params:1.2091M
[2023-08-24 13:21:46,790][main.py][line:136][INFO] Training Mode
[2023-08-24 13:23:00,352][main.py][line:101][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 13:23:00,440][main.py][line:133][INFO] total params:1.2091M
[2023-08-24 13:23:00,440][main.py][line:136][INFO] Training Mode
[2023-08-24 13:23:00,440][main.py][line:61][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 13:23:00,440][main.py][line:62][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 13:23:12,297][main.py][line:65][INFO] Random initialize AUCAUC:0.5444 Anomaly AUC:0.53443
[2023-08-24 13:24:20,740][main.py][line:86][INFO] [Epoch:1/50]: loss1:0.3315 loss2:1.0616 loss3:1.5397 | AUC:0.8268 Anomaly AUC:0.6456
[2023-08-24 13:25:16,585][main.py][line:86][INFO] [Epoch:2/50]: loss1:0.1175 loss2:0.7792 loss3:1.5869 | AUC:0.8454 Anomaly AUC:0.6655
[2023-08-24 13:26:36,736][main.py][line:86][INFO] [Epoch:3/50]: loss1:0.0632 loss2:0.6582 loss3:1.6591 | AUC:0.8494 Anomaly AUC:0.6842
[2023-08-24 13:27:42,369][main.py][line:86][INFO] [Epoch:4/50]: loss1:0.0384 loss2:0.5558 loss3:1.6162 | AUC:0.8444 Anomaly AUC:0.6694
[2023-08-24 13:28:47,426][main.py][line:86][INFO] [Epoch:5/50]: loss1:0.0184 loss2:0.4480 loss3:1.5468 | AUC:0.8352 Anomaly AUC:0.6673
[2023-08-24 13:30:11,122][main.py][line:86][INFO] [Epoch:6/50]: loss1:0.0367 loss2:0.3960 loss3:1.6147 | AUC:0.8447 Anomaly AUC:0.6751
[2023-08-24 13:31:22,517][main.py][line:86][INFO] [Epoch:7/50]: loss1:0.0116 loss2:0.2893 loss3:1.5783 | AUC:0.8483 Anomaly AUC:0.6744
[2023-08-24 13:33:16,143][main.py][line:86][INFO] [Epoch:8/50]: loss1:0.0118 loss2:0.2191 loss3:1.5513 | AUC:0.8417 Anomaly AUC:0.6750
[2023-08-24 13:34:15,103][main.py][line:86][INFO] [Epoch:9/50]: loss1:0.0348 loss2:0.2196 loss3:1.7634 | AUC:0.8377 Anomaly AUC:0.6766
[2023-08-24 13:35:07,737][main.py][line:86][INFO] [Epoch:10/50]: loss1:0.0113 loss2:0.1440 loss3:1.6544 | AUC:0.8462 Anomaly AUC:0.6757
[2023-08-24 13:36:48,227][main.py][line:86][INFO] [Epoch:11/50]: loss1:0.0047 loss2:0.0912 loss3:1.6441 | AUC:0.8453 Anomaly AUC:0.6746
[2023-08-24 13:37:51,419][main.py][line:86][INFO] [Epoch:12/50]: loss1:0.0033 loss2:0.0621 loss3:1.5058 | AUC:0.8417 Anomaly AUC:0.6664
[2023-08-24 13:38:54,002][main.py][line:86][INFO] [Epoch:13/50]: loss1:0.0025 loss2:0.0436 loss3:1.4328 | AUC:0.8423 Anomaly AUC:0.6707
[2023-08-24 13:40:22,527][main.py][line:86][INFO] [Epoch:14/50]: loss1:0.0022 loss2:0.0321 loss3:1.3552 | AUC:0.8395 Anomaly AUC:0.6672
[2023-08-24 13:41:09,985][main.py][line:86][INFO] [Epoch:15/50]: loss1:0.0394 loss2:0.0551 loss3:1.7060 | AUC:0.8127 Anomaly AUC:0.6361
[2023-08-24 13:42:07,566][main.py][line:86][INFO] [Epoch:16/50]: loss1:0.0328 loss2:0.0856 loss3:2.1785 | AUC:0.8371 Anomaly AUC:0.6634
[2023-08-24 13:42:58,510][main.py][line:86][INFO] [Epoch:17/50]: loss1:0.0115 loss2:0.0412 loss3:1.9268 | AUC:0.8344 Anomaly AUC:0.6589
[2023-08-24 13:43:24,116][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 13:43:24,242][main.py][line:139][INFO] total params:1.2091M
[2023-08-24 13:43:24,242][main.py][line:142][INFO] Training Mode
[2023-08-24 13:43:24,243][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 13:43:24,243][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 13:44:06,668][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 13:44:06,753][main.py][line:139][INFO] total params:1.2091M
[2023-08-24 13:44:06,753][main.py][line:142][INFO] Training Mode
[2023-08-24 13:44:06,754][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 13:44:06,754][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 13:44:15,798][main.py][line:66][INFO] Random initialize AUCAUC:0.5444 Anomaly AUC:0.53443
[2023-08-24 13:46:53,554][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 32, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 13:46:53,641][main.py][line:139][INFO] total params:1.2091M
[2023-08-24 13:46:53,641][main.py][line:142][INFO] Training Mode
[2023-08-24 13:46:53,641][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 13:46:53,641][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 13:47:05,831][main.py][line:66][INFO] Random initialize AUCAUC:0.5444 Anomaly AUC:0.53443
[2023-08-24 13:48:27,477][main.py][line:88][INFO] [Epoch:1/50]: loss1:0.3180 loss2:0.9280 loss3:0.0000 | AUC:0.8379 Anomaly AUC:0.6586
[2023-08-24 13:49:22,385][main.py][line:88][INFO] [Epoch:2/50]: loss1:0.1117 loss2:0.6212 loss3:0.0000 | AUC:0.8499 Anomaly AUC:0.6878
[2023-08-24 13:50:22,755][main.py][line:88][INFO] [Epoch:3/50]: loss1:0.0688 loss2:0.4802 loss3:0.0000 | AUC:0.8353 Anomaly AUC:0.6665
[2023-08-24 13:51:10,005][main.py][line:88][INFO] [Epoch:4/50]: loss1:0.0348 loss2:0.3385 loss3:0.0000 | AUC:0.8373 Anomaly AUC:0.6675
[2023-08-24 13:51:58,512][main.py][line:88][INFO] [Epoch:5/50]: loss1:0.0339 loss2:0.2433 loss3:0.0000 | AUC:0.8360 Anomaly AUC:0.6667
[2023-08-24 13:53:10,417][main.py][line:88][INFO] [Epoch:6/50]: loss1:0.0373 loss2:0.1733 loss3:0.0000 | AUC:0.8382 Anomaly AUC:0.6682
[2023-08-24 13:54:14,752][main.py][line:88][INFO] [Epoch:7/50]: loss1:0.0204 loss2:0.1089 loss3:0.0000 | AUC:0.8115 Anomaly AUC:0.6487
[2023-08-24 13:54:50,578][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8512.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 13:54:50,693][main.py][line:139][INFO] total params:1.2091M
[2023-08-24 13:54:50,693][main.py][line:142][INFO] Training Mode
[2023-08-24 13:54:50,693][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 13:54:50,693][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 13:54:56,923][main.py][line:66][INFO] Random initialize AUCAUC:0.5444 Anomaly AUC:0.53443
[2023-08-24 13:56:34,368][main.py][line:88][INFO] [Epoch:1/50]: loss1:0.3879 loss2:1.1027 loss3:0.0000 | AUC:0.8336 Anomaly AUC:0.6379
[2023-08-24 13:58:13,584][main.py][line:88][INFO] [Epoch:2/50]: loss1:0.1527 loss2:0.8754 loss3:0.0000 | AUC:0.8478 Anomaly AUC:0.6749
[2023-08-24 13:59:57,350][main.py][line:88][INFO] [Epoch:3/50]: loss1:0.0687 loss2:0.7828 loss3:0.0000 | AUC:0.8501 Anomaly AUC:0.6836
[2023-08-24 14:01:31,894][main.py][line:88][INFO] [Epoch:4/50]: loss1:0.0321 loss2:0.7052 loss3:0.0000 | AUC:0.8399 Anomaly AUC:0.6791
[2023-08-24 14:03:12,162][main.py][line:88][INFO] [Epoch:5/50]: loss1:0.0314 loss2:0.6430 loss3:0.0000 | AUC:0.8498 Anomaly AUC:0.6837
[2023-08-24 14:04:51,943][main.py][line:88][INFO] [Epoch:6/50]: loss1:0.0181 loss2:0.5795 loss3:0.0000 | AUC:0.8480 Anomaly AUC:0.6754
[2023-08-24 14:06:57,752][main.py][line:88][INFO] [Epoch:7/50]: loss1:0.0212 loss2:0.5285 loss3:0.0000 | AUC:0.8466 Anomaly AUC:0.6851
[2023-08-24 14:08:43,510][main.py][line:88][INFO] [Epoch:8/50]: loss1:0.0159 loss2:0.4758 loss3:0.0000 | AUC:0.8555 Anomaly AUC:0.6892
[2023-08-24 14:10:41,487][main.py][line:88][INFO] [Epoch:9/50]: loss1:0.0088 loss2:0.4122 loss3:0.0000 | AUC:0.8528 Anomaly AUC:0.6866
[2023-08-24 14:12:32,917][main.py][line:88][INFO] [Epoch:10/50]: loss1:0.0073 loss2:0.3574 loss3:0.0000 | AUC:0.8525 Anomaly AUC:0.6875
[2023-08-24 14:14:23,875][main.py][line:88][INFO] [Epoch:11/50]: loss1:0.0073 loss2:0.3065 loss3:0.0000 | AUC:0.8539 Anomaly AUC:0.6874
[2023-08-24 14:16:12,888][main.py][line:88][INFO] [Epoch:12/50]: loss1:0.0269 loss2:0.3021 loss3:0.0000 | AUC:0.8450 Anomaly AUC:0.6814
[2023-08-24 14:17:59,702][main.py][line:88][INFO] [Epoch:13/50]: loss1:0.0334 loss2:0.3015 loss3:0.0000 | AUC:0.8441 Anomaly AUC:0.6781
[2023-08-24 14:19:47,153][main.py][line:88][INFO] [Epoch:14/50]: loss1:0.0095 loss2:0.2221 loss3:0.0000 | AUC:0.8484 Anomaly AUC:0.6807
[2023-08-24 14:21:35,957][main.py][line:88][INFO] [Epoch:15/50]: loss1:0.0046 loss2:0.1767 loss3:0.0000 | AUC:0.8530 Anomaly AUC:0.6882
[2023-08-24 14:23:19,732][main.py][line:88][INFO] [Epoch:16/50]: loss1:0.0042 loss2:0.1476 loss3:0.0000 | AUC:0.8486 Anomaly AUC:0.6799
[2023-08-24 14:25:03,287][main.py][line:88][INFO] [Epoch:17/50]: loss1:0.0034 loss2:0.1240 loss3:0.0000 | AUC:0.8532 Anomaly AUC:0.6894
[2023-08-24 14:27:01,998][main.py][line:88][INFO] [Epoch:18/50]: loss1:0.0029 loss2:0.1020 loss3:0.0000 | AUC:0.8527 Anomaly AUC:0.6916
[2023-08-24 14:28:45,540][main.py][line:88][INFO] [Epoch:19/50]: loss1:0.0032 loss2:0.0894 loss3:0.0000 | AUC:0.8403 Anomaly AUC:0.6784
[2023-08-24 14:30:22,851][main.py][line:88][INFO] [Epoch:20/50]: loss1:0.0481 loss2:0.1458 loss3:0.0000 | AUC:0.8383 Anomaly AUC:0.6747
[2023-08-24 14:32:05,009][main.py][line:88][INFO] [Epoch:21/50]: loss1:0.0077 loss2:0.0949 loss3:0.0000 | AUC:0.8430 Anomaly AUC:0.6789
[2023-08-24 14:34:08,517][main.py][line:88][INFO] [Epoch:22/50]: loss1:0.0033 loss2:0.0716 loss3:0.0000 | AUC:0.8446 Anomaly AUC:0.6811
[2023-08-24 14:35:47,698][main.py][line:88][INFO] [Epoch:23/50]: loss1:0.0024 loss2:0.0579 loss3:0.0000 | AUC:0.8456 Anomaly AUC:0.6863
[2023-08-24 14:37:29,556][main.py][line:88][INFO] [Epoch:24/50]: loss1:0.0019 loss2:0.0479 loss3:0.0000 | AUC:0.8460 Anomaly AUC:0.6845
[2023-08-24 14:39:10,924][main.py][line:88][INFO] [Epoch:25/50]: loss1:0.0016 loss2:0.0416 loss3:0.0000 | AUC:0.8445 Anomaly AUC:0.6824
[2023-08-24 14:40:54,654][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8555.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 14:40:54,772][main.py][line:139][INFO] total params:1.2091M
[2023-08-24 14:40:54,772][main.py][line:147][INFO] Test Mode
[2023-08-24 14:40:54,772][main.py][line:42][INFO] Not found pretrained checkpoint file.
[2023-08-24 14:41:00,704][infer.py][line:47][INFO] offline AUC:0.5516 AP:0.0907 FAR:0.6865 | Complete in 0m 6s

[2023-08-24 14:42:05,459][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8555.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 14:42:05,545][main.py][line:139][INFO] total params:1.2091M
[2023-08-24 14:42:05,545][main.py][line:147][INFO] Test Mode
[2023-08-24 14:42:05,545][main.py][line:42][INFO] Not found pretrained checkpoint file.
[2023-08-24 14:42:10,995][infer.py][line:47][INFO] offline AUC:0.5516 AP:0.0907 FAR:0.6865 | Complete in 0m 5s

[2023-08-24 14:43:28,450][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 14:43:28,548][main.py][line:139][INFO] total params:1.2091M
[2023-08-24 14:43:28,548][main.py][line:147][INFO] Test Mode
[2023-08-24 14:43:28,548][main.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__current.pkl.
[2023-08-24 14:43:34,008][infer.py][line:47][INFO] offline AUC:0.8622 AP:0.3341 FAR:0.0016 | Complete in 0m 5s

[2023-08-24 14:46:21,927][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 14:46:22,175][main.py][line:139][INFO] total params:33.1046M
[2023-08-24 14:46:22,175][main.py][line:142][INFO] Training Mode
[2023-08-24 14:46:22,176][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.0, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.0, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.0, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 14:46:22,176][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 14:46:32,298][main.py][line:66][INFO] Random initialize AUCAUC:0.6143 Anomaly AUC:0.58483
[2023-08-24 14:48:33,816][main.py][line:88][INFO] [Epoch:1/50]: loss1:0.4623 loss2:1.1118 loss3:0.0000 | AUC:0.8028 Anomaly AUC:0.6294
[2023-08-24 14:51:17,516][main.py][line:88][INFO] [Epoch:2/50]: loss1:0.2898 loss2:0.9832 loss3:0.0000 | AUC:0.8281 Anomaly AUC:0.6569
[2023-08-24 14:53:48,290][main.py][line:88][INFO] [Epoch:3/50]: loss1:0.2198 loss2:0.9233 loss3:0.0000 | AUC:0.8279 Anomaly AUC:0.6554
[2023-08-24 14:56:13,833][main.py][line:88][INFO] [Epoch:4/50]: loss1:0.1708 loss2:0.8558 loss3:0.0000 | AUC:0.8395 Anomaly AUC:0.6716
[2023-08-24 14:58:40,756][main.py][line:88][INFO] [Epoch:5/50]: loss1:0.1492 loss2:0.8175 loss3:0.0000 | AUC:0.7899 Anomaly AUC:0.6480
[2023-08-24 15:01:11,262][main.py][line:88][INFO] [Epoch:6/50]: loss1:0.1045 loss2:0.7629 loss3:0.0000 | AUC:0.8198 Anomaly AUC:0.6636
[2023-08-24 15:03:28,726][main.py][line:88][INFO] [Epoch:7/50]: loss1:0.0828 loss2:0.7087 loss3:0.0000 | AUC:0.8223 Anomaly AUC:0.6654
[2023-08-24 15:05:46,305][main.py][line:88][INFO] [Epoch:8/50]: loss1:0.0622 loss2:0.6615 loss3:0.0000 | AUC:0.8168 Anomaly AUC:0.6510
[2023-08-24 15:07:10,075][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 15:07:10,348][main.py][line:139][INFO] total params:33.1046M
[2023-08-24 15:07:10,348][main.py][line:142][INFO] Training Mode
[2023-08-24 15:07:10,349][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.0, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 64, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(64, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(64, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.0, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.0, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 15:07:10,349][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.005
    lr: 0.005
    maximize: False
    weight_decay: 0
)

[2023-08-24 15:07:24,552][main.py][line:66][INFO] Random initialize AUCAUC:0.6143 Anomaly AUC:0.58483
[2023-08-24 15:11:07,753][main.py][line:88][INFO] [Epoch:1/50]: loss1:0.7805 loss2:1.4003 loss3:0.0000 | AUC:0.7518 Anomaly AUC:0.6536
[2023-08-24 15:15:39,898][main.py][line:88][INFO] [Epoch:2/50]: loss1:0.6983 loss2:1.4029 loss3:0.0000 | AUC:0.7677 Anomaly AUC:0.6638
[2023-08-24 15:19:04,435][main.py][line:88][INFO] [Epoch:3/50]: loss1:0.6487 loss2:1.3038 loss3:0.0000 | AUC:0.4571 Anomaly AUC:0.4288
[2023-08-24 15:22:23,110][main.py][line:88][INFO] [Epoch:4/50]: loss1:0.3835 loss2:1.1058 loss3:0.0000 | AUC:0.8178 Anomaly AUC:0.6449
[2023-08-24 15:25:19,931][main.py][line:88][INFO] [Epoch:5/50]: loss1:0.3267 loss2:1.0631 loss3:0.0000 | AUC:0.7987 Anomaly AUC:0.6292
[2023-08-24 15:28:13,430][main.py][line:88][INFO] [Epoch:6/50]: loss1:0.3074 loss2:1.0735 loss3:0.0000 | AUC:0.8118 Anomaly AUC:0.6345
[2023-08-24 15:30:22,523][main.py][line:88][INFO] [Epoch:7/50]: loss1:0.2914 loss2:1.0683 loss3:0.0000 | AUC:0.8031 Anomaly AUC:0.6178
[2023-08-24 15:33:16,167][main.py][line:88][INFO] [Epoch:8/50]: loss1:0.2777 loss2:1.0562 loss3:0.0000 | AUC:0.7081 Anomaly AUC:0.5441
[2023-08-24 15:35:34,380][main.py][line:88][INFO] [Epoch:9/50]: loss1:0.2372 loss2:1.0930 loss3:0.0000 | AUC:0.8180 Anomaly AUC:0.6514
[2023-08-24 15:38:00,919][main.py][line:88][INFO] [Epoch:10/50]: loss1:0.2521 loss2:1.0620 loss3:0.0000 | AUC:0.3753 Anomaly AUC:0.4292
[2023-08-24 15:40:38,069][main.py][line:88][INFO] [Epoch:11/50]: loss1:0.4009 loss2:1.1277 loss3:0.0000 | AUC:0.1932 Anomaly AUC:0.3758
[2023-08-24 15:43:21,129][main.py][line:88][INFO] [Epoch:12/50]: loss1:0.2953 loss2:1.1087 loss3:0.0000 | AUC:0.8265 Anomaly AUC:0.6491
[2023-08-24 15:45:47,884][main.py][line:88][INFO] [Epoch:13/50]: loss1:0.2335 loss2:1.0407 loss3:0.0000 | AUC:0.8158 Anomaly AUC:0.6590
[2023-08-24 15:48:06,528][main.py][line:88][INFO] [Epoch:14/50]: loss1:0.2130 loss2:0.9833 loss3:0.0000 | AUC:0.8177 Anomaly AUC:0.6622
[2023-08-24 15:50:23,939][main.py][line:88][INFO] [Epoch:15/50]: loss1:0.1892 loss2:0.9562 loss3:0.0000 | AUC:0.8203 Anomaly AUC:0.6724
[2023-08-24 15:52:56,939][main.py][line:88][INFO] [Epoch:16/50]: loss1:0.1786 loss2:0.9409 loss3:0.0000 | AUC:0.8190 Anomaly AUC:0.6585
[2023-08-24 15:55:10,022][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 15:55:10,297][main.py][line:139][INFO] total params:30.1014M
[2023-08-24 15:55:10,297][main.py][line:142][INFO] Training Mode
[2023-08-24 15:55:10,298][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 128, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(128, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.7, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 256, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(256, 256, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(256, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(256, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 256, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(256, 1024, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.7, inplace=False)
                  (4): Conv1d(1024, 256, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(256, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 512, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(8, 8, kernel_size=(5,), stride=(1,), padding=(2,), groups=8)
                  (to_out): Conv1d(512, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.7, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 128, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 15:55:10,298][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.005
    lr: 0.005
    maximize: False
    weight_decay: 0
)

[2023-08-24 15:55:24,519][main.py][line:66][INFO] Random initialize AUCAUC:0.4535 Anomaly AUC:0.46468
[2023-08-24 15:57:50,881][main.py][line:88][INFO] [Epoch:1/50]: loss1:0.7511 loss2:1.3009 loss3:0.0000 | AUC:0.5178 Anomaly AUC:0.5096
[2023-08-24 16:00:53,808][main.py][line:88][INFO] [Epoch:2/50]: loss1:0.6971 loss2:1.2423 loss3:0.0000 | AUC:0.4557 Anomaly AUC:0.4696
[2023-08-24 16:03:13,161][main.py][line:88][INFO] [Epoch:3/50]: loss1:0.6971 loss2:1.2623 loss3:0.0000 | AUC:0.5545 Anomaly AUC:0.5247
[2023-08-24 16:05:31,823][main.py][line:88][INFO] [Epoch:4/50]: loss1:0.6978 loss2:1.3055 loss3:0.0000 | AUC:0.4780 Anomaly AUC:0.4786
[2023-08-24 16:08:14,929][main.py][line:88][INFO] [Epoch:5/50]: loss1:0.6992 loss2:1.2563 loss3:0.0000 | AUC:0.4910 Anomaly AUC:0.5003
[2023-08-24 16:10:40,496][main.py][line:88][INFO] [Epoch:6/50]: loss1:0.6962 loss2:1.2397 loss3:0.0000 | AUC:0.5227 Anomaly AUC:0.5301
[2023-08-24 16:11:47,207][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 16:11:47,483][main.py][line:139][INFO] total params:29.6643M
[2023-08-24 16:11:47,483][main.py][line:142][INFO] Training Mode
[2023-08-24 16:11:47,484][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.7, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.7, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.7, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 16:11:47,484][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.005
    lr: 0.005
    maximize: False
    weight_decay: 0
)

[2023-08-24 16:12:00,926][main.py][line:66][INFO] Random initialize AUCAUC:0.4659 Anomaly AUC:0.54638
[2023-08-24 16:13:58,155][main.py][line:88][INFO] [Epoch:1/50]: loss1:0.7513 loss2:1.4025 loss3:0.0000 | AUC:0.5148 Anomaly AUC:0.5268
[2023-08-24 16:16:31,361][main.py][line:88][INFO] [Epoch:2/50]: loss1:0.7057 loss2:1.4002 loss3:0.0000 | AUC:0.4505 Anomaly AUC:0.3932
[2023-08-24 16:19:42,842][main.py][line:88][INFO] [Epoch:3/50]: loss1:0.6577 loss2:1.3402 loss3:0.0000 | AUC:0.7227 Anomaly AUC:0.5598
[2023-08-24 16:22:27,552][main.py][line:88][INFO] [Epoch:4/50]: loss1:0.3808 loss2:1.1063 loss3:0.0000 | AUC:0.8146 Anomaly AUC:0.6198
[2023-08-24 16:25:30,357][main.py][line:88][INFO] [Epoch:5/50]: loss1:0.3171 loss2:1.0306 loss3:0.0000 | AUC:0.7298 Anomaly AUC:0.5844
[2023-08-24 16:29:06,289][main.py][line:88][INFO] [Epoch:6/50]: loss1:0.2790 loss2:0.9817 loss3:0.0000 | AUC:0.7848 Anomaly AUC:0.6141
[2023-08-24 16:31:07,484][main.py][line:88][INFO] [Epoch:7/50]: loss1:0.2471 loss2:0.9517 loss3:0.0000 | AUC:0.7944 Anomaly AUC:0.6142
[2023-08-24 16:34:29,199][main.py][line:88][INFO] [Epoch:8/50]: loss1:0.2294 loss2:0.9310 loss3:0.0000 | AUC:0.8166 Anomaly AUC:0.6191
[2023-08-24 16:37:45,400][main.py][line:88][INFO] [Epoch:9/50]: loss1:0.2079 loss2:0.9073 loss3:0.0000 | AUC:0.8348 Anomaly AUC:0.6451
[2023-08-24 16:40:17,546][main.py][line:88][INFO] [Epoch:10/50]: loss1:0.2038 loss2:0.9012 loss3:0.0000 | AUC:0.8083 Anomaly AUC:0.6037
[2023-08-24 16:49:37,841][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 16:49:38,100][main.py][line:139][INFO] total params:29.6643M
[2023-08-24 16:49:38,100][main.py][line:142][INFO] Training Mode
[2023-08-24 16:49:38,101][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.7, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.7, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.7, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 16:49:38,101][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.005
    lr: 0.005
    maximize: False
    weight_decay: 0
)

[2023-08-24 16:49:52,731][main.py][line:66][INFO] Random initialize AUCAUC:0.4659 Anomaly AUC:0.54638
[2023-08-24 16:58:48,975][main.py][line:88][INFO] [Epoch:1/50]: loss1:0.7561 loss2:1.4201 loss3:0.0000 | AUC:0.6275 Anomaly AUC:0.5444
[2023-08-24 16:59:12,081][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 16:59:12,329][main.py][line:139][INFO] total params:29.6643M
[2023-08-24 16:59:12,329][main.py][line:142][INFO] Training Mode
[2023-08-24 16:59:12,330][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 64, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(64, 64, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(64, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 64, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(64, 256, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.7, inplace=False)
                  (4): Conv1d(256, 64, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(64, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.7, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(16, 16, kernel_size=(5,), stride=(1,), padding=(2,), groups=16)
                  (to_out): Conv1d(1024, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.7, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 64, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 16:59:12,330][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.005
    lr: 0.005
    maximize: False
    weight_decay: 0
)

[2023-08-24 16:59:21,549][main.py][line:66][INFO] Random initialize AUCAUC:0.4659 Anomaly AUC:0.54638
[2023-08-24 17:01:53,988][main.py][line:88][INFO] [Epoch:1/50]: loss1:0.7341 loss2:1.4007 loss3:0.0000 | AUC:0.5050 Anomaly AUC:0.5172
[2023-08-24 17:03:14,015][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 32, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 17:03:14,310][main.py][line:139][INFO] total params:35.9893M
[2023-08-24 17:03:14,311][main.py][line:142][INFO] Training Mode
[2023-08-24 17:03:14,311][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(512, 512, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(512, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 512, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(512, 2048, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(2048, 512, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(512, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 128, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(2, 2, kernel_size=(5,), stride=(1,), padding=(2,), groups=2)
                  (to_out): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 512, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 17:03:14,311][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.005
    lr: 0.005
    maximize: False
    weight_decay: 0
)

[2023-08-24 17:03:25,566][main.py][line:66][INFO] Random initialize AUCAUC:0.5148 Anomaly AUC:0.51334
[2023-08-24 17:05:22,316][main.py][line:88][INFO] [Epoch:1/50]: loss1:0.7299 loss2:1.2687 loss3:0.0000 | AUC:0.6886 Anomaly AUC:0.5402
[2023-08-24 17:07:23,347][main.py][line:88][INFO] [Epoch:2/50]: loss1:0.6700 loss2:1.2399 loss3:0.0000 | AUC:0.8006 Anomaly AUC:0.5941
[2023-08-24 17:09:26,275][main.py][line:88][INFO] [Epoch:3/50]: loss1:0.3292 loss2:0.9911 loss3:0.0000 | AUC:0.7457 Anomaly AUC:0.5871
[2023-08-24 17:11:28,951][main.py][line:88][INFO] [Epoch:4/50]: loss1:0.2440 loss2:0.9235 loss3:0.0000 | AUC:0.7824 Anomaly AUC:0.6024
[2023-08-24 17:14:06,041][main.py][line:88][INFO] [Epoch:5/50]: loss1:0.2022 loss2:0.8879 loss3:0.0000 | AUC:0.8015 Anomaly AUC:0.5922
[2023-08-24 17:16:42,471][main.py][line:88][INFO] [Epoch:6/50]: loss1:0.1647 loss2:0.8585 loss3:0.0000 | AUC:0.7856 Anomaly AUC:0.5941
[2023-08-24 17:18:53,746][main.py][line:88][INFO] [Epoch:7/50]: loss1:0.1385 loss2:0.8396 loss3:0.0000 | AUC:0.7949 Anomaly AUC:0.5976
[2023-08-24 17:21:07,518][main.py][line:88][INFO] [Epoch:8/50]: loss1:0.1015 loss2:0.8127 loss3:0.0000 | AUC:0.6707 Anomaly AUC:0.5585
[2023-08-24 17:23:10,525][main.py][line:88][INFO] [Epoch:9/50]: loss1:0.0743 loss2:0.7953 loss3:0.0000 | AUC:0.7459 Anomaly AUC:0.6078
[2023-08-24 17:25:25,568][main.py][line:88][INFO] [Epoch:10/50]: loss1:0.0628 loss2:0.7805 loss3:0.0000 | AUC:0.7126 Anomaly AUC:0.5723
[2023-08-24 17:28:06,500][main.py][line:88][INFO] [Epoch:11/50]: loss1:0.0474 loss2:0.7637 loss3:0.0000 | AUC:0.7423 Anomaly AUC:0.5934
[2023-08-24 17:30:13,947][main.py][line:88][INFO] [Epoch:12/50]: loss1:0.0310 loss2:0.7389 loss3:0.0000 | AUC:0.7289 Anomaly AUC:0.5804
[2023-08-24 17:32:30,973][main.py][line:88][INFO] [Epoch:13/50]: loss1:0.0348 loss2:0.7318 loss3:0.0000 | AUC:0.6353 Anomaly AUC:0.5607
[2023-08-24 17:34:37,409][main.py][line:88][INFO] [Epoch:14/50]: loss1:0.0274 loss2:0.6726 loss3:0.0000 | AUC:0.7321 Anomaly AUC:0.5876
[2023-08-24 17:34:43,311][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 32, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 17:34:43,581][main.py][line:139][INFO] total params:33.7275M
[2023-08-24 17:34:43,582][main.py][line:142][INFO] Training Mode
[2023-08-24 17:34:43,582][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 256, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(4, 4, kernel_size=(5,), stride=(1,), padding=(2,), groups=4)
                  (to_out): Conv1d(256, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 17:34:43,582][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.005
    lr: 0.005
    maximize: False
    weight_decay: 0
)

[2023-08-24 17:34:58,247][main.py][line:66][INFO] Random initialize AUCAUC:0.5238 Anomaly AUC:0.53492
[2023-08-24 17:36:53,783][main.py][line:88][INFO] [Epoch:1/50]: loss1:0.7389 loss2:1.2825 loss3:0.0000 | AUC:0.4931 Anomaly AUC:0.4742
[2023-08-24 17:38:42,787][main.py][line:88][INFO] [Epoch:2/50]: loss1:0.6981 loss2:1.2295 loss3:0.0000 | AUC:0.4201 Anomaly AUC:0.4588
[2023-08-24 17:40:30,612][main.py][line:88][INFO] [Epoch:3/50]: loss1:0.6960 loss2:1.2279 loss3:0.0000 | AUC:0.4506 Anomaly AUC:0.4567
[2023-08-24 17:42:18,855][main.py][line:88][INFO] [Epoch:4/50]: loss1:0.6943 loss2:1.2259 loss3:0.0000 | AUC:0.4133 Anomaly AUC:0.4542
[2023-08-24 17:44:09,997][main.py][line:88][INFO] [Epoch:5/50]: loss1:0.6937 loss2:1.2252 loss3:0.0000 | AUC:0.4367 Anomaly AUC:0.4484
[2023-08-24 17:46:11,709][main.py][line:88][INFO] [Epoch:6/50]: loss1:0.6935 loss2:1.2259 loss3:0.0000 | AUC:0.4744 Anomaly AUC:0.4877
[2023-08-24 17:48:10,090][main.py][line:88][INFO] [Epoch:7/50]: loss1:0.6934 loss2:1.2244 loss3:0.0000 | AUC:0.5731 Anomaly AUC:0.5113
[2023-08-24 17:48:52,762][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 32, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 17:48:53,044][main.py][line:139][INFO] total params:33.7275M
[2023-08-24 17:48:53,044][main.py][line:142][INFO] Training Mode
[2023-08-24 17:48:53,045][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (mgfn): mgfn(
      (to_tokens): Conv1d(1024, 32, kernel_size=(3,), stride=(1,), padding=(1,))
      (stages): ModuleList(
        (0): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(32, 32, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): GLANCE(
                  (norm): LayerNorm()
                  (to_qkv): Conv1d(32, 192, kernel_size=(1,), stride=(1,), bias=False)
                  (to_out): Conv1d(64, 32, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(128, 32, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(32, 128, kernel_size=(1,), stride=(1,))
          )
        )
        (1): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-2): 3 x ModuleList(
                (0): Conv1d(128, 128, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(128, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(128, 256, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(4, 4, kernel_size=(5,), stride=(1,), padding=(2,), groups=4)
                  (to_out): Conv1d(256, 128, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(128, 512, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(512, 128, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): Sequential(
            (0): LayerNorm()
            (1): Conv1d(128, 1024, kernel_size=(1,), stride=(1,))
          )
        )
        (2): ModuleList(
          (0): Backbone(
            (layers): ModuleList(
              (0-1): 2 x ModuleList(
                (0): Conv1d(1024, 1024, kernel_size=(3,), stride=(1,), padding=(1,))
                (1): FOCUS(
                  (norm): BatchNorm1d(1024, eps=1e-05, momentum=0.1, affine=True, track_running_stats=True)
                  (to_v): Conv1d(1024, 2048, kernel_size=(1,), stride=(1,), bias=False)
                  (rel_pos): Conv1d(32, 32, kernel_size=(5,), stride=(1,), padding=(2,), groups=32)
                  (to_out): Conv1d(2048, 1024, kernel_size=(1,), stride=(1,))
                )
                (2): Sequential(
                  (0): LayerNorm()
                  (1): Conv1d(1024, 4096, kernel_size=(1,), stride=(1,))
                  (2): GELU(approximate='none')
                  (3): Dropout(p=0.1, inplace=False)
                  (4): Conv1d(4096, 1024, kernel_size=(1,), stride=(1,))
                )
              )
            )
          )
          (1): None
        )
      )
      (to_logits): Sequential(
        (0): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
      )
      (to_mag): Conv1d(1, 32, kernel_size=(3,), stride=(1,), padding=(1,))
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 17:48:53,045][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.005
    lr: 0.005
    maximize: False
    weight_decay: 0
)

[2023-08-24 17:49:08,177][main.py][line:66][INFO] Random initialize AUCAUC:0.5238 Anomaly AUC:0.53492
[2023-08-24 17:51:12,529][main.py][line:88][INFO] [Epoch:1/50]: loss1:0.4881 loss2:1.1281 loss3:134.6923 | AUC:0.7305 Anomaly AUC:0.5887
[2023-08-24 17:53:55,497][main.py][line:88][INFO] [Epoch:2/50]: loss1:0.2149 loss2:0.9256 loss3:186.3966 | AUC:0.8230 Anomaly AUC:0.6373
[2023-08-24 17:56:19,499][main.py][line:88][INFO] [Epoch:3/50]: loss1:0.1481 loss2:0.8727 loss3:183.0580 | AUC:0.8032 Anomaly AUC:0.6096
[2023-08-24 17:58:19,837][main.py][line:88][INFO] [Epoch:4/50]: loss1:0.0999 loss2:0.8334 loss3:143.1277 | AUC:0.8298 Anomaly AUC:0.6423
[2023-08-24 17:59:58,679][main.py][line:88][INFO] [Epoch:5/50]: loss1:0.0895 loss2:0.8189 loss3:127.5040 | AUC:0.8015 Anomaly AUC:0.6218
[2023-08-24 18:01:50,420][main.py][line:88][INFO] [Epoch:6/50]: loss1:0.0644 loss2:0.7333 loss3:181.7980 | AUC:0.8307 Anomaly AUC:0.6776
[2023-08-24 18:04:21,601][main.py][line:88][INFO] [Epoch:7/50]: loss1:0.0537 loss2:0.6312 loss3:161.9659 | AUC:0.8235 Anomaly AUC:0.6643
[2023-08-24 18:06:00,066][main.py][line:88][INFO] [Epoch:8/50]: loss1:0.0470 loss2:0.6933 loss3:124.9404 | AUC:0.8147 Anomaly AUC:0.6652
[2023-08-24 18:07:41,419][main.py][line:88][INFO] [Epoch:9/50]: loss1:0.0665 loss2:0.6860 loss3:127.8434 | AUC:0.7973 Anomaly AUC:0.6567
[2023-08-24 18:09:21,258][main.py][line:88][INFO] [Epoch:10/50]: loss1:0.0346 loss2:0.7578 loss3:138.1157 | AUC:0.8272 Anomaly AUC:0.6652
[2023-08-24 18:11:05,899][main.py][line:88][INFO] [Epoch:11/50]: loss1:0.0396 loss2:0.7042 loss3:203.8456 | AUC:0.8341 Anomaly AUC:0.6833
[2023-08-24 18:12:50,211][main.py][line:88][INFO] [Epoch:12/50]: loss1:0.0916 loss2:0.3610 loss3:539.6075 | AUC:0.5244 Anomaly AUC:0.5163
[2023-08-24 18:14:34,578][main.py][line:88][INFO] [Epoch:13/50]: loss1:0.6748 loss2:1.1061 loss3:245.6854 | AUC:0.3813 Anomaly AUC:0.4770
[2023-08-24 18:45:13,066][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 18:45:13,173][main.py][line:139][INFO] total params:1.2091M
[2023-08-24 18:45:13,173][main.py][line:142][INFO] Training Mode
[2023-08-24 18:45:34,792][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 18:45:34,877][main.py][line:139][INFO] total params:1.2091M
[2023-08-24 18:45:34,877][main.py][line:142][INFO] Training Mode
[2023-08-24 18:45:34,877][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.7, inplace=False)
)

[2023-08-24 18:45:34,877][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 18:45:40,796][main.py][line:66][INFO] Random initialize AUCAUC:0.5444 Anomaly AUC:0.53443
[2023-08-24 18:46:30,622][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 18:46:30,717][main.py][line:139][INFO] total params:1.2091M
[2023-08-24 18:46:30,717][main.py][line:142][INFO] Training Mode
[2023-08-24 18:46:30,717][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 18:46:30,717][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 18:49:16,109][main.py][line:88][INFO] [Epoch:1/50]: loss1:0.2677 loss2:0.9842 loss3:0.0000 | AUC:0.8356 Anomaly AUC:0.6522
[2023-08-24 18:52:15,164][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 18:52:15,273][main.py][line:139][INFO] total params:1.2091M
[2023-08-24 18:52:15,273][main.py][line:142][INFO] Training Mode
[2023-08-24 18:52:15,273][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 18:52:15,273][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 18:58:30,221][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 18:58:30,333][main.py][line:139][INFO] total params:7.7021M
[2023-08-24 18:58:30,333][main.py][line:142][INFO] Training Mode
[2023-08-24 18:58:30,334][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (cls_head): ADCLS_head(
        (mlp): Sequential(
          (0): Linear(in_features=1024, out_features=128, bias=True)
          (1): ReLU()
          (2): Linear(in_features=128, out_features=1, bias=True)
          (3): Sigmoid()
        )
      )
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 18:58:30,334][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 18:59:31,411][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 18:59:31,538][main.py][line:139][INFO] total params:7.7021M
[2023-08-24 18:59:31,538][main.py][line:142][INFO] Training Mode
[2023-08-24 18:59:31,539][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (cls_head): ADCLS_head(
        (mlp): Sequential(
          (0): Linear(in_features=1024, out_features=128, bias=True)
          (1): ReLU()
          (2): Linear(in_features=128, out_features=1, bias=True)
          (3): Sigmoid()
        )
      )
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 18:59:31,539][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:09:14,662][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 19:09:14,772][main.py][line:139][INFO] total params:7.5707M
[2023-08-24 19:09:14,772][main.py][line:142][INFO] Training Mode
[2023-08-24 19:09:14,772][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 19:09:14,772][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:09:26,360][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 19:09:26,487][main.py][line:139][INFO] total params:7.5707M
[2023-08-24 19:09:26,487][main.py][line:142][INFO] Training Mode
[2023-08-24 19:09:26,487][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 19:09:26,487][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:10:21,243][main.py][line:103][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 19:10:21,366][main.py][line:139][INFO] total params:7.5707M
[2023-08-24 19:10:21,367][main.py][line:142][INFO] Training Mode
[2023-08-24 19:10:21,367][main.py][line:62][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 19:10:21,367][main.py][line:63][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:12:15,767][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 19:12:15,897][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 19:12:15,897][main.py][line:145][INFO] Training Mode
[2023-08-24 19:12:15,898][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 19:12:15,898][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:14:10,006][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 19:14:10,116][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 19:14:10,116][main.py][line:145][INFO] Training Mode
[2023-08-24 19:14:10,117][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 19:14:10,117][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:18:34,195][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 19:18:34,323][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 19:18:34,324][main.py][line:145][INFO] Training Mode
[2023-08-24 19:18:34,324][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 19:18:34,324][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:23:44,732][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 16, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 19:23:44,883][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 19:23:44,883][main.py][line:145][INFO] Training Mode
[2023-08-24 19:23:44,884][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 19:23:44,884][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:37:49,977][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 19:37:50,117][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 19:37:50,118][main.py][line:145][INFO] Training Mode
[2023-08-24 19:37:50,118][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 19:37:50,118][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:38:12,984][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 19:38:13,103][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 19:38:13,103][main.py][line:145][INFO] Training Mode
[2023-08-24 19:38:13,103][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 19:38:13,103][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:38:43,150][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 19:38:43,272][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 19:38:43,272][main.py][line:145][INFO] Training Mode
[2023-08-24 19:38:43,273][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 19:38:43,273][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:38:55,563][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 19:38:55,681][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 19:38:55,681][main.py][line:145][INFO] Training Mode
[2023-08-24 19:38:55,681][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 19:38:55,681][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:39:13,683][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 19:39:13,805][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 19:39:13,805][main.py][line:145][INFO] Training Mode
[2023-08-24 19:39:13,805][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 19:39:13,805][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:39:31,852][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 19:39:31,976][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 19:39:31,977][main.py][line:145][INFO] Training Mode
[2023-08-24 19:39:31,977][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 19:39:31,977][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-24 19:39:39,478][main.py][line:69][INFO] Random initialize AUCAUC:0.4034 Anomaly AUC:0.48216
[2023-08-24 19:43:45,403][main.py][line:91][INFO] [Epoch:1/50]: loss1:0.3824 loss2:0.9943 loss3:0.3244 | AUC:0.8248 Anomaly AUC:0.6711
[2023-08-24 19:47:43,497][main.py][line:91][INFO] [Epoch:2/50]: loss1:0.1385 loss2:0.7168 loss3:0.1913 | AUC:0.8525 Anomaly AUC:0.6857
[2023-08-24 19:50:49,804][main.py][line:91][INFO] [Epoch:3/50]: loss1:0.0550 loss2:0.5504 loss3:0.0844 | AUC:0.8351 Anomaly AUC:0.6613
[2023-08-24 19:53:57,324][main.py][line:91][INFO] [Epoch:4/50]: loss1:0.0201 loss2:0.3480 loss3:0.0721 | AUC:0.8210 Anomaly AUC:0.6337
[2023-08-24 19:57:58,815][main.py][line:91][INFO] [Epoch:5/50]: loss1:0.0187 loss2:0.2016 loss3:0.0701 | AUC:0.8268 Anomaly AUC:0.6420
[2023-08-24 20:02:10,281][main.py][line:91][INFO] [Epoch:6/50]: loss1:0.0199 loss2:0.1201 loss3:0.0699 | AUC:0.8346 Anomaly AUC:0.6722
[2023-08-24 20:06:02,091][main.py][line:91][INFO] [Epoch:7/50]: loss1:0.0148 loss2:0.0647 loss3:0.0688 | AUC:0.8161 Anomaly AUC:0.6260
[2023-08-24 20:09:54,174][main.py][line:91][INFO] [Epoch:8/50]: loss1:0.0043 loss2:0.0314 loss3:0.0656 | AUC:0.8302 Anomaly AUC:0.6315
[2023-08-24 20:13:48,385][main.py][line:91][INFO] [Epoch:9/50]: loss1:0.0071 loss2:0.0277 loss3:0.0653 | AUC:0.8326 Anomaly AUC:0.6492
[2023-08-24 20:17:51,965][main.py][line:91][INFO] [Epoch:10/50]: loss1:0.0096 loss2:0.0306 loss3:0.0664 | AUC:0.8291 Anomaly AUC:0.6396
[2023-08-24 20:21:43,674][main.py][line:91][INFO] [Epoch:11/50]: loss1:0.0104 loss2:0.0316 loss3:0.0662 | AUC:0.8390 Anomaly AUC:0.6518
[2023-08-24 20:25:33,460][main.py][line:91][INFO] [Epoch:12/50]: loss1:0.0004 loss2:0.0069 loss3:0.0631 | AUC:0.8389 Anomaly AUC:0.6508
[2023-08-24 20:29:05,710][main.py][line:91][INFO] [Epoch:13/50]: loss1:0.0004 loss2:0.0050 loss3:0.0627 | AUC:0.8349 Anomaly AUC:0.6367
[2023-08-24 20:32:43,758][main.py][line:91][INFO] [Epoch:14/50]: loss1:0.0001 loss2:0.0034 loss3:0.0624 | AUC:0.8449 Anomaly AUC:0.6549
[2023-08-24 20:36:39,194][main.py][line:91][INFO] [Epoch:15/50]: loss1:0.0001 loss2:0.0031 loss3:0.0620 | AUC:0.8460 Anomaly AUC:0.6647
[2023-08-24 20:40:06,542][main.py][line:91][INFO] [Epoch:16/50]: loss1:0.0002 loss2:0.0034 loss3:0.0618 | AUC:0.8372 Anomaly AUC:0.6544
[2023-08-24 20:44:13,691][main.py][line:91][INFO] [Epoch:17/50]: loss1:0.0280 loss2:0.0562 loss3:0.0685 | AUC:0.7830 Anomaly AUC:0.6153
[2023-08-24 20:47:58,752][main.py][line:91][INFO] [Epoch:18/50]: loss1:0.0052 loss2:0.0156 loss3:0.0645 | AUC:0.8374 Anomaly AUC:0.6375
[2023-08-24 20:51:45,833][main.py][line:91][INFO] [Epoch:19/50]: loss1:0.0024 loss2:0.0086 loss3:0.0634 | AUC:0.8379 Anomaly AUC:0.6494
[2023-08-24 20:55:20,780][main.py][line:91][INFO] [Epoch:20/50]: loss1:0.0034 loss2:0.0047 loss3:0.0633 | AUC:0.8375 Anomaly AUC:0.6550
[2023-08-24 20:59:08,326][main.py][line:91][INFO] [Epoch:21/50]: loss1:0.0100 loss2:0.0162 loss3:0.0650 | AUC:0.8416 Anomaly AUC:0.6400
[2023-08-24 21:02:43,115][main.py][line:91][INFO] [Epoch:22/50]: loss1:0.0001 loss2:0.0023 loss3:0.0624 | AUC:0.8402 Anomaly AUC:0.6540
[2023-08-24 21:06:05,202][main.py][line:91][INFO] [Epoch:23/50]: loss1:0.0001 loss2:0.0011 loss3:0.0619 | AUC:0.8477 Anomaly AUC:0.6578
[2023-08-24 21:09:50,110][main.py][line:91][INFO] [Epoch:24/50]: loss1:0.0001 loss2:0.0004 loss3:0.0617 | AUC:0.8482 Anomaly AUC:0.6568
[2023-08-24 21:13:45,338][main.py][line:91][INFO] [Epoch:25/50]: loss1:0.0000 loss2:0.0003 loss3:0.0613 | AUC:0.8432 Anomaly AUC:0.6544
[2023-08-24 21:17:38,813][main.py][line:91][INFO] [Epoch:26/50]: loss1:0.0000 loss2:0.0003 loss3:0.0610 | AUC:0.8427 Anomaly AUC:0.6524
[2023-08-24 21:18:00,775][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 21:18:00,940][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 21:18:00,940][main.py][line:145][INFO] Training Mode
[2023-08-24 21:18:00,941][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 21:18:00,941][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0
)

[2023-08-24 21:18:08,680][main.py][line:69][INFO] Random initialize AUCAUC:0.4034 Anomaly AUC:0.48216
[2023-08-24 21:20:26,838][main.py][line:91][INFO] [Epoch:1/50]: loss1:0.3713 loss2:0.9697 loss3:0.3805 | AUC:0.8331 Anomaly AUC:0.6707
[2023-08-24 21:22:42,318][main.py][line:91][INFO] [Epoch:2/50]: loss1:0.1080 loss2:0.6650 loss3:0.3640 | AUC:0.8031 Anomaly AUC:0.6663
[2023-08-24 21:24:42,006][main.py][line:91][INFO] [Epoch:3/50]: loss1:0.0286 loss2:0.4815 loss3:0.3484 | AUC:0.7940 Anomaly AUC:0.6330
[2023-08-24 21:26:43,974][main.py][line:91][INFO] [Epoch:4/50]: loss1:0.0242 loss2:0.3371 loss3:0.3282 | AUC:0.8293 Anomaly AUC:0.6633
[2023-08-24 21:28:55,475][main.py][line:91][INFO] [Epoch:5/50]: loss1:0.0124 loss2:0.2030 loss3:0.3040 | AUC:0.8095 Anomaly AUC:0.6583
[2023-08-24 21:29:07,869][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 21:29:08,015][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 21:29:08,015][main.py][line:145][INFO] Training Mode
[2023-08-24 21:29:08,015][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 21:29:08,016][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-08-24 21:29:18,659][main.py][line:69][INFO] Random initialize AUCAUC:0.4034 Anomaly AUC:0.48216
[2023-08-24 21:32:07,116][main.py][line:91][INFO] [Epoch:1/50]: loss1:0.4647 loss2:1.0762 loss3:0.1938 | AUC:0.7989 Anomaly AUC:0.6214
[2023-08-24 21:34:32,729][main.py][line:91][INFO] [Epoch:2/50]: loss1:0.2083 loss2:0.7833 loss3:0.0668 | AUC:0.7797 Anomaly AUC:0.6037
[2023-08-24 21:36:42,965][main.py][line:91][INFO] [Epoch:3/50]: loss1:0.1094 loss2:0.6202 loss3:0.0649 | AUC:0.7698 Anomaly AUC:0.6179
[2023-08-24 21:36:52,896][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 21:36:53,041][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 21:36:53,041][main.py][line:145][INFO] Training Mode
[2023-08-24 21:36:53,042][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 21:36:53,042][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0003
    lr: 0.0003
    maximize: False
    weight_decay: 5e-05
)

[2023-08-24 21:37:00,634][main.py][line:69][INFO] Random initialize AUCAUC:0.4034 Anomaly AUC:0.48216
[2023-08-24 21:40:14,380][main.py][line:91][INFO] [Epoch:1/50]: loss1:0.3846 loss2:0.9814 loss3:0.3597 | AUC:0.8234 Anomaly AUC:0.6894
[2023-08-24 21:43:27,443][main.py][line:91][INFO] [Epoch:2/50]: loss1:0.1089 loss2:0.6697 loss3:0.2349 | AUC:0.8287 Anomaly AUC:0.6820
[2023-08-24 21:45:54,659][main.py][line:91][INFO] [Epoch:3/50]: loss1:0.0313 loss2:0.4741 loss3:0.1024 | AUC:0.8274 Anomaly AUC:0.6720
[2023-08-24 21:48:26,595][main.py][line:91][INFO] [Epoch:4/50]: loss1:0.0156 loss2:0.2929 loss3:0.0889 | AUC:0.8468 Anomaly AUC:0.6829
[2023-08-24 21:51:25,944][main.py][line:91][INFO] [Epoch:5/50]: loss1:0.0189 loss2:0.1790 loss3:0.0837 | AUC:0.8492 Anomaly AUC:0.6956
[2023-08-24 21:54:45,458][main.py][line:91][INFO] [Epoch:6/50]: loss1:0.0068 loss2:0.0828 loss3:0.0743 | AUC:0.8361 Anomaly AUC:0.6784
[2023-08-24 21:57:42,931][main.py][line:91][INFO] [Epoch:7/50]: loss1:0.0122 loss2:0.0701 loss3:0.0720 | AUC:0.8565 Anomaly AUC:0.7041
[2023-08-24 22:00:37,459][main.py][line:91][INFO] [Epoch:8/50]: loss1:0.0036 loss2:0.0413 loss3:0.0690 | AUC:0.8447 Anomaly AUC:0.6987
[2023-08-24 22:04:09,431][main.py][line:91][INFO] [Epoch:9/50]: loss1:0.0094 loss2:0.0419 loss3:0.0685 | AUC:0.8501 Anomaly AUC:0.6899
[2023-08-24 22:07:04,392][main.py][line:91][INFO] [Epoch:10/50]: loss1:0.0118 loss2:0.0394 loss3:0.0695 | AUC:0.8363 Anomaly AUC:0.6809
[2023-08-24 22:09:57,464][main.py][line:91][INFO] [Epoch:11/50]: loss1:0.0056 loss2:0.0220 loss3:0.0658 | AUC:0.8503 Anomaly AUC:0.7057
[2023-08-24 22:12:56,081][main.py][line:91][INFO] [Epoch:12/50]: loss1:0.0002 loss2:0.0072 loss3:0.0630 | AUC:0.8445 Anomaly AUC:0.7060
[2023-08-24 22:16:03,660][main.py][line:91][INFO] [Epoch:13/50]: loss1:0.0001 loss2:0.0055 loss3:0.0622 | AUC:0.8421 Anomaly AUC:0.7050
[2023-08-24 22:19:29,072][main.py][line:91][INFO] [Epoch:14/50]: loss1:0.0001 loss2:0.0043 loss3:0.0617 | AUC:0.8409 Anomaly AUC:0.6985
[2023-08-24 22:22:40,902][main.py][line:91][INFO] [Epoch:15/50]: loss1:0.0001 loss2:0.0037 loss3:0.0615 | AUC:0.8345 Anomaly AUC:0.6860
[2023-08-24 22:25:32,381][main.py][line:91][INFO] [Epoch:16/50]: loss1:0.0001 loss2:0.0033 loss3:0.0611 | AUC:0.8238 Anomaly AUC:0.6762
[2023-08-24 22:28:52,212][main.py][line:91][INFO] [Epoch:17/50]: loss1:0.0001 loss2:0.0027 loss3:0.0609 | AUC:0.8243 Anomaly AUC:0.6816
[2023-08-24 22:31:50,004][main.py][line:91][INFO] [Epoch:18/50]: loss1:0.0001 loss2:0.0024 loss3:0.0608 | AUC:0.8111 Anomaly AUC:0.6695
[2023-08-24 22:35:01,221][main.py][line:91][INFO] [Epoch:19/50]: loss1:0.0001 loss2:0.0023 loss3:0.0606 | AUC:0.8197 Anomaly AUC:0.6684
[2023-08-24 22:38:06,480][main.py][line:91][INFO] [Epoch:20/50]: loss1:0.0001 loss2:0.0020 loss3:0.0603 | AUC:0.8114 Anomaly AUC:0.6596
[2023-08-24 22:41:02,054][main.py][line:91][INFO] [Epoch:21/50]: loss1:0.0001 loss2:0.0018 loss3:0.0605 | AUC:0.8100 Anomaly AUC:0.6566
[2023-08-24 22:44:08,650][main.py][line:91][INFO] [Epoch:22/50]: loss1:0.0001 loss2:0.0016 loss3:0.0602 | AUC:0.8199 Anomaly AUC:0.6602
[2023-08-24 22:47:51,966][main.py][line:91][INFO] [Epoch:23/50]: loss1:0.0723 loss2:0.1058 loss3:0.0755 | AUC:0.8351 Anomaly AUC:0.6633
[2023-08-24 22:51:16,994][main.py][line:91][INFO] [Epoch:24/50]: loss1:0.0005 loss2:0.0048 loss3:0.0638 | AUC:0.8342 Anomaly AUC:0.6583
[2023-08-24 22:54:28,618][main.py][line:91][INFO] [Epoch:25/50]: loss1:0.0002 loss2:0.0020 loss3:0.0619 | AUC:0.8386 Anomaly AUC:0.6570
[2023-08-24 22:57:44,451][main.py][line:91][INFO] [Epoch:26/50]: loss1:0.0001 loss2:0.0017 loss3:0.0611 | AUC:0.8345 Anomaly AUC:0.6508
[2023-08-24 23:01:08,533][main.py][line:91][INFO] [Epoch:27/50]: loss1:0.0001 loss2:0.0013 loss3:0.0605 | AUC:0.8340 Anomaly AUC:0.6478
[2023-08-24 23:04:14,982][main.py][line:91][INFO] [Epoch:28/50]: loss1:0.0001 loss2:0.0011 loss3:0.0604 | AUC:0.8282 Anomaly AUC:0.6335
[2023-08-24 23:06:41,535][main.py][line:91][INFO] [Epoch:29/50]: loss1:0.0001 loss2:0.0009 loss3:0.0601 | AUC:0.8314 Anomaly AUC:0.6379
[2023-08-24 23:09:46,293][main.py][line:91][INFO] [Epoch:30/50]: loss1:0.0001 loss2:0.0008 loss3:0.0598 | AUC:0.8335 Anomaly AUC:0.6402
[2023-08-24 23:12:37,910][main.py][line:91][INFO] [Epoch:31/50]: loss1:0.0001 loss2:0.0005 loss3:0.0598 | AUC:0.8396 Anomaly AUC:0.6428
[2023-08-24 23:16:00,109][main.py][line:91][INFO] [Epoch:32/50]: loss1:0.0001 loss2:0.0006 loss3:0.0598 | AUC:0.8423 Anomaly AUC:0.6402
[2023-08-24 23:18:44,463][main.py][line:91][INFO] [Epoch:33/50]: loss1:0.0001 loss2:0.0002 loss3:0.0597 | AUC:0.8411 Anomaly AUC:0.6349
[2023-08-24 23:21:00,592][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-24 23:21:00,755][main.py][line:142][INFO] total params:7.5707M
[2023-08-24 23:21:00,755][main.py][line:145][INFO] Training Mode
[2023-08-24 23:21:00,755][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-24 23:21:00,756][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003
    maximize: False
    weight_decay: 5e-05
)

[2023-08-24 23:21:12,887][main.py][line:69][INFO] Random initialize AUCAUC:0.4034 Anomaly AUC:0.48216
[2023-08-24 23:24:58,720][main.py][line:91][INFO] [Epoch:1/50]: loss1:0.3846 loss2:0.9814 loss3:0.3597 | AUC:0.8234 Anomaly AUC:0.6894
[2023-08-24 23:28:41,243][main.py][line:91][INFO] [Epoch:2/50]: loss1:0.1055 loss2:0.6643 loss3:0.2345 | AUC:0.8069 Anomaly AUC:0.6795
[2023-08-24 23:31:28,549][main.py][line:91][INFO] [Epoch:3/50]: loss1:0.0330 loss2:0.4696 loss3:0.1020 | AUC:0.8251 Anomaly AUC:0.6829
[2023-08-24 23:34:06,799][main.py][line:91][INFO] [Epoch:4/50]: loss1:0.0209 loss2:0.3011 loss3:0.0879 | AUC:0.8313 Anomaly AUC:0.6729
[2023-08-24 23:39:59,409][main.py][line:91][INFO] [Epoch:5/50]: loss1:0.0071 loss2:0.1499 loss3:0.0801 | AUC:0.8392 Anomaly AUC:0.6701
[2023-08-24 23:44:21,195][main.py][line:91][INFO] [Epoch:6/50]: loss1:0.0006 loss2:0.0587 loss3:0.0697 | AUC:0.8503 Anomaly AUC:0.6741
[2023-08-24 23:47:50,229][main.py][line:91][INFO] [Epoch:7/50]: loss1:0.0003 loss2:0.0332 loss3:0.0667 | AUC:0.8466 Anomaly AUC:0.6666
[2023-08-24 23:52:59,547][main.py][line:91][INFO] [Epoch:8/50]: loss1:0.0002 loss2:0.0218 loss3:0.0649 | AUC:0.8514 Anomaly AUC:0.6778
[2023-08-24 23:58:23,063][main.py][line:91][INFO] [Epoch:9/50]: loss1:0.0002 loss2:0.0151 loss3:0.0636 | AUC:0.8503 Anomaly AUC:0.6741
[2023-08-25 00:03:06,644][main.py][line:91][INFO] [Epoch:10/50]: loss1:0.0002 loss2:0.0115 loss3:0.0626 | AUC:0.8504 Anomaly AUC:0.6773
[2023-08-25 00:07:24,983][main.py][line:91][INFO] [Epoch:11/50]: loss1:0.0598 loss2:0.1997 loss3:0.0730 | AUC:0.8326 Anomaly AUC:0.6767
[2023-08-25 00:10:29,260][main.py][line:91][INFO] [Epoch:12/50]: loss1:0.0189 loss2:0.0635 loss3:0.0692 | AUC:0.8413 Anomaly AUC:0.6801
[2023-08-25 00:13:53,825][main.py][line:91][INFO] [Epoch:13/50]: loss1:0.0092 loss2:0.0321 loss3:0.0657 | AUC:0.8250 Anomaly AUC:0.6738
[2023-08-25 00:17:19,649][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 00:17:19,794][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 00:17:19,794][main.py][line:145][INFO] Training Mode
[2023-08-25 00:17:19,795][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 00:17:19,795][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-25 00:17:28,828][main.py][line:69][INFO] Random initialize AUCAUC:0.4034 Anomaly AUC:0.48216
[2023-08-25 00:20:59,742][main.py][line:91][INFO] [Epoch:1/50]: loss1:0.3890 loss2:0.9953 loss3:0.3382 | AUC:0.8300 Anomaly AUC:0.6413
[2023-08-25 00:23:48,791][main.py][line:91][INFO] [Epoch:2/50]: loss1:0.1312 loss2:0.7113 loss3:0.2083 | AUC:0.8378 Anomaly AUC:0.6818
[2023-08-25 00:26:24,778][main.py][line:91][INFO] [Epoch:3/50]: loss1:0.0397 loss2:0.5203 loss3:0.1199 | AUC:0.8202 Anomaly AUC:0.6694
[2023-08-25 00:28:54,364][main.py][line:91][INFO] [Epoch:4/50]: loss1:0.0220 loss2:0.3225 loss3:0.0813 | AUC:0.8325 Anomaly AUC:0.6688
[2023-08-25 00:32:06,014][main.py][line:91][INFO] [Epoch:5/50]: loss1:0.0167 loss2:0.1722 loss3:0.0754 | AUC:0.8256 Anomaly AUC:0.6255
[2023-08-25 00:35:41,280][main.py][line:91][INFO] [Epoch:6/50]: loss1:0.0146 loss2:0.0991 loss3:0.0727 | AUC:0.8202 Anomaly AUC:0.6335
[2023-08-25 00:40:00,439][main.py][line:91][INFO] [Epoch:7/50]: loss1:0.0325 loss2:0.0954 loss3:0.0737 | AUC:0.8454 Anomaly AUC:0.6581
[2023-08-25 00:43:33,776][main.py][line:91][INFO] [Epoch:8/50]: loss1:0.0165 loss2:0.0564 loss3:0.0714 | AUC:0.8177 Anomaly AUC:0.6384
[2023-08-25 00:46:42,367][main.py][line:91][INFO] [Epoch:9/50]: loss1:0.0066 loss2:0.0289 loss3:0.0685 | AUC:0.8192 Anomaly AUC:0.6161
[2023-08-25 00:47:55,676][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 00:47:55,831][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 00:47:55,831][main.py][line:145][INFO] Training Mode
[2023-08-25 00:47:55,832][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 00:47:55,832][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-25 00:48:27,333][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 00:48:27,454][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 00:48:27,454][main.py][line:145][INFO] Training Mode
[2023-08-25 00:48:27,455][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 00:48:27,455][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-25 00:49:59,028][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 00:49:59,138][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 00:49:59,138][main.py][line:145][INFO] Training Mode
[2023-08-25 00:49:59,139][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 00:49:59,139][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-25 00:50:15,071][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 00:50:15,197][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 00:50:15,197][main.py][line:145][INFO] Training Mode
[2023-08-25 00:50:15,198][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 00:50:15,198][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-25 00:53:42,635][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 00:53:42,755][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 00:53:42,756][main.py][line:145][INFO] Training Mode
[2023-08-25 00:53:42,756][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (embedding): Temporal(
      (conv_1): Sequential(
        (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
        (1): ReLU()
      )
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 00:53:42,756][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-25 00:55:08,265][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 00:55:08,388][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 00:55:08,388][main.py][line:145][INFO] Training Mode
[2023-08-25 00:55:08,388][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 00:55:08,388][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-25 00:55:52,026][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 00:55:52,148][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 00:55:52,149][main.py][line:145][INFO] Training Mode
[2023-08-25 00:55:52,149][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 00:55:52,149][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-25 00:55:58,429][main.py][line:69][INFO] Random initialize AUCAUC:0.4396 Anomaly AUC:0.41765
[2023-08-25 00:59:33,002][main.py][line:91][INFO] [Epoch:1/50]: loss1:0.4214 loss2:1.1170 loss3:0.3832 | AUC:0.8218 Anomaly AUC:0.6353
[2023-08-25 01:02:39,727][main.py][line:91][INFO] [Epoch:2/50]: loss1:0.2577 loss2:0.8440 loss3:0.3760 | AUC:0.8147 Anomaly AUC:0.6250
[2023-08-25 01:05:39,966][main.py][line:91][INFO] [Epoch:3/50]: loss1:0.1789 loss2:0.7106 loss3:0.3748 | AUC:0.8354 Anomaly AUC:0.6513
[2023-08-25 01:08:18,770][main.py][line:91][INFO] [Epoch:4/50]: loss1:0.1041 loss2:0.5879 loss3:0.3740 | AUC:0.8386 Anomaly AUC:0.6625
[2023-08-25 01:12:33,703][main.py][line:91][INFO] [Epoch:5/50]: loss1:0.0473 loss2:0.4616 loss3:0.3727 | AUC:0.8311 Anomaly AUC:0.6432
[2023-08-25 01:15:56,993][main.py][line:91][INFO] [Epoch:6/50]: loss1:0.0275 loss2:0.3516 loss3:0.3708 | AUC:0.8370 Anomaly AUC:0.6526
[2023-08-25 01:20:59,349][main.py][line:91][INFO] [Epoch:7/50]: loss1:0.0253 loss2:0.2599 loss3:0.3683 | AUC:0.8357 Anomaly AUC:0.6515
[2023-08-25 01:25:01,790][main.py][line:91][INFO] [Epoch:8/50]: loss1:0.0069 loss2:0.1639 loss3:0.3649 | AUC:0.8440 Anomaly AUC:0.6671
[2023-08-25 01:28:44,876][main.py][line:91][INFO] [Epoch:9/50]: loss1:0.0040 loss2:0.0995 loss3:0.3604 | AUC:0.8433 Anomaly AUC:0.6695
[2023-08-25 01:32:46,257][main.py][line:91][INFO] [Epoch:10/50]: loss1:0.0025 loss2:0.0583 loss3:0.3552 | AUC:0.8418 Anomaly AUC:0.6674
[2023-08-25 01:36:45,269][main.py][line:91][INFO] [Epoch:11/50]: loss1:0.0337 loss2:0.0658 loss3:0.3507 | AUC:0.8352 Anomaly AUC:0.6637
[2023-08-25 01:37:41,938][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 01:37:42,093][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 01:37:42,093][main.py][line:145][INFO] Training Mode
[2023-08-25 01:37:42,094][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 01:37:42,094][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-25 01:38:40,331][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 01:38:40,441][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 01:38:40,441][main.py][line:145][INFO] Training Mode
[2023-08-25 01:38:40,441][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 01:38:40,441][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-25 01:38:48,570][main.py][line:69][INFO] Random initialize AUCAUC:0.4188 Anomaly AUC:0.46923
[2023-08-25 01:42:20,534][main.py][line:91][INFO] [Epoch:1/50]: loss1:0.4515 loss2:1.0476 loss3:0.3178 | AUC:0.8201 Anomaly AUC:0.6451
[2023-08-25 01:45:19,238][main.py][line:91][INFO] [Epoch:2/50]: loss1:0.1922 loss2:0.7789 loss3:0.1378 | AUC:0.8353 Anomaly AUC:0.6491
[2023-08-25 01:47:52,944][main.py][line:91][INFO] [Epoch:3/50]: loss1:0.1749 loss2:0.7203 loss3:0.1000 | AUC:0.7823 Anomaly AUC:0.5959
[2023-08-25 01:50:22,413][main.py][line:91][INFO] [Epoch:4/50]: loss1:0.3045 loss2:0.8133 loss3:0.1158 | AUC:0.7833 Anomaly AUC:0.5922
[2023-08-25 01:53:27,821][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 01:53:27,981][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 01:53:27,981][main.py][line:145][INFO] Training Mode
[2023-08-25 01:53:27,982][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 01:53:27,982][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0003
    lr: 0.0003
    maximize: False
    weight_decay: 5e-05
)

[2023-08-25 01:53:36,500][main.py][line:69][INFO] Random initialize AUCAUC:0.4188 Anomaly AUC:0.46923
[2023-08-25 01:57:20,897][main.py][line:91][INFO] [Epoch:1/50]: loss1:0.3904 loss2:0.9960 loss3:0.3593 | AUC:0.8345 Anomaly AUC:0.6562
[2023-08-25 02:00:30,150][main.py][line:91][INFO] [Epoch:2/50]: loss1:0.1443 loss2:0.7151 loss3:0.2408 | AUC:0.8498 Anomaly AUC:0.6874
[2023-08-25 02:03:07,903][main.py][line:91][INFO] [Epoch:3/50]: loss1:0.0663 loss2:0.5670 loss3:0.1036 | AUC:0.8401 Anomaly AUC:0.6852
[2023-08-25 02:05:47,643][main.py][line:91][INFO] [Epoch:4/50]: loss1:0.0396 loss2:0.4472 loss3:0.0884 | AUC:0.8445 Anomaly AUC:0.6806
[2023-08-25 02:08:48,110][main.py][line:91][INFO] [Epoch:5/50]: loss1:0.0223 loss2:0.3157 loss3:0.0800 | AUC:0.8496 Anomaly AUC:0.6860
[2023-08-25 02:11:49,247][main.py][line:91][INFO] [Epoch:6/50]: loss1:0.0156 loss2:0.2037 loss3:0.0727 | AUC:0.8565 Anomaly AUC:0.6718
[2023-08-25 02:15:13,977][main.py][line:91][INFO] [Epoch:7/50]: loss1:0.0150 loss2:0.1250 loss3:0.0703 | AUC:0.8214 Anomaly AUC:0.6810
[2023-08-25 02:18:17,437][main.py][line:91][INFO] [Epoch:8/50]: loss1:0.0168 loss2:0.1041 loss3:0.0695 | AUC:0.8525 Anomaly AUC:0.6775
[2023-08-25 02:21:19,279][main.py][line:91][INFO] [Epoch:9/50]: loss1:0.0154 loss2:0.0810 loss3:0.0686 | AUC:0.7828 Anomaly AUC:0.6280
[2023-08-25 02:24:39,433][main.py][line:91][INFO] [Epoch:10/50]: loss1:0.0143 loss2:0.0712 loss3:0.0693 | AUC:0.8343 Anomaly AUC:0.6659
[2023-08-25 02:28:11,965][main.py][line:91][INFO] [Epoch:11/50]: loss1:0.0114 loss2:0.0427 loss3:0.0657 | AUC:0.8381 Anomaly AUC:0.6632
[2023-08-25 02:31:04,930][main.py][line:91][INFO] [Epoch:12/50]: loss1:0.0033 loss2:0.0200 loss3:0.0643 | AUC:0.7966 Anomaly AUC:0.6089
[2023-08-25 02:34:20,554][main.py][line:91][INFO] [Epoch:13/50]: loss1:0.0128 loss2:0.0502 loss3:0.0665 | AUC:0.8289 Anomaly AUC:0.6448
[2023-08-25 02:37:41,619][main.py][line:91][INFO] [Epoch:14/50]: loss1:0.0104 loss2:0.0361 loss3:0.0663 | AUC:0.8454 Anomaly AUC:0.6790
[2023-08-25 02:40:54,927][main.py][line:91][INFO] [Epoch:15/50]: loss1:0.0003 loss2:0.0074 loss3:0.0628 | AUC:0.8395 Anomaly AUC:0.6610
[2023-08-25 02:44:14,735][main.py][line:91][INFO] [Epoch:16/50]: loss1:0.0028 loss2:0.0139 loss3:0.0626 | AUC:0.8361 Anomaly AUC:0.6737
[2023-08-25 02:47:39,609][main.py][line:91][INFO] [Epoch:17/50]: loss1:0.0172 loss2:0.0443 loss3:0.0652 | AUC:0.8558 Anomaly AUC:0.6808
[2023-08-25 02:50:44,730][main.py][line:91][INFO] [Epoch:18/50]: loss1:0.0106 loss2:0.0466 loss3:0.0649 | AUC:0.8295 Anomaly AUC:0.6663
[2023-08-25 02:53:43,745][main.py][line:91][INFO] [Epoch:19/50]: loss1:0.0006 loss2:0.0062 loss3:0.0627 | AUC:0.8422 Anomaly AUC:0.6697
[2023-08-25 02:57:06,372][main.py][line:91][INFO] [Epoch:20/50]: loss1:0.0001 loss2:0.0027 loss3:0.0616 | AUC:0.8468 Anomaly AUC:0.6789
[2023-08-25 03:00:25,273][main.py][line:91][INFO] [Epoch:21/50]: loss1:0.0001 loss2:0.0030 loss3:0.0613 | AUC:0.8518 Anomaly AUC:0.6820
[2023-08-25 03:03:31,887][main.py][line:91][INFO] [Epoch:22/50]: loss1:0.0001 loss2:0.0031 loss3:0.0610 | AUC:0.8473 Anomaly AUC:0.6720
[2023-08-25 03:06:46,147][main.py][line:91][INFO] [Epoch:23/50]: loss1:0.0001 loss2:0.0026 loss3:0.0608 | AUC:0.8422 Anomaly AUC:0.6666
[2023-08-25 03:10:25,891][main.py][line:91][INFO] [Epoch:24/50]: loss1:0.0001 loss2:0.0018 loss3:0.0606 | AUC:0.8397 Anomaly AUC:0.6533
[2023-08-25 03:13:52,747][main.py][line:91][INFO] [Epoch:25/50]: loss1:0.0004 loss2:0.0023 loss3:0.0607 | AUC:0.8395 Anomaly AUC:0.6528
[2023-08-25 03:17:11,829][main.py][line:91][INFO] [Epoch:26/50]: loss1:0.0144 loss2:0.0432 loss3:0.0658 | AUC:0.8458 Anomaly AUC:0.6880
[2023-08-25 03:20:10,240][main.py][line:91][INFO] [Epoch:27/50]: loss1:0.0148 loss2:0.0342 loss3:0.0657 | AUC:0.8326 Anomaly AUC:0.6608
[2023-08-25 03:22:49,182][main.py][line:91][INFO] [Epoch:28/50]: loss1:0.0005 loss2:0.0030 loss3:0.0623 | AUC:0.8404 Anomaly AUC:0.6628
[2023-08-25 03:25:36,536][main.py][line:91][INFO] [Epoch:29/50]: loss1:0.0002 loss2:0.0017 loss3:0.0614 | AUC:0.8444 Anomaly AUC:0.6574
[2023-08-25 03:28:36,116][main.py][line:91][INFO] [Epoch:30/50]: loss1:0.0001 loss2:0.0012 loss3:0.0608 | AUC:0.8391 Anomaly AUC:0.6537
[2023-08-25 03:31:56,636][main.py][line:91][INFO] [Epoch:31/50]: loss1:0.0001 loss2:0.0007 loss3:0.0605 | AUC:0.8425 Anomaly AUC:0.6554
[2023-08-25 03:35:22,636][main.py][line:91][INFO] [Epoch:32/50]: loss1:0.0001 loss2:0.0009 loss3:0.0604 | AUC:0.8442 Anomaly AUC:0.6570
[2023-08-25 03:38:40,490][main.py][line:91][INFO] [Epoch:33/50]: loss1:0.0001 loss2:0.0009 loss3:0.0601 | AUC:0.8432 Anomaly AUC:0.6549
[2023-08-25 03:41:26,205][main.py][line:91][INFO] [Epoch:34/50]: loss1:0.0001 loss2:0.0014 loss3:0.0601 | AUC:0.8410 Anomaly AUC:0.6573
[2023-08-25 03:44:33,515][main.py][line:91][INFO] [Epoch:35/50]: loss1:0.0001 loss2:0.0009 loss3:0.0600 | AUC:0.8395 Anomaly AUC:0.6523
[2023-08-25 03:48:00,659][main.py][line:91][INFO] [Epoch:36/50]: loss1:0.0001 loss2:0.0009 loss3:0.0600 | AUC:0.8435 Anomaly AUC:0.6569
[2023-08-25 03:51:20,117][main.py][line:91][INFO] [Epoch:37/50]: loss1:0.0001 loss2:0.0012 loss3:0.0600 | AUC:0.8460 Anomaly AUC:0.6662
[2023-08-25 03:54:25,727][main.py][line:91][INFO] [Epoch:38/50]: loss1:0.0001 loss2:0.0011 loss3:0.0599 | AUC:0.8455 Anomaly AUC:0.6609
[2023-08-25 03:57:41,107][main.py][line:91][INFO] [Epoch:39/50]: loss1:0.0001 loss2:0.0012 loss3:0.0599 | AUC:0.8461 Anomaly AUC:0.6632
[2023-08-25 04:01:07,689][main.py][line:91][INFO] [Epoch:40/50]: loss1:0.0043 loss2:0.0111 loss3:0.0620 | AUC:0.8437 Anomaly AUC:0.6712
[2023-08-25 04:04:05,839][main.py][line:91][INFO] [Epoch:41/50]: loss1:0.0004 loss2:0.0029 loss3:0.0616 | AUC:0.8495 Anomaly AUC:0.6779
[2023-08-25 04:07:06,317][main.py][line:91][INFO] [Epoch:42/50]: loss1:0.0001 loss2:0.0012 loss3:0.0604 | AUC:0.8480 Anomaly AUC:0.6728
[2023-08-25 04:10:02,348][main.py][line:91][INFO] [Epoch:43/50]: loss1:0.0001 loss2:0.0012 loss3:0.0600 | AUC:0.8482 Anomaly AUC:0.6709
[2023-08-25 04:12:58,921][main.py][line:91][INFO] [Epoch:44/50]: loss1:0.0001 loss2:0.0011 loss3:0.0598 | AUC:0.8483 Anomaly AUC:0.6710
[2023-08-25 04:15:38,488][main.py][line:91][INFO] [Epoch:45/50]: loss1:0.0001 loss2:0.0010 loss3:0.0597 | AUC:0.8527 Anomaly AUC:0.6760
[2023-08-25 04:18:37,687][main.py][line:91][INFO] [Epoch:46/50]: loss1:0.0001 loss2:0.0009 loss3:0.0598 | AUC:0.8505 Anomaly AUC:0.6706
[2023-08-25 04:21:29,175][main.py][line:91][INFO] [Epoch:47/50]: loss1:0.0001 loss2:0.0009 loss3:0.0596 | AUC:0.8522 Anomaly AUC:0.6736
[2023-08-25 04:24:30,964][main.py][line:91][INFO] [Epoch:48/50]: loss1:0.0001 loss2:0.0009 loss3:0.0597 | AUC:0.8519 Anomaly AUC:0.6714
[2023-08-25 04:27:31,777][main.py][line:91][INFO] [Epoch:49/50]: loss1:0.0001 loss2:0.0010 loss3:0.0597 | AUC:0.8560 Anomaly AUC:0.6806
[2023-08-25 04:30:36,752][main.py][line:91][INFO] [Epoch:50/50]: loss1:0.0000 loss2:0.0006 loss3:0.0598 | AUC:0.8557 Anomaly AUC:0.6830
[2023-08-25 04:30:36,782][main.py][line:99][INFO] Training completes in 157m 0s | best AUCAUC:0.8565 Anomaly AUC:0.6718

[2023-08-25 11:27:01,282][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 11:27:01,429][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 11:27:01,429][main.py][line:150][INFO] Test Mode
[2023-08-25 11:27:01,429][main.py][line:29][INFO] loading pretrained checkpoint from ./ckpt/ucf__current.pkl.
[2023-08-25 11:27:10,592][infer.py][line:47][INFO] offline AUC:0.8582 AP:0.3178 FAR:0.0068 | Complete in 0m 9s

[2023-08-25 11:28:49,924][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 11:28:50,047][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 11:28:50,048][main.py][line:150][INFO] Test Mode
[2023-08-25 11:28:50,048][main.py][line:29][INFO] loading pretrained checkpoint from ./ckpt/ucf__current.pkl.
[2023-08-25 11:28:58,982][infer.py][line:47][INFO] offline AUC:0.8582 AP:0.3178 FAR:0.0068 | Complete in 0m 9s

[2023-08-25 11:29:47,635][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 11:29:47,746][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 11:29:47,746][main.py][line:145][INFO] Training Mode
[2023-08-25 11:29:47,746][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 11:29:47,746][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-25 11:29:55,829][main.py][line:69][INFO] Random initialize AUCAUC:0.4188 Anomaly AUC:0.46923
[2023-08-25 11:32:09,089][main.py][line:91][INFO] [Epoch:1/100]: loss1:0.4515 loss2:1.0476 loss3:0.3178 | AUC:0.8201 Anomaly AUC:0.6451
[2023-08-25 11:34:23,495][main.py][line:91][INFO] [Epoch:2/100]: loss1:0.1922 loss2:0.7793 loss3:0.1408 | AUC:0.8180 Anomaly AUC:0.6376
[2023-08-25 11:36:28,343][main.py][line:91][INFO] [Epoch:3/100]: loss1:0.0956 loss2:0.6360 loss3:0.0783 | AUC:0.7975 Anomaly AUC:0.6315
[2023-08-25 11:38:32,745][main.py][line:91][INFO] [Epoch:4/100]: loss1:0.0529 loss2:0.5152 loss3:0.0714 | AUC:0.7990 Anomaly AUC:0.6251
[2023-08-25 11:40:45,909][main.py][line:91][INFO] [Epoch:5/100]: loss1:0.0329 loss2:0.4006 loss3:0.0687 | AUC:0.8060 Anomaly AUC:0.6150
[2023-08-25 11:43:10,232][main.py][line:91][INFO] [Epoch:6/100]: loss1:0.0200 loss2:0.2910 loss3:0.0675 | AUC:0.8121 Anomaly AUC:0.6200
[2023-08-25 11:45:43,166][main.py][line:91][INFO] [Epoch:7/100]: loss1:0.0166 loss2:0.1993 loss3:0.0674 | AUC:0.8319 Anomaly AUC:0.6404
[2023-08-25 11:48:09,551][main.py][line:91][INFO] [Epoch:8/100]: loss1:0.0120 loss2:0.1355 loss3:0.0672 | AUC:0.8222 Anomaly AUC:0.6422
[2023-08-25 11:50:21,591][main.py][line:91][INFO] [Epoch:9/100]: loss1:0.0202 loss2:0.1112 loss3:0.0680 | AUC:0.7924 Anomaly AUC:0.6169
[2023-08-25 11:52:55,843][main.py][line:91][INFO] [Epoch:10/100]: loss1:0.0015 loss2:0.0384 loss3:0.0647 | AUC:0.8052 Anomaly AUC:0.6234
[2023-08-25 11:55:17,289][main.py][line:91][INFO] [Epoch:11/100]: loss1:0.0133 loss2:0.0781 loss3:0.0658 | AUC:0.8067 Anomaly AUC:0.6203
[2023-08-25 11:57:35,840][main.py][line:91][INFO] [Epoch:12/100]: loss1:0.0164 loss2:0.0674 loss3:0.0672 | AUC:0.8192 Anomaly AUC:0.6221
[2023-08-25 11:59:54,104][main.py][line:91][INFO] [Epoch:13/100]: loss1:0.0102 loss2:0.0361 loss3:0.0650 | AUC:0.8262 Anomaly AUC:0.6085
[2023-08-25 12:02:23,858][main.py][line:91][INFO] [Epoch:14/100]: loss1:0.0039 loss2:0.0213 loss3:0.0639 | AUC:0.7771 Anomaly AUC:0.6058
[2023-08-25 12:04:49,697][main.py][line:91][INFO] [Epoch:15/100]: loss1:0.0199 loss2:0.0571 loss3:0.0668 | AUC:0.8084 Anomaly AUC:0.6315
[2023-08-25 12:07:04,166][main.py][line:91][INFO] [Epoch:16/100]: loss1:0.0043 loss2:0.0170 loss3:0.0642 | AUC:0.8226 Anomaly AUC:0.6122
[2023-08-25 12:09:33,593][main.py][line:91][INFO] [Epoch:17/100]: loss1:0.0007 loss2:0.0071 loss3:0.0630 | AUC:0.8145 Anomaly AUC:0.6128
[2023-08-25 12:11:53,598][main.py][line:91][INFO] [Epoch:18/100]: loss1:0.0001 loss2:0.0017 loss3:0.0627 | AUC:0.7892 Anomaly AUC:0.6139
[2023-08-25 12:14:01,310][main.py][line:91][INFO] [Epoch:19/100]: loss1:0.0030 loss2:0.0044 loss3:0.0622 | AUC:0.8167 Anomaly AUC:0.6139
[2023-08-25 12:16:23,776][main.py][line:91][INFO] [Epoch:20/100]: loss1:0.0114 loss2:0.0351 loss3:0.0633 | AUC:0.8017 Anomaly AUC:0.6317
[2023-08-25 12:17:15,491][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 12:17:15,657][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 12:17:15,657][main.py][line:145][INFO] Training Mode
[2023-08-25 12:17:15,658][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 12:17:15,658][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-25 12:17:24,086][main.py][line:69][INFO] Random initialize AUCAUC:0.4188 Anomaly AUC:0.46923
[2023-08-25 12:21:22,133][main.py][line:91][INFO] [Epoch:1/100]: loss1:0.4515 loss2:1.0476 loss3:0.3178 | AUC:0.8201 Anomaly AUC:0.6451
[2023-08-25 12:25:46,474][main.py][line:91][INFO] [Epoch:2/100]: loss1:0.1922 loss2:0.7793 loss3:0.1408 | AUC:0.8180 Anomaly AUC:0.6376
[2023-08-25 12:28:39,035][main.py][line:91][INFO] [Epoch:3/100]: loss1:0.0956 loss2:0.6360 loss3:0.0783 | AUC:0.7975 Anomaly AUC:0.6315
[2023-08-25 12:31:26,480][main.py][line:91][INFO] [Epoch:4/100]: loss1:0.0529 loss2:0.5152 loss3:0.0714 | AUC:0.7990 Anomaly AUC:0.6251
[2023-08-25 12:35:03,135][main.py][line:91][INFO] [Epoch:5/100]: loss1:0.0329 loss2:0.4006 loss3:0.0687 | AUC:0.8060 Anomaly AUC:0.6150
[2023-08-25 12:38:39,918][main.py][line:91][INFO] [Epoch:6/100]: loss1:0.0200 loss2:0.2910 loss3:0.0675 | AUC:0.8121 Anomaly AUC:0.6200
[2023-08-25 12:42:29,655][main.py][line:91][INFO] [Epoch:7/100]: loss1:0.0166 loss2:0.1993 loss3:0.0674 | AUC:0.8319 Anomaly AUC:0.6404
[2023-08-25 12:47:14,205][main.py][line:91][INFO] [Epoch:8/100]: loss1:0.0120 loss2:0.1355 loss3:0.0672 | AUC:0.8222 Anomaly AUC:0.6422
[2023-08-25 12:51:20,930][main.py][line:91][INFO] [Epoch:9/100]: loss1:0.0202 loss2:0.1112 loss3:0.0680 | AUC:0.7924 Anomaly AUC:0.6169
[2023-08-25 12:56:21,915][main.py][line:91][INFO] [Epoch:10/100]: loss1:0.0015 loss2:0.0384 loss3:0.0647 | AUC:0.8052 Anomaly AUC:0.6234
[2023-08-25 13:01:00,007][main.py][line:91][INFO] [Epoch:11/100]: loss1:0.0133 loss2:0.0781 loss3:0.0658 | AUC:0.8067 Anomaly AUC:0.6203
[2023-08-25 13:04:31,990][main.py][line:91][INFO] [Epoch:12/100]: loss1:0.0164 loss2:0.0674 loss3:0.0672 | AUC:0.8192 Anomaly AUC:0.6221
[2023-08-25 13:08:14,328][main.py][line:91][INFO] [Epoch:13/100]: loss1:0.0102 loss2:0.0361 loss3:0.0650 | AUC:0.8262 Anomaly AUC:0.6085
[2023-08-25 13:12:03,329][main.py][line:91][INFO] [Epoch:14/100]: loss1:0.0039 loss2:0.0213 loss3:0.0639 | AUC:0.7771 Anomaly AUC:0.6058
[2023-08-25 13:12:52,892][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 13:12:53,045][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 13:12:53,045][main.py][line:145][INFO] Training Mode
[2023-08-25 13:12:53,045][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 13:12:53,046][main.py][line:66][INFO] Optimizer:RAdam (
Parameter Group 0
    betas: (0.9, 0.999)
    differentiable: False
    eps: 1e-08
    foreach: None
    initial_lr: 0.0003
    lr: 0.0003
    weight_decay: 0
)

[2023-08-25 13:13:01,183][main.py][line:69][INFO] Random initialize AUCAUC:0.4188 Anomaly AUC:0.46923
[2023-08-25 13:16:07,317][main.py][line:91][INFO] [Epoch:1/100]: loss1:0.5019 loss2:1.2058 loss3:0.3864 | AUC:0.8425 Anomaly AUC:0.6591
[2023-08-25 13:19:20,144][main.py][line:91][INFO] [Epoch:2/100]: loss1:0.2024 loss2:0.8302 loss3:0.3792 | AUC:0.8269 Anomaly AUC:0.6457
[2023-08-25 13:21:47,803][main.py][line:91][INFO] [Epoch:3/100]: loss1:0.0815 loss2:0.6743 loss3:0.3617 | AUC:0.8380 Anomaly AUC:0.6473
[2023-08-25 13:24:17,147][main.py][line:91][INFO] [Epoch:4/100]: loss1:0.0317 loss2:0.5536 loss3:0.3215 | AUC:0.8222 Anomaly AUC:0.6058
[2023-08-25 13:27:15,737][main.py][line:91][INFO] [Epoch:5/100]: loss1:0.0141 loss2:0.4448 loss3:0.1855 | AUC:0.8001 Anomaly AUC:0.5377
[2023-08-25 13:30:53,933][main.py][line:91][INFO] [Epoch:6/100]: loss1:0.0247 loss2:0.3541 loss3:0.1029 | AUC:0.7851 Anomaly AUC:0.5983
[2023-08-25 13:34:43,752][main.py][line:91][INFO] [Epoch:7/100]: loss1:0.0315 loss2:0.3263 loss3:0.0814 | AUC:0.7948 Anomaly AUC:0.5807
[2023-08-25 13:35:00,593][main.py][line:106][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 13:35:00,760][main.py][line:142][INFO] total params:7.5707M
[2023-08-25 13:35:00,760][main.py][line:145][INFO] Training Mode
[2023-08-25 13:35:00,760][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 13:35:00,760][main.py][line:66][INFO] Optimizer:RAdam (
Parameter Group 0
    betas: (0.9, 0.999)
    differentiable: False
    eps: 1e-08
    foreach: None
    lr: 0.0003
    weight_decay: 0
)

[2023-08-25 13:35:08,581][main.py][line:69][INFO] Random initialize AUCAUC:0.4188 Anomaly AUC:0.46923
[2023-08-25 13:37:40,815][main.py][line:91][INFO] [Epoch:1/100]: loss1:0.5019 loss2:1.2058 loss3:0.3864 | AUC:0.8425 Anomaly AUC:0.6591
[2023-08-25 13:40:14,334][main.py][line:91][INFO] [Epoch:2/100]: loss1:0.2000 loss2:0.8273 loss3:0.3790 | AUC:0.8185 Anomaly AUC:0.6317
[2023-08-25 13:42:23,394][main.py][line:91][INFO] [Epoch:3/100]: loss1:0.0856 loss2:0.6777 loss3:0.3618 | AUC:0.8248 Anomaly AUC:0.6290
[2023-08-25 13:44:26,052][main.py][line:91][INFO] [Epoch:4/100]: loss1:0.0276 loss2:0.5468 loss3:0.3186 | AUC:0.8386 Anomaly AUC:0.6344
[2023-08-25 13:47:03,550][main.py][line:91][INFO] [Epoch:5/100]: loss1:0.0076 loss2:0.4169 loss3:0.1751 | AUC:0.8122 Anomaly AUC:0.5544
[2023-08-25 13:49:26,017][main.py][line:91][INFO] [Epoch:6/100]: loss1:0.0516 loss2:0.3839 loss3:0.0974 | AUC:0.8012 Anomaly AUC:0.5598
[2023-08-25 13:51:53,957][main.py][line:91][INFO] [Epoch:7/100]: loss1:0.0244 loss2:0.3138 loss3:0.0763 | AUC:0.8233 Anomaly AUC:0.5903
[2023-08-25 13:54:56,643][main.py][line:91][INFO] [Epoch:8/100]: loss1:0.0307 loss2:0.2726 loss3:0.0739 | AUC:0.7490 Anomaly AUC:0.5573
[2023-08-25 13:57:25,772][main.py][line:91][INFO] [Epoch:9/100]: loss1:0.0056 loss2:0.1720 loss3:0.0687 | AUC:0.7969 Anomaly AUC:0.5234
[2023-08-25 14:00:17,862][main.py][line:91][INFO] [Epoch:10/100]: loss1:0.0525 loss2:0.2139 loss3:0.0732 | AUC:0.8009 Anomaly AUC:0.5845
[2023-08-25 14:03:24,765][main.py][line:91][INFO] [Epoch:11/100]: loss1:0.0224 loss2:0.2062 loss3:0.0692 | AUC:0.7952 Anomaly AUC:0.5674
[2023-08-25 14:06:00,791][main.py][line:91][INFO] [Epoch:12/100]: loss1:0.3899 loss2:0.7356 loss3:0.1015 | AUC:0.7821 Anomaly AUC:0.5645
[2023-08-25 14:08:29,549][main.py][line:91][INFO] [Epoch:13/100]: loss1:0.3405 loss2:0.9288 loss3:0.0849 | AUC:0.7903 Anomaly AUC:0.5849
[2023-08-25 14:10:53,966][main.py][line:91][INFO] [Epoch:14/100]: loss1:0.2194 loss2:0.7684 loss3:0.0787 | AUC:0.7727 Anomaly AUC:0.5812
[2023-08-25 14:13:16,601][main.py][line:91][INFO] [Epoch:15/100]: loss1:0.1507 loss2:0.6555 loss3:0.0765 | AUC:0.7783 Anomaly AUC:0.5751
[2023-08-25 14:15:43,175][main.py][line:91][INFO] [Epoch:16/100]: loss1:0.1041 loss2:0.5710 loss3:0.0752 | AUC:0.7762 Anomaly AUC:0.5709
[2023-08-25 14:18:27,924][main.py][line:91][INFO] [Epoch:17/100]: loss1:0.0760 loss2:0.5091 loss3:0.0742 | AUC:0.7852 Anomaly AUC:0.5686
[2023-08-25 14:21:08,185][main.py][line:91][INFO] [Epoch:18/100]: loss1:0.0486 loss2:0.4457 loss3:0.0741 | AUC:0.7744 Anomaly AUC:0.5697
[2023-08-25 14:23:27,753][main.py][line:91][INFO] [Epoch:19/100]: loss1:0.0423 loss2:0.3958 loss3:0.0738 | AUC:0.7689 Anomaly AUC:0.5676
[2023-08-25 14:25:49,408][main.py][line:91][INFO] [Epoch:20/100]: loss1:0.0277 loss2:0.3251 loss3:0.0735 | AUC:0.7732 Anomaly AUC:0.5615
[2023-08-25 14:28:31,883][main.py][line:91][INFO] [Epoch:21/100]: loss1:0.0188 loss2:0.2673 loss3:0.0732 | AUC:0.7775 Anomaly AUC:0.5705
[2023-08-25 14:30:57,308][main.py][line:91][INFO] [Epoch:22/100]: loss1:0.0254 loss2:0.2470 loss3:0.0729 | AUC:0.7936 Anomaly AUC:0.5715
[2023-08-25 14:33:28,933][main.py][line:91][INFO] [Epoch:23/100]: loss1:0.0169 loss2:0.2158 loss3:0.0726 | AUC:0.7744 Anomaly AUC:0.5743
[2023-08-25 14:35:59,036][main.py][line:91][INFO] [Epoch:24/100]: loss1:0.0065 loss2:0.1350 loss3:0.0722 | AUC:0.7664 Anomaly AUC:0.5723
[2023-08-25 14:38:26,767][main.py][line:91][INFO] [Epoch:25/100]: loss1:0.0146 loss2:0.1094 loss3:0.0718 | AUC:0.7843 Anomaly AUC:0.5751
[2023-08-25 14:43:58,307][main.py][line:107][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 14:43:58,449][main.py][line:143][INFO] total params:7.5707M
[2023-08-25 14:43:58,449][main.py][line:146][INFO] Training Mode
[2023-08-25 14:43:58,449][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 14:43:58,450][main.py][line:66][INFO] Optimizer:AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003
    maximize: False
    weight_decay: 5e-05
)

[2023-08-25 14:44:07,210][main.py][line:69][INFO] Random initialize AUCAUC:0.5717 Anomaly AUC:0.56752
[2023-08-25 14:46:35,952][main.py][line:92][INFO] [Epoch:1/0.0003]: lr:100.00000 | loss1:0.3979 loss2:1.0254 loss3:0.3533 | AUC:0.8224 Anomaly AUC:0.6491
[2023-08-25 14:49:34,304][main.py][line:92][INFO] [Epoch:2/0.0003]: lr:100.00000 | loss1:0.1663 loss2:0.7739 loss3:0.2175 | AUC:0.8328 Anomaly AUC:0.6921
[2023-08-25 14:52:04,705][main.py][line:92][INFO] [Epoch:3/0.0003]: lr:100.00000 | loss1:0.0759 loss2:0.6609 loss3:0.0991 | AUC:0.8465 Anomaly AUC:0.6988
[2023-08-25 14:54:24,908][main.py][line:92][INFO] [Epoch:4/0.0003]: lr:100.00000 | loss1:0.1072 loss2:0.6565 loss3:0.0903 | AUC:0.8365 Anomaly AUC:0.6644
[2023-08-25 14:57:22,889][main.py][line:92][INFO] [Epoch:5/0.0003]: lr:100.00000 | loss1:0.0867 loss2:0.6049 loss3:0.0817 | AUC:0.8509 Anomaly AUC:0.6963
[2023-08-25 15:00:26,756][main.py][line:92][INFO] [Epoch:6/0.0003]: lr:100.00000 | loss1:0.0301 loss2:0.4864 loss3:0.0721 | AUC:0.8584 Anomaly AUC:0.6855
[2023-08-25 15:03:19,284][main.py][line:92][INFO] [Epoch:7/0.0003]: lr:100.00000 | loss1:0.0196 loss2:0.4067 loss3:0.0706 | AUC:0.8476 Anomaly AUC:0.6661
[2023-08-25 15:06:21,223][main.py][line:92][INFO] [Epoch:8/0.0003]: lr:100.00000 | loss1:0.0133 loss2:0.3347 loss3:0.0704 | AUC:0.8554 Anomaly AUC:0.6827
[2023-08-25 15:09:22,736][main.py][line:92][INFO] [Epoch:9/0.0003]: lr:100.00000 | loss1:0.0053 loss2:0.2460 loss3:0.0680 | AUC:0.8369 Anomaly AUC:0.6588
[2023-08-25 15:12:05,916][main.py][line:92][INFO] [Epoch:10/0.0003]: lr:100.00000 | loss1:0.2834 loss2:0.8893 loss3:0.1712 | AUC:0.8239 Anomaly AUC:0.6219
[2023-08-25 15:14:47,974][main.py][line:92][INFO] [Epoch:11/0.0003]: lr:100.00000 | loss1:0.1783 loss2:0.7501 loss3:0.1529 | AUC:0.8200 Anomaly AUC:0.6029
[2023-08-25 15:17:41,791][main.py][line:92][INFO] [Epoch:12/0.0003]: lr:100.00000 | loss1:0.1374 loss2:0.6013 loss3:0.1452 | AUC:0.8242 Anomaly AUC:0.6119
[2023-08-25 15:20:47,950][main.py][line:92][INFO] [Epoch:13/0.0003]: lr:100.00000 | loss1:0.1123 loss2:0.5360 loss3:0.1455 | AUC:0.8267 Anomaly AUC:0.6159
[2023-08-25 15:24:03,568][main.py][line:92][INFO] [Epoch:14/0.0003]: lr:100.00000 | loss1:0.0861 loss2:0.5981 loss3:0.1414 | AUC:0.8276 Anomaly AUC:0.6170
[2023-08-25 15:27:04,582][main.py][line:92][INFO] [Epoch:15/0.0003]: lr:100.00000 | loss1:0.0675 loss2:0.5785 loss3:0.1227 | AUC:0.8290 Anomaly AUC:0.6173
[2023-08-25 15:30:14,095][main.py][line:92][INFO] [Epoch:16/0.0003]: lr:100.00000 | loss1:0.0598 loss2:0.5491 loss3:0.1058 | AUC:0.8363 Anomaly AUC:0.6334
[2023-08-25 15:33:00,004][main.py][line:92][INFO] [Epoch:17/0.0003]: lr:100.00000 | loss1:0.0476 loss2:0.5151 loss3:0.0948 | AUC:0.8286 Anomaly AUC:0.6166
[2023-08-25 15:36:21,651][main.py][line:92][INFO] [Epoch:18/0.0003]: lr:100.00000 | loss1:0.0336 loss2:0.4809 loss3:0.0896 | AUC:0.8330 Anomaly AUC:0.6237
[2023-08-25 15:39:17,425][main.py][line:92][INFO] [Epoch:19/0.0003]: lr:100.00000 | loss1:0.0309 loss2:0.4300 loss3:0.0875 | AUC:0.8373 Anomaly AUC:0.6267
[2023-08-25 15:42:00,145][main.py][line:92][INFO] [Epoch:20/0.0003]: lr:100.00000 | loss1:0.0263 loss2:0.3993 loss3:0.0860 | AUC:0.8391 Anomaly AUC:0.6314
[2023-08-25 15:44:26,672][main.py][line:92][INFO] [Epoch:21/0.0003]: lr:100.00000 | loss1:0.0216 loss2:0.3315 loss3:0.0843 | AUC:0.8376 Anomaly AUC:0.6258
[2023-08-25 15:46:56,242][main.py][line:92][INFO] [Epoch:22/0.0003]: lr:100.00000 | loss1:0.0171 loss2:0.2583 loss3:0.0832 | AUC:0.8393 Anomaly AUC:0.6305
[2023-08-25 15:49:30,301][main.py][line:92][INFO] [Epoch:23/0.0003]: lr:100.00000 | loss1:0.0168 loss2:0.2180 loss3:0.0819 | AUC:0.8350 Anomaly AUC:0.6194
[2023-08-25 15:52:31,191][main.py][line:92][INFO] [Epoch:24/0.0003]: lr:100.00000 | loss1:0.0125 loss2:0.0832 loss3:0.0804 | AUC:0.8367 Anomaly AUC:0.6245
[2023-08-25 15:55:10,664][main.py][line:92][INFO] [Epoch:25/0.0003]: lr:100.00000 | loss1:0.0089 loss2:0.0597 loss3:0.0797 | AUC:0.8403 Anomaly AUC:0.6341
[2023-08-25 15:57:43,393][main.py][line:92][INFO] [Epoch:26/0.0003]: lr:100.00000 | loss1:0.0124 loss2:0.0425 loss3:0.0790 | AUC:0.8398 Anomaly AUC:0.6415
[2023-08-25 16:00:34,522][main.py][line:92][INFO] [Epoch:27/0.0003]: lr:100.00000 | loss1:0.0208 loss2:0.0924 loss3:0.0784 | AUC:0.8320 Anomaly AUC:0.6185
[2023-08-25 16:03:09,801][main.py][line:92][INFO] [Epoch:28/0.0003]: lr:100.00000 | loss1:0.0073 loss2:0.0019 loss3:0.0781 | AUC:0.8315 Anomaly AUC:0.6208
[2023-08-25 16:05:46,488][main.py][line:92][INFO] [Epoch:29/0.0003]: lr:100.00000 | loss1:0.0148 loss2:0.0621 loss3:0.0783 | AUC:0.8331 Anomaly AUC:0.6215
[2023-08-25 16:08:18,299][main.py][line:107][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 16:08:18,449][main.py][line:143][INFO] total params:7.5707M
[2023-08-25 16:08:18,449][main.py][line:146][INFO] Training Mode
[2023-08-25 16:08:18,450][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 16:08:18,450][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003
    maximize: False
    weight_decay: 5e-05
)

[2023-08-25 16:08:26,387][main.py][line:69][INFO] Random initialize AUCAUC:0.5717 Anomaly AUC:0.56752
[2023-08-25 16:10:07,606][main.py][line:107][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 16:10:07,734][main.py][line:143][INFO] total params:7.5707M
[2023-08-25 16:10:07,735][main.py][line:146][INFO] Training Mode
[2023-08-25 16:10:07,735][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 16:10:07,735][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003
    maximize: False
    weight_decay: 5e-05
)

[2023-08-25 16:10:16,335][main.py][line:69][INFO] Random initialize AUCAUC:0.5711 Anomaly AUC:0.56142
[2023-08-25 16:10:43,473][main.py][line:107][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 16:10:43,606][main.py][line:143][INFO] total params:7.0451M
[2023-08-25 16:10:43,606][main.py][line:146][INFO] Training Mode
[2023-08-25 16:10:43,607][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 16:10:43,607][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003
    maximize: False
    weight_decay: 5e-05
)

[2023-08-25 16:10:51,055][main.py][line:69][INFO] Random initialize AUCAUC:0.6062 Anomaly AUC:0.57717
[2023-08-25 16:14:00,008][main.py][line:92][INFO] [Epoch:1/100]: lr:0.00030 | loss1:0.3917 loss2:1.4090 loss3:0.3668 | AUC:0.7836 Anomaly AUC:0.5674
[2023-08-25 16:16:29,258][main.py][line:92][INFO] [Epoch:2/100]: lr:0.00030 | loss1:0.1930 loss2:1.4025 loss3:0.2054 | AUC:0.7664 Anomaly AUC:0.5479
[2023-08-25 16:18:41,710][main.py][line:92][INFO] [Epoch:3/100]: lr:0.00030 | loss1:0.1029 loss2:1.3924 loss3:0.0844 | AUC:0.7681 Anomaly AUC:0.5257
[2023-08-25 16:20:47,554][main.py][line:92][INFO] [Epoch:4/100]: lr:0.00030 | loss1:0.0648 loss2:1.3901 loss3:0.0721 | AUC:0.7703 Anomaly AUC:0.5411
[2023-08-25 16:23:07,135][main.py][line:92][INFO] [Epoch:5/100]: lr:0.00030 | loss1:0.0270 loss2:1.3864 loss3:0.0675 | AUC:0.7893 Anomaly AUC:0.5438
[2023-08-25 16:25:59,466][main.py][line:92][INFO] [Epoch:6/100]: lr:0.00030 | loss1:0.0303 loss2:1.3784 loss3:0.0664 | AUC:0.7901 Anomaly AUC:0.5564
[2023-08-25 16:28:49,590][main.py][line:92][INFO] [Epoch:7/100]: lr:0.00030 | loss1:0.0298 loss2:1.3654 loss3:0.0659 | AUC:0.7845 Anomaly AUC:0.5550
[2023-08-25 16:30:24,650][main.py][line:107][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 16:30:24,771][main.py][line:143][INFO] total params:3.3693M
[2023-08-25 16:30:24,771][main.py][line:146][INFO] Training Mode
[2023-08-25 16:30:24,771][main.py][line:65][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 16:30:24,771][main.py][line:66][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003
    maximize: False
    weight_decay: 5e-05
)

[2023-08-25 16:30:35,226][main.py][line:69][INFO] Random initialize AUCAUC:0.4335 Anomaly AUC:0.46871
[2023-08-25 16:34:41,835][main.py][line:92][INFO] [Epoch:1/100]: lr:0.00030 | loss1:0.4552 loss2:1.1334 loss3:0.3805 | AUC:0.8316 Anomaly AUC:0.6520
[2023-08-25 16:41:13,370][main.py][line:92][INFO] [Epoch:2/100]: lr:0.00030 | loss1:0.2714 loss2:0.9384 loss3:0.3773 | AUC:0.8278 Anomaly AUC:0.6344
[2023-08-25 16:44:29,882][main.py][line:92][INFO] [Epoch:3/100]: lr:0.00030 | loss1:0.2153 loss2:0.8643 loss3:0.3750 | AUC:0.8332 Anomaly AUC:0.6402
[2023-08-25 16:47:11,975][main.py][line:92][INFO] [Epoch:4/100]: lr:0.00030 | loss1:0.1791 loss2:0.8085 loss3:0.3729 | AUC:0.8325 Anomaly AUC:0.6359
[2023-08-25 16:51:57,416][main.py][line:92][INFO] [Epoch:5/100]: lr:0.00030 | loss1:0.1433 loss2:0.7497 loss3:0.3704 | AUC:0.8401 Anomaly AUC:0.6432
[2023-08-25 16:58:53,555][main.py][line:92][INFO] [Epoch:6/100]: lr:0.00030 | loss1:0.1106 loss2:0.6932 loss3:0.3676 | AUC:0.8295 Anomaly AUC:0.6262
[2023-08-25 17:05:58,347][main.py][line:92][INFO] [Epoch:7/100]: lr:0.00030 | loss1:0.1085 loss2:0.6574 loss3:0.3654 | AUC:0.8345 Anomaly AUC:0.6387
[2023-08-25 17:12:14,267][main.py][line:92][INFO] [Epoch:8/100]: lr:0.00030 | loss1:0.0830 loss2:0.5991 loss3:0.3628 | AUC:0.8409 Anomaly AUC:0.6460
[2023-08-25 17:19:36,953][main.py][line:92][INFO] [Epoch:9/100]: lr:0.00030 | loss1:0.0737 loss2:0.5556 loss3:0.3610 | AUC:0.8312 Anomaly AUC:0.6305
[2023-08-25 17:24:57,535][main.py][line:92][INFO] [Epoch:10/100]: lr:0.00030 | loss1:0.0687 loss2:0.5247 loss3:0.3597 | AUC:0.8402 Anomaly AUC:0.6408
[2023-08-25 17:29:58,173][main.py][line:92][INFO] [Epoch:11/100]: lr:0.00030 | loss1:0.0594 loss2:0.4606 loss3:0.3584 | AUC:0.8407 Anomaly AUC:0.6336
[2023-08-25 17:35:18,893][main.py][line:92][INFO] [Epoch:12/100]: lr:0.00030 | loss1:0.0473 loss2:0.3745 loss3:0.3570 | AUC:0.8419 Anomaly AUC:0.6414
[2023-08-25 17:42:14,707][main.py][line:92][INFO] [Epoch:13/100]: lr:0.00030 | loss1:0.0528 loss2:0.3514 loss3:0.3559 | AUC:0.8382 Anomaly AUC:0.6384
[2023-08-25 17:47:25,696][main.py][line:92][INFO] [Epoch:14/100]: lr:0.00030 | loss1:0.0443 loss2:0.2817 loss3:0.3548 | AUC:0.8430 Anomaly AUC:0.6499
[2023-08-25 17:51:54,289][main.py][line:92][INFO] [Epoch:15/100]: lr:0.00030 | loss1:0.0222 loss2:0.0938 loss3:0.3535 | AUC:0.8457 Anomaly AUC:0.6525
[2023-08-25 17:55:38,820][main.py][line:92][INFO] [Epoch:16/100]: lr:0.00030 | loss1:0.0359 loss2:0.1970 loss3:0.3515 | AUC:0.8449 Anomaly AUC:0.6527
[2023-08-25 18:00:31,228][main.py][line:92][INFO] [Epoch:17/100]: lr:0.00030 | loss1:0.0218 loss2:0.1432 loss3:0.3503 | AUC:0.8445 Anomaly AUC:0.6519
[2023-08-25 18:04:50,718][main.py][line:92][INFO] [Epoch:18/100]: lr:0.00030 | loss1:0.0302 loss2:0.1784 loss3:0.3472 | AUC:0.8328 Anomaly AUC:0.6462
[2023-08-25 18:08:23,619][main.py][line:92][INFO] [Epoch:19/100]: lr:0.00030 | loss1:0.0287 loss2:0.2525 loss3:0.3453 | AUC:0.8445 Anomaly AUC:0.6551
[2023-08-25 18:13:24,360][main.py][line:92][INFO] [Epoch:20/100]: lr:0.00030 | loss1:0.0320 loss2:0.1855 loss3:0.3431 | AUC:0.8332 Anomaly AUC:0.6376
[2023-08-25 18:19:48,798][main.py][line:92][INFO] [Epoch:21/100]: lr:0.00030 | loss1:0.0216 loss2:0.1322 loss3:0.3390 | AUC:0.8341 Anomaly AUC:0.6499
[2023-08-25 18:24:15,877][main.py][line:92][INFO] [Epoch:22/100]: lr:0.00030 | loss1:0.0215 loss2:0.2269 loss3:0.3343 | AUC:0.8356 Anomaly AUC:0.6571
[2023-08-25 18:27:26,367][main.py][line:109][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 18:27:26,502][main.py][line:145][INFO] total params:3.3693M
[2023-08-25 18:27:26,502][main.py][line:148][INFO] Training Mode
[2023-08-25 18:27:26,503][main.py][line:67][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 18:27:26,503][main.py][line:68][INFO] Optimizer:Lamb (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-06
    lr: 0.0025
    weight_decay: 0.01
)

[2023-08-25 18:27:34,300][main.py][line:71][INFO] Random initialize AUCAUC:0.4335 Anomaly AUC:0.46871
[2023-08-25 18:31:01,616][main.py][line:94][INFO] [Epoch:1/100]: lr:0.00250 | loss1:0.4763 loss2:1.1321 loss3:0.3785 | AUC:0.8359 Anomaly AUC:0.6420
[2023-08-25 18:36:27,112][main.py][line:94][INFO] [Epoch:2/100]: lr:0.00250 | loss1:0.2849 loss2:0.8079 loss3:0.3769 | AUC:0.8295 Anomaly AUC:0.6491
[2023-08-25 18:39:11,694][main.py][line:94][INFO] [Epoch:3/100]: lr:0.00250 | loss1:0.2149 loss2:0.6290 loss3:0.3770 | AUC:0.8380 Anomaly AUC:0.6631
[2023-08-25 18:41:39,181][main.py][line:94][INFO] [Epoch:4/100]: lr:0.00250 | loss1:0.1808 loss2:0.4572 loss3:0.3756 | AUC:0.8390 Anomaly AUC:0.6537
[2023-08-25 18:47:08,640][main.py][line:94][INFO] [Epoch:5/100]: lr:0.00250 | loss1:0.1481 loss2:0.2552 loss3:0.3737 | AUC:0.8396 Anomaly AUC:0.6478
[2023-08-25 18:52:13,206][main.py][line:94][INFO] [Epoch:6/100]: lr:0.00250 | loss1:0.1426 loss2:0.2675 loss3:0.3716 | AUC:0.8325 Anomaly AUC:0.6585
[2023-08-25 18:58:44,099][main.py][line:94][INFO] [Epoch:7/100]: lr:0.00250 | loss1:0.1201 loss2:0.2806 loss3:0.3685 | AUC:0.8420 Anomaly AUC:0.6654
[2023-08-25 19:04:41,330][main.py][line:94][INFO] [Epoch:8/100]: lr:0.00250 | loss1:0.0995 loss2:0.2605 loss3:0.3635 | AUC:0.8394 Anomaly AUC:0.6587
[2023-08-25 19:08:02,103][main.py][line:94][INFO] [Epoch:9/100]: lr:0.00250 | loss1:0.0942 loss2:0.3046 loss3:0.3581 | AUC:0.8391 Anomaly AUC:0.6733
[2023-08-25 19:11:02,617][main.py][line:94][INFO] [Epoch:10/100]: lr:0.00250 | loss1:0.0830 loss2:0.3512 loss3:0.3551 | AUC:0.8457 Anomaly AUC:0.6766
[2023-08-25 19:14:55,796][main.py][line:94][INFO] [Epoch:11/100]: lr:0.00250 | loss1:0.0723 loss2:0.3356 loss3:0.3557 | AUC:0.8386 Anomaly AUC:0.6691
[2023-08-25 19:19:06,569][main.py][line:94][INFO] [Epoch:12/100]: lr:0.00250 | loss1:0.0691 loss2:0.3048 loss3:0.3582 | AUC:0.8253 Anomaly AUC:0.6655
[2023-08-25 19:23:16,031][main.py][line:94][INFO] [Epoch:13/100]: lr:0.00250 | loss1:0.0451 loss2:0.2616 loss3:0.3587 | AUC:0.8415 Anomaly AUC:0.6773
[2023-08-25 19:28:14,905][main.py][line:94][INFO] [Epoch:14/100]: lr:0.00250 | loss1:0.0416 loss2:0.2298 loss3:0.3584 | AUC:0.8397 Anomaly AUC:0.6716
[2023-08-25 19:32:55,246][main.py][line:94][INFO] [Epoch:15/100]: lr:0.00250 | loss1:0.0339 loss2:0.1740 loss3:0.3572 | AUC:0.8235 Anomaly AUC:0.6671
[2023-08-25 19:35:03,207][main.py][line:109][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.3, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 19:35:03,347][main.py][line:145][INFO] total params:3.3693M
[2023-08-25 19:35:03,347][main.py][line:148][INFO] Training Mode
[2023-08-25 19:35:03,348][main.py][line:67][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 19:35:03,348][main.py][line:68][INFO] Optimizer:Lamb (
Parameter Group 0
    betas: (0.9, 0.999)
    eps: 1e-06
    lr: 0.0025
    weight_decay: 0.01
)

[2023-08-25 19:35:09,780][main.py][line:71][INFO] Random initialize AUCAUC:0.4335 Anomaly AUC:0.46871
[2023-08-25 19:36:10,964][main.py][line:94][INFO] [Epoch:1/100]: lr:0.00250 | loss1:0.1027 loss2:0.9825 loss3:0.3885 | AUC:0.6861 Anomaly AUC:0.6019
[2023-08-25 19:37:22,718][main.py][line:94][INFO] [Epoch:2/100]: lr:0.00250 | loss1:0.0012 loss2:0.5886 loss3:0.3861 | AUC:0.6257 Anomaly AUC:0.5636
[2023-08-25 19:38:53,484][main.py][line:109][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.3, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 19:38:53,606][main.py][line:145][INFO] total params:3.3693M
[2023-08-25 19:38:53,606][main.py][line:148][INFO] Training Mode
[2023-08-25 19:38:53,607][main.py][line:67][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 19:38:53,607][main.py][line:68][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 5e-05
)

[2023-08-25 19:39:00,187][main.py][line:71][INFO] Random initialize AUCAUC:0.4335 Anomaly AUC:0.46871
[2023-08-25 19:40:36,028][main.py][line:94][INFO] [Epoch:1/100]: lr:0.00050 | loss1:0.0429 loss2:0.9083 loss3:0.3877 | AUC:0.7043 Anomaly AUC:0.6145
[2023-08-25 19:42:43,413][main.py][line:94][INFO] [Epoch:2/100]: lr:0.00050 | loss1:0.0016 loss2:0.7236 loss3:0.3874 | AUC:0.6952 Anomaly AUC:0.6167
[2023-08-25 19:44:17,025][main.py][line:94][INFO] [Epoch:3/100]: lr:0.00050 | loss1:0.0008 loss2:0.6622 loss3:0.3868 | AUC:0.6721 Anomaly AUC:0.5998
[2023-08-25 19:45:45,454][main.py][line:94][INFO] [Epoch:4/100]: lr:0.00049 | loss1:0.0005 loss2:0.6164 loss3:0.3868 | AUC:0.6779 Anomaly AUC:0.6026
[2023-08-25 19:46:57,300][main.py][line:109][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 19:46:57,450][main.py][line:145][INFO] total params:7.5707M
[2023-08-25 19:46:57,450][main.py][line:148][INFO] Training Mode
[2023-08-25 19:46:57,451][main.py][line:67][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 19:46:57,451][main.py][line:68][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 5e-05
)

[2023-08-25 19:47:05,540][main.py][line:71][INFO] Random initialize AUCAUC:0.5671 Anomaly AUC:0.56435
[2023-08-25 19:48:43,335][main.py][line:94][INFO] [Epoch:1/100]: lr:0.00050 | loss1:0.4960 loss2:1.1234 loss3:0.3142 | AUC:0.8177 Anomaly AUC:0.6264
[2023-08-25 19:50:30,599][main.py][line:94][INFO] [Epoch:2/100]: lr:0.00050 | loss1:0.1679 loss2:0.8386 loss3:0.1966 | AUC:0.8299 Anomaly AUC:0.6782
[2023-08-25 19:51:47,769][main.py][line:94][INFO] [Epoch:3/100]: lr:0.00050 | loss1:0.0159 loss2:0.6718 loss3:0.0996 | AUC:0.8266 Anomaly AUC:0.6626
[2023-08-25 19:53:05,990][main.py][line:94][INFO] [Epoch:4/100]: lr:0.00049 | loss1:0.0106 loss2:0.5897 loss3:0.0635 | AUC:0.8336 Anomaly AUC:0.6662
[2023-08-25 19:54:44,730][main.py][line:94][INFO] [Epoch:5/100]: lr:0.00049 | loss1:0.0061 loss2:0.4992 loss3:0.0450 | AUC:0.8266 Anomaly AUC:0.6584
[2023-08-25 19:56:37,818][main.py][line:94][INFO] [Epoch:6/100]: lr:0.00049 | loss1:0.0061 loss2:0.4273 loss3:0.0480 | AUC:0.8187 Anomaly AUC:0.6439
[2023-08-25 19:58:17,490][main.py][line:94][INFO] [Epoch:7/100]: lr:0.00048 | loss1:0.0032 loss2:0.3227 loss3:0.0303 | AUC:0.8187 Anomaly AUC:0.6568
[2023-08-25 20:00:35,051][main.py][line:94][INFO] [Epoch:8/100]: lr:0.00048 | loss1:0.0039 loss2:0.2462 loss3:0.0325 | AUC:0.7601 Anomaly AUC:0.6613
[2023-08-25 20:02:32,505][main.py][line:94][INFO] [Epoch:9/100]: lr:0.00047 | loss1:0.0040 loss2:0.2072 loss3:0.0342 | AUC:0.8380 Anomaly AUC:0.6763
[2023-08-25 20:04:02,790][main.py][line:94][INFO] [Epoch:10/100]: lr:0.00047 | loss1:0.0026 loss2:0.1226 loss3:0.0180 | AUC:0.8391 Anomaly AUC:0.6928
[2023-08-25 20:05:53,402][main.py][line:94][INFO] [Epoch:11/100]: lr:0.00046 | loss1:0.0031 loss2:0.1189 loss3:0.0279 | AUC:0.8400 Anomaly AUC:0.6691
[2023-08-25 20:07:42,124][main.py][line:94][INFO] [Epoch:12/100]: lr:0.00045 | loss1:0.0043 loss2:0.0984 loss3:0.0251 | AUC:0.8354 Anomaly AUC:0.6705
[2023-08-25 20:09:41,466][main.py][line:94][INFO] [Epoch:13/100]: lr:0.00044 | loss1:0.0038 loss2:0.0689 loss3:0.0236 | AUC:0.8264 Anomaly AUC:0.6982
[2023-08-25 20:11:26,352][main.py][line:94][INFO] [Epoch:14/100]: lr:0.00044 | loss1:0.0014 loss2:0.0500 loss3:0.0146 | AUC:0.8342 Anomaly AUC:0.6837
[2023-08-25 20:13:19,148][main.py][line:94][INFO] [Epoch:15/100]: lr:0.00043 | loss1:0.0093 loss2:0.1016 loss3:0.0475 | AUC:0.8226 Anomaly AUC:0.7008
[2023-08-25 20:15:10,902][main.py][line:94][INFO] [Epoch:16/100]: lr:0.00042 | loss1:0.0031 loss2:0.0569 loss3:0.0226 | AUC:0.8308 Anomaly AUC:0.6702
[2023-08-25 20:17:11,156][main.py][line:94][INFO] [Epoch:17/100]: lr:0.00041 | loss1:0.0016 loss2:0.0317 loss3:0.0133 | AUC:0.8214 Anomaly AUC:0.6819
[2023-08-25 20:18:43,172][main.py][line:94][INFO] [Epoch:18/100]: lr:0.00040 | loss1:0.0034 loss2:0.0526 loss3:0.0278 | AUC:0.8306 Anomaly AUC:0.6691
[2023-08-25 20:20:34,555][main.py][line:94][INFO] [Epoch:19/100]: lr:0.00039 | loss1:0.0009 loss2:0.0233 loss3:0.0110 | AUC:0.8340 Anomaly AUC:0.6600
[2023-08-25 20:22:17,230][main.py][line:94][INFO] [Epoch:20/100]: lr:0.00038 | loss1:0.0004 loss2:0.0136 loss3:0.0063 | AUC:0.8199 Anomaly AUC:0.6447
[2023-08-25 20:24:08,636][main.py][line:94][INFO] [Epoch:21/100]: lr:0.00036 | loss1:0.0004 loss2:0.0131 loss3:0.0054 | AUC:0.8274 Anomaly AUC:0.6700
[2023-08-25 20:25:27,969][main.py][line:94][INFO] [Epoch:22/100]: lr:0.00035 | loss1:0.0010 loss2:0.0166 loss3:0.0071 | AUC:0.8382 Anomaly AUC:0.6751
[2023-08-25 20:27:00,425][main.py][line:94][INFO] [Epoch:23/100]: lr:0.00034 | loss1:0.0002 loss2:0.0082 loss3:0.0033 | AUC:0.8402 Anomaly AUC:0.6650
[2023-08-25 20:28:32,333][main.py][line:94][INFO] [Epoch:24/100]: lr:0.00033 | loss1:0.0021 loss2:0.0205 loss3:0.0116 | AUC:0.8217 Anomaly AUC:0.6731
[2023-08-25 20:30:33,404][main.py][line:94][INFO] [Epoch:25/100]: lr:0.00031 | loss1:0.0002 loss2:0.0104 loss3:0.0041 | AUC:0.8294 Anomaly AUC:0.6659
[2023-08-25 20:31:57,586][main.py][line:94][INFO] [Epoch:26/100]: lr:0.00030 | loss1:0.0001 loss2:0.0056 loss3:0.0018 | AUC:0.8330 Anomaly AUC:0.6619
[2023-08-25 20:33:49,426][main.py][line:94][INFO] [Epoch:27/100]: lr:0.00029 | loss1:0.0001 loss2:0.0051 loss3:0.0012 | AUC:0.8328 Anomaly AUC:0.6713
[2023-08-25 20:35:41,405][main.py][line:94][INFO] [Epoch:28/100]: lr:0.00028 | loss1:0.0005 loss2:0.0047 loss3:0.0030 | AUC:0.8218 Anomaly AUC:0.6958
[2023-08-25 20:37:16,387][main.py][line:94][INFO] [Epoch:29/100]: lr:0.00026 | loss1:0.0003 loss2:0.0070 loss3:0.0037 | AUC:0.8299 Anomaly AUC:0.6614
[2023-08-25 20:38:39,554][main.py][line:94][INFO] [Epoch:30/100]: lr:0.00025 | loss1:0.0055 loss2:0.0440 loss3:0.0389 | AUC:0.8410 Anomaly AUC:0.6813
[2023-08-25 20:40:19,282][main.py][line:94][INFO] [Epoch:31/100]: lr:0.00024 | loss1:0.0012 loss2:0.0191 loss3:0.0108 | AUC:0.8311 Anomaly AUC:0.6667
[2023-08-25 20:41:58,587][main.py][line:94][INFO] [Epoch:32/100]: lr:0.00022 | loss1:0.0007 loss2:0.0163 loss3:0.0085 | AUC:0.8128 Anomaly AUC:0.6691
[2023-08-25 20:43:54,932][main.py][line:94][INFO] [Epoch:33/100]: lr:0.00021 | loss1:0.0008 loss2:0.0070 loss3:0.0077 | AUC:0.8212 Anomaly AUC:0.6635
[2023-08-25 20:45:30,910][main.py][line:94][INFO] [Epoch:34/100]: lr:0.00020 | loss1:0.0001 loss2:0.0043 loss3:0.0030 | AUC:0.8345 Anomaly AUC:0.6681
[2023-08-25 20:47:00,181][main.py][line:94][INFO] [Epoch:35/100]: lr:0.00019 | loss1:0.0001 loss2:0.0035 loss3:0.0019 | AUC:0.8351 Anomaly AUC:0.6674
[2023-08-25 20:48:39,883][main.py][line:94][INFO] [Epoch:36/100]: lr:0.00017 | loss1:0.0001 loss2:0.0028 loss3:0.0014 | AUC:0.8355 Anomaly AUC:0.6656
[2023-08-25 20:50:44,824][main.py][line:94][INFO] [Epoch:37/100]: lr:0.00016 | loss1:0.0001 loss2:0.0028 loss3:0.0011 | AUC:0.8367 Anomaly AUC:0.6667
[2023-08-25 20:52:35,538][main.py][line:94][INFO] [Epoch:38/100]: lr:0.00015 | loss1:0.0001 loss2:0.0028 loss3:0.0010 | AUC:0.8351 Anomaly AUC:0.6663
[2023-08-25 20:54:31,708][main.py][line:94][INFO] [Epoch:39/100]: lr:0.00014 | loss1:0.0001 loss2:0.0025 loss3:0.0009 | AUC:0.8347 Anomaly AUC:0.6681
[2023-08-25 20:56:02,743][main.py][line:94][INFO] [Epoch:40/100]: lr:0.00013 | loss1:0.0001 loss2:0.0024 loss3:0.0009 | AUC:0.8352 Anomaly AUC:0.6676
[2023-08-25 20:57:19,828][main.py][line:94][INFO] [Epoch:41/100]: lr:0.00011 | loss1:0.0001 loss2:0.0024 loss3:0.0009 | AUC:0.8324 Anomaly AUC:0.6614
[2023-08-25 20:59:00,302][main.py][line:94][INFO] [Epoch:42/100]: lr:0.00010 | loss1:0.0001 loss2:0.0024 loss3:0.0008 | AUC:0.8335 Anomaly AUC:0.6662
[2023-08-25 20:59:14,515][main.py][line:109][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 20:59:14,663][main.py][line:145][INFO] total params:7.0451M
[2023-08-25 20:59:14,663][main.py][line:148][INFO] Training Mode
[2023-08-25 20:59:14,664][main.py][line:67][INFO] Model:XModel(
  (self_attention): XEncoder(
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 20:59:14,664][main.py][line:68][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 5e-05
)

[2023-08-25 20:59:22,193][main.py][line:71][INFO] Random initialize AUCAUC:0.6062 Anomaly AUC:0.57717
[2023-08-25 21:00:40,428][main.py][line:94][INFO] [Epoch:1/100]: lr:0.00050 | loss1:0.5442 loss2:1.2163 loss3:0.3408 | AUC:0.8203 Anomaly AUC:0.6233
[2023-08-25 21:02:02,619][main.py][line:94][INFO] [Epoch:2/100]: lr:0.00050 | loss1:0.3075 loss2:0.9655 loss3:0.1318 | AUC:0.8199 Anomaly AUC:0.6419
[2023-08-25 21:03:26,579][main.py][line:94][INFO] [Epoch:3/100]: lr:0.00050 | loss1:0.2074 loss2:0.8476 loss3:0.0503 | AUC:0.8298 Anomaly AUC:0.6707
[2023-08-25 21:04:41,182][main.py][line:94][INFO] [Epoch:4/100]: lr:0.00049 | loss1:0.1691 loss2:0.7859 loss3:0.0375 | AUC:0.8409 Anomaly AUC:0.6867
[2023-08-25 21:06:03,525][main.py][line:94][INFO] [Epoch:5/100]: lr:0.00049 | loss1:0.1316 loss2:0.7255 loss3:0.0252 | AUC:0.8126 Anomaly AUC:0.6794
[2023-08-25 21:07:11,544][main.py][line:94][INFO] [Epoch:6/100]: lr:0.00049 | loss1:0.0996 loss2:0.6586 loss3:0.0190 | AUC:0.8442 Anomaly AUC:0.6780
[2023-08-25 21:08:37,036][main.py][line:94][INFO] [Epoch:7/100]: lr:0.00048 | loss1:0.0896 loss2:0.6197 loss3:0.0176 | AUC:0.8149 Anomaly AUC:0.6588
[2023-08-25 21:09:54,450][main.py][line:94][INFO] [Epoch:8/100]: lr:0.00048 | loss1:0.0573 loss2:0.5533 loss3:0.0107 | AUC:0.8109 Anomaly AUC:0.6364
[2023-08-25 21:11:29,273][main.py][line:94][INFO] [Epoch:9/100]: lr:0.00047 | loss1:0.0311 loss2:0.4877 loss3:0.0066 | AUC:0.8385 Anomaly AUC:0.6647
[2023-08-25 21:13:22,377][main.py][line:94][INFO] [Epoch:10/100]: lr:0.00047 | loss1:0.0525 loss2:0.4807 loss3:0.0107 | AUC:0.8315 Anomaly AUC:0.6581
[2023-08-25 21:14:59,105][main.py][line:94][INFO] [Epoch:11/100]: lr:0.00046 | loss1:0.0237 loss2:0.4008 loss3:0.0057 | AUC:0.8428 Anomaly AUC:0.6825
[2023-08-25 21:16:16,810][main.py][line:94][INFO] [Epoch:12/100]: lr:0.00045 | loss1:0.0218 loss2:0.3552 loss3:0.0052 | AUC:0.8181 Anomaly AUC:0.6566
[2023-08-25 21:17:45,556][main.py][line:94][INFO] [Epoch:13/100]: lr:0.00044 | loss1:0.0243 loss2:0.3214 loss3:0.0053 | AUC:0.8028 Anomaly AUC:0.6589
[2023-08-25 21:19:11,883][main.py][line:94][INFO] [Epoch:14/100]: lr:0.00044 | loss1:0.0137 loss2:0.2623 loss3:0.0041 | AUC:0.8224 Anomaly AUC:0.6495
[2023-08-25 21:20:41,947][main.py][line:94][INFO] [Epoch:15/100]: lr:0.00043 | loss1:0.0256 loss2:0.2423 loss3:0.0059 | AUC:0.8316 Anomaly AUC:0.6506
[2023-08-25 21:21:58,973][main.py][line:94][INFO] [Epoch:16/100]: lr:0.00042 | loss1:0.0060 loss2:0.1709 loss3:0.0024 | AUC:0.8138 Anomaly AUC:0.6477
[2023-08-25 21:23:43,053][main.py][line:94][INFO] [Epoch:17/100]: lr:0.00041 | loss1:0.0141 loss2:0.1625 loss3:0.0038 | AUC:0.8284 Anomaly AUC:0.6506
[2023-08-25 21:25:07,972][main.py][line:94][INFO] [Epoch:18/100]: lr:0.00040 | loss1:0.0105 loss2:0.1351 loss3:0.0033 | AUC:0.8252 Anomaly AUC:0.6643
[2023-08-25 21:26:31,802][main.py][line:94][INFO] [Epoch:19/100]: lr:0.00039 | loss1:0.0135 loss2:0.1256 loss3:0.0035 | AUC:0.8314 Anomaly AUC:0.6670
[2023-08-25 21:27:21,179][main.py][line:109][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 21:27:21,301][main.py][line:145][INFO] total params:2.8436M
[2023-08-25 21:27:21,301][main.py][line:148][INFO] Training Mode
[2023-08-25 21:27:21,301][main.py][line:67][INFO] Model:XModel(
  (self_attention): XEncoder(
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 21:27:21,301][main.py][line:68][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 5e-05
)

[2023-08-25 21:27:36,780][main.py][line:109][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 21:27:36,867][main.py][line:145][INFO] total params:3.3693M
[2023-08-25 21:27:36,867][main.py][line:148][INFO] Training Mode
[2023-08-25 21:27:36,867][main.py][line:67][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 21:27:36,867][main.py][line:68][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 5e-05
)

[2023-08-25 21:27:43,013][main.py][line:71][INFO] Random initialize AUCAUC:0.4665 Anomaly AUC:0.48169
[2023-08-25 21:29:15,369][main.py][line:94][INFO] [Epoch:1/100]: lr:0.00050 | loss1:0.0514 loss2:0.9740 loss3:0.3873 | AUC:0.6684 Anomaly AUC:0.5141
[2023-08-25 21:31:03,722][main.py][line:94][INFO] [Epoch:2/100]: lr:0.00050 | loss1:0.0024 loss2:0.7021 loss3:0.3839 | AUC:0.7051 Anomaly AUC:0.5603
[2023-08-25 21:32:25,106][main.py][line:94][INFO] [Epoch:3/100]: lr:0.00050 | loss1:0.0014 loss2:0.6016 loss3:0.3813 | AUC:0.6996 Anomaly AUC:0.5677
[2023-08-25 21:33:34,346][main.py][line:94][INFO] [Epoch:4/100]: lr:0.00050 | loss1:0.0009 loss2:0.5230 loss3:0.3792 | AUC:0.7050 Anomaly AUC:0.5966
[2023-08-25 21:34:09,786][main.py][line:109][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 21:34:09,921][main.py][line:145][INFO] total params:3.3693M
[2023-08-25 21:34:09,921][main.py][line:148][INFO] Training Mode
[2023-08-25 21:34:09,921][main.py][line:67][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 21:34:09,921][main.py][line:68][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0007
    maximize: False
    weight_decay: 5e-05
)

[2023-08-25 21:34:20,067][main.py][line:71][INFO] Random initialize AUCAUC:0.4665 Anomaly AUC:0.48169
[2023-08-25 21:36:10,784][main.py][line:94][INFO] [Epoch:1/100]: lr:0.00050 | loss1:0.0662 loss2:1.0190 loss3:0.3894 | AUC:0.7104 Anomaly AUC:0.5302
[2023-08-25 21:38:27,496][main.py][line:94][INFO] [Epoch:2/100]: lr:0.00050 | loss1:0.0032 loss2:0.7444 loss3:0.3846 | AUC:0.6679 Anomaly AUC:0.5328
[2023-08-25 21:40:19,171][main.py][line:94][INFO] [Epoch:3/100]: lr:0.00050 | loss1:0.0019 loss2:0.6611 loss3:0.3821 | AUC:0.6885 Anomaly AUC:0.5287
[2023-08-25 21:41:13,134][main.py][line:109][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-25 21:41:13,282][main.py][line:145][INFO] total params:7.5707M
[2023-08-25 21:41:13,282][main.py][line:148][INFO] Training Mode
[2023-08-25 21:41:13,283][main.py][line:67][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-25 21:41:13,283][main.py][line:68][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0007
    maximize: False
    weight_decay: 5e-05
)

[2023-08-25 21:41:24,935][main.py][line:71][INFO] Random initialize AUCAUC:0.5727 Anomaly AUC:0.55777
[2023-08-25 21:43:19,940][main.py][line:94][INFO] [Epoch:1/100]: lr:0.00050 | loss1:0.5243 loss2:1.1448 loss3:0.2861 | AUC:0.8151 Anomaly AUC:0.6279
[2023-08-25 21:46:34,224][main.py][line:94][INFO] [Epoch:2/100]: lr:0.00050 | loss1:0.3069 loss2:0.9366 loss3:0.1481 | AUC:0.8114 Anomaly AUC:0.6646
[2023-08-25 21:48:08,948][main.py][line:94][INFO] [Epoch:3/100]: lr:0.00050 | loss1:0.2187 loss2:0.8358 loss3:0.0879 | AUC:0.8488 Anomaly AUC:0.6926
[2023-08-25 21:49:34,942][main.py][line:94][INFO] [Epoch:4/100]: lr:0.00050 | loss1:0.1631 loss2:0.7729 loss3:0.0569 | AUC:0.8612 Anomaly AUC:0.7024
[2023-08-25 21:51:07,231][main.py][line:94][INFO] [Epoch:5/100]: lr:0.00050 | loss1:0.1078 loss2:0.7077 loss3:0.0387 | AUC:0.8476 Anomaly AUC:0.6794
[2023-08-25 21:53:14,848][main.py][line:94][INFO] [Epoch:6/100]: lr:0.00050 | loss1:0.0801 loss2:0.6469 loss3:0.0314 | AUC:0.8570 Anomaly AUC:0.7013
[2023-08-25 21:54:53,085][main.py][line:94][INFO] [Epoch:7/100]: lr:0.00050 | loss1:0.0458 loss2:0.5701 loss3:0.0308 | AUC:0.8410 Anomaly AUC:0.6891
[2023-08-25 21:57:09,332][main.py][line:94][INFO] [Epoch:8/100]: lr:0.00050 | loss1:0.0293 loss2:0.4895 loss3:0.0321 | AUC:0.8521 Anomaly AUC:0.6984
[2023-08-25 22:00:18,070][main.py][line:94][INFO] [Epoch:9/100]: lr:0.00050 | loss1:0.0249 loss2:0.4169 loss3:0.0298 | AUC:0.8504 Anomaly AUC:0.6877
[2023-08-25 22:02:27,431][main.py][line:94][INFO] [Epoch:10/100]: lr:0.00050 | loss1:0.0117 loss2:0.3176 loss3:0.0223 | AUC:0.8454 Anomaly AUC:0.6951
[2023-08-25 22:04:28,195][main.py][line:94][INFO] [Epoch:11/100]: lr:0.00050 | loss1:0.0062 loss2:0.2242 loss3:0.0150 | AUC:0.8346 Anomaly AUC:0.6915
[2023-08-25 22:06:46,158][main.py][line:94][INFO] [Epoch:12/100]: lr:0.00050 | loss1:0.0085 loss2:0.1583 loss3:0.0158 | AUC:0.8271 Anomaly AUC:0.7115
[2023-08-25 22:09:06,454][main.py][line:94][INFO] [Epoch:13/100]: lr:0.00050 | loss1:0.0037 loss2:0.1038 loss3:0.0127 | AUC:0.8307 Anomaly AUC:0.6680
[2023-08-25 22:10:48,876][main.py][line:94][INFO] [Epoch:14/100]: lr:0.00050 | loss1:0.0038 loss2:0.0659 loss3:0.0113 | AUC:0.8079 Anomaly AUC:0.6629
[2023-08-25 22:12:49,615][main.py][line:94][INFO] [Epoch:15/100]: lr:0.00050 | loss1:0.0092 loss2:0.0890 loss3:0.0183 | AUC:0.8459 Anomaly AUC:0.6966
[2023-08-25 22:15:16,503][main.py][line:94][INFO] [Epoch:16/100]: lr:0.00050 | loss1:0.0016 loss2:0.0373 loss3:0.0056 | AUC:0.8336 Anomaly AUC:0.6786
[2023-08-25 22:17:56,776][main.py][line:94][INFO] [Epoch:17/100]: lr:0.00050 | loss1:0.0005 loss2:0.0215 loss3:0.0029 | AUC:0.8089 Anomaly AUC:0.6253
[2023-08-25 22:19:57,957][main.py][line:94][INFO] [Epoch:18/100]: lr:0.00050 | loss1:0.0002 loss2:0.0129 loss3:0.0017 | AUC:0.8129 Anomaly AUC:0.6248
[2023-08-25 22:21:42,058][main.py][line:94][INFO] [Epoch:19/100]: lr:0.00050 | loss1:0.0002 loss2:0.0098 loss3:0.0016 | AUC:0.8022 Anomaly AUC:0.6146
[2023-08-25 22:24:07,307][main.py][line:94][INFO] [Epoch:20/100]: lr:0.00050 | loss1:0.0002 loss2:0.0083 loss3:0.0017 | AUC:0.7865 Anomaly AUC:0.5951
[2023-08-25 22:26:15,104][main.py][line:94][INFO] [Epoch:21/100]: lr:0.00050 | loss1:0.0002 loss2:0.0076 loss3:0.0018 | AUC:0.7903 Anomaly AUC:0.5827
[2023-08-25 22:28:33,979][main.py][line:94][INFO] [Epoch:22/100]: lr:0.00050 | loss1:0.0002 loss2:0.0069 loss3:0.0018 | AUC:0.8127 Anomaly AUC:0.6202
[2023-08-25 22:30:51,928][main.py][line:94][INFO] [Epoch:23/100]: lr:0.00050 | loss1:0.0001 loss2:0.0061 loss3:0.0020 | AUC:0.7724 Anomaly AUC:0.5587
[2023-08-25 22:33:08,081][main.py][line:94][INFO] [Epoch:24/100]: lr:0.00050 | loss1:0.1723 loss2:0.3227 loss3:0.0628 | AUC:0.7875 Anomaly AUC:0.5940
[2023-08-25 22:35:07,751][main.py][line:94][INFO] [Epoch:25/100]: lr:0.00050 | loss1:0.2876 loss2:0.7955 loss3:0.0589 | AUC:0.8378 Anomaly AUC:0.6405
[2023-08-25 22:37:12,451][main.py][line:94][INFO] [Epoch:26/100]: lr:0.00050 | loss1:0.0777 loss2:0.4013 loss3:0.0285 | AUC:0.8106 Anomaly AUC:0.6492
[2023-08-25 22:39:31,407][main.py][line:94][INFO] [Epoch:27/100]: lr:0.00050 | loss1:0.0134 loss2:0.1524 loss3:0.0219 | AUC:0.8370 Anomaly AUC:0.6973
[2023-08-25 22:41:14,464][main.py][line:94][INFO] [Epoch:28/100]: lr:0.00050 | loss1:0.0025 loss2:0.0484 loss3:0.0125 | AUC:0.8473 Anomaly AUC:0.6971
[2023-08-25 22:42:49,654][main.py][line:94][INFO] [Epoch:29/100]: lr:0.00050 | loss1:0.0014 loss2:0.0221 loss3:0.0079 | AUC:0.8348 Anomaly AUC:0.6844
[2023-08-25 22:45:10,370][main.py][line:94][INFO] [Epoch:30/100]: lr:0.00050 | loss1:0.0018 loss2:0.0172 loss3:0.0082 | AUC:0.7827 Anomaly AUC:0.6779
[2023-08-25 22:47:29,116][main.py][line:94][INFO] [Epoch:31/100]: lr:0.00050 | loss1:0.0030 loss2:0.0213 loss3:0.0108 | AUC:0.8282 Anomaly AUC:0.6855
[2023-08-25 22:49:09,474][main.py][line:94][INFO] [Epoch:32/100]: lr:0.00050 | loss1:0.0030 loss2:0.0254 loss3:0.0101 | AUC:0.8359 Anomaly AUC:0.7019
[2023-08-25 22:51:24,668][main.py][line:94][INFO] [Epoch:33/100]: lr:0.00050 | loss1:0.0034 loss2:0.0154 loss3:0.0106 | AUC:0.7651 Anomaly AUC:0.7001
[2023-08-25 22:53:17,068][main.py][line:94][INFO] [Epoch:34/100]: lr:0.00050 | loss1:0.0010 loss2:0.0102 loss3:0.0081 | AUC:0.8252 Anomaly AUC:0.6917
[2023-08-25 22:55:29,965][main.py][line:94][INFO] [Epoch:35/100]: lr:0.00050 | loss1:0.0002 loss2:0.0046 loss3:0.0030 | AUC:0.8326 Anomaly AUC:0.6840
[2023-08-25 22:57:06,999][main.py][line:94][INFO] [Epoch:36/100]: lr:0.00050 | loss1:0.0001 loss2:0.0026 loss3:0.0023 | AUC:0.8328 Anomaly AUC:0.6792
[2023-08-25 22:58:54,546][main.py][line:94][INFO] [Epoch:37/100]: lr:0.00050 | loss1:0.0001 loss2:0.0025 loss3:0.0012 | AUC:0.8320 Anomaly AUC:0.6789
[2023-08-25 23:00:53,081][main.py][line:94][INFO] [Epoch:38/100]: lr:0.00050 | loss1:0.0001 loss2:0.0031 loss3:0.0013 | AUC:0.8343 Anomaly AUC:0.6637
[2023-08-25 23:03:09,995][main.py][line:94][INFO] [Epoch:39/100]: lr:0.00050 | loss1:0.0062 loss2:0.0393 loss3:0.0164 | AUC:0.8293 Anomaly AUC:0.7024
[2023-08-25 23:06:01,236][main.py][line:94][INFO] [Epoch:40/100]: lr:0.00050 | loss1:0.0090 loss2:0.0593 loss3:0.0352 | AUC:0.8211 Anomaly AUC:0.7066
[2023-08-25 23:08:10,430][main.py][line:94][INFO] [Epoch:41/100]: lr:0.00050 | loss1:0.0035 loss2:0.0218 loss3:0.0172 | AUC:0.8409 Anomaly AUC:0.6998
[2023-08-25 23:10:06,762][main.py][line:94][INFO] [Epoch:42/100]: lr:0.00050 | loss1:0.0004 loss2:0.0079 loss3:0.0069 | AUC:0.8395 Anomaly AUC:0.7039
[2023-08-25 23:11:56,178][main.py][line:94][INFO] [Epoch:43/100]: lr:0.00050 | loss1:0.0001 loss2:0.0046 loss3:0.0041 | AUC:0.8454 Anomaly AUC:0.7100
[2023-08-25 23:14:15,634][main.py][line:94][INFO] [Epoch:44/100]: lr:0.00050 | loss1:0.0001 loss2:0.0023 loss3:0.0024 | AUC:0.8485 Anomaly AUC:0.7096
[2023-08-25 23:15:50,967][main.py][line:94][INFO] [Epoch:45/100]: lr:0.00050 | loss1:0.0000 loss2:0.0017 loss3:0.0019 | AUC:0.8474 Anomaly AUC:0.7064
[2023-08-25 23:17:32,714][main.py][line:94][INFO] [Epoch:46/100]: lr:0.00050 | loss1:0.0000 loss2:0.0016 loss3:0.0017 | AUC:0.8466 Anomaly AUC:0.7053
[2023-08-25 23:19:20,287][main.py][line:94][INFO] [Epoch:47/100]: lr:0.00050 | loss1:0.0000 loss2:0.0014 loss3:0.0014 | AUC:0.8487 Anomaly AUC:0.7071
[2023-08-25 23:21:22,243][main.py][line:94][INFO] [Epoch:48/100]: lr:0.00050 | loss1:0.0000 loss2:0.0016 loss3:0.0015 | AUC:0.8476 Anomaly AUC:0.7061
[2023-08-25 23:23:01,412][main.py][line:94][INFO] [Epoch:49/100]: lr:0.00050 | loss1:0.0000 loss2:0.0014 loss3:0.0016 | AUC:0.8402 Anomaly AUC:0.7025
[2023-08-25 23:24:54,597][main.py][line:94][INFO] [Epoch:50/100]: lr:0.00050 | loss1:0.0000 loss2:0.0016 loss3:0.0022 | AUC:0.8416 Anomaly AUC:0.6967
[2023-08-25 23:27:02,555][main.py][line:94][INFO] [Epoch:51/100]: lr:0.00050 | loss1:0.0000 loss2:0.0015 loss3:0.0016 | AUC:0.8415 Anomaly AUC:0.6941
[2023-08-25 23:28:51,385][main.py][line:94][INFO] [Epoch:52/100]: lr:0.00050 | loss1:0.0000 loss2:0.0013 loss3:0.0017 | AUC:0.8418 Anomaly AUC:0.6950
[2023-08-25 23:30:31,948][main.py][line:94][INFO] [Epoch:53/100]: lr:0.00050 | loss1:0.0000 loss2:0.0013 loss3:0.0014 | AUC:0.8421 Anomaly AUC:0.6899
[2023-08-25 23:32:29,267][main.py][line:94][INFO] [Epoch:54/100]: lr:0.00050 | loss1:0.0000 loss2:0.0015 loss3:0.0019 | AUC:0.8456 Anomaly AUC:0.6948
[2023-08-25 23:34:14,949][main.py][line:94][INFO] [Epoch:55/100]: lr:0.00050 | loss1:0.0000 loss2:0.0012 loss3:0.0017 | AUC:0.8419 Anomaly AUC:0.6891
[2023-08-25 23:35:54,413][main.py][line:94][INFO] [Epoch:56/100]: lr:0.00050 | loss1:0.0918 loss2:0.1997 loss3:0.0931 | AUC:0.8031 Anomaly AUC:0.6779
[2023-08-25 23:38:34,635][main.py][line:94][INFO] [Epoch:57/100]: lr:0.00050 | loss1:0.0175 loss2:0.2444 loss3:0.0771 | AUC:0.7838 Anomaly AUC:0.6869
[2023-08-25 23:40:31,532][main.py][line:94][INFO] [Epoch:58/100]: lr:0.00050 | loss1:0.0050 loss2:0.0641 loss3:0.0297 | AUC:0.7646 Anomaly AUC:0.7091
[2023-08-25 23:42:45,586][main.py][line:94][INFO] [Epoch:59/100]: lr:0.00050 | loss1:0.0103 loss2:0.0580 loss3:0.0379 | AUC:0.7332 Anomaly AUC:0.6608
[2023-08-25 23:45:08,234][main.py][line:94][INFO] [Epoch:60/100]: lr:0.00050 | loss1:0.0015 loss2:0.0314 loss3:0.0181 | AUC:0.8378 Anomaly AUC:0.6975
[2023-08-25 23:46:43,605][main.py][line:94][INFO] [Epoch:61/100]: lr:0.00050 | loss1:0.0011 loss2:0.0082 loss3:0.0138 | AUC:0.8252 Anomaly AUC:0.6993
[2023-08-25 23:48:22,271][main.py][line:94][INFO] [Epoch:62/100]: lr:0.00050 | loss1:0.0003 loss2:0.0056 loss3:0.0095 | AUC:0.8441 Anomaly AUC:0.6997
[2023-08-25 23:50:33,390][main.py][line:94][INFO] [Epoch:63/100]: lr:0.00050 | loss1:0.0002 loss2:0.0030 loss3:0.0062 | AUC:0.8558 Anomaly AUC:0.7108
[2023-08-25 23:52:40,898][main.py][line:94][INFO] [Epoch:64/100]: lr:0.00050 | loss1:0.0006 loss2:0.0058 loss3:0.0076 | AUC:0.8532 Anomaly AUC:0.7133
[2023-08-25 23:54:20,735][main.py][line:94][INFO] [Epoch:65/100]: lr:0.00050 | loss1:0.0002 loss2:0.0022 loss3:0.0048 | AUC:0.8595 Anomaly AUC:0.7119
[2023-08-25 23:56:06,990][main.py][line:94][INFO] [Epoch:66/100]: lr:0.00050 | loss1:0.0001 loss2:0.0018 loss3:0.0039 | AUC:0.8558 Anomaly AUC:0.7077
[2023-08-25 23:57:53,073][main.py][line:94][INFO] [Epoch:67/100]: lr:0.00050 | loss1:0.0001 loss2:0.0019 loss3:0.0036 | AUC:0.8565 Anomaly AUC:0.7063
[2023-08-26 00:00:08,049][main.py][line:94][INFO] [Epoch:68/100]: lr:0.00050 | loss1:0.0064 loss2:0.0475 loss3:0.0470 | AUC:0.7942 Anomaly AUC:0.6997
[2023-08-26 00:02:30,329][main.py][line:94][INFO] [Epoch:69/100]: lr:0.00050 | loss1:0.0023 loss2:0.0152 loss3:0.0186 | AUC:0.8282 Anomaly AUC:0.7019
[2023-08-26 00:03:57,676][main.py][line:94][INFO] [Epoch:70/100]: lr:0.00050 | loss1:0.0038 loss2:0.0407 loss3:0.0367 | AUC:0.8152 Anomaly AUC:0.6818
[2023-08-26 00:05:22,722][main.py][line:94][INFO] [Epoch:71/100]: lr:0.00050 | loss1:0.0049 loss2:0.0347 loss3:0.0301 | AUC:0.7965 Anomaly AUC:0.6933
[2023-08-26 00:06:54,080][main.py][line:94][INFO] [Epoch:72/100]: lr:0.00050 | loss1:0.0013 loss2:0.0089 loss3:0.0131 | AUC:0.8340 Anomaly AUC:0.7038
[2023-08-26 00:08:40,435][main.py][line:94][INFO] [Epoch:73/100]: lr:0.00050 | loss1:0.0021 loss2:0.0103 loss3:0.0125 | AUC:0.8163 Anomaly AUC:0.6988
[2023-08-26 00:11:11,660][main.py][line:94][INFO] [Epoch:74/100]: lr:0.00050 | loss1:0.0021 loss2:0.0141 loss3:0.0144 | AUC:0.7974 Anomaly AUC:0.7032
[2023-08-26 00:12:56,693][main.py][line:94][INFO] [Epoch:75/100]: lr:0.00050 | loss1:0.0019 loss2:0.0063 loss3:0.0088 | AUC:0.8175 Anomaly AUC:0.7034
[2023-08-26 00:14:25,357][main.py][line:94][INFO] [Epoch:76/100]: lr:0.00050 | loss1:0.0015 loss2:0.0131 loss3:0.0153 | AUC:0.8214 Anomaly AUC:0.6850
[2023-08-26 00:16:15,255][main.py][line:94][INFO] [Epoch:77/100]: lr:0.00050 | loss1:0.0024 loss2:0.0289 loss3:0.0220 | AUC:0.8306 Anomaly AUC:0.6882
[2023-08-26 00:17:52,628][main.py][line:94][INFO] [Epoch:78/100]: lr:0.00050 | loss1:0.0002 loss2:0.0050 loss3:0.0087 | AUC:0.8465 Anomaly AUC:0.6915
[2023-08-26 00:19:42,573][main.py][line:94][INFO] [Epoch:79/100]: lr:0.00050 | loss1:0.0001 loss2:0.0020 loss3:0.0046 | AUC:0.8485 Anomaly AUC:0.6917
[2023-08-26 00:21:38,566][main.py][line:94][INFO] [Epoch:80/100]: lr:0.00050 | loss1:0.0010 loss2:0.0015 loss3:0.0036 | AUC:0.8424 Anomaly AUC:0.6776
[2023-08-26 00:22:44,923][main.py][line:109][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 00:22:45,087][main.py][line:145][INFO] total params:7.5707M
[2023-08-26 00:22:45,087][main.py][line:148][INFO] Training Mode
[2023-08-26 00:22:45,087][main.py][line:67][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 00:22:45,087][main.py][line:68][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0007
    lr: 0.0007
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 00:22:54,189][main.py][line:71][INFO] Random initialize AUCAUC:0.5727 Anomaly AUC:0.55777
[2023-08-26 00:24:06,941][main.py][line:94][INFO] [Epoch:1/100]: lr:0.00050 | loss1:0.5243 loss2:1.1448 loss3:0.2861 | AUC:0.8151 Anomaly AUC:0.6279
[2023-08-26 00:25:21,995][main.py][line:94][INFO] [Epoch:2/100]: lr:0.00050 | loss1:0.3103 loss2:0.9382 loss3:0.1469 | AUC:0.8139 Anomaly AUC:0.6535
[2023-08-26 00:26:33,604][main.py][line:94][INFO] [Epoch:3/100]: lr:0.00050 | loss1:0.2281 loss2:0.8414 loss3:0.0867 | AUC:0.8404 Anomaly AUC:0.6791
[2023-08-26 00:27:43,785][main.py][line:94][INFO] [Epoch:4/100]: lr:0.00049 | loss1:0.1658 loss2:0.7767 loss3:0.0594 | AUC:0.8265 Anomaly AUC:0.6667
[2023-08-26 00:29:09,134][main.py][line:94][INFO] [Epoch:5/100]: lr:0.00049 | loss1:0.1179 loss2:0.7103 loss3:0.0497 | AUC:0.8309 Anomaly AUC:0.6757
[2023-08-26 00:30:38,766][main.py][line:94][INFO] [Epoch:6/100]: lr:0.00049 | loss1:0.0654 loss2:0.6209 loss3:0.0352 | AUC:0.8358 Anomaly AUC:0.6790
[2023-08-26 00:31:52,410][main.py][line:94][INFO] [Epoch:7/100]: lr:0.00048 | loss1:0.0467 loss2:0.5515 loss3:0.0317 | AUC:0.8355 Anomaly AUC:0.6961
[2023-08-26 00:33:47,569][main.py][line:94][INFO] [Epoch:8/100]: lr:0.00048 | loss1:0.0244 loss2:0.4699 loss3:0.0265 | AUC:0.8445 Anomaly AUC:0.6958
[2023-08-26 00:35:41,435][main.py][line:94][INFO] [Epoch:9/100]: lr:0.00047 | loss1:0.0139 loss2:0.3871 loss3:0.0229 | AUC:0.8559 Anomaly AUC:0.6939
[2023-08-26 00:36:58,507][main.py][line:94][INFO] [Epoch:10/100]: lr:0.00047 | loss1:0.0052 loss2:0.2664 loss3:0.0165 | AUC:0.8156 Anomaly AUC:0.6893
[2023-08-26 00:38:35,219][main.py][line:94][INFO] [Epoch:11/100]: lr:0.00046 | loss1:0.0081 loss2:0.2264 loss3:0.0174 | AUC:0.8383 Anomaly AUC:0.6793
[2023-08-26 00:39:59,811][main.py][line:94][INFO] [Epoch:12/100]: lr:0.00045 | loss1:0.0054 loss2:0.1214 loss3:0.0142 | AUC:0.8299 Anomaly AUC:0.6846
[2023-08-26 00:41:36,552][main.py][line:94][INFO] [Epoch:13/100]: lr:0.00044 | loss1:0.0055 loss2:0.1133 loss3:0.0177 | AUC:0.8208 Anomaly AUC:0.6645
[2023-08-26 00:43:07,598][main.py][line:94][INFO] [Epoch:14/100]: lr:0.00044 | loss1:0.0015 loss2:0.0490 loss3:0.0044 | AUC:0.8266 Anomaly AUC:0.6504
[2023-08-26 00:44:38,874][main.py][line:94][INFO] [Epoch:15/100]: lr:0.00043 | loss1:0.0004 loss2:0.0284 loss3:0.0025 | AUC:0.8411 Anomaly AUC:0.6773
[2023-08-26 00:46:25,979][main.py][line:94][INFO] [Epoch:16/100]: lr:0.00042 | loss1:0.0003 loss2:0.0214 loss3:0.0018 | AUC:0.8417 Anomaly AUC:0.6719
[2023-08-26 00:48:15,288][main.py][line:94][INFO] [Epoch:17/100]: lr:0.00041 | loss1:0.0002 loss2:0.0169 loss3:0.0014 | AUC:0.8444 Anomaly AUC:0.6791
[2023-08-26 00:49:39,970][main.py][line:94][INFO] [Epoch:18/100]: lr:0.00040 | loss1:0.0002 loss2:0.0138 loss3:0.0013 | AUC:0.8411 Anomaly AUC:0.6653
[2023-08-26 00:50:58,969][main.py][line:94][INFO] [Epoch:19/100]: lr:0.00039 | loss1:0.0049 loss2:0.0324 loss3:0.0112 | AUC:0.8465 Anomaly AUC:0.6786
[2023-08-26 00:52:30,043][main.py][line:94][INFO] [Epoch:20/100]: lr:0.00038 | loss1:0.0043 loss2:0.0503 loss3:0.0156 | AUC:0.8439 Anomaly AUC:0.6678
[2023-08-26 00:53:56,966][main.py][line:94][INFO] [Epoch:21/100]: lr:0.00036 | loss1:0.0017 loss2:0.0311 loss3:0.0098 | AUC:0.8456 Anomaly AUC:0.6785
[2023-08-26 00:55:22,965][main.py][line:94][INFO] [Epoch:22/100]: lr:0.00035 | loss1:0.0003 loss2:0.0108 loss3:0.0047 | AUC:0.8466 Anomaly AUC:0.6786
[2023-08-26 00:56:42,454][main.py][line:94][INFO] [Epoch:23/100]: lr:0.00034 | loss1:0.0002 loss2:0.0079 loss3:0.0031 | AUC:0.8460 Anomaly AUC:0.6743
[2023-08-26 00:57:54,898][main.py][line:94][INFO] [Epoch:24/100]: lr:0.00033 | loss1:0.0001 loss2:0.0068 loss3:0.0021 | AUC:0.8485 Anomaly AUC:0.6746
[2023-08-26 00:59:30,503][main.py][line:94][INFO] [Epoch:25/100]: lr:0.00031 | loss1:0.0001 loss2:0.0060 loss3:0.0016 | AUC:0.8407 Anomaly AUC:0.6555
[2023-08-26 01:00:53,447][main.py][line:94][INFO] [Epoch:26/100]: lr:0.00030 | loss1:0.0001 loss2:0.0055 loss3:0.0015 | AUC:0.8377 Anomaly AUC:0.6471
[2023-08-26 01:02:18,699][main.py][line:94][INFO] [Epoch:27/100]: lr:0.00029 | loss1:0.0001 loss2:0.0052 loss3:0.0012 | AUC:0.8364 Anomaly AUC:0.6480
[2023-08-26 01:03:57,382][main.py][line:94][INFO] [Epoch:28/100]: lr:0.00028 | loss1:0.0001 loss2:0.0047 loss3:0.0012 | AUC:0.8314 Anomaly AUC:0.6358
[2023-08-26 01:05:43,744][main.py][line:94][INFO] [Epoch:29/100]: lr:0.00026 | loss1:0.0001 loss2:0.0046 loss3:0.0013 | AUC:0.8271 Anomaly AUC:0.6284
[2023-08-26 01:07:04,988][main.py][line:94][INFO] [Epoch:30/100]: lr:0.00025 | loss1:0.0032 loss2:0.0174 loss3:0.0152 | AUC:0.7995 Anomaly AUC:0.6625
[2023-08-26 01:08:25,675][main.py][line:94][INFO] [Epoch:31/100]: lr:0.00024 | loss1:0.0096 loss2:0.0590 loss3:0.0372 | AUC:0.8439 Anomaly AUC:0.6708
[2023-08-26 01:09:54,382][main.py][line:94][INFO] [Epoch:32/100]: lr:0.00022 | loss1:0.0029 loss2:0.0235 loss3:0.0138 | AUC:0.8490 Anomaly AUC:0.6838
[2023-08-26 01:11:30,103][main.py][line:94][INFO] [Epoch:33/100]: lr:0.00021 | loss1:0.0019 loss2:0.0170 loss3:0.0154 | AUC:0.8521 Anomaly AUC:0.6820
[2023-08-26 01:12:57,912][main.py][line:94][INFO] [Epoch:34/100]: lr:0.00020 | loss1:0.0003 loss2:0.0053 loss3:0.0037 | AUC:0.8496 Anomaly AUC:0.6802
[2023-08-26 01:14:27,871][main.py][line:94][INFO] [Epoch:35/100]: lr:0.00019 | loss1:0.0001 loss2:0.0040 loss3:0.0034 | AUC:0.8514 Anomaly AUC:0.6840
[2023-08-26 01:15:50,094][main.py][line:94][INFO] [Epoch:36/100]: lr:0.00017 | loss1:0.0001 loss2:0.0032 loss3:0.0022 | AUC:0.8526 Anomaly AUC:0.6855
[2023-08-26 01:17:27,461][main.py][line:94][INFO] [Epoch:37/100]: lr:0.00016 | loss1:0.0000 loss2:0.0030 loss3:0.0019 | AUC:0.8531 Anomaly AUC:0.6856
[2023-08-26 01:18:58,583][main.py][line:94][INFO] [Epoch:38/100]: lr:0.00015 | loss1:0.0000 loss2:0.0029 loss3:0.0018 | AUC:0.8534 Anomaly AUC:0.6866
[2023-08-26 01:20:22,586][main.py][line:94][INFO] [Epoch:39/100]: lr:0.00014 | loss1:0.0001 loss2:0.0026 loss3:0.0014 | AUC:0.8532 Anomaly AUC:0.6867
[2023-08-26 01:21:50,092][main.py][line:94][INFO] [Epoch:40/100]: lr:0.00013 | loss1:0.0000 loss2:0.0026 loss3:0.0015 | AUC:0.8541 Anomaly AUC:0.6881
[2023-08-26 01:23:10,722][main.py][line:94][INFO] [Epoch:41/100]: lr:0.00011 | loss1:0.0000 loss2:0.0024 loss3:0.0014 | AUC:0.8546 Anomaly AUC:0.6887
[2023-08-26 01:24:35,892][main.py][line:94][INFO] [Epoch:42/100]: lr:0.00010 | loss1:0.0000 loss2:0.0025 loss3:0.0015 | AUC:0.8551 Anomaly AUC:0.6896
[2023-08-26 01:26:18,928][main.py][line:94][INFO] [Epoch:43/100]: lr:0.00009 | loss1:0.0000 loss2:0.0024 loss3:0.0013 | AUC:0.8558 Anomaly AUC:0.6911
[2023-08-26 01:27:40,705][main.py][line:94][INFO] [Epoch:44/100]: lr:0.00008 | loss1:0.0000 loss2:0.0023 loss3:0.0012 | AUC:0.8559 Anomaly AUC:0.6911
[2023-08-26 01:29:03,950][main.py][line:94][INFO] [Epoch:45/100]: lr:0.00007 | loss1:0.0000 loss2:0.0022 loss3:0.0012 | AUC:0.8562 Anomaly AUC:0.6923
[2023-08-26 01:30:37,788][main.py][line:94][INFO] [Epoch:46/100]: lr:0.00006 | loss1:0.0000 loss2:0.0022 loss3:0.0012 | AUC:0.8566 Anomaly AUC:0.6925
[2023-08-26 01:31:46,804][main.py][line:94][INFO] [Epoch:47/100]: lr:0.00006 | loss1:0.0000 loss2:0.0021 loss3:0.0013 | AUC:0.8572 Anomaly AUC:0.6939
[2023-08-26 01:33:11,339][main.py][line:94][INFO] [Epoch:48/100]: lr:0.00005 | loss1:0.0000 loss2:0.0022 loss3:0.0011 | AUC:0.8575 Anomaly AUC:0.6950
[2023-08-26 01:34:31,245][main.py][line:94][INFO] [Epoch:49/100]: lr:0.00004 | loss1:0.0000 loss2:0.0021 loss3:0.0012 | AUC:0.8588 Anomaly AUC:0.6962
[2023-08-26 01:35:44,860][main.py][line:94][INFO] [Epoch:50/100]: lr:0.00003 | loss1:0.0000 loss2:0.0022 loss3:0.0011 | AUC:0.8581 Anomaly AUC:0.6959
[2023-08-26 01:37:11,596][main.py][line:94][INFO] [Epoch:51/100]: lr:0.00003 | loss1:0.0000 loss2:0.0021 loss3:0.0010 | AUC:0.8583 Anomaly AUC:0.6966
[2023-08-26 01:38:30,011][main.py][line:94][INFO] [Epoch:52/100]: lr:0.00002 | loss1:0.0000 loss2:0.0021 loss3:0.0011 | AUC:0.8584 Anomaly AUC:0.6960
[2023-08-26 01:39:43,555][main.py][line:94][INFO] [Epoch:53/100]: lr:0.00002 | loss1:0.0000 loss2:0.0020 loss3:0.0011 | AUC:0.8581 Anomaly AUC:0.6957
[2023-08-26 01:40:54,801][main.py][line:94][INFO] [Epoch:54/100]: lr:0.00001 | loss1:0.0000 loss2:0.0021 loss3:0.0010 | AUC:0.8584 Anomaly AUC:0.6962
[2023-08-26 01:42:31,852][main.py][line:94][INFO] [Epoch:55/100]: lr:0.00001 | loss1:0.0000 loss2:0.0019 loss3:0.0010 | AUC:0.8582 Anomaly AUC:0.6967
[2023-08-26 01:43:57,174][main.py][line:94][INFO] [Epoch:56/100]: lr:0.00001 | loss1:0.0000 loss2:0.0019 loss3:0.0010 | AUC:0.8584 Anomaly AUC:0.6969
[2023-08-26 01:44:09,356][main.py][line:112][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 01:44:09,506][main.py][line:148][INFO] total params:7.5707M
[2023-08-26 01:44:09,506][main.py][line:151][INFO] Training Mode
[2023-08-26 01:44:09,507][main.py][line:70][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 01:44:09,507][main.py][line:71][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 5e-05
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0007
    lr: 5e-05
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 01:44:17,171][main.py][line:74][INFO] Random initialize AUCAUC:0.5727 Anomaly AUC:0.55777
[2023-08-26 01:46:28,878][main.py][line:112][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 01:46:29,023][main.py][line:148][INFO] total params:7.5707M
[2023-08-26 01:46:29,023][main.py][line:151][INFO] Training Mode
[2023-08-26 01:46:29,024][main.py][line:70][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 01:46:29,024][main.py][line:71][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 5e-05
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0007
    lr: 5e-05
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 01:46:37,015][main.py][line:74][INFO] Random initialize AUCAUC:0.5727 Anomaly AUC:0.55777
[2023-08-26 01:48:39,126][main.py][line:97][INFO] [Epoch:1/100]: lr:0.00007 | loss1:0.5739 loss2:1.3020 loss3:0.3838 | AUC:0.8077 Anomaly AUC:0.6047
[2023-08-26 01:50:57,161][main.py][line:97][INFO] [Epoch:2/100]: lr:0.00010 | loss1:0.3043 loss2:1.0458 loss3:0.3120 | AUC:0.8131 Anomaly AUC:0.6487
[2023-08-26 01:52:47,642][main.py][line:97][INFO] [Epoch:3/100]: lr:0.00012 | loss1:0.1931 loss2:0.9044 loss3:0.2347 | AUC:0.8234 Anomaly AUC:0.6725
[2023-08-26 01:54:47,748][main.py][line:97][INFO] [Epoch:4/100]: lr:0.00014 | loss1:0.1347 loss2:0.8314 loss3:0.1582 | AUC:0.8178 Anomaly AUC:0.6710
[2023-08-26 01:56:53,190][main.py][line:97][INFO] [Epoch:5/100]: lr:0.00016 | loss1:0.0864 loss2:0.7666 loss3:0.0831 | AUC:0.8230 Anomaly AUC:0.6809
[2023-08-26 01:58:56,784][main.py][line:97][INFO] [Epoch:6/100]: lr:0.00018 | loss1:0.1227 loss2:0.7545 loss3:0.0535 | AUC:0.8294 Anomaly AUC:0.6856
[2023-08-26 02:01:04,164][main.py][line:97][INFO] [Epoch:7/100]: lr:0.00021 | loss1:0.0438 loss2:0.6715 loss3:0.0265 | AUC:0.8211 Anomaly AUC:0.6789
[2023-08-26 02:03:52,779][main.py][line:97][INFO] [Epoch:8/100]: lr:0.00023 | loss1:0.0715 loss2:0.6631 loss3:0.0254 | AUC:0.8253 Anomaly AUC:0.6931
[2023-08-26 02:06:26,793][main.py][line:97][INFO] [Epoch:9/100]: lr:0.00025 | loss1:0.0445 loss2:0.6045 loss3:0.0176 | AUC:0.8061 Anomaly AUC:0.6810
[2023-08-26 02:08:29,337][main.py][line:97][INFO] [Epoch:10/100]: lr:0.00028 | loss1:0.0310 loss2:0.5363 loss3:0.0123 | AUC:0.8497 Anomaly AUC:0.6876
[2023-08-26 02:11:01,712][main.py][line:97][INFO] [Epoch:11/100]: lr:0.00030 | loss1:0.0647 loss2:0.5601 loss3:0.0160 | AUC:0.8569 Anomaly AUC:0.7029
[2023-08-26 02:13:51,903][main.py][line:97][INFO] [Epoch:12/100]: lr:0.00032 | loss1:0.0411 loss2:0.4852 loss3:0.0097 | AUC:0.8527 Anomaly AUC:0.6726
[2023-08-26 02:15:52,927][main.py][line:97][INFO] [Epoch:13/100]: lr:0.00034 | loss1:0.0151 loss2:0.3999 loss3:0.0055 | AUC:0.8422 Anomaly AUC:0.6830
[2023-08-26 02:17:57,977][main.py][line:97][INFO] [Epoch:14/100]: lr:0.00036 | loss1:0.0431 loss2:0.4097 loss3:0.0103 | AUC:0.8378 Anomaly AUC:0.7011
[2023-08-26 02:19:35,346][main.py][line:97][INFO] [Epoch:15/100]: lr:0.00039 | loss1:0.0205 loss2:0.3144 loss3:0.0057 | AUC:0.8487 Anomaly AUC:0.6856
[2023-08-26 02:21:24,564][main.py][line:97][INFO] [Epoch:16/100]: lr:0.00041 | loss1:0.0147 loss2:0.2482 loss3:0.0045 | AUC:0.8620 Anomaly AUC:0.7068
[2023-08-26 02:24:00,529][main.py][line:97][INFO] [Epoch:17/100]: lr:0.00043 | loss1:0.0094 loss2:0.1877 loss3:0.0032 | AUC:0.8569 Anomaly AUC:0.6895
[2023-08-26 02:26:03,772][main.py][line:97][INFO] [Epoch:18/100]: lr:0.00046 | loss1:0.0179 loss2:0.1831 loss3:0.0048 | AUC:0.8283 Anomaly AUC:0.6393
[2023-08-26 02:28:08,897][main.py][line:97][INFO] [Epoch:19/100]: lr:0.00048 | loss1:0.0341 loss2:0.1918 loss3:0.0085 | AUC:0.8566 Anomaly AUC:0.6964
[2023-08-26 02:30:09,795][main.py][line:97][INFO] [Epoch:20/100]: lr:0.00050 | loss1:0.0159 loss2:0.1133 loss3:0.0040 | AUC:0.8430 Anomaly AUC:0.6594
[2023-08-26 02:32:09,542][main.py][line:97][INFO] [Epoch:21/100]: lr:0.00050 | loss1:0.0223 loss2:0.1217 loss3:0.0053 | AUC:0.8330 Anomaly AUC:0.6663
[2023-08-26 02:33:59,785][main.py][line:97][INFO] [Epoch:22/100]: lr:0.00050 | loss1:0.0145 loss2:0.0887 loss3:0.0038 | AUC:0.8459 Anomaly AUC:0.6948
[2023-08-26 02:35:44,835][main.py][line:97][INFO] [Epoch:23/100]: lr:0.00050 | loss1:0.0152 loss2:0.0774 loss3:0.0037 | AUC:0.8343 Anomaly AUC:0.6711
[2023-08-26 02:37:40,551][main.py][line:97][INFO] [Epoch:24/100]: lr:0.00050 | loss1:0.0079 loss2:0.0573 loss3:0.0023 | AUC:0.8530 Anomaly AUC:0.6828
[2023-08-26 02:39:51,368][main.py][line:97][INFO] [Epoch:25/100]: lr:0.00050 | loss1:0.0204 loss2:0.0746 loss3:0.0046 | AUC:0.8071 Anomaly AUC:0.6831
[2023-08-26 02:41:45,536][main.py][line:97][INFO] [Epoch:26/100]: lr:0.00050 | loss1:0.0089 loss2:0.0482 loss3:0.0024 | AUC:0.8287 Anomaly AUC:0.6663
[2023-08-26 02:43:58,136][main.py][line:97][INFO] [Epoch:27/100]: lr:0.00050 | loss1:0.0172 loss2:0.0552 loss3:0.0035 | AUC:0.8568 Anomaly AUC:0.6726
[2023-08-26 02:46:02,923][main.py][line:97][INFO] [Epoch:28/100]: lr:0.00050 | loss1:0.0033 loss2:0.0237 loss3:0.0013 | AUC:0.8583 Anomaly AUC:0.6822
[2023-08-26 02:47:43,177][main.py][line:97][INFO] [Epoch:29/100]: lr:0.00050 | loss1:0.0003 loss2:0.0144 loss3:0.0005 | AUC:0.8566 Anomaly AUC:0.6829
[2023-08-26 02:49:39,340][main.py][line:97][INFO] [Epoch:30/100]: lr:0.00050 | loss1:0.0002 loss2:0.0106 loss3:0.0004 | AUC:0.8554 Anomaly AUC:0.6807
[2023-08-26 02:51:52,938][main.py][line:97][INFO] [Epoch:31/100]: lr:0.00050 | loss1:0.0001 loss2:0.0088 loss3:0.0004 | AUC:0.8589 Anomaly AUC:0.6841
[2023-08-26 02:54:00,805][main.py][line:97][INFO] [Epoch:32/100]: lr:0.00050 | loss1:0.0001 loss2:0.0082 loss3:0.0004 | AUC:0.8605 Anomaly AUC:0.6849
[2023-08-26 02:56:29,609][main.py][line:97][INFO] [Epoch:33/100]: lr:0.00050 | loss1:0.0001 loss2:0.0075 loss3:0.0004 | AUC:0.8621 Anomaly AUC:0.6858
[2023-08-26 02:58:31,970][main.py][line:97][INFO] [Epoch:34/100]: lr:0.00050 | loss1:0.0001 loss2:0.0062 loss3:0.0004 | AUC:0.8630 Anomaly AUC:0.6862
[2023-08-26 03:00:25,460][main.py][line:97][INFO] [Epoch:35/100]: lr:0.00049 | loss1:0.0001 loss2:0.0059 loss3:0.0004 | AUC:0.8626 Anomaly AUC:0.6834
[2023-08-26 03:02:38,018][main.py][line:97][INFO] [Epoch:36/100]: lr:0.00049 | loss1:0.0001 loss2:0.0050 loss3:0.0004 | AUC:0.8627 Anomaly AUC:0.6827
[2023-08-26 03:04:29,846][main.py][line:97][INFO] [Epoch:37/100]: lr:0.00049 | loss1:0.0001 loss2:0.0048 loss3:0.0005 | AUC:0.8625 Anomaly AUC:0.6818
[2023-08-26 03:06:54,768][main.py][line:97][INFO] [Epoch:38/100]: lr:0.00049 | loss1:0.0001 loss2:0.0045 loss3:0.0005 | AUC:0.8630 Anomaly AUC:0.6827
[2023-08-26 03:09:31,045][main.py][line:97][INFO] [Epoch:39/100]: lr:0.00049 | loss1:0.0001 loss2:0.0040 loss3:0.0005 | AUC:0.8627 Anomaly AUC:0.6806
[2023-08-26 03:11:48,700][main.py][line:97][INFO] [Epoch:40/100]: lr:0.00049 | loss1:0.0001 loss2:0.0039 loss3:0.0005 | AUC:0.8621 Anomaly AUC:0.6796
[2023-08-26 03:13:55,498][main.py][line:97][INFO] [Epoch:41/100]: lr:0.00049 | loss1:0.0000 loss2:0.0036 loss3:0.0005 | AUC:0.8613 Anomaly AUC:0.6768
[2023-08-26 03:16:28,167][main.py][line:97][INFO] [Epoch:42/100]: lr:0.00049 | loss1:0.0000 loss2:0.0035 loss3:0.0005 | AUC:0.8616 Anomaly AUC:0.6772
[2023-08-26 03:19:05,543][main.py][line:97][INFO] [Epoch:43/100]: lr:0.00049 | loss1:0.0000 loss2:0.0033 loss3:0.0005 | AUC:0.8618 Anomaly AUC:0.6793
[2023-08-26 03:21:41,836][main.py][line:97][INFO] [Epoch:44/100]: lr:0.00049 | loss1:0.0000 loss2:0.0030 loss3:0.0005 | AUC:0.8594 Anomaly AUC:0.6718
[2023-08-26 03:24:16,943][main.py][line:97][INFO] [Epoch:45/100]: lr:0.00048 | loss1:0.4847 loss2:0.8397 loss3:0.1089 | AUC:0.8055 Anomaly AUC:0.6112
[2023-08-26 03:26:35,663][main.py][line:97][INFO] [Epoch:46/100]: lr:0.00048 | loss1:0.1165 loss2:0.6666 loss3:0.0245 | AUC:0.8377 Anomaly AUC:0.6250
[2023-08-26 03:28:24,888][main.py][line:97][INFO] [Epoch:47/100]: lr:0.00048 | loss1:0.0421 loss2:0.3291 loss3:0.0079 | AUC:0.8088 Anomaly AUC:0.5830
[2023-08-26 03:31:20,095][main.py][line:97][INFO] [Epoch:48/100]: lr:0.00048 | loss1:0.0231 loss2:0.1333 loss3:0.0047 | AUC:0.8044 Anomaly AUC:0.5486
[2023-08-26 03:33:26,520][main.py][line:97][INFO] [Epoch:49/100]: lr:0.00048 | loss1:0.0154 loss2:0.0714 loss3:0.0036 | AUC:0.8155 Anomaly AUC:0.6072
[2023-08-26 03:36:05,094][main.py][line:97][INFO] [Epoch:50/100]: lr:0.00048 | loss1:0.0105 loss2:0.0397 loss3:0.0025 | AUC:0.8222 Anomaly AUC:0.6345
[2023-08-26 03:38:34,805][main.py][line:97][INFO] [Epoch:51/100]: lr:0.00048 | loss1:0.0164 loss2:0.0452 loss3:0.0034 | AUC:0.8351 Anomaly AUC:0.6251
[2023-08-26 03:40:18,611][main.py][line:97][INFO] [Epoch:52/100]: lr:0.00048 | loss1:0.0109 loss2:0.0301 loss3:0.0027 | AUC:0.8354 Anomaly AUC:0.6409
[2023-08-26 03:42:35,774][main.py][line:97][INFO] [Epoch:53/100]: lr:0.00047 | loss1:0.0069 loss2:0.0228 loss3:0.0021 | AUC:0.8412 Anomaly AUC:0.6509
[2023-08-26 03:45:03,573][main.py][line:97][INFO] [Epoch:54/100]: lr:0.00047 | loss1:0.0050 loss2:0.0149 loss3:0.0012 | AUC:0.8230 Anomaly AUC:0.6267
[2023-08-26 03:47:03,206][main.py][line:97][INFO] [Epoch:55/100]: lr:0.00047 | loss1:0.0096 loss2:0.0178 loss3:0.0022 | AUC:0.8351 Anomaly AUC:0.6403
[2023-08-26 03:49:32,401][main.py][line:97][INFO] [Epoch:56/100]: lr:0.00047 | loss1:0.0075 loss2:0.0165 loss3:0.0018 | AUC:0.8285 Anomaly AUC:0.6174
[2023-08-26 03:51:52,725][main.py][line:97][INFO] [Epoch:57/100]: lr:0.00047 | loss1:0.0064 loss2:0.0147 loss3:0.0016 | AUC:0.8170 Anomaly AUC:0.6167
[2023-08-26 03:54:01,321][main.py][line:97][INFO] [Epoch:58/100]: lr:0.00047 | loss1:0.0084 loss2:0.0217 loss3:0.0022 | AUC:0.8090 Anomaly AUC:0.6345
[2023-08-26 03:56:08,099][main.py][line:97][INFO] [Epoch:59/100]: lr:0.00046 | loss1:0.0050 loss2:0.0156 loss3:0.0018 | AUC:0.8307 Anomaly AUC:0.6550
[2023-08-26 03:59:55,334][main.py][line:97][INFO] [Epoch:60/100]: lr:0.00046 | loss1:0.0045 loss2:0.0094 loss3:0.0015 | AUC:0.8426 Anomaly AUC:0.6554
[2023-08-26 04:02:19,097][main.py][line:97][INFO] [Epoch:61/100]: lr:0.00046 | loss1:0.0056 loss2:0.0112 loss3:0.0012 | AUC:0.8452 Anomaly AUC:0.6318
[2023-08-26 04:04:33,302][main.py][line:97][INFO] [Epoch:62/100]: lr:0.00046 | loss1:0.0042 loss2:0.0135 loss3:0.0014 | AUC:0.8149 Anomaly AUC:0.6332
[2023-08-26 04:06:12,434][main.py][line:97][INFO] [Epoch:63/100]: lr:0.00046 | loss1:0.0077 loss2:0.0167 loss3:0.0024 | AUC:0.8283 Anomaly AUC:0.6170
[2023-08-26 04:08:04,115][main.py][line:97][INFO] [Epoch:64/100]: lr:0.00045 | loss1:0.0102 loss2:0.0125 loss3:0.0022 | AUC:0.8413 Anomaly AUC:0.6362
[2023-08-26 04:10:00,394][main.py][line:97][INFO] [Epoch:65/100]: lr:0.00045 | loss1:0.0064 loss2:0.0129 loss3:0.0020 | AUC:0.8139 Anomaly AUC:0.6394
[2023-08-26 04:11:36,859][main.py][line:97][INFO] [Epoch:66/100]: lr:0.00045 | loss1:0.0033 loss2:0.0086 loss3:0.0013 | AUC:0.8189 Anomaly AUC:0.6251
[2023-08-26 04:13:27,841][main.py][line:97][INFO] [Epoch:67/100]: lr:0.00045 | loss1:0.0055 loss2:0.0126 loss3:0.0016 | AUC:0.8249 Anomaly AUC:0.6538
[2023-08-26 04:15:20,545][main.py][line:97][INFO] [Epoch:68/100]: lr:0.00045 | loss1:0.0026 loss2:0.0093 loss3:0.0013 | AUC:0.8396 Anomaly AUC:0.6453
[2023-08-26 04:17:37,065][main.py][line:97][INFO] [Epoch:69/100]: lr:0.00044 | loss1:0.0000 loss2:0.0024 loss3:0.0004 | AUC:0.8367 Anomaly AUC:0.6471
[2023-08-26 04:19:21,470][main.py][line:97][INFO] [Epoch:70/100]: lr:0.00044 | loss1:0.0000 loss2:0.0014 loss3:0.0003 | AUC:0.8366 Anomaly AUC:0.6441
[2023-08-26 04:21:16,377][main.py][line:97][INFO] [Epoch:71/100]: lr:0.00044 | loss1:0.0000 loss2:0.0013 loss3:0.0003 | AUC:0.8354 Anomaly AUC:0.6398
[2023-08-26 04:22:59,127][main.py][line:97][INFO] [Epoch:72/100]: lr:0.00044 | loss1:0.0000 loss2:0.0012 loss3:0.0003 | AUC:0.8328 Anomaly AUC:0.6324
[2023-08-26 04:24:52,571][main.py][line:97][INFO] [Epoch:73/100]: lr:0.00043 | loss1:0.0000 loss2:0.0012 loss3:0.0003 | AUC:0.8304 Anomaly AUC:0.6270
[2023-08-26 04:26:45,890][main.py][line:97][INFO] [Epoch:74/100]: lr:0.00043 | loss1:0.0000 loss2:0.0012 loss3:0.0003 | AUC:0.8275 Anomaly AUC:0.6187
[2023-08-26 04:28:44,557][main.py][line:97][INFO] [Epoch:75/100]: lr:0.00043 | loss1:0.0000 loss2:0.0011 loss3:0.0003 | AUC:0.8256 Anomaly AUC:0.6135
[2023-08-26 04:30:53,900][main.py][line:97][INFO] [Epoch:76/100]: lr:0.00043 | loss1:0.0000 loss2:0.0012 loss3:0.0003 | AUC:0.8246 Anomaly AUC:0.6099
[2023-08-26 04:32:56,081][main.py][line:97][INFO] [Epoch:77/100]: lr:0.00043 | loss1:0.0000 loss2:0.0010 loss3:0.0003 | AUC:0.8234 Anomaly AUC:0.6065
[2023-08-26 04:35:29,631][main.py][line:97][INFO] [Epoch:78/100]: lr:0.00042 | loss1:0.0000 loss2:0.0010 loss3:0.0003 | AUC:0.8229 Anomaly AUC:0.6044
[2023-08-26 04:37:47,702][main.py][line:97][INFO] [Epoch:79/100]: lr:0.00042 | loss1:0.0000 loss2:0.0009 loss3:0.0003 | AUC:0.8213 Anomaly AUC:0.6028
[2023-08-26 04:39:28,326][main.py][line:97][INFO] [Epoch:80/100]: lr:0.00042 | loss1:0.0000 loss2:0.0004 loss3:0.0003 | AUC:0.8218 Anomaly AUC:0.6008
[2023-08-26 04:42:25,001][main.py][line:97][INFO] [Epoch:81/100]: lr:0.00042 | loss1:0.0000 loss2:0.0011 loss3:0.0003 | AUC:0.8214 Anomaly AUC:0.5971
[2023-08-26 04:44:14,034][main.py][line:97][INFO] [Epoch:82/100]: lr:0.00041 | loss1:0.0000 loss2:0.0010 loss3:0.0003 | AUC:0.8208 Anomaly AUC:0.5950
[2023-08-26 04:45:40,929][main.py][line:97][INFO] [Epoch:83/100]: lr:0.00041 | loss1:0.0000 loss2:0.0010 loss3:0.0003 | AUC:0.8207 Anomaly AUC:0.5946
[2023-08-26 04:47:16,712][main.py][line:97][INFO] [Epoch:84/100]: lr:0.00041 | loss1:0.0000 loss2:0.0012 loss3:0.0004 | AUC:0.8105 Anomaly AUC:0.6042
[2023-08-26 04:49:26,312][main.py][line:97][INFO] [Epoch:85/100]: lr:0.00040 | loss1:0.0000 loss2:0.0000 loss3:0.0004 | AUC:0.7963 Anomaly AUC:0.5851
[2023-08-26 04:51:05,596][main.py][line:97][INFO] [Epoch:86/100]: lr:0.00040 | loss1:0.0000 loss2:0.0000 loss3:0.0003 | AUC:0.7926 Anomaly AUC:0.5842
[2023-08-26 04:53:29,242][main.py][line:97][INFO] [Epoch:87/100]: lr:0.00040 | loss1:0.0000 loss2:0.0000 loss3:0.0003 | AUC:0.7955 Anomaly AUC:0.5838
[2023-08-26 04:55:08,465][main.py][line:97][INFO] [Epoch:88/100]: lr:0.00040 | loss1:0.0000 loss2:0.0000 loss3:0.0003 | AUC:0.7971 Anomaly AUC:0.5824
[2023-08-26 04:56:37,456][main.py][line:97][INFO] [Epoch:89/100]: lr:0.00039 | loss1:0.0000 loss2:0.0000 loss3:0.0003 | AUC:0.7988 Anomaly AUC:0.5840
[2023-08-26 04:58:14,790][main.py][line:97][INFO] [Epoch:90/100]: lr:0.00039 | loss1:0.0000 loss2:0.0000 loss3:0.0003 | AUC:0.7958 Anomaly AUC:0.5803
[2023-08-26 05:00:23,357][main.py][line:97][INFO] [Epoch:91/100]: lr:0.00039 | loss1:0.0000 loss2:0.0000 loss3:0.0003 | AUC:0.7957 Anomaly AUC:0.5796
[2023-08-26 05:02:28,735][main.py][line:97][INFO] [Epoch:92/100]: lr:0.00039 | loss1:0.0000 loss2:0.0000 loss3:0.0003 | AUC:0.7965 Anomaly AUC:0.5793
[2023-08-26 05:04:00,589][main.py][line:97][INFO] [Epoch:93/100]: lr:0.00038 | loss1:0.0000 loss2:0.0000 loss3:0.0003 | AUC:0.7961 Anomaly AUC:0.5798
[2023-08-26 05:05:25,035][main.py][line:97][INFO] [Epoch:94/100]: lr:0.00038 | loss1:0.0000 loss2:0.0000 loss3:0.0002 | AUC:0.7958 Anomaly AUC:0.5804
[2023-08-26 05:06:55,253][main.py][line:97][INFO] [Epoch:95/100]: lr:0.00038 | loss1:0.0000 loss2:0.0000 loss3:0.0002 | AUC:0.7954 Anomaly AUC:0.5812
[2023-08-26 05:08:27,834][main.py][line:97][INFO] [Epoch:96/100]: lr:0.00037 | loss1:0.1617 loss2:0.4751 loss3:0.0333 | AUC:0.8230 Anomaly AUC:0.6130
[2023-08-26 05:09:50,990][main.py][line:97][INFO] [Epoch:97/100]: lr:0.00037 | loss1:0.0687 loss2:0.4669 loss3:0.0165 | AUC:0.8325 Anomaly AUC:0.6353
[2023-08-26 05:11:27,447][main.py][line:97][INFO] [Epoch:98/100]: lr:0.00037 | loss1:0.0172 loss2:0.1442 loss3:0.0062 | AUC:0.8155 Anomaly AUC:0.6042
[2023-08-26 05:12:52,292][main.py][line:97][INFO] [Epoch:99/100]: lr:0.00036 | loss1:0.0105 loss2:0.0508 loss3:0.0039 | AUC:0.8294 Anomaly AUC:0.6419
[2023-08-26 05:14:21,537][main.py][line:97][INFO] [Epoch:100/100]: lr:0.00036 | loss1:0.0045 loss2:0.0182 loss3:0.0021 | AUC:0.8239 Anomaly AUC:0.6205
[2023-08-26 05:14:21,569][main.py][line:105][INFO] Training completes in 207m 45s | best AUCAUC:0.8630 Anomaly AUC:0.6827

[2023-08-26 11:16:20,943][main.py][line:112][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 11:16:21,078][main.py][line:148][INFO] total params:7.5707M
[2023-08-26 11:16:21,078][main.py][line:156][INFO] Test Mode
[2023-08-26 11:16:21,078][main.py][line:31][INFO] loading pretrained checkpoint from ./ckpt/ucf__current.pkl.
[2023-08-26 11:16:30,384][infer.py][line:47][INFO] offline AUC:0.8623 AP:0.3215 FAR:0.0076 | Complete in 0m 9s

[2023-08-26 11:18:16,576][main.py][line:112][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__863.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 11:18:16,688][main.py][line:148][INFO] total params:7.5707M
[2023-08-26 11:18:16,688][main.py][line:156][INFO] Test Mode
[2023-08-26 11:18:16,689][main.py][line:31][INFO] loading pretrained checkpoint from ./ckpt/ucf__863.pkl.
[2023-08-26 11:18:24,680][infer.py][line:47][INFO] offline AUC:0.8623 AP:0.3215 FAR:0.0076 | Complete in 0m 8s

[2023-08-26 11:21:53,609][main.py][line:112][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 11:21:53,742][main.py][line:148][INFO] total params:9.6689M
[2023-08-26 11:21:53,743][main.py][line:156][INFO] Test Mode
[2023-08-26 11:21:53,743][main.py][line:31][INFO] loading pretrained checkpoint from ./ckpt/ucf__current.pkl.
[2023-08-26 11:22:02,704][infer.py][line:47][INFO] offline AUC:0.3875 AP:0.0627 FAR:0.0000 | Complete in 0m 9s

[2023-08-26 11:22:17,753][main.py][line:112][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 11:22:17,876][main.py][line:148][INFO] total params:9.6689M
[2023-08-26 11:22:17,876][main.py][line:151][INFO] Training Mode
[2023-08-26 11:22:17,876][main.py][line:70][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 11:22:17,876][main.py][line:71][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 5e-05
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0007
    lr: 5e-05
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 11:22:25,138][main.py][line:74][INFO] Random initialize AUCAUC:0.4114 Anomaly AUC:0.45879
[2023-08-26 11:23:59,485][main.py][line:97][INFO] [Epoch:1/100]: lr:0.00007 | loss1:0.4877 loss2:1.2127 loss3:0.3855 | AUC:0.8065 Anomaly AUC:0.6061
[2023-08-26 11:25:33,249][main.py][line:97][INFO] [Epoch:2/100]: lr:0.00010 | loss1:0.1285 loss2:0.9246 loss3:0.3939 | AUC:0.7598 Anomaly AUC:0.6221
[2023-08-26 11:26:54,764][main.py][line:97][INFO] [Epoch:3/100]: lr:0.00012 | loss1:0.0142 loss2:0.7923 loss3:0.3730 | AUC:0.7388 Anomaly AUC:0.6530
[2023-08-26 11:28:10,961][main.py][line:97][INFO] [Epoch:4/100]: lr:0.00014 | loss1:0.0086 loss2:0.7242 loss3:0.3464 | AUC:0.7176 Anomaly AUC:0.6664
[2023-08-26 11:29:51,008][main.py][line:97][INFO] [Epoch:5/100]: lr:0.00016 | loss1:0.1285 loss2:0.8476 loss3:0.3691 | AUC:0.7495 Anomaly AUC:0.6504
[2023-08-26 11:31:24,923][main.py][line:97][INFO] [Epoch:6/100]: lr:0.00018 | loss1:0.0097 loss2:0.6997 loss3:0.2958 | AUC:0.7248 Anomaly AUC:0.6579
[2023-08-26 11:33:24,855][main.py][line:97][INFO] [Epoch:7/100]: lr:0.00021 | loss1:0.0101 loss2:0.6409 loss3:0.2257 | AUC:0.7492 Anomaly AUC:0.6584
[2023-08-26 11:34:51,654][main.py][line:97][INFO] [Epoch:8/100]: lr:0.00023 | loss1:0.0088 loss2:0.5817 loss3:0.1553 | AUC:0.7323 Anomaly AUC:0.6479
[2023-08-26 11:36:42,446][main.py][line:97][INFO] [Epoch:9/100]: lr:0.00025 | loss1:0.3243 loss2:0.9251 loss3:0.1996 | AUC:0.7840 Anomaly AUC:0.6549
[2023-08-26 11:38:45,038][main.py][line:97][INFO] [Epoch:10/100]: lr:0.00028 | loss1:0.0602 loss2:0.7534 loss3:0.1811 | AUC:0.7848 Anomaly AUC:0.6503
[2023-08-26 11:40:25,143][main.py][line:97][INFO] [Epoch:11/100]: lr:0.00030 | loss1:0.0187 loss2:0.7212 loss3:0.1253 | AUC:0.7362 Anomaly AUC:0.6398
[2023-08-26 11:42:26,393][main.py][line:97][INFO] [Epoch:12/100]: lr:0.00032 | loss1:0.0842 loss2:0.8319 loss3:0.1154 | AUC:0.7773 Anomaly AUC:0.6822
[2023-08-26 11:43:55,869][main.py][line:97][INFO] [Epoch:13/100]: lr:0.00034 | loss1:0.0094 loss2:0.6493 loss3:0.0800 | AUC:0.7788 Anomaly AUC:0.6740
[2023-08-26 11:45:23,000][main.py][line:97][INFO] [Epoch:14/100]: lr:0.00036 | loss1:0.0048 loss2:0.5082 loss3:0.0560 | AUC:0.7404 Anomaly AUC:0.6479
[2023-08-26 11:46:53,294][main.py][line:97][INFO] [Epoch:15/100]: lr:0.00039 | loss1:0.3668 loss2:0.8483 loss3:0.1212 | AUC:0.7474 Anomaly AUC:0.6447
[2023-08-26 11:48:19,471][main.py][line:97][INFO] [Epoch:16/100]: lr:0.00041 | loss1:0.3644 loss2:0.9240 loss3:0.0655 | AUC:0.8218 Anomaly AUC:0.6438
[2023-08-26 11:50:00,725][main.py][line:97][INFO] [Epoch:17/100]: lr:0.00043 | loss1:0.1490 loss2:0.7485 loss3:0.0751 | AUC:0.7760 Anomaly AUC:0.6568
[2023-08-26 11:51:41,201][main.py][line:97][INFO] [Epoch:18/100]: lr:0.00046 | loss1:0.0131 loss2:0.5959 loss3:0.0549 | AUC:0.7772 Anomaly AUC:0.6538
[2023-08-26 11:53:10,657][main.py][line:97][INFO] [Epoch:19/100]: lr:0.00048 | loss1:0.0088 loss2:0.5466 loss3:0.0466 | AUC:0.7571 Anomaly AUC:0.6639
[2023-08-26 11:54:33,512][main.py][line:97][INFO] [Epoch:20/100]: lr:0.00050 | loss1:0.0053 loss2:0.4885 loss3:0.0355 | AUC:0.6889 Anomaly AUC:0.6455
[2023-08-26 11:56:06,028][main.py][line:97][INFO] [Epoch:21/100]: lr:0.00050 | loss1:0.0050 loss2:0.4487 loss3:0.0369 | AUC:0.7596 Anomaly AUC:0.6484
[2023-08-26 11:57:41,453][main.py][line:97][INFO] [Epoch:22/100]: lr:0.00050 | loss1:0.0035 loss2:0.3837 loss3:0.0262 | AUC:0.6575 Anomaly AUC:0.6345
[2023-08-26 11:59:00,060][main.py][line:97][INFO] [Epoch:23/100]: lr:0.00050 | loss1:0.0056 loss2:0.3814 loss3:0.0386 | AUC:0.7533 Anomaly AUC:0.6533
[2023-08-26 12:00:34,722][main.py][line:97][INFO] [Epoch:24/100]: lr:0.00050 | loss1:0.0032 loss2:0.3237 loss3:0.0224 | AUC:0.5548 Anomaly AUC:0.6245
[2023-08-26 12:02:04,664][main.py][line:97][INFO] [Epoch:25/100]: lr:0.00050 | loss1:0.0059 loss2:0.3695 loss3:0.0469 | AUC:0.8083 Anomaly AUC:0.6782
[2023-08-26 12:03:19,477][main.py][line:97][INFO] [Epoch:26/100]: lr:0.00050 | loss1:0.0021 loss2:0.2379 loss3:0.0173 | AUC:0.7918 Anomaly AUC:0.6686
[2023-08-26 12:04:40,284][main.py][line:97][INFO] [Epoch:27/100]: lr:0.00050 | loss1:0.0050 loss2:0.2646 loss3:0.0331 | AUC:0.7655 Anomaly AUC:0.6643
[2023-08-26 12:06:02,580][main.py][line:97][INFO] [Epoch:28/100]: lr:0.00050 | loss1:0.0025 loss2:0.1819 loss3:0.0169 | AUC:0.7964 Anomaly AUC:0.6601
[2023-08-26 12:07:43,194][main.py][line:97][INFO] [Epoch:29/100]: lr:0.00050 | loss1:0.0024 loss2:0.1716 loss3:0.0195 | AUC:0.7809 Anomaly AUC:0.6655
[2023-08-26 12:09:01,037][main.py][line:97][INFO] [Epoch:30/100]: lr:0.00050 | loss1:0.0014 loss2:0.1281 loss3:0.0121 | AUC:0.7722 Anomaly AUC:0.6640
[2023-08-26 12:10:40,613][main.py][line:97][INFO] [Epoch:31/100]: lr:0.00050 | loss1:0.0030 loss2:0.1205 loss3:0.0189 | AUC:0.7820 Anomaly AUC:0.6558
[2023-08-26 12:12:18,327][main.py][line:97][INFO] [Epoch:32/100]: lr:0.00050 | loss1:0.0035 loss2:0.1386 loss3:0.0217 | AUC:0.7679 Anomaly AUC:0.6446
[2023-08-26 12:13:44,036][main.py][line:97][INFO] [Epoch:33/100]: lr:0.00050 | loss1:0.0040 loss2:0.1118 loss3:0.0261 | AUC:0.7375 Anomaly AUC:0.6614
[2023-08-26 12:15:07,934][main.py][line:97][INFO] [Epoch:34/100]: lr:0.00050 | loss1:0.0020 loss2:0.0753 loss3:0.0148 | AUC:0.7816 Anomaly AUC:0.6666
[2023-08-26 12:16:36,337][main.py][line:97][INFO] [Epoch:35/100]: lr:0.00049 | loss1:0.0013 loss2:0.0594 loss3:0.0109 | AUC:0.7399 Anomaly AUC:0.6472
[2023-08-26 12:17:57,775][main.py][line:97][INFO] [Epoch:36/100]: lr:0.00049 | loss1:0.0012 loss2:0.0557 loss3:0.0121 | AUC:0.7805 Anomaly AUC:0.6458
[2023-08-26 12:19:22,339][main.py][line:97][INFO] [Epoch:37/100]: lr:0.00049 | loss1:0.0035 loss2:0.1037 loss3:0.0265 | AUC:0.7904 Anomaly AUC:0.6884
[2023-08-26 12:20:11,704][main.py][line:112][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 12:20:11,861][main.py][line:148][INFO] total params:9.6689M
[2023-08-26 12:20:11,861][main.py][line:151][INFO] Training Mode
[2023-08-26 12:20:11,861][main.py][line:70][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 12:20:11,861][main.py][line:71][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 5e-05
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0007
    lr: 5e-05
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 12:20:22,837][main.py][line:74][INFO] Random initialize AUCAUC:0.4693 Anomaly AUC:0.51224
[2023-08-26 12:22:07,329][main.py][line:97][INFO] [Epoch:1/100]: lr:0.00007 | loss1:0.4427 loss2:1.1923 loss3:0.3841 | AUC:0.7940 Anomaly AUC:0.6124
[2023-08-26 12:24:15,937][main.py][line:97][INFO] [Epoch:2/100]: lr:0.00010 | loss1:0.1183 loss2:0.9240 loss3:0.3984 | AUC:0.7491 Anomaly AUC:0.6030
[2023-08-26 12:26:23,626][main.py][line:97][INFO] [Epoch:3/100]: lr:0.00012 | loss1:0.0174 loss2:0.7987 loss3:0.3772 | AUC:0.6983 Anomaly AUC:0.6233
[2023-08-26 12:27:55,809][main.py][line:97][INFO] [Epoch:4/100]: lr:0.00014 | loss1:0.0182 loss2:0.7462 loss3:0.3537 | AUC:0.5056 Anomaly AUC:0.6016
[2023-08-26 12:29:44,163][main.py][line:97][INFO] [Epoch:5/100]: lr:0.00016 | loss1:0.0123 loss2:0.7130 loss3:0.3404 | AUC:0.5874 Anomaly AUC:0.6230
[2023-08-26 12:31:48,439][main.py][line:97][INFO] [Epoch:6/100]: lr:0.00018 | loss1:0.0077 loss2:0.6532 loss3:0.2439 | AUC:0.6134 Anomaly AUC:0.6187
[2023-08-26 12:33:54,226][main.py][line:97][INFO] [Epoch:7/100]: lr:0.00021 | loss1:0.0744 loss2:0.7365 loss3:0.2261 | AUC:0.6283 Anomaly AUC:0.6530
[2023-08-26 12:36:02,703][main.py][line:97][INFO] [Epoch:8/100]: lr:0.00023 | loss1:0.0079 loss2:0.6189 loss3:0.1554 | AUC:0.7548 Anomaly AUC:0.6546
[2023-08-26 12:38:26,212][main.py][line:97][INFO] [Epoch:9/100]: lr:0.00025 | loss1:0.0079 loss2:0.5694 loss3:0.1300 | AUC:0.7472 Anomaly AUC:0.6545
[2023-08-26 12:41:04,855][main.py][line:97][INFO] [Epoch:10/100]: lr:0.00028 | loss1:0.0591 loss2:0.6150 loss3:0.1470 | AUC:0.7317 Anomaly AUC:0.6641
[2023-08-26 12:43:24,898][main.py][line:97][INFO] [Epoch:11/100]: lr:0.00030 | loss1:0.0098 loss2:0.5611 loss3:0.1192 | AUC:0.7813 Anomaly AUC:0.6628
[2023-08-26 12:45:30,005][main.py][line:97][INFO] [Epoch:12/100]: lr:0.00032 | loss1:0.0783 loss2:0.5716 loss3:0.1248 | AUC:0.7618 Anomaly AUC:0.6148
[2023-08-26 12:47:16,414][main.py][line:97][INFO] [Epoch:13/100]: lr:0.00034 | loss1:0.0389 loss2:0.6712 loss3:0.1443 | AUC:0.7670 Anomaly AUC:0.6411
[2023-08-26 12:49:36,300][main.py][line:97][INFO] [Epoch:14/100]: lr:0.00036 | loss1:0.0081 loss2:0.5616 loss3:0.0544 | AUC:0.7541 Anomaly AUC:0.6544
[2023-08-26 12:51:17,978][main.py][line:97][INFO] [Epoch:15/100]: lr:0.00039 | loss1:0.0080 loss2:0.5276 loss3:0.0548 | AUC:0.7061 Anomaly AUC:0.6462
[2023-08-26 12:52:59,943][main.py][line:97][INFO] [Epoch:16/100]: lr:0.00041 | loss1:0.0055 loss2:0.4837 loss3:0.0413 | AUC:0.7485 Anomaly AUC:0.6563
[2023-08-26 12:54:36,927][main.py][line:97][INFO] [Epoch:17/100]: lr:0.00043 | loss1:0.0062 loss2:0.4497 loss3:0.0499 | AUC:0.6791 Anomaly AUC:0.6720
[2023-08-26 12:56:19,312][main.py][line:97][INFO] [Epoch:18/100]: lr:0.00046 | loss1:0.2347 loss2:0.5515 loss3:0.0800 | AUC:0.8064 Anomaly AUC:0.6152
[2023-08-26 12:58:26,738][main.py][line:97][INFO] [Epoch:19/100]: lr:0.00048 | loss1:0.2129 loss2:0.8174 loss3:0.0850 | AUC:0.7643 Anomaly AUC:0.6694
[2023-08-26 13:00:02,401][main.py][line:97][INFO] [Epoch:20/100]: lr:0.00050 | loss1:0.0159 loss2:0.6297 loss3:0.0525 | AUC:0.7152 Anomaly AUC:0.6744
[2023-08-26 13:02:02,557][main.py][line:97][INFO] [Epoch:21/100]: lr:0.00050 | loss1:0.0067 loss2:0.5671 loss3:0.0325 | AUC:0.7913 Anomaly AUC:0.6714
[2023-08-26 13:04:07,757][main.py][line:97][INFO] [Epoch:22/100]: lr:0.00050 | loss1:0.2040 loss2:0.7272 loss3:0.0571 | AUC:0.8283 Anomaly AUC:0.6581
[2023-08-26 13:06:37,164][main.py][line:97][INFO] [Epoch:23/100]: lr:0.00050 | loss1:0.1018 loss2:1.0328 loss3:0.0943 | AUC:0.7751 Anomaly AUC:0.6839
[2023-08-26 13:09:04,022][main.py][line:97][INFO] [Epoch:24/100]: lr:0.00050 | loss1:0.0304 loss2:0.7195 loss3:0.0540 | AUC:0.7801 Anomaly AUC:0.6830
[2023-08-26 13:11:26,361][main.py][line:97][INFO] [Epoch:25/100]: lr:0.00050 | loss1:0.0089 loss2:0.5190 loss3:0.0268 | AUC:0.7965 Anomaly AUC:0.6832
[2023-08-26 13:13:31,039][main.py][line:97][INFO] [Epoch:26/100]: lr:0.00050 | loss1:0.0075 loss2:0.4620 loss3:0.0260 | AUC:0.7656 Anomaly AUC:0.6902
[2023-08-26 13:15:25,438][main.py][line:97][INFO] [Epoch:27/100]: lr:0.00050 | loss1:0.1030 loss2:0.5259 loss3:0.0560 | AUC:0.7813 Anomaly AUC:0.6788
[2023-08-26 13:17:28,285][main.py][line:97][INFO] [Epoch:28/100]: lr:0.00050 | loss1:0.0228 loss2:0.5639 loss3:0.0482 | AUC:0.7709 Anomaly AUC:0.6777
[2023-08-26 13:19:18,075][main.py][line:97][INFO] [Epoch:29/100]: lr:0.00050 | loss1:0.0069 loss2:0.4884 loss3:0.0228 | AUC:0.7496 Anomaly AUC:0.6941
[2023-08-26 13:21:25,931][main.py][line:97][INFO] [Epoch:30/100]: lr:0.00050 | loss1:0.0051 loss2:0.4428 loss3:0.0240 | AUC:0.7709 Anomaly AUC:0.6740
[2023-08-26 13:23:31,054][main.py][line:97][INFO] [Epoch:31/100]: lr:0.00050 | loss1:0.0051 loss2:0.4095 loss3:0.0248 | AUC:0.7948 Anomaly AUC:0.6810
[2023-08-26 13:25:32,057][main.py][line:97][INFO] [Epoch:32/100]: lr:0.00050 | loss1:0.0045 loss2:0.3686 loss3:0.0201 | AUC:0.7979 Anomaly AUC:0.6678
[2023-08-26 13:27:19,449][main.py][line:97][INFO] [Epoch:33/100]: lr:0.00050 | loss1:0.0026 loss2:0.3118 loss3:0.0135 | AUC:0.8200 Anomaly AUC:0.6776
[2023-08-26 13:29:17,939][main.py][line:97][INFO] [Epoch:34/100]: lr:0.00050 | loss1:0.0062 loss2:0.3282 loss3:0.0308 | AUC:0.7901 Anomaly AUC:0.6834
[2023-08-26 13:31:25,227][main.py][line:97][INFO] [Epoch:35/100]: lr:0.00049 | loss1:0.0022 loss2:0.2585 loss3:0.0130 | AUC:0.8092 Anomaly AUC:0.6782
[2023-08-26 13:33:35,642][main.py][line:97][INFO] [Epoch:36/100]: lr:0.00049 | loss1:0.0044 loss2:0.2397 loss3:0.0182 | AUC:0.8104 Anomaly AUC:0.6816
[2023-08-26 13:35:38,613][main.py][line:97][INFO] [Epoch:37/100]: lr:0.00049 | loss1:0.0019 loss2:0.1838 loss3:0.0107 | AUC:0.8269 Anomaly AUC:0.6829
[2023-08-26 13:37:31,137][main.py][line:97][INFO] [Epoch:38/100]: lr:0.00049 | loss1:0.0020 loss2:0.1579 loss3:0.0091 | AUC:0.8125 Anomaly AUC:0.6758
[2023-08-26 13:39:45,740][main.py][line:97][INFO] [Epoch:39/100]: lr:0.00049 | loss1:0.0341 loss2:0.2847 loss3:0.0751 | AUC:0.8027 Anomaly AUC:0.6711
[2023-08-26 13:41:39,087][main.py][line:97][INFO] [Epoch:40/100]: lr:0.00049 | loss1:0.0100 loss2:0.2688 loss3:0.0442 | AUC:0.7929 Anomaly AUC:0.6849
[2023-08-26 13:43:57,431][main.py][line:97][INFO] [Epoch:41/100]: lr:0.00049 | loss1:0.0149 loss2:0.2561 loss3:0.0490 | AUC:0.8006 Anomaly AUC:0.6778
[2023-08-26 13:45:57,309][main.py][line:97][INFO] [Epoch:42/100]: lr:0.00049 | loss1:0.0507 loss2:0.3443 loss3:0.0745 | AUC:0.8289 Anomaly AUC:0.6873
[2023-08-26 13:47:55,082][main.py][line:97][INFO] [Epoch:43/100]: lr:0.00049 | loss1:0.0073 loss2:0.1908 loss3:0.0321 | AUC:0.7781 Anomaly AUC:0.6871
[2023-08-26 13:49:50,122][main.py][line:97][INFO] [Epoch:44/100]: lr:0.00049 | loss1:0.0084 loss2:0.1680 loss3:0.0331 | AUC:0.8075 Anomaly AUC:0.6828
[2023-08-26 13:51:42,373][main.py][line:97][INFO] [Epoch:45/100]: lr:0.00048 | loss1:0.0110 loss2:0.1607 loss3:0.0439 | AUC:0.8094 Anomaly AUC:0.6707
[2023-08-26 13:53:32,463][main.py][line:97][INFO] [Epoch:46/100]: lr:0.00048 | loss1:0.0040 loss2:0.1081 loss3:0.0224 | AUC:0.7982 Anomaly AUC:0.6693
[2023-08-26 13:55:14,686][main.py][line:97][INFO] [Epoch:47/100]: lr:0.00048 | loss1:0.0042 loss2:0.0877 loss3:0.0207 | AUC:0.8116 Anomaly AUC:0.6807
[2023-08-26 13:56:55,163][main.py][line:97][INFO] [Epoch:48/100]: lr:0.00048 | loss1:0.0037 loss2:0.0918 loss3:0.0194 | AUC:0.8201 Anomaly AUC:0.6886
[2023-08-26 13:59:05,038][main.py][line:97][INFO] [Epoch:49/100]: lr:0.00048 | loss1:0.0128 loss2:0.1043 loss3:0.0409 | AUC:0.8260 Anomaly AUC:0.6887
[2023-08-26 14:00:37,361][main.py][line:97][INFO] [Epoch:50/100]: lr:0.00048 | loss1:0.0085 loss2:0.0852 loss3:0.0340 | AUC:0.7969 Anomaly AUC:0.6629
[2023-08-26 14:02:19,304][main.py][line:97][INFO] [Epoch:51/100]: lr:0.00048 | loss1:0.0066 loss2:0.0643 loss3:0.0217 | AUC:0.8242 Anomaly AUC:0.6977
[2023-08-26 14:03:48,463][main.py][line:97][INFO] [Epoch:52/100]: lr:0.00048 | loss1:0.0042 loss2:0.0541 loss3:0.0243 | AUC:0.8243 Anomaly AUC:0.6713
[2023-08-26 14:05:30,745][main.py][line:97][INFO] [Epoch:53/100]: lr:0.00047 | loss1:0.0081 loss2:0.0636 loss3:0.0231 | AUC:0.8225 Anomaly AUC:0.6738
[2023-08-26 14:07:05,253][main.py][line:97][INFO] [Epoch:54/100]: lr:0.00047 | loss1:0.0034 loss2:0.0377 loss3:0.0143 | AUC:0.8343 Anomaly AUC:0.6867
[2023-08-26 14:08:45,194][main.py][line:97][INFO] [Epoch:55/100]: lr:0.00047 | loss1:0.0028 loss2:0.0380 loss3:0.0149 | AUC:0.8292 Anomaly AUC:0.6892
[2023-08-26 14:10:33,369][main.py][line:97][INFO] [Epoch:56/100]: lr:0.00047 | loss1:0.0015 loss2:0.0324 loss3:0.0101 | AUC:0.8158 Anomaly AUC:0.6917
[2023-08-26 14:12:19,408][main.py][line:97][INFO] [Epoch:57/100]: lr:0.00047 | loss1:0.0150 loss2:0.1023 loss3:0.0432 | AUC:0.8165 Anomaly AUC:0.6670
[2023-08-26 14:13:55,401][main.py][line:112][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 14:13:55,581][main.py][line:148][INFO] total params:9.6689M
[2023-08-26 14:13:55,581][main.py][line:151][INFO] Training Mode
[2023-08-26 14:13:55,582][main.py][line:70][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 14:13:55,582][main.py][line:71][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 5e-05
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0007
    lr: 5e-05
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 14:14:03,836][main.py][line:74][INFO] Random initialize AUCAUC:0.5276 Anomaly AUC:0.48186
[2023-08-26 14:14:33,947][main.py][line:112][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 14:14:34,075][main.py][line:148][INFO] total params:9.6689M
[2023-08-26 14:14:34,075][main.py][line:151][INFO] Training Mode
[2023-08-26 14:14:34,076][main.py][line:70][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 14:14:34,076][main.py][line:71][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 5e-05
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 14:14:41,857][main.py][line:74][INFO] Random initialize AUCAUC:0.5276 Anomaly AUC:0.48186
[2023-08-26 14:17:04,994][main.py][line:97][INFO] [Epoch:1/100]: lr:0.00007 | loss1:0.4144 loss2:1.2064 loss3:0.3854 | AUC:0.8184 Anomaly AUC:0.6296
[2023-08-26 14:18:45,766][main.py][line:97][INFO] [Epoch:2/100]: lr:0.00010 | loss1:0.0261 loss2:0.8633 loss3:0.3913 | AUC:0.7859 Anomaly AUC:0.6358
[2023-08-26 14:19:58,591][main.py][line:97][INFO] [Epoch:3/100]: lr:0.00012 | loss1:0.0054 loss2:0.7539 loss3:0.3699 | AUC:0.7346 Anomaly AUC:0.6321
[2023-08-26 14:21:17,670][main.py][line:97][INFO] [Epoch:4/100]: lr:0.00014 | loss1:0.3593 loss2:1.1717 loss3:0.3756 | AUC:0.6332 Anomaly AUC:0.4987
[2023-08-26 14:23:44,254][main.py][line:97][INFO] [Epoch:5/100]: lr:0.00016 | loss1:0.0117 loss2:0.8091 loss3:0.3561 | AUC:0.6810 Anomaly AUC:0.5872
[2023-08-26 14:25:05,749][main.py][line:97][INFO] [Epoch:6/100]: lr:0.00018 | loss1:0.0075 loss2:0.7158 loss3:0.3340 | AUC:0.6542 Anomaly AUC:0.6269
[2023-08-26 14:27:05,321][main.py][line:97][INFO] [Epoch:7/100]: lr:0.00021 | loss1:0.2128 loss2:0.7719 loss3:0.3095 | AUC:0.5547 Anomaly AUC:0.5065
[2023-08-26 14:28:38,695][main.py][line:97][INFO] [Epoch:8/100]: lr:0.00023 | loss1:0.3403 loss2:1.2716 loss3:0.2318 | AUC:0.8117 Anomaly AUC:0.6348
[2023-08-26 14:30:36,640][main.py][line:97][INFO] [Epoch:9/100]: lr:0.00025 | loss1:0.0306 loss2:0.8898 loss3:0.1832 | AUC:0.7823 Anomaly AUC:0.6278
[2023-08-26 14:33:48,814][main.py][line:97][INFO] [Epoch:10/100]: lr:0.00028 | loss1:0.0216 loss2:0.7630 loss3:0.1659 | AUC:0.6896 Anomaly AUC:0.6246
[2023-08-26 14:36:46,315][main.py][line:97][INFO] [Epoch:11/100]: lr:0.00030 | loss1:0.0149 loss2:0.7210 loss3:0.1541 | AUC:0.6054 Anomaly AUC:0.5796
[2023-08-26 14:37:36,085][main.py][line:112][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 14:37:36,238][main.py][line:148][INFO] total params:9.6689M
[2023-08-26 14:37:36,238][main.py][line:151][INFO] Training Mode
[2023-08-26 14:37:36,238][main.py][line:70][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 14:37:36,238][main.py][line:71][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 14:37:48,536][main.py][line:74][INFO] Random initialize AUCAUC:0.5276 Anomaly AUC:0.48186
[2023-08-26 14:39:20,405][main.py][line:97][INFO] [Epoch:1/100]: lr:0.00050 | loss1:0.4690 loss2:1.1404 loss3:0.3641 | AUC:0.7237 Anomaly AUC:0.5784
[2023-08-26 14:40:38,997][main.py][line:97][INFO] [Epoch:2/100]: lr:0.00050 | loss1:0.4138 loss2:1.1047 loss3:0.2704 | AUC:0.7761 Anomaly AUC:0.5981
[2023-08-26 14:42:03,217][main.py][line:97][INFO] [Epoch:3/100]: lr:0.00050 | loss1:0.3721 loss2:1.1659 loss3:0.1477 | AUC:0.8199 Anomaly AUC:0.6225
[2023-08-26 14:43:37,172][main.py][line:97][INFO] [Epoch:4/100]: lr:0.00050 | loss1:0.3130 loss2:1.0175 loss3:0.0663 | AUC:0.8240 Anomaly AUC:0.6277
[2023-08-26 14:45:05,776][main.py][line:97][INFO] [Epoch:5/100]: lr:0.00050 | loss1:0.2423 loss2:0.9382 loss3:0.0476 | AUC:0.8232 Anomaly AUC:0.6229
[2023-08-26 14:46:30,716][main.py][line:97][INFO] [Epoch:6/100]: lr:0.00050 | loss1:0.1846 loss2:0.8701 loss3:0.0340 | AUC:0.8174 Anomaly AUC:0.6195
[2023-08-26 14:48:07,913][main.py][line:97][INFO] [Epoch:7/100]: lr:0.00050 | loss1:0.1576 loss2:0.8261 loss3:0.0254 | AUC:0.8072 Anomaly AUC:0.6124
[2023-08-26 14:49:32,672][main.py][line:97][INFO] [Epoch:8/100]: lr:0.00050 | loss1:0.1371 loss2:0.7883 loss3:0.0219 | AUC:0.8234 Anomaly AUC:0.6120
[2023-08-26 14:51:19,788][main.py][line:97][INFO] [Epoch:9/100]: lr:0.00050 | loss1:0.1069 loss2:0.7371 loss3:0.0174 | AUC:0.8280 Anomaly AUC:0.6151
[2023-08-26 14:53:16,208][main.py][line:97][INFO] [Epoch:10/100]: lr:0.00050 | loss1:0.0977 loss2:0.7056 loss3:0.0152 | AUC:0.8122 Anomaly AUC:0.6135
[2023-08-26 14:54:54,792][main.py][line:97][INFO] [Epoch:11/100]: lr:0.00050 | loss1:0.0894 loss2:0.6844 loss3:0.0139 | AUC:0.8019 Anomaly AUC:0.6055
[2023-08-26 14:56:56,689][main.py][line:97][INFO] [Epoch:12/100]: lr:0.00050 | loss1:0.0671 loss2:0.6262 loss3:0.0108 | AUC:0.8165 Anomaly AUC:0.6462
[2023-08-26 14:58:28,180][main.py][line:97][INFO] [Epoch:13/100]: lr:0.00050 | loss1:0.0653 loss2:0.5893 loss3:0.0096 | AUC:0.8107 Anomaly AUC:0.6141
[2023-08-26 14:59:54,292][main.py][line:97][INFO] [Epoch:14/100]: lr:0.00050 | loss1:0.0487 loss2:0.5380 loss3:0.0075 | AUC:0.7956 Anomaly AUC:0.6343
[2023-08-26 15:01:09,747][main.py][line:97][INFO] [Epoch:15/100]: lr:0.00050 | loss1:0.0514 loss2:0.5274 loss3:0.0078 | AUC:0.8112 Anomaly AUC:0.6392
[2023-08-26 15:02:20,327][main.py][line:97][INFO] [Epoch:16/100]: lr:0.00050 | loss1:0.0332 loss2:0.4651 loss3:0.0062 | AUC:0.7849 Anomaly AUC:0.6267
[2023-08-26 15:03:32,097][main.py][line:97][INFO] [Epoch:17/100]: lr:0.00050 | loss1:0.0460 loss2:0.4489 loss3:0.0074 | AUC:0.7557 Anomaly AUC:0.6068
[2023-08-26 15:04:52,342][main.py][line:97][INFO] [Epoch:18/100]: lr:0.00050 | loss1:0.0300 loss2:0.4072 loss3:0.0050 | AUC:0.7481 Anomaly AUC:0.5965
[2023-08-26 15:06:07,416][main.py][line:97][INFO] [Epoch:19/100]: lr:0.00050 | loss1:0.0303 loss2:0.3702 loss3:0.0054 | AUC:0.7787 Anomaly AUC:0.5889
[2023-08-26 15:07:36,994][main.py][line:97][INFO] [Epoch:20/100]: lr:0.00050 | loss1:0.0453 loss2:0.3645 loss3:0.0075 | AUC:0.8106 Anomaly AUC:0.6086
[2023-08-26 15:09:11,385][main.py][line:97][INFO] [Epoch:21/100]: lr:0.00050 | loss1:0.0172 loss2:0.3107 loss3:0.0039 | AUC:0.8077 Anomaly AUC:0.6082
[2023-08-26 15:10:43,094][main.py][line:97][INFO] [Epoch:22/100]: lr:0.00050 | loss1:0.0156 loss2:0.2590 loss3:0.0035 | AUC:0.8055 Anomaly AUC:0.6130
[2023-08-26 15:12:10,770][main.py][line:97][INFO] [Epoch:23/100]: lr:0.00050 | loss1:0.0311 loss2:0.2834 loss3:0.0052 | AUC:0.7983 Anomaly AUC:0.5832
[2023-08-26 15:13:36,081][main.py][line:97][INFO] [Epoch:24/100]: lr:0.00050 | loss1:0.0203 loss2:0.2391 loss3:0.0041 | AUC:0.8129 Anomaly AUC:0.6027
[2023-08-26 15:14:49,161][main.py][line:112][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 15:14:49,350][main.py][line:148][INFO] total params:9.6689M
[2023-08-26 15:14:49,350][main.py][line:151][INFO] Training Mode
[2023-08-26 15:14:49,351][main.py][line:70][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 15:14:49,351][main.py][line:71][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0007
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 15:15:01,071][main.py][line:74][INFO] Random initialize AUCAUC:0.5276 Anomaly AUC:0.48186
[2023-08-26 15:17:10,246][main.py][line:97][INFO] [Epoch:1/100]: lr:0.00050 | loss1:0.5186 loss2:1.1583 loss3:0.3033 | AUC:0.8171 Anomaly AUC:0.6474
[2023-08-26 15:21:02,109][main.py][line:97][INFO] [Epoch:2/100]: lr:0.00050 | loss1:0.3236 loss2:0.9681 loss3:0.0634 | AUC:0.8297 Anomaly AUC:0.6540
[2023-08-26 15:23:29,911][main.py][line:97][INFO] [Epoch:3/100]: lr:0.00050 | loss1:0.2406 loss2:0.8896 loss3:0.0379 | AUC:0.8233 Anomaly AUC:0.6522
[2023-08-26 15:25:34,424][main.py][line:97][INFO] [Epoch:4/100]: lr:0.00050 | loss1:0.1919 loss2:0.8281 loss3:0.0300 | AUC:0.8234 Anomaly AUC:0.6524
[2023-08-26 15:27:53,462][main.py][line:97][INFO] [Epoch:5/100]: lr:0.00050 | loss1:0.1670 loss2:0.7901 loss3:0.0263 | AUC:0.8298 Anomaly AUC:0.6490
[2023-08-26 15:30:09,685][main.py][line:97][INFO] [Epoch:6/100]: lr:0.00050 | loss1:0.1314 loss2:0.7391 loss3:0.0213 | AUC:0.8247 Anomaly AUC:0.6779
[2023-08-26 15:31:48,930][main.py][line:97][INFO] [Epoch:7/100]: lr:0.00050 | loss1:0.1025 loss2:0.6939 loss3:0.0179 | AUC:0.8211 Anomaly AUC:0.6615
[2023-08-26 15:33:14,229][main.py][line:97][INFO] [Epoch:8/100]: lr:0.00050 | loss1:0.0638 loss2:0.6301 loss3:0.0130 | AUC:0.7818 Anomaly AUC:0.6489
[2023-08-26 15:35:19,787][main.py][line:97][INFO] [Epoch:9/100]: lr:0.00050 | loss1:0.0656 loss2:0.6180 loss3:0.0129 | AUC:0.7784 Anomaly AUC:0.6756
[2023-08-26 15:38:20,822][main.py][line:97][INFO] [Epoch:10/100]: lr:0.00050 | loss1:0.0475 loss2:0.5668 loss3:0.0092 | AUC:0.7846 Anomaly AUC:0.6929
[2023-08-26 15:41:08,955][main.py][line:97][INFO] [Epoch:11/100]: lr:0.00050 | loss1:0.0478 loss2:0.5337 loss3:0.0096 | AUC:0.7606 Anomaly AUC:0.6743
[2023-08-26 15:43:41,345][main.py][line:97][INFO] [Epoch:12/100]: lr:0.00050 | loss1:0.0445 loss2:0.5096 loss3:0.0102 | AUC:0.7895 Anomaly AUC:0.6621
[2023-08-26 15:45:51,216][main.py][line:97][INFO] [Epoch:13/100]: lr:0.00050 | loss1:0.0303 loss2:0.4447 loss3:0.0075 | AUC:0.8049 Anomaly AUC:0.6943
[2023-08-26 15:48:10,453][main.py][line:97][INFO] [Epoch:14/100]: lr:0.00050 | loss1:0.0196 loss2:0.3974 loss3:0.0057 | AUC:0.7674 Anomaly AUC:0.6878
[2023-08-26 15:50:10,254][main.py][line:97][INFO] [Epoch:15/100]: lr:0.00050 | loss1:0.0178 loss2:0.3554 loss3:0.0057 | AUC:0.8101 Anomaly AUC:0.6821
[2023-08-26 15:51:07,115][main.py][line:112][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 15:51:07,267][main.py][line:148][INFO] total params:9.6689M
[2023-08-26 15:51:07,267][main.py][line:151][INFO] Training Mode
[2023-08-26 15:51:07,267][main.py][line:70][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 15:51:07,267][main.py][line:71][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0003
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 15:51:17,623][main.py][line:74][INFO] Random initialize AUCAUC:0.5276 Anomaly AUC:0.48186
[2023-08-26 15:53:22,429][main.py][line:97][INFO] [Epoch:1/100]: lr:0.00050 | loss1:0.3072 loss2:1.0684 loss3:0.4005 | AUC:0.4327 Anomaly AUC:0.4729
[2023-08-26 15:55:21,163][main.py][line:97][INFO] [Epoch:2/100]: lr:0.00050 | loss1:0.2560 loss2:1.0467 loss3:0.3871 | AUC:0.6322 Anomaly AUC:0.5399
[2023-08-26 15:57:04,842][main.py][line:97][INFO] [Epoch:3/100]: lr:0.00050 | loss1:0.1341 loss2:0.9493 loss3:0.3548 | AUC:0.4539 Anomaly AUC:0.5067
[2023-08-26 15:58:37,434][main.py][line:97][INFO] [Epoch:4/100]: lr:0.00050 | loss1:0.0098 loss2:0.6785 loss3:0.2617 | AUC:0.6562 Anomaly AUC:0.5210
[2023-08-26 16:00:42,382][main.py][line:97][INFO] [Epoch:5/100]: lr:0.00050 | loss1:0.0080 loss2:0.6642 loss3:0.2213 | AUC:0.6138 Anomaly AUC:0.5228
[2023-08-26 16:02:41,384][main.py][line:97][INFO] [Epoch:6/100]: lr:0.00050 | loss1:0.6395 loss2:1.1075 loss3:0.2719 | AUC:0.5377 Anomaly AUC:0.5206
[2023-08-26 16:04:32,326][main.py][line:97][INFO] [Epoch:7/100]: lr:0.00050 | loss1:0.0267 loss2:0.9184 loss3:0.2233 | AUC:0.4585 Anomaly AUC:0.4808
[2023-08-26 16:06:16,662][main.py][line:97][INFO] [Epoch:8/100]: lr:0.00050 | loss1:0.2241 loss2:1.0289 loss3:0.1891 | AUC:0.7605 Anomaly AUC:0.5790
[2023-08-26 16:08:23,008][main.py][line:97][INFO] [Epoch:9/100]: lr:0.00050 | loss1:0.0427 loss2:0.9336 loss3:0.2035 | AUC:0.6217 Anomaly AUC:0.5549
[2023-08-26 16:10:33,264][main.py][line:97][INFO] [Epoch:10/100]: lr:0.00050 | loss1:0.0114 loss2:0.7888 loss3:0.1289 | AUC:0.7607 Anomaly AUC:0.6441
[2023-08-26 16:13:08,312][main.py][line:97][INFO] [Epoch:11/100]: lr:0.00050 | loss1:0.0124 loss2:0.7478 loss3:0.0906 | AUC:0.7636 Anomaly AUC:0.6372
[2023-08-26 16:15:23,407][main.py][line:97][INFO] [Epoch:12/100]: lr:0.00050 | loss1:0.0090 loss2:0.7120 loss3:0.0781 | AUC:0.7309 Anomaly AUC:0.6356
[2023-08-26 16:17:26,195][main.py][line:97][INFO] [Epoch:13/100]: lr:0.00050 | loss1:0.0085 loss2:0.6769 loss3:0.0779 | AUC:0.6830 Anomaly AUC:0.6299
[2023-08-26 16:19:28,259][main.py][line:97][INFO] [Epoch:14/100]: lr:0.00050 | loss1:0.0063 loss2:0.6405 loss3:0.0628 | AUC:0.7800 Anomaly AUC:0.6694
[2023-08-26 16:21:21,682][main.py][line:97][INFO] [Epoch:15/100]: lr:0.00050 | loss1:0.0095 loss2:0.6129 loss3:0.0626 | AUC:0.7995 Anomaly AUC:0.6418
[2023-08-26 16:23:14,852][main.py][line:97][INFO] [Epoch:16/100]: lr:0.00050 | loss1:0.0063 loss2:0.5733 loss3:0.0633 | AUC:0.7970 Anomaly AUC:0.6425
[2023-08-26 16:24:57,820][main.py][line:97][INFO] [Epoch:17/100]: lr:0.00050 | loss1:0.2960 loss2:0.8059 loss3:0.1087 | AUC:0.7908 Anomaly AUC:0.6176
[2023-08-26 16:26:44,988][main.py][line:97][INFO] [Epoch:18/100]: lr:0.00050 | loss1:0.3761 loss2:1.0857 loss3:0.0882 | AUC:0.8296 Anomaly AUC:0.6276
[2023-08-26 16:28:38,299][main.py][line:97][INFO] [Epoch:19/100]: lr:0.00050 | loss1:0.2610 loss2:0.9680 loss3:0.0608 | AUC:0.8221 Anomaly AUC:0.6327
[2023-08-26 16:30:46,900][main.py][line:97][INFO] [Epoch:20/100]: lr:0.00050 | loss1:0.1907 loss2:0.9245 loss3:0.0465 | AUC:0.8222 Anomaly AUC:0.6318
[2023-08-26 16:30:53,476][main.py][line:121][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 30, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 16:30:53,646][main.py][line:157][INFO] total params:9.6689M
[2023-08-26 16:30:53,646][main.py][line:160][INFO] Training Mode
[2023-08-26 16:30:53,647][main.py][line:78][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 16:30:53,647][main.py][line:79][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.00019253422615602239
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0009458770702653651
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 16:32:03,561][main.py][line:105][INFO] [Epoch:1/30]: lr:0.00019 | loss1:0.4980 loss2:1.1649 loss3:0.2798 | AUC:0.8224 Anomaly AUC:0.6387
[2023-08-26 16:33:35,271][main.py][line:105][INFO] [Epoch:2/30]: lr:0.00019 | loss1:0.2956 loss2:0.9468 loss3:0.0732 | AUC:0.8191 Anomaly AUC:0.6916
[2023-08-26 16:34:56,693][main.py][line:105][INFO] [Epoch:3/30]: lr:0.00019 | loss1:0.2209 loss2:0.8710 loss3:0.0372 | AUC:0.8419 Anomaly AUC:0.6946
[2023-08-26 16:36:07,127][main.py][line:105][INFO] [Epoch:4/30]: lr:0.00019 | loss1:0.1834 loss2:0.8209 loss3:0.0298 | AUC:0.8312 Anomaly AUC:0.6770
[2023-08-26 16:37:19,709][main.py][line:105][INFO] [Epoch:5/30]: lr:0.00019 | loss1:0.1545 loss2:0.7839 loss3:0.0267 | AUC:0.8184 Anomaly AUC:0.6555
[2023-08-26 16:38:43,068][main.py][line:105][INFO] [Epoch:6/30]: lr:0.00019 | loss1:0.1175 loss2:0.7374 loss3:0.0215 | AUC:0.8305 Anomaly AUC:0.6414
[2023-08-26 16:40:23,661][main.py][line:121][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 30, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 16:40:23,821][main.py][line:165][INFO] total params:9.6689M
[2023-08-26 16:40:23,821][main.py][line:168][INFO] Training Mode
[2023-08-26 16:40:23,822][main.py][line:78][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 16:40:23,822][main.py][line:79][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0003454957528378858
    lr: 0.0003454957528378858
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 1.715200534486453e-05
    lr: 1.715200534486453e-05
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 16:41:01,318][main.py][line:105][INFO] [Epoch:1/30]: lr:0.00035 | loss1:0.6478 loss2:1.3595 loss3:0.3862 | AUC:0.8176 Anomaly AUC:0.6257
[2023-08-26 16:41:50,581][main.py][line:121][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 30, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 16:41:50,713][main.py][line:165][INFO] total params:9.6689M
[2023-08-26 16:41:50,713][main.py][line:168][INFO] Training Mode
[2023-08-26 16:41:50,714][main.py][line:78][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 16:41:50,714][main.py][line:79][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 1.446945948977353e-05
    lr: 1.446945948977353e-05
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 9.808904550174232e-05
    lr: 9.808904550174232e-05
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 16:42:24,221][main.py][line:121][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 16:42:24,342][main.py][line:165][INFO] total params:9.6689M
[2023-08-26 16:42:24,342][main.py][line:168][INFO] Training Mode
[2023-08-26 16:42:24,344][main.py][line:78][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 16:42:24,344][main.py][line:79][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 3.730090212424105e-05
    lr: 3.730090212424105e-05
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0006249061683179006
    lr: 0.0006249061683179006
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 16:42:54,473][main.py][line:105][INFO] [Epoch:1/10]: lr:0.00004 | loss1:0.7195 loss2:1.3551 loss3:0.3766 | AUC:0.7993 Anomaly AUC:0.6159
[2023-08-26 16:43:21,786][main.py][line:105][INFO] [Epoch:2/10]: lr:0.00004 | loss1:0.5210 loss2:1.2126 loss3:0.3293 | AUC:0.8061 Anomaly AUC:0.5984
[2023-08-26 16:43:48,200][main.py][line:105][INFO] [Epoch:3/10]: lr:0.00004 | loss1:0.3809 loss2:1.0981 loss3:0.2069 | AUC:0.8110 Anomaly AUC:0.6111
[2023-08-26 16:44:09,772][main.py][line:105][INFO] [Epoch:4/10]: lr:0.00004 | loss1:0.3142 loss2:1.0148 loss3:0.1580 | AUC:0.8077 Anomaly AUC:0.6068
[2023-08-26 16:44:32,418][main.py][line:105][INFO] [Epoch:5/10]: lr:0.00004 | loss1:0.2625 loss2:0.9572 loss3:0.1410 | AUC:0.8290 Anomaly AUC:0.6454
[2023-08-26 16:44:57,593][main.py][line:105][INFO] [Epoch:6/10]: lr:0.00004 | loss1:0.2512 loss2:0.9489 loss3:0.1305 | AUC:0.8345 Anomaly AUC:0.6438
[2023-08-26 16:45:20,564][main.py][line:105][INFO] [Epoch:7/10]: lr:0.00004 | loss1:0.2172 loss2:0.9198 loss3:0.1183 | AUC:0.8241 Anomaly AUC:0.6522
[2023-08-26 16:45:52,138][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 16:45:52,277][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 16:45:52,278][main.py][line:169][INFO] Training Mode
[2023-08-26 16:45:52,279][main.py][line:79][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 16:45:52,279][main.py][line:80][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.00020800936756432736
    lr: 0.00020800936756432736
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 8.009905580349912e-05
    lr: 8.009905580349912e-05
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 16:46:19,839][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00021 | loss1:0.6373 loss2:1.3160 loss3:0.3850 | AUC:0.8087 Anomaly AUC:0.6256
[2023-08-26 16:46:41,808][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00021 | loss1:0.3241 loss2:1.0929 loss3:0.3864 | AUC:0.8158 Anomaly AUC:0.6354
[2023-08-26 16:47:05,542][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00021 | loss1:0.1350 loss2:0.9555 loss3:0.3949 | AUC:0.8067 Anomaly AUC:0.6502
[2023-08-26 16:47:28,483][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00021 | loss1:0.0330 loss2:0.8618 loss3:0.4066 | AUC:0.7539 Anomaly AUC:0.6188
[2023-08-26 16:47:50,191][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00020 | loss1:0.0530 loss2:0.8496 loss3:0.4092 | AUC:0.5574 Anomaly AUC:0.5282
[2023-08-26 16:48:14,362][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00020 | loss1:0.0380 loss2:0.8202 loss3:0.4110 | AUC:0.5785 Anomaly AUC:0.5219
[2023-08-26 16:48:39,584][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00020 | loss1:0.0305 loss2:0.7980 loss3:0.4025 | AUC:0.5696 Anomaly AUC:0.5190
[2023-08-26 16:49:04,609][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00020 | loss1:0.0304 loss2:0.7800 loss3:0.3956 | AUC:0.5307 Anomaly AUC:0.5147
[2023-08-26 16:49:27,573][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00020 | loss1:0.0327 loss2:0.7585 loss3:0.3914 | AUC:0.5335 Anomaly AUC:0.5197
[2023-08-26 16:49:50,012][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00019 | loss1:0.0288 loss2:0.7383 loss3:0.3874 | AUC:0.5452 Anomaly AUC:0.5214
[2023-08-26 16:49:50,066][main.py][line:114][INFO] Training completes in 3m 58s | best AUCAUC:0.8158 Anomaly AUC:0.6354

[2023-08-26 16:49:50,117][main.py][line:79][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 16:49:50,117][main.py][line:80][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 1.0230245694566897e-05
    lr: 1.0230245694566897e-05
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.00011246255879346856
    lr: 0.00011246255879346856
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 16:50:13,771][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00001 | loss1:0.2202 loss2:1.0177 loss3:0.3963 | AUC:0.8095 Anomaly AUC:0.6261
[2023-08-26 16:50:38,081][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00001 | loss1:0.0590 loss2:0.9746 loss3:0.4366 | AUC:0.8049 Anomaly AUC:0.6226
[2023-08-26 16:51:03,288][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00001 | loss1:0.0305 loss2:0.9407 loss3:0.4667 | AUC:0.7954 Anomaly AUC:0.6181
[2023-08-26 16:51:28,801][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00001 | loss1:0.0290 loss2:0.9190 loss3:0.4587 | AUC:0.7865 Anomaly AUC:0.6203
[2023-08-26 16:51:54,576][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00001 | loss1:0.0287 loss2:0.9043 loss3:0.4528 | AUC:0.7618 Anomaly AUC:0.6132
[2023-08-26 16:52:18,584][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00001 | loss1:0.0226 loss2:0.8914 loss3:0.4435 | AUC:0.7186 Anomaly AUC:0.6013
[2023-08-26 16:52:41,861][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00001 | loss1:0.0249 loss2:0.8889 loss3:0.4362 | AUC:0.7175 Anomaly AUC:0.6185
[2023-08-26 16:53:05,251][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00001 | loss1:0.0253 loss2:0.8879 loss3:0.4318 | AUC:0.7090 Anomaly AUC:0.6065
[2023-08-26 16:53:29,273][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00001 | loss1:0.0234 loss2:0.8826 loss3:0.4309 | AUC:0.7110 Anomaly AUC:0.6378
[2023-08-26 16:57:12,646][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 16:57:12,782][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 16:57:12,782][main.py][line:169][INFO] Training Mode
[2023-08-26 16:58:59,272][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 16:58:59,401][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 16:58:59,402][main.py][line:169][INFO] Training Mode
[2023-08-26 17:02:39,545][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 17:02:39,678][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 17:02:39,678][main.py][line:169][INFO] Training Mode
[2023-08-26 17:05:15,771][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 17:05:15,890][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 17:05:15,890][main.py][line:169][INFO] Training Mode
[2023-08-26 17:06:21,587][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 17:06:21,708][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 17:06:21,708][main.py][line:169][INFO] Training Mode
[2023-08-26 17:08:35,405][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 17:08:35,528][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 17:08:35,528][main.py][line:169][INFO] Training Mode
[2023-08-26 17:09:16,881][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 17:09:17,017][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 17:09:17,017][main.py][line:169][INFO] Training Mode
[2023-08-26 17:10:56,522][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 17:10:56,643][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 17:10:56,643][main.py][line:169][INFO] Training Mode
[2023-08-26 17:11:41,672][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 17:11:41,808][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 17:11:41,808][main.py][line:169][INFO] Training Mode
[2023-08-26 17:13:18,763][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 17:13:18,898][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 17:13:18,898][main.py][line:169][INFO] Training Mode
[2023-08-26 17:14:22,969][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 17:14:23,100][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 17:14:23,100][main.py][line:169][INFO] Training Mode
[2023-08-26 17:14:45,645][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 17:14:45,784][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 17:14:45,784][main.py][line:169][INFO] Training Mode
[2023-08-26 17:15:04,783][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 17:15:04,902][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 17:15:04,902][main.py][line:169][INFO] Training Mode
[2023-08-26 17:15:23,290][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00014 | loss1:0.6740 loss2:1.3455 loss3:0.3861 | AUC:0.8131 Anomaly AUC:0.6163
[2023-08-26 17:15:37,708][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00014 | loss1:0.3804 loss2:1.1418 loss3:0.3863 | AUC:0.8221 Anomaly AUC:0.6215
[2023-08-26 17:16:01,048][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00014 | loss1:0.2490 loss2:1.0120 loss3:0.3866 | AUC:0.8237 Anomaly AUC:0.6363
[2023-08-26 17:16:18,122][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 17:16:18,262][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 17:16:18,262][main.py][line:169][INFO] Training Mode
[2023-08-26 17:16:35,901][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00003 | loss1:0.7489 loss2:1.4048 loss3:0.3862 | AUC:0.8054 Anomaly AUC:0.6012
[2023-08-26 17:17:00,288][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00003 | loss1:0.5474 loss2:1.3782 loss3:0.3862 | AUC:0.8093 Anomaly AUC:0.5995
[2023-08-26 17:17:15,449][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00003 | loss1:0.3910 loss2:1.3436 loss3:0.3865 | AUC:0.8118 Anomaly AUC:0.6024
[2023-08-26 17:17:29,112][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00003 | loss1:0.2970 loss2:1.3122 loss3:0.3866 | AUC:0.8130 Anomaly AUC:0.6156
[2023-08-26 17:17:43,634][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00003 | loss1:0.2271 loss2:1.2862 loss3:0.3867 | AUC:0.8051 Anomaly AUC:0.6098
[2023-08-26 17:17:57,709][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00003 | loss1:0.1569 loss2:1.2674 loss3:0.3867 | AUC:0.7908 Anomaly AUC:0.6106
[2023-08-26 17:18:11,560][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00003 | loss1:0.1127 loss2:1.2481 loss3:0.3874 | AUC:0.7496 Anomaly AUC:0.5787
[2023-08-26 17:18:26,360][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00003 | loss1:0.0700 loss2:1.2263 loss3:0.3881 | AUC:0.6035 Anomaly AUC:0.5139
[2023-08-26 17:18:37,246][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00003 | loss1:0.0570 loss2:1.1981 loss3:0.3885 | AUC:0.5812 Anomaly AUC:0.5140
[2023-08-26 17:18:51,222][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00003 | loss1:0.0442 loss2:1.1738 loss3:0.3891 | AUC:0.5560 Anomaly AUC:0.5161
[2023-08-26 17:18:51,272][main.py][line:114][INFO] Training completes in 2m 33s | best AUCAUC:0.8130 Anomaly AUC:0.6156

[2023-08-26 17:19:04,886][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00023 | loss1:0.6452 loss2:1.3242 loss3:0.3859 | AUC:0.8051 Anomaly AUC:0.6275
[2023-08-26 17:19:19,921][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00023 | loss1:0.2176 loss2:1.2499 loss3:0.3921 | AUC:0.8092 Anomaly AUC:0.6386
[2023-08-26 17:19:30,908][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00023 | loss1:0.0445 loss2:1.1712 loss3:0.3891 | AUC:0.7094 Anomaly AUC:0.5519
[2023-08-26 17:19:44,844][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00023 | loss1:0.0655 loss2:1.1242 loss3:0.3735 | AUC:0.5109 Anomaly AUC:0.5144
[2023-08-26 17:19:56,779][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00023 | loss1:0.1653 loss2:1.0687 loss3:0.3867 | AUC:0.8149 Anomaly AUC:0.6327
[2023-08-26 17:20:10,140][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00022 | loss1:0.0252 loss2:0.9798 loss3:0.3451 | AUC:0.8331 Anomaly AUC:0.6633
[2023-08-26 17:20:23,247][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00022 | loss1:0.0304 loss2:0.9217 loss3:0.3076 | AUC:0.7918 Anomaly AUC:0.6157
[2023-08-26 17:20:42,362][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00022 | loss1:0.0267 loss2:0.8890 loss3:0.2822 | AUC:0.7552 Anomaly AUC:0.6015
[2023-08-26 17:20:54,186][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00022 | loss1:0.0288 loss2:0.8771 loss3:0.2676 | AUC:0.7413 Anomaly AUC:0.6476
[2023-08-26 17:21:12,325][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00021 | loss1:0.0248 loss2:0.8748 loss3:0.2570 | AUC:0.7575 Anomaly AUC:0.6627
[2023-08-26 17:21:12,378][main.py][line:114][INFO] Training completes in 2m 21s | best AUCAUC:0.8331 Anomaly AUC:0.6633

[2023-08-26 17:21:26,028][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00010 | loss1:0.3215 loss2:1.1578 loss3:0.9702 | AUC:0.7646 Anomaly AUC:0.6216
[2023-08-26 17:21:37,405][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00010 | loss1:0.0362 loss2:0.9196 loss3:0.6052 | AUC:0.7004 Anomaly AUC:0.5984
[2023-08-26 17:21:48,532][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00010 | loss1:0.0292 loss2:0.8757 loss3:0.5563 | AUC:0.6964 Anomaly AUC:0.6069
[2023-08-26 17:22:00,299][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00010 | loss1:0.0392 loss2:0.8660 loss3:0.6488 | AUC:0.7217 Anomaly AUC:0.6248
[2023-08-26 17:22:13,795][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00010 | loss1:0.0264 loss2:0.8417 loss3:0.5716 | AUC:0.6841 Anomaly AUC:0.6105
[2023-08-26 17:22:27,258][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00010 | loss1:0.0286 loss2:0.8363 loss3:0.5097 | AUC:0.6918 Anomaly AUC:0.6145
[2023-08-26 17:22:40,988][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00010 | loss1:0.0297 loss2:0.8256 loss3:0.4906 | AUC:0.5530 Anomaly AUC:0.5853
[2023-08-26 17:22:53,071][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00010 | loss1:0.0247 loss2:0.8097 loss3:0.4615 | AUC:0.6394 Anomaly AUC:0.5836
[2023-08-26 17:23:07,333][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00009 | loss1:0.0265 loss2:0.8042 loss3:0.4430 | AUC:0.6326 Anomaly AUC:0.6025
[2023-08-26 17:23:18,516][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00009 | loss1:0.0291 loss2:0.7843 loss3:0.4313 | AUC:0.6588 Anomaly AUC:0.6224
[2023-08-26 17:23:18,542][main.py][line:114][INFO] Training completes in 2m 6s | best AUCAUC:0.7646 Anomaly AUC:0.6216

[2023-08-26 17:24:33,476][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 17:24:33,619][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 17:24:33,619][main.py][line:169][INFO] Training Mode
[2023-08-26 17:24:53,160][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00063 | loss1:0.7342 loss2:1.4115 loss3:0.3857 | AUC:0.7959 Anomaly AUC:0.6217
[2023-08-26 17:25:03,789][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00063 | loss1:0.4650 loss2:1.4023 loss3:0.3891 | AUC:0.8016 Anomaly AUC:0.6174
[2023-08-26 17:25:25,186][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00063 | loss1:0.1135 loss2:1.3707 loss3:0.4296 | AUC:0.5438 Anomaly AUC:0.4937
[2023-08-26 17:25:39,241][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00062 | loss1:0.0475 loss2:1.2885 loss3:0.5351 | AUC:0.4536 Anomaly AUC:0.4806
[2023-08-26 17:25:50,320][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00062 | loss1:0.0356 loss2:1.1876 loss3:0.5868 | AUC:0.5602 Anomaly AUC:0.5313
[2023-08-26 17:26:01,183][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00062 | loss1:0.0341 loss2:1.1303 loss3:0.5983 | AUC:0.5044 Anomaly AUC:0.4966
[2023-08-26 17:26:12,170][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00061 | loss1:0.0353 loss2:1.0886 loss3:0.6036 | AUC:0.4974 Anomaly AUC:0.5082
[2023-08-26 17:26:25,018][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00060 | loss1:0.0345 loss2:1.0459 loss3:0.6026 | AUC:0.5150 Anomaly AUC:0.4843
[2023-08-26 17:26:37,982][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00060 | loss1:0.0346 loss2:1.0050 loss3:0.6003 | AUC:0.5544 Anomaly AUC:0.5127
[2023-08-26 17:26:51,105][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00059 | loss1:0.0316 loss2:0.9741 loss3:0.5984 | AUC:0.6002 Anomaly AUC:0.5260
[2023-08-26 17:26:51,158][main.py][line:114][INFO] Training completes in 2m 17s | best AUCAUC:0.8016 Anomaly AUC:0.6174

[2023-08-26 17:27:03,991][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00011 | loss1:0.2268 loss2:1.3601 loss3:0.3977 | AUC:0.8073 Anomaly AUC:0.6154
[2023-08-26 17:27:17,370][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00011 | loss1:0.0715 loss2:1.3148 loss3:0.3998 | AUC:0.7666 Anomaly AUC:0.5881
[2023-08-26 17:27:30,433][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00011 | loss1:0.0323 loss2:1.2537 loss3:0.3939 | AUC:0.4980 Anomaly AUC:0.4392
[2023-08-26 17:27:41,561][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00011 | loss1:0.0305 loss2:1.1902 loss3:0.3863 | AUC:0.3704 Anomaly AUC:0.4243
[2023-08-26 17:27:52,418][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00011 | loss1:0.0408 loss2:1.1298 loss3:0.3841 | AUC:0.3324 Anomaly AUC:0.4238
[2023-08-26 17:28:03,425][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00011 | loss1:0.0245 loss2:1.0721 loss3:0.3814 | AUC:0.3223 Anomaly AUC:0.4205
[2023-08-26 17:28:16,419][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00010 | loss1:0.0287 loss2:1.0426 loss3:0.3759 | AUC:0.2907 Anomaly AUC:0.4286
[2023-08-26 17:28:32,765][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00010 | loss1:0.0285 loss2:1.0300 loss3:0.3734 | AUC:0.2823 Anomaly AUC:0.4348
[2023-08-26 17:28:46,759][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00010 | loss1:0.0319 loss2:1.0095 loss3:0.3700 | AUC:0.2898 Anomaly AUC:0.4338
[2023-08-26 17:29:02,351][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00010 | loss1:0.0281 loss2:0.9802 loss3:0.3653 | AUC:0.3265 Anomaly AUC:0.4423
[2023-08-26 17:29:02,378][main.py][line:114][INFO] Training completes in 2m 11s | best AUCAUC:0.8073 Anomaly AUC:0.6154

[2023-08-26 17:29:13,278][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00003 | loss1:0.0716 loss2:1.3438 loss3:0.4020 | AUC:0.8010 Anomaly AUC:0.6165
[2023-08-26 17:29:27,800][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00003 | loss1:0.0357 loss2:1.3496 loss3:0.4013 | AUC:0.7949 Anomaly AUC:0.6130
[2023-08-26 17:29:41,049][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00003 | loss1:0.0283 loss2:1.3513 loss3:0.3967 | AUC:0.7865 Anomaly AUC:0.6178
[2023-08-26 17:29:54,031][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00003 | loss1:0.0297 loss2:1.3393 loss3:0.3945 | AUC:0.7900 Anomaly AUC:0.6156
[2023-08-26 17:30:07,115][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00003 | loss1:0.0239 loss2:1.3389 loss3:0.3928 | AUC:0.7782 Anomaly AUC:0.6093
[2023-08-26 17:30:20,021][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00003 | loss1:0.0271 loss2:1.3444 loss3:0.3905 | AUC:0.7788 Anomaly AUC:0.5994
[2023-08-26 17:30:32,949][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00003 | loss1:0.0268 loss2:1.3434 loss3:0.3885 | AUC:0.7184 Anomaly AUC:0.5796
[2023-08-26 17:30:45,880][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00003 | loss1:0.0249 loss2:1.3358 loss3:0.3870 | AUC:0.7007 Anomaly AUC:0.5871
[2023-08-26 17:30:58,408][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00003 | loss1:0.0192 loss2:1.3407 loss3:0.3851 | AUC:0.7539 Anomaly AUC:0.5989
[2023-08-26 17:31:09,793][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00003 | loss1:0.0265 loss2:1.3363 loss3:0.3829 | AUC:0.7233 Anomaly AUC:0.5741
[2023-08-26 17:31:09,846][main.py][line:114][INFO] Training completes in 2m 7s | best AUCAUC:0.8010 Anomaly AUC:0.6165

[2023-08-26 17:31:22,868][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00001 | loss1:0.3515 loss2:1.3340 loss3:0.5067 | AUC:0.6510 Anomaly AUC:0.5902
[2023-08-26 17:31:38,462][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00001 | loss1:0.0377 loss2:1.2542 loss3:0.4771 | AUC:0.3969 Anomaly AUC:0.4825
[2023-08-26 17:31:50,207][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00001 | loss1:0.0394 loss2:1.1370 loss3:0.4417 | AUC:0.3857 Anomaly AUC:0.4818
[2023-08-26 17:32:03,358][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00001 | loss1:0.0390 loss2:1.0468 loss3:0.4243 | AUC:0.5363 Anomaly AUC:0.4990
[2023-08-26 17:32:20,431][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00001 | loss1:0.0464 loss2:1.0139 loss3:0.4090 | AUC:0.6048 Anomaly AUC:0.5480
[2023-08-26 17:32:31,348][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00001 | loss1:0.0370 loss2:0.9741 loss3:0.3836 | AUC:0.7189 Anomaly AUC:0.5922
[2023-08-26 17:32:43,458][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00001 | loss1:0.0414 loss2:0.9693 loss3:0.3711 | AUC:0.6152 Anomaly AUC:0.5493
[2023-08-26 17:32:54,527][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00001 | loss1:0.0421 loss2:0.9547 loss3:0.3657 | AUC:0.6940 Anomaly AUC:0.6057
[2023-08-26 17:33:05,448][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00001 | loss1:0.0403 loss2:0.9299 loss3:0.3570 | AUC:0.7002 Anomaly AUC:0.6039
[2023-08-26 17:33:16,509][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00001 | loss1:0.0428 loss2:0.9077 loss3:0.3478 | AUC:0.6947 Anomaly AUC:0.6124
[2023-08-26 17:33:16,535][main.py][line:114][INFO] Training completes in 2m 7s | best AUCAUC:0.7189 Anomaly AUC:0.5922

[2023-08-26 17:33:29,801][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00003 | loss1:0.0331 loss2:0.9538 loss3:0.3553 | AUC:0.7639 Anomaly AUC:0.6149
[2023-08-26 17:33:42,727][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00003 | loss1:0.0356 loss2:0.9283 loss3:0.3404 | AUC:0.7621 Anomaly AUC:0.6208
[2023-08-26 17:33:56,083][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00003 | loss1:0.0371 loss2:0.9092 loss3:0.3355 | AUC:0.7766 Anomaly AUC:0.6206
[2023-08-26 17:34:09,190][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00003 | loss1:0.0355 loss2:0.8671 loss3:0.3267 | AUC:0.7845 Anomaly AUC:0.6247
[2023-08-26 17:34:22,070][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00003 | loss1:0.0297 loss2:0.8516 loss3:0.3210 | AUC:0.5062 Anomaly AUC:0.5632
[2023-08-26 17:34:38,392][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00003 | loss1:0.0384 loss2:0.8372 loss3:0.3332 | AUC:0.7641 Anomaly AUC:0.6208
[2023-08-26 17:34:49,303][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00003 | loss1:0.0312 loss2:0.8133 loss3:0.3065 | AUC:0.7499 Anomaly AUC:0.6189
[2023-08-26 17:35:01,523][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00003 | loss1:0.0303 loss2:0.7941 loss3:0.2886 | AUC:0.7492 Anomaly AUC:0.6243
[2023-08-26 17:35:14,783][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00003 | loss1:0.0310 loss2:0.7831 loss3:0.2781 | AUC:0.7334 Anomaly AUC:0.6175
[2023-08-26 17:35:28,018][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00003 | loss1:0.0322 loss2:0.7746 loss3:0.2679 | AUC:0.7197 Anomaly AUC:0.6247
[2023-08-26 17:35:28,071][main.py][line:114][INFO] Training completes in 2m 11s | best AUCAUC:0.7845 Anomaly AUC:0.6247

[2023-08-26 17:35:45,518][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00045 | loss1:0.1920 loss2:0.9936 loss3:0.3338 | AUC:0.8011 Anomaly AUC:0.6349
[2023-08-26 17:35:58,640][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00045 | loss1:0.0290 loss2:0.8549 loss3:0.3306 | AUC:0.7230 Anomaly AUC:0.6057
[2023-08-26 17:36:12,483][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00045 | loss1:0.0322 loss2:0.8179 loss3:0.3376 | AUC:0.7928 Anomaly AUC:0.6189
[2023-08-26 17:36:26,019][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00045 | loss1:0.0305 loss2:0.7920 loss3:0.3289 | AUC:0.7929 Anomaly AUC:0.6183
[2023-08-26 17:36:37,000][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00044 | loss1:0.0284 loss2:0.7650 loss3:0.3257 | AUC:0.7834 Anomaly AUC:0.6132
[2023-08-26 17:36:48,512][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00044 | loss1:0.0219 loss2:0.7366 loss3:0.3226 | AUC:0.6362 Anomaly AUC:0.5687
[2023-08-26 17:37:02,484][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00044 | loss1:0.0792 loss2:0.8722 loss3:0.3488 | AUC:0.6925 Anomaly AUC:0.6049
[2023-08-26 17:37:15,695][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00043 | loss1:0.0274 loss2:0.7612 loss3:0.3439 | AUC:0.7707 Anomaly AUC:0.6172
[2023-08-26 17:37:32,182][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00043 | loss1:0.0266 loss2:0.7305 loss3:0.3338 | AUC:0.7661 Anomaly AUC:0.6074
[2023-08-26 17:37:44,682][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00042 | loss1:0.0293 loss2:0.6990 loss3:0.3273 | AUC:0.7722 Anomaly AUC:0.6143
[2023-08-26 17:37:44,708][main.py][line:114][INFO] Training completes in 2m 17s | best AUCAUC:0.8011 Anomaly AUC:0.6349

[2023-08-26 17:37:56,294][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00003 | loss1:0.0334 loss2:0.8846 loss3:0.3356 | AUC:0.7977 Anomaly AUC:0.6341
[2023-08-26 17:38:10,992][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00003 | loss1:0.0276 loss2:0.8539 loss3:0.3137 | AUC:0.7866 Anomaly AUC:0.6439
[2023-08-26 17:38:25,070][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00003 | loss1:0.0275 loss2:0.8392 loss3:0.3026 | AUC:0.7920 Anomaly AUC:0.6257
[2023-08-26 17:38:38,624][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00003 | loss1:0.0270 loss2:0.8299 loss3:0.2903 | AUC:0.7675 Anomaly AUC:0.6322
[2023-08-26 17:38:49,597][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00003 | loss1:0.0265 loss2:0.8216 loss3:0.2831 | AUC:0.7751 Anomaly AUC:0.6273
[2023-08-26 17:39:00,554][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00003 | loss1:0.0297 loss2:0.8221 loss3:0.2659 | AUC:0.7800 Anomaly AUC:0.6299
[2023-08-26 17:39:16,162][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00003 | loss1:0.0248 loss2:0.8052 loss3:0.2455 | AUC:0.7882 Anomaly AUC:0.6305
[2023-08-26 17:39:29,180][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00003 | loss1:0.0248 loss2:0.8159 loss3:0.2609 | AUC:0.7495 Anomaly AUC:0.6364
[2023-08-26 17:39:44,753][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00003 | loss1:0.0242 loss2:0.8078 loss3:0.2191 | AUC:0.7797 Anomaly AUC:0.6370
[2023-08-26 17:39:58,237][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00003 | loss1:0.0232 loss2:0.7934 loss3:0.1773 | AUC:0.7806 Anomaly AUC:0.6338
[2023-08-26 17:39:58,289][main.py][line:114][INFO] Training completes in 2m 14s | best AUCAUC:0.7977 Anomaly AUC:0.6341

[2023-08-26 17:40:09,177][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00012 | loss1:0.1180 loss2:0.9809 loss3:0.3553 | AUC:0.7797 Anomaly AUC:0.6443
[2023-08-26 17:40:19,973][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00012 | loss1:0.0329 loss2:0.9701 loss3:0.3626 | AUC:0.6258 Anomaly AUC:0.5915
[2023-08-26 17:40:30,977][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00012 | loss1:0.0259 loss2:0.9426 loss3:0.3520 | AUC:0.6947 Anomaly AUC:0.5903
[2023-08-26 17:40:44,442][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00012 | loss1:0.0265 loss2:0.9216 loss3:0.3393 | AUC:0.5800 Anomaly AUC:0.5657
[2023-08-26 17:41:10,422][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00012 | loss1:0.0285 loss2:0.9228 loss3:0.3314 | AUC:0.3710 Anomaly AUC:0.5248
[2023-08-26 17:41:21,520][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00012 | loss1:0.0326 loss2:0.9519 loss3:0.3314 | AUC:0.5262 Anomaly AUC:0.5611
[2023-08-26 17:41:35,320][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00012 | loss1:0.0277 loss2:0.9217 loss3:0.3171 | AUC:0.7054 Anomaly AUC:0.6073
[2023-08-26 17:41:48,163][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00012 | loss1:0.0226 loss2:0.9075 loss3:0.3000 | AUC:0.4784 Anomaly AUC:0.5884
[2023-08-26 17:42:02,727][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00011 | loss1:0.0228 loss2:0.9208 loss3:0.3091 | AUC:0.6578 Anomaly AUC:0.6288
[2023-08-26 17:42:16,204][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00011 | loss1:0.0226 loss2:0.8974 loss3:0.2974 | AUC:0.4306 Anomaly AUC:0.5920
[2023-08-26 17:42:16,231][main.py][line:114][INFO] Training completes in 2m 18s | best AUCAUC:0.7797 Anomaly AUC:0.6443

[2023-08-26 17:42:29,342][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00005 | loss1:0.2139 loss2:1.0503 loss3:0.4227 | AUC:0.5340 Anomaly AUC:0.5579
[2023-08-26 17:42:42,801][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00005 | loss1:0.0408 loss2:0.9004 loss3:0.3638 | AUC:0.4374 Anomaly AUC:0.5470
[2023-08-26 17:42:56,274][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00005 | loss1:0.0414 loss2:0.8706 loss3:0.3397 | AUC:0.4318 Anomaly AUC:0.5364
[2023-08-26 17:43:09,989][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00005 | loss1:0.0385 loss2:0.8505 loss3:0.3173 | AUC:0.5440 Anomaly AUC:0.5659
[2023-08-26 17:43:24,626][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00005 | loss1:0.0357 loss2:0.8423 loss3:0.2986 | AUC:0.3414 Anomaly AUC:0.5225
[2023-08-26 17:43:37,977][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00005 | loss1:0.0439 loss2:0.8427 loss3:0.2806 | AUC:0.5210 Anomaly AUC:0.5595
[2023-08-26 17:43:51,809][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00005 | loss1:0.0390 loss2:0.8410 loss3:0.2923 | AUC:0.2979 Anomaly AUC:0.5068
[2023-08-26 17:44:05,631][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00005 | loss1:0.0557 loss2:0.8592 loss3:0.2758 | AUC:0.3697 Anomaly AUC:0.5244
[2023-08-26 17:44:19,032][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00005 | loss1:0.0330 loss2:0.8147 loss3:0.2213 | AUC:0.7094 Anomaly AUC:0.5955
[2023-08-26 17:44:32,654][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00005 | loss1:0.0289 loss2:0.7911 loss3:0.1972 | AUC:0.4148 Anomaly AUC:0.5674
[2023-08-26 17:44:32,706][main.py][line:114][INFO] Training completes in 2m 16s | best AUCAUC:0.7094 Anomaly AUC:0.5955

[2023-08-26 17:44:43,751][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00001 | loss1:0.0302 loss2:0.7869 loss3:0.1942 | AUC:0.6746 Anomaly AUC:0.6335
[2023-08-26 17:44:54,622][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00001 | loss1:0.0282 loss2:0.7683 loss3:0.1830 | AUC:0.7125 Anomaly AUC:0.6248
[2023-08-26 17:45:05,995][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00001 | loss1:0.0278 loss2:0.7618 loss3:0.1739 | AUC:0.7263 Anomaly AUC:0.6193
[2023-08-26 17:45:19,138][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00001 | loss1:0.0270 loss2:0.7573 loss3:0.1680 | AUC:0.6929 Anomaly AUC:0.6216
[2023-08-26 17:45:32,934][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00001 | loss1:0.0251 loss2:0.7478 loss3:0.1650 | AUC:0.7206 Anomaly AUC:0.6145
[2023-08-26 17:45:44,867][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00001 | loss1:0.0227 loss2:0.7445 loss3:0.1534 | AUC:0.6946 Anomaly AUC:0.6160
[2023-08-26 17:45:56,096][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00001 | loss1:0.0254 loss2:0.7381 loss3:0.1570 | AUC:0.6710 Anomaly AUC:0.6091
[2023-08-26 17:46:07,586][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00001 | loss1:0.0295 loss2:0.7321 loss3:0.1607 | AUC:0.6717 Anomaly AUC:0.6122
[2023-08-26 17:46:22,035][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00001 | loss1:0.0255 loss2:0.7204 loss3:0.1474 | AUC:0.6404 Anomaly AUC:0.6097
[2023-08-26 17:46:35,735][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00001 | loss1:0.0248 loss2:0.7121 loss3:0.1357 | AUC:0.6381 Anomaly AUC:0.6090
[2023-08-26 17:46:35,788][main.py][line:114][INFO] Training completes in 2m 3s | best AUCAUC:0.7263 Anomaly AUC:0.6193

[2023-08-26 17:46:48,962][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00016 | loss1:0.0237 loss2:0.7733 loss3:0.1666 | AUC:0.6756 Anomaly AUC:0.6179
[2023-08-26 17:47:09,789][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00016 | loss1:0.0290 loss2:0.7757 loss3:0.1706 | AUC:0.7538 Anomaly AUC:0.6209
[2023-08-26 17:47:20,688][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00016 | loss1:0.0236 loss2:0.7557 loss3:0.1615 | AUC:0.7008 Anomaly AUC:0.6201
[2023-08-26 17:47:32,664][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00016 | loss1:0.0258 loss2:0.7509 loss3:0.1593 | AUC:0.7094 Anomaly AUC:0.6235
[2023-08-26 17:47:46,349][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00016 | loss1:0.0285 loss2:0.7439 loss3:0.1535 | AUC:0.6953 Anomaly AUC:0.6219
[2023-08-26 17:48:01,506][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00015 | loss1:0.0256 loss2:0.7381 loss3:0.1530 | AUC:0.7319 Anomaly AUC:0.6266
[2023-08-26 17:48:13,510][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00015 | loss1:0.0225 loss2:0.7171 loss3:0.1537 | AUC:0.7285 Anomaly AUC:0.6262
[2023-08-26 17:48:27,388][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00015 | loss1:0.0256 loss2:0.7178 loss3:0.1506 | AUC:0.6882 Anomaly AUC:0.6241
[2023-08-26 17:48:41,162][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00015 | loss1:0.0264 loss2:0.7174 loss3:0.1496 | AUC:0.7374 Anomaly AUC:0.6247
[2023-08-26 17:48:52,097][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00015 | loss1:0.0277 loss2:0.7112 loss3:0.1447 | AUC:0.7186 Anomaly AUC:0.6249
[2023-08-26 17:48:52,124][main.py][line:114][INFO] Training completes in 2m 16s | best AUCAUC:0.7538 Anomaly AUC:0.6209

[2023-08-26 17:49:03,091][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00089 | loss1:0.3266 loss2:1.1936 loss3:0.1719 | AUC:0.7813 Anomaly AUC:0.6011
[2023-08-26 17:49:16,773][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00089 | loss1:0.0254 loss2:1.0680 loss3:0.1908 | AUC:0.6557 Anomaly AUC:0.5416
[2023-08-26 17:49:30,401][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00089 | loss1:0.0328 loss2:0.8833 loss3:0.1846 | AUC:0.7481 Anomaly AUC:0.5979
[2023-08-26 17:49:44,023][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00088 | loss1:0.0298 loss2:0.8975 loss3:0.1852 | AUC:0.7833 Anomaly AUC:0.6166
[2023-08-26 17:49:57,820][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00088 | loss1:0.0282 loss2:0.8562 loss3:0.1850 | AUC:0.7863 Anomaly AUC:0.6198
[2023-08-26 17:50:11,300][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00087 | loss1:0.0235 loss2:0.8262 loss3:0.1865 | AUC:0.7707 Anomaly AUC:0.6014
[2023-08-26 17:50:27,265][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00086 | loss1:0.0251 loss2:0.7968 loss3:0.1839 | AUC:0.7849 Anomaly AUC:0.6146
[2023-08-26 17:50:38,187][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00085 | loss1:0.0292 loss2:0.7812 loss3:0.1851 | AUC:0.7814 Anomaly AUC:0.5994
[2023-08-26 17:50:49,340][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00084 | loss1:0.0256 loss2:0.7481 loss3:0.1836 | AUC:0.7623 Anomaly AUC:0.5925
[2023-08-26 17:51:03,548][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00083 | loss1:0.0258 loss2:0.7472 loss3:0.1843 | AUC:0.7545 Anomaly AUC:0.5658
[2023-08-26 17:51:03,600][main.py][line:114][INFO] Training completes in 2m 11s | best AUCAUC:0.7863 Anomaly AUC:0.6198

[2023-08-26 17:51:17,032][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00031 | loss1:0.0326 loss2:0.7705 loss3:0.1949 | AUC:0.7833 Anomaly AUC:0.6206
[2023-08-26 17:51:30,379][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00031 | loss1:0.0279 loss2:0.7726 loss3:0.1954 | AUC:0.7606 Anomaly AUC:0.6031
[2023-08-26 17:51:44,210][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00031 | loss1:0.0323 loss2:0.7623 loss3:0.2011 | AUC:0.7737 Anomaly AUC:0.6115
[2023-08-26 17:51:57,766][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00031 | loss1:0.0273 loss2:0.7310 loss3:0.2020 | AUC:0.7771 Anomaly AUC:0.6021
[2023-08-26 17:52:11,687][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00031 | loss1:0.0250 loss2:0.7139 loss3:0.2034 | AUC:0.7729 Anomaly AUC:0.5990
[2023-08-26 17:52:22,821][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00031 | loss1:0.0264 loss2:0.6968 loss3:0.2007 | AUC:0.7753 Anomaly AUC:0.6079
[2023-08-26 17:52:41,462][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00030 | loss1:0.0244 loss2:0.7001 loss3:0.2052 | AUC:0.7678 Anomaly AUC:0.5975
[2023-08-26 17:52:57,824][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00030 | loss1:0.0262 loss2:0.6815 loss3:0.2121 | AUC:0.7306 Anomaly AUC:0.6042
[2023-08-26 17:53:18,123][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00030 | loss1:0.0247 loss2:0.6814 loss3:0.2135 | AUC:0.7634 Anomaly AUC:0.6038
[2023-08-26 17:53:31,135][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00029 | loss1:0.0221 loss2:0.6699 loss3:0.2066 | AUC:0.7573 Anomaly AUC:0.6029
[2023-08-26 17:53:31,161][main.py][line:114][INFO] Training completes in 2m 27s | best AUCAUC:0.7833 Anomaly AUC:0.6206

[2023-08-26 17:53:43,085][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00008 | loss1:0.0270 loss2:0.7242 loss3:0.1656 | AUC:0.7249 Anomaly AUC:0.6169
[2023-08-26 17:53:56,317][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00008 | loss1:0.0266 loss2:0.7139 loss3:0.1559 | AUC:0.7566 Anomaly AUC:0.6211
[2023-08-26 17:54:07,355][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00008 | loss1:0.0212 loss2:0.7076 loss3:0.1519 | AUC:0.7521 Anomaly AUC:0.6215
[2023-08-26 17:54:19,114][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00008 | loss1:0.0274 loss2:0.7051 loss3:0.1491 | AUC:0.7423 Anomaly AUC:0.6227
[2023-08-26 17:54:33,100][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00007 | loss1:0.0266 loss2:0.6947 loss3:0.1450 | AUC:0.7341 Anomaly AUC:0.6222
[2023-08-26 17:54:44,172][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00007 | loss1:0.0224 loss2:0.6912 loss3:0.1453 | AUC:0.7319 Anomaly AUC:0.6230
[2023-08-26 17:54:59,320][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00007 | loss1:0.0222 loss2:0.6850 loss3:0.1432 | AUC:0.7265 Anomaly AUC:0.6241
[2023-08-26 17:55:15,868][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00007 | loss1:0.0186 loss2:0.6862 loss3:0.1420 | AUC:0.7280 Anomaly AUC:0.6263
[2023-08-26 17:55:30,369][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00007 | loss1:0.0217 loss2:0.6779 loss3:0.1391 | AUC:0.7116 Anomaly AUC:0.6238
[2023-08-26 17:55:44,693][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00007 | loss1:0.0215 loss2:0.6746 loss3:0.1371 | AUC:0.7153 Anomaly AUC:0.6252
[2023-08-26 17:55:44,746][main.py][line:114][INFO] Training completes in 2m 14s | best AUCAUC:0.7566 Anomaly AUC:0.6211

[2023-08-26 17:55:59,498][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00022 | loss1:0.0272 loss2:0.7492 loss3:0.1750 | AUC:0.7522 Anomaly AUC:0.6108
[2023-08-26 17:56:14,070][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00022 | loss1:0.0438 loss2:0.7530 loss3:0.1575 | AUC:0.7448 Anomaly AUC:0.6082
[2023-08-26 17:56:28,722][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00022 | loss1:0.0301 loss2:0.7385 loss3:0.1393 | AUC:0.7542 Anomaly AUC:0.6287
[2023-08-26 17:56:43,729][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00022 | loss1:0.0329 loss2:0.7396 loss3:0.1383 | AUC:0.7465 Anomaly AUC:0.6440
[2023-08-26 17:56:58,183][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00022 | loss1:0.0267 loss2:0.7367 loss3:0.1279 | AUC:0.7326 Anomaly AUC:0.6403
[2023-08-26 17:57:12,595][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00022 | loss1:0.0243 loss2:0.7229 loss3:0.1302 | AUC:0.7071 Anomaly AUC:0.6486
[2023-08-26 17:57:27,310][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00022 | loss1:0.0244 loss2:0.7110 loss3:0.1300 | AUC:0.6759 Anomaly AUC:0.6347
[2023-08-26 17:57:38,472][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00021 | loss1:0.0212 loss2:0.6959 loss3:0.1239 | AUC:0.6811 Anomaly AUC:0.6403
[2023-08-26 17:57:56,153][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00021 | loss1:0.0232 loss2:0.7017 loss3:0.1260 | AUC:0.6402 Anomaly AUC:0.6362
[2023-08-26 17:58:08,074][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00021 | loss1:0.0235 loss2:0.7040 loss3:0.1282 | AUC:0.7061 Anomaly AUC:0.6385
[2023-08-26 17:58:08,126][main.py][line:114][INFO] Training completes in 2m 23s | best AUCAUC:0.7542 Anomaly AUC:0.6287

[2023-08-26 17:58:24,661][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00095 | loss1:0.2011 loss2:1.1404 loss3:0.1294 | AUC:0.6556 Anomaly AUC:0.4913
[2023-08-26 17:58:35,705][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00095 | loss1:0.0326 loss2:1.1274 loss3:0.1301 | AUC:0.6850 Anomaly AUC:0.5182
[2023-08-26 17:58:47,766][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00094 | loss1:0.0401 loss2:1.0992 loss3:0.1257 | AUC:0.6458 Anomaly AUC:0.4845
[2023-08-26 17:59:02,666][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00094 | loss1:0.0448 loss2:1.1002 loss3:0.1275 | AUC:0.7489 Anomaly AUC:0.6026
[2023-08-26 17:59:13,591][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00093 | loss1:0.0325 loss2:1.0966 loss3:0.1258 | AUC:0.6901 Anomaly AUC:0.5381
[2023-08-26 17:59:25,718][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00093 | loss1:0.0273 loss2:1.0708 loss3:0.1232 | AUC:0.7310 Anomaly AUC:0.5862
[2023-08-26 17:59:36,925][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00092 | loss1:0.0440 loss2:1.0401 loss3:0.1296 | AUC:0.7571 Anomaly AUC:0.6145
[2023-08-26 17:59:48,023][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00091 | loss1:0.0267 loss2:0.9180 loss3:0.1234 | AUC:0.7562 Anomaly AUC:0.6302
[2023-08-26 18:00:06,004][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00090 | loss1:0.0261 loss2:0.8489 loss3:0.1222 | AUC:0.7272 Anomaly AUC:0.5732
[2023-08-26 18:00:20,592][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00089 | loss1:0.0298 loss2:0.7905 loss3:0.1263 | AUC:0.7482 Anomaly AUC:0.6473
[2023-08-26 18:00:20,645][main.py][line:114][INFO] Training completes in 2m 12s | best AUCAUC:0.7571 Anomaly AUC:0.6145

[2023-08-26 18:00:39,479][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00009 | loss1:0.0266 loss2:0.7435 loss3:0.1533 | AUC:0.7733 Anomaly AUC:0.6421
[2023-08-26 18:00:50,289][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00009 | loss1:0.0247 loss2:0.6621 loss3:0.1371 | AUC:0.7475 Anomaly AUC:0.6503
[2023-08-26 18:01:01,322][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00009 | loss1:0.0238 loss2:0.6380 loss3:0.1328 | AUC:0.7234 Anomaly AUC:0.6288
[2023-08-26 18:01:13,003][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00009 | loss1:0.0222 loss2:0.6073 loss3:0.1255 | AUC:0.7436 Anomaly AUC:0.6260
[2023-08-26 18:01:26,310][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00009 | loss1:0.0254 loss2:0.5997 loss3:0.1447 | AUC:0.7256 Anomaly AUC:0.6372
[2023-08-26 18:01:42,696][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00009 | loss1:0.0188 loss2:0.5775 loss3:0.1377 | AUC:0.7275 Anomaly AUC:0.6282
[2023-08-26 18:01:58,134][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00009 | loss1:0.0226 loss2:0.5809 loss3:0.1315 | AUC:0.7346 Anomaly AUC:0.6153
[2023-08-26 18:02:13,367][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00009 | loss1:0.0244 loss2:0.5680 loss3:0.1313 | AUC:0.7395 Anomaly AUC:0.6147
[2023-08-26 18:02:37,664][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00009 | loss1:0.0229 loss2:0.5489 loss3:0.1306 | AUC:0.7645 Anomaly AUC:0.6266
[2023-08-26 18:02:49,252][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00009 | loss1:0.0219 loss2:0.5355 loss3:0.1276 | AUC:0.7443 Anomaly AUC:0.6244
[2023-08-26 18:02:49,307][main.py][line:114][INFO] Training completes in 2m 29s | best AUCAUC:0.7733 Anomaly AUC:0.6421

[2023-08-26 18:03:03,689][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00050 | loss1:0.0458 loss2:0.7146 loss3:0.1462 | AUC:0.7796 Anomaly AUC:0.6431
[2023-08-26 18:03:14,649][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00050 | loss1:0.0241 loss2:0.6478 loss3:0.1292 | AUC:0.7513 Anomaly AUC:0.6412
[2023-08-26 18:03:42,037][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00050 | loss1:0.0288 loss2:0.6322 loss3:0.1237 | AUC:0.7581 Anomaly AUC:0.6420
[2023-08-26 18:03:56,202][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00050 | loss1:0.0266 loss2:0.6074 loss3:0.1202 | AUC:0.7544 Anomaly AUC:0.6411
[2023-08-26 18:04:09,044][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00049 | loss1:0.0263 loss2:0.5953 loss3:0.1236 | AUC:0.7530 Anomaly AUC:0.6428
[2023-08-26 18:04:20,146][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00049 | loss1:0.0265 loss2:0.5828 loss3:0.1170 | AUC:0.7491 Anomaly AUC:0.6488
[2023-08-26 18:04:32,989][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00048 | loss1:0.0281 loss2:0.5716 loss3:0.1173 | AUC:0.7507 Anomaly AUC:0.6391
[2023-08-26 18:04:50,542][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00048 | loss1:0.0274 loss2:0.5566 loss3:0.1168 | AUC:0.7465 Anomaly AUC:0.6431
[2023-08-26 18:05:03,718][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00047 | loss1:0.0239 loss2:0.5281 loss3:0.1139 | AUC:0.7516 Anomaly AUC:0.6435
[2023-08-26 18:05:18,458][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00047 | loss1:0.0174 loss2:0.5205 loss3:0.1157 | AUC:0.7540 Anomaly AUC:0.6438
[2023-08-26 18:05:18,512][main.py][line:114][INFO] Training completes in 2m 29s | best AUCAUC:0.7796 Anomaly AUC:0.6431

[2023-08-26 18:05:33,035][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00021 | loss1:0.0267 loss2:0.6458 loss3:0.1205 | AUC:0.7412 Anomaly AUC:0.6420
[2023-08-26 18:05:51,060][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00021 | loss1:0.0316 loss2:0.6357 loss3:0.1150 | AUC:0.7406 Anomaly AUC:0.6464
[2023-08-26 18:06:01,956][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00021 | loss1:0.0266 loss2:0.6208 loss3:0.1142 | AUC:0.7476 Anomaly AUC:0.6448
[2023-08-26 18:06:12,848][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00021 | loss1:0.0260 loss2:0.6109 loss3:0.1137 | AUC:0.7306 Anomaly AUC:0.6432
[2023-08-26 18:06:24,612][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00020 | loss1:0.0234 loss2:0.6030 loss3:0.1137 | AUC:0.7266 Anomaly AUC:0.6506
[2023-08-26 18:06:37,770][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00020 | loss1:0.0267 loss2:0.5993 loss3:0.1156 | AUC:0.7279 Anomaly AUC:0.6434
[2023-08-26 18:06:55,009][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00020 | loss1:0.0234 loss2:0.5882 loss3:0.1122 | AUC:0.7204 Anomaly AUC:0.6426
[2023-08-26 18:07:05,974][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00020 | loss1:0.0234 loss2:0.5823 loss3:0.1109 | AUC:0.7335 Anomaly AUC:0.6401
[2023-08-26 18:07:18,086][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00020 | loss1:0.0242 loss2:0.5918 loss3:0.1089 | AUC:0.7354 Anomaly AUC:0.6402
[2023-08-26 18:07:32,349][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00019 | loss1:0.0208 loss2:0.5626 loss3:0.1080 | AUC:0.7339 Anomaly AUC:0.6365
[2023-08-26 18:07:32,376][main.py][line:114][INFO] Training completes in 2m 14s | best AUCAUC:0.7476 Anomaly AUC:0.6448

[2023-08-26 18:07:46,277][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00007 | loss1:0.0267 loss2:0.5975 loss3:0.1191 | AUC:0.7338 Anomaly AUC:0.6485
[2023-08-26 18:07:57,361][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00007 | loss1:0.0241 loss2:0.5945 loss3:0.1184 | AUC:0.7418 Anomaly AUC:0.6424
[2023-08-26 18:08:08,377][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00007 | loss1:0.0186 loss2:0.5862 loss3:0.1177 | AUC:0.7482 Anomaly AUC:0.6405
[2023-08-26 18:08:20,444][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00007 | loss1:0.0180 loss2:0.5833 loss3:0.1170 | AUC:0.7424 Anomaly AUC:0.6389
[2023-08-26 18:08:51,276][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00007 | loss1:0.0203 loss2:0.5748 loss3:0.1155 | AUC:0.7489 Anomaly AUC:0.6407
[2023-08-26 18:09:03,444][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00007 | loss1:0.0165 loss2:0.5666 loss3:0.1156 | AUC:0.7476 Anomaly AUC:0.6429
[2023-08-26 18:09:26,145][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00007 | loss1:0.0222 loss2:0.5674 loss3:0.1180 | AUC:0.7431 Anomaly AUC:0.6404
[2023-08-26 18:09:37,091][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00007 | loss1:0.0160 loss2:0.5560 loss3:0.1174 | AUC:0.7390 Anomaly AUC:0.6399
[2023-08-26 18:09:51,559][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00007 | loss1:0.0151 loss2:0.5537 loss3:0.1173 | AUC:0.7361 Anomaly AUC:0.6404
[2023-08-26 18:10:05,090][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00007 | loss1:0.0158 loss2:0.5497 loss3:0.1183 | AUC:0.7360 Anomaly AUC:0.6412
[2023-08-26 18:10:05,140][main.py][line:114][INFO] Training completes in 2m 33s | best AUCAUC:0.7489 Anomaly AUC:0.6407

[2023-08-26 18:10:20,090][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00014 | loss1:0.0213 loss2:0.5724 loss3:0.1150 | AUC:0.6653 Anomaly AUC:0.6330
[2023-08-26 18:10:31,014][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00014 | loss1:0.0249 loss2:0.5786 loss3:0.1217 | AUC:0.7060 Anomaly AUC:0.6410
[2023-08-26 18:10:42,963][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00014 | loss1:0.0239 loss2:0.5673 loss3:0.1137 | AUC:0.7095 Anomaly AUC:0.6404
[2023-08-26 18:11:00,939][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00014 | loss1:0.0165 loss2:0.5636 loss3:0.1136 | AUC:0.7098 Anomaly AUC:0.6366
[2023-08-26 18:11:14,720][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00014 | loss1:0.0163 loss2:0.5498 loss3:0.1125 | AUC:0.6993 Anomaly AUC:0.6298
[2023-08-26 18:11:25,713][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00014 | loss1:0.0185 loss2:0.5473 loss3:0.1139 | AUC:0.7214 Anomaly AUC:0.6336
[2023-08-26 18:13:43,110][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 18:13:43,232][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 18:13:43,232][main.py][line:169][INFO] Training Mode
[2023-08-26 18:18:40,299][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 18:18:40,420][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 18:18:40,420][main.py][line:169][INFO] Training Mode
[2023-08-26 18:19:51,356][main.py][line:122][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.8, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 18:19:51,477][main.py][line:166][INFO] total params:9.6689M
[2023-08-26 18:19:51,477][main.py][line:169][INFO] Training Mode
[2023-08-26 18:20:11,498][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00020 | loss1:0.6685 loss2:1.2951 loss3:0.3817 | AUC:0.7970 Anomaly AUC:0.6247
[2023-08-26 18:20:22,549][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00020 | loss1:0.4257 loss2:1.1278 loss3:0.3809 | AUC:0.8126 Anomaly AUC:0.6408
[2023-08-26 18:20:33,074][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00020 | loss1:0.1385 loss2:0.9629 loss3:0.4401 | AUC:0.8020 Anomaly AUC:0.6661
[2023-08-26 18:20:43,686][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00020 | loss1:0.0471 loss2:0.8708 loss3:0.4074 | AUC:0.7698 Anomaly AUC:0.6162
[2023-08-26 18:20:55,424][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00020 | loss1:0.0825 loss2:0.8678 loss3:0.4160 | AUC:0.8022 Anomaly AUC:0.6426
[2023-08-26 18:21:07,497][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00020 | loss1:0.0398 loss2:0.8272 loss3:0.3626 | AUC:0.7921 Anomaly AUC:0.6472
[2023-08-26 18:21:20,515][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00020 | loss1:0.0327 loss2:0.8036 loss3:0.3292 | AUC:0.7661 Anomaly AUC:0.6327
[2023-08-26 18:21:35,229][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00020 | loss1:0.0374 loss2:0.7874 loss3:0.3186 | AUC:0.7484 Anomaly AUC:0.6434
[2023-08-26 18:21:47,982][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00020 | loss1:0.0359 loss2:0.7712 loss3:0.2327 | AUC:0.7463 Anomaly AUC:0.6269
[2023-08-26 18:22:02,295][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00020 | loss1:0.0636 loss2:0.8017 loss3:0.3102 | AUC:0.7100 Anomaly AUC:0.6058
[2023-08-26 18:22:02,351][main.py][line:114][INFO] Training completes in 2m 11s | best AUCAUC:0.8126 Anomaly AUC:0.6408

[2023-08-26 18:22:15,279][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00040 | loss1:0.5269 loss2:1.2048 loss3:0.3693 | AUC:0.8034 Anomaly AUC:0.6037
[2023-08-26 18:22:29,502][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00040 | loss1:0.2940 loss2:1.0289 loss3:0.3079 | AUC:0.7998 Anomaly AUC:0.6171
[2023-08-26 18:22:42,281][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00040 | loss1:0.0823 loss2:0.8962 loss3:0.3280 | AUC:0.7984 Anomaly AUC:0.6397
[2023-08-26 18:22:54,765][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00040 | loss1:0.0886 loss2:0.8833 loss3:0.3463 | AUC:0.7702 Anomaly AUC:0.6387
[2023-08-26 18:23:06,235][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00040 | loss1:0.1300 loss2:0.9309 loss3:0.2549 | AUC:0.7667 Anomaly AUC:0.6440
[2023-08-26 18:23:17,155][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00040 | loss1:0.0617 loss2:0.8594 loss3:0.2295 | AUC:0.7979 Anomaly AUC:0.6545
[2023-08-26 18:23:28,040][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00040 | loss1:0.0513 loss2:0.8376 loss3:0.1748 | AUC:0.7058 Anomaly AUC:0.6455
[2023-08-26 18:23:39,989][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00040 | loss1:0.0492 loss2:0.8244 loss3:0.1405 | AUC:0.7633 Anomaly AUC:0.6511
[2023-08-26 18:23:52,353][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00040 | loss1:0.0367 loss2:0.7877 loss3:0.1186 | AUC:0.7304 Anomaly AUC:0.6472
[2023-08-26 18:24:04,849][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00040 | loss1:0.0345 loss2:0.7573 loss3:0.1067 | AUC:0.7516 Anomaly AUC:0.6500
[2023-08-26 18:24:04,899][main.py][line:114][INFO] Training completes in 2m 2s | best AUCAUC:0.8034 Anomaly AUC:0.6037

[2023-08-26 18:24:17,285][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00100 | loss1:0.5666 loss2:1.2206 loss3:0.3542 | AUC:0.8087 Anomaly AUC:0.6136
[2023-08-26 18:24:29,850][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00100 | loss1:0.3381 loss2:1.0695 loss3:0.2393 | AUC:0.7937 Anomaly AUC:0.6171
[2023-08-26 18:24:42,219][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00100 | loss1:0.2897 loss2:1.0209 loss3:0.1789 | AUC:0.8037 Anomaly AUC:0.6161
[2023-08-26 18:24:53,768][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00100 | loss1:0.2474 loss2:0.9685 loss3:0.1542 | AUC:0.8116 Anomaly AUC:0.6282
[2023-08-26 18:25:07,808][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00100 | loss1:0.2527 loss2:0.9699 loss3:0.1509 | AUC:0.8067 Anomaly AUC:0.6227
[2023-08-26 18:25:20,227][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00100 | loss1:0.2133 loss2:0.9488 loss3:0.1342 | AUC:0.8058 Anomaly AUC:0.6365
[2023-08-26 18:25:32,679][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00100 | loss1:0.1765 loss2:0.9247 loss3:0.1210 | AUC:0.7958 Anomaly AUC:0.6417
[2023-08-26 18:25:45,121][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00100 | loss1:0.1643 loss2:0.9022 loss3:0.1112 | AUC:0.8048 Anomaly AUC:0.6417
[2023-08-26 18:25:57,567][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00100 | loss1:0.1646 loss2:0.9058 loss3:0.1019 | AUC:0.8042 Anomaly AUC:0.6188
[2023-08-26 18:26:10,194][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00100 | loss1:0.1287 loss2:0.8748 loss3:0.0913 | AUC:0.8016 Anomaly AUC:0.6242
[2023-08-26 18:26:10,245][main.py][line:114][INFO] Training completes in 2m 5s | best AUCAUC:0.8116 Anomaly AUC:0.6282

[2023-08-26 18:26:24,155][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00020 | loss1:0.2925 loss2:0.9869 loss3:0.1701 | AUC:0.8142 Anomaly AUC:0.6348
[2023-08-26 18:26:35,140][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00020 | loss1:0.1620 loss2:0.9160 loss3:0.1302 | AUC:0.8088 Anomaly AUC:0.6319
[2023-08-26 18:26:45,979][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00020 | loss1:0.1411 loss2:0.8731 loss3:0.1075 | AUC:0.8161 Anomaly AUC:0.6301
[2023-08-26 18:26:57,640][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00020 | loss1:0.1220 loss2:0.8417 loss3:0.0922 | AUC:0.8080 Anomaly AUC:0.6440
[2023-08-26 18:27:10,466][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00020 | loss1:0.1527 loss2:0.8434 loss3:0.0886 | AUC:0.8224 Anomaly AUC:0.6466
[2023-08-26 18:27:21,985][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00020 | loss1:0.1217 loss2:0.8053 loss3:0.0811 | AUC:0.8116 Anomaly AUC:0.6678
[2023-08-26 18:27:32,837][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00020 | loss1:0.0904 loss2:0.7817 loss3:0.0691 | AUC:0.8020 Anomaly AUC:0.6515
[2023-08-26 18:27:43,814][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00020 | loss1:0.0861 loss2:0.7583 loss3:0.0667 | AUC:0.8067 Anomaly AUC:0.6743
[2023-08-26 18:27:56,917][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00020 | loss1:0.0823 loss2:0.7463 loss3:0.0573 | AUC:0.8090 Anomaly AUC:0.6508
[2023-08-26 18:28:07,803][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00020 | loss1:0.0494 loss2:0.7111 loss3:0.0523 | AUC:0.8025 Anomaly AUC:0.6612
[2023-08-26 18:28:07,829][main.py][line:114][INFO] Training completes in 1m 58s | best AUCAUC:0.8224 Anomaly AUC:0.6466

[2023-08-26 18:28:18,671][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00080 | loss1:0.4159 loss2:1.1583 loss3:0.1538 | AUC:0.8127 Anomaly AUC:0.6169
[2023-08-26 18:28:30,592][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00080 | loss1:0.2072 loss2:0.9921 loss3:0.1431 | AUC:0.8010 Anomaly AUC:0.6194
[2023-08-26 18:28:41,980][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00080 | loss1:0.1629 loss2:0.9631 loss3:0.1226 | AUC:0.8083 Anomaly AUC:0.6243
[2023-08-26 18:28:52,859][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00080 | loss1:0.1443 loss2:0.9335 loss3:0.1310 | AUC:0.8207 Anomaly AUC:0.6365
[2023-08-26 18:29:03,785][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00080 | loss1:0.1429 loss2:0.9288 loss3:0.1305 | AUC:0.8147 Anomaly AUC:0.6456
[2023-08-26 18:29:19,100][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00080 | loss1:0.1755 loss2:0.9460 loss3:0.1320 | AUC:0.8114 Anomaly AUC:0.6469
[2023-08-26 18:29:30,859][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00080 | loss1:0.1188 loss2:0.9024 loss3:0.1184 | AUC:0.8207 Anomaly AUC:0.6490
[2023-08-26 18:29:44,986][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00080 | loss1:0.1095 loss2:0.8947 loss3:0.1129 | AUC:0.8082 Anomaly AUC:0.6391
[2023-08-26 18:29:57,442][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00080 | loss1:0.1008 loss2:0.8795 loss3:0.1086 | AUC:0.8078 Anomaly AUC:0.6578
[2023-08-26 18:30:09,514][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00080 | loss1:0.1565 loss2:0.9261 loss3:0.1180 | AUC:0.8183 Anomaly AUC:0.6442
[2023-08-26 18:30:09,567][main.py][line:114][INFO] Training completes in 2m 2s | best AUCAUC:0.8207 Anomaly AUC:0.6365

[2023-08-26 18:30:21,915][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00010 | loss1:0.1228 loss2:0.9144 loss3:0.1297 | AUC:0.8185 Anomaly AUC:0.6375
[2023-08-26 18:30:34,189][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00010 | loss1:0.0624 loss2:0.8713 loss3:0.1047 | AUC:0.8111 Anomaly AUC:0.6398
[2023-08-26 18:30:46,046][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00010 | loss1:0.0491 loss2:0.8429 loss3:0.0881 | AUC:0.8097 Anomaly AUC:0.6437
[2023-08-26 18:31:00,213][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00010 | loss1:0.0612 loss2:0.8318 loss3:0.0812 | AUC:0.8114 Anomaly AUC:0.6569
[2023-08-26 18:31:12,360][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00010 | loss1:0.0443 loss2:0.8092 loss3:0.0764 | AUC:0.8020 Anomaly AUC:0.6544
[2023-08-26 18:31:25,282][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00010 | loss1:0.0366 loss2:0.7925 loss3:0.0700 | AUC:0.8094 Anomaly AUC:0.6512
[2023-08-26 18:31:39,491][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00010 | loss1:0.0223 loss2:0.7641 loss3:0.0637 | AUC:0.8167 Anomaly AUC:0.6699
[2023-08-26 18:31:51,912][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00010 | loss1:0.0346 loss2:0.7652 loss3:0.0594 | AUC:0.8141 Anomaly AUC:0.6577
[2023-08-26 18:32:04,632][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00010 | loss1:0.0673 loss2:0.7840 loss3:0.0810 | AUC:0.8115 Anomaly AUC:0.6639
[2023-08-26 18:32:17,282][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00010 | loss1:0.0239 loss2:0.7446 loss3:0.0590 | AUC:0.8030 Anomaly AUC:0.6488
[2023-08-26 18:32:17,333][main.py][line:114][INFO] Training completes in 2m 8s | best AUCAUC:0.8185 Anomaly AUC:0.6375

[2023-08-26 18:32:31,896][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00010 | loss1:0.0711 loss2:0.8654 loss3:0.1151 | AUC:0.8116 Anomaly AUC:0.6333
[2023-08-26 18:32:43,275][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00010 | loss1:0.0602 loss2:0.8242 loss3:0.1052 | AUC:0.8097 Anomaly AUC:0.6292
[2023-08-26 18:32:54,102][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00010 | loss1:0.0432 loss2:0.7858 loss3:0.0932 | AUC:0.8110 Anomaly AUC:0.6268
[2023-08-26 18:33:06,434][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00010 | loss1:0.0377 loss2:0.7677 loss3:0.0861 | AUC:0.8132 Anomaly AUC:0.6245
[2023-08-26 18:33:20,411][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00010 | loss1:0.0346 loss2:0.7502 loss3:0.0897 | AUC:0.8113 Anomaly AUC:0.6325
[2023-08-26 18:33:34,922][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00010 | loss1:0.0267 loss2:0.7336 loss3:0.0786 | AUC:0.8164 Anomaly AUC:0.6412
[2023-08-26 18:33:47,281][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00010 | loss1:0.0205 loss2:0.7155 loss3:0.0743 | AUC:0.8170 Anomaly AUC:0.6590
[2023-08-26 18:34:00,066][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00010 | loss1:0.0254 loss2:0.7096 loss3:0.0841 | AUC:0.8195 Anomaly AUC:0.6492
[2023-08-26 18:34:14,761][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00010 | loss1:0.0166 loss2:0.6919 loss3:0.0702 | AUC:0.8117 Anomaly AUC:0.6570
[2023-08-26 18:34:29,144][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00010 | loss1:0.0140 loss2:0.6710 loss3:0.0646 | AUC:0.8070 Anomaly AUC:0.6514
[2023-08-26 18:34:29,197][main.py][line:114][INFO] Training completes in 2m 12s | best AUCAUC:0.8195 Anomaly AUC:0.6492

[2023-08-26 18:34:41,620][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00020 | loss1:0.2567 loss2:0.8972 loss3:0.2385 | AUC:0.8075 Anomaly AUC:0.6448
[2023-08-26 18:34:54,322][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00020 | loss1:0.0817 loss2:0.7516 loss3:0.1320 | AUC:0.8135 Anomaly AUC:0.6417
[2023-08-26 18:35:06,638][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00020 | loss1:0.0657 loss2:0.7176 loss3:0.1083 | AUC:0.8186 Anomaly AUC:0.6621
[2023-08-26 18:35:21,066][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00020 | loss1:0.0626 loss2:0.7106 loss3:0.0871 | AUC:0.8082 Anomaly AUC:0.6524
[2023-08-26 18:35:33,389][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00020 | loss1:0.0418 loss2:0.6851 loss3:0.0739 | AUC:0.7996 Anomaly AUC:0.6660
[2023-08-26 18:35:46,189][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00020 | loss1:0.0623 loss2:0.6913 loss3:0.0766 | AUC:0.8184 Anomaly AUC:0.6619
[2023-08-26 18:35:58,780][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00020 | loss1:0.0477 loss2:0.6776 loss3:0.0747 | AUC:0.8186 Anomaly AUC:0.6692
[2023-08-26 18:36:13,286][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00020 | loss1:0.0336 loss2:0.6622 loss3:0.0680 | AUC:0.7963 Anomaly AUC:0.6487
[2023-08-26 18:36:25,897][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00020 | loss1:0.0523 loss2:0.6577 loss3:0.0662 | AUC:0.8045 Anomaly AUC:0.6423
[2023-08-26 18:36:38,191][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00020 | loss1:0.0363 loss2:0.6441 loss3:0.0640 | AUC:0.8103 Anomaly AUC:0.6567
[2023-08-26 18:36:38,242][main.py][line:114][INFO] Training completes in 2m 9s | best AUCAUC:0.8186 Anomaly AUC:0.6692

[2023-08-26 18:36:50,644][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00010 | loss1:0.1673 loss2:0.7618 loss3:0.1539 | AUC:0.8022 Anomaly AUC:0.6178
[2023-08-26 18:37:03,283][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00010 | loss1:0.0417 loss2:0.6710 loss3:0.0814 | AUC:0.8061 Anomaly AUC:0.6278
[2023-08-26 18:37:17,605][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00010 | loss1:0.0233 loss2:0.6490 loss3:0.0650 | AUC:0.8181 Anomaly AUC:0.6495
[2023-08-26 18:37:30,125][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00010 | loss1:0.0168 loss2:0.6370 loss3:0.0564 | AUC:0.8190 Anomaly AUC:0.6422
[2023-08-26 18:37:42,196][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00010 | loss1:0.0157 loss2:0.6370 loss3:0.0559 | AUC:0.8099 Anomaly AUC:0.6303
[2023-08-26 18:37:53,885][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00010 | loss1:0.0071 loss2:0.6186 loss3:0.0494 | AUC:0.8095 Anomaly AUC:0.6402
[2023-08-26 18:38:07,069][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00010 | loss1:0.0082 loss2:0.6180 loss3:0.0501 | AUC:0.8217 Anomaly AUC:0.6645
[2023-08-26 18:38:19,789][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00010 | loss1:0.0133 loss2:0.6156 loss3:0.0511 | AUC:0.8201 Anomaly AUC:0.6582
[2023-08-26 18:38:33,504][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00010 | loss1:0.0189 loss2:0.6161 loss3:0.0567 | AUC:0.8118 Anomaly AUC:0.6620
[2023-08-26 18:38:44,981][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00010 | loss1:0.0294 loss2:0.6162 loss3:0.0529 | AUC:0.8122 Anomaly AUC:0.6611
[2023-08-26 18:38:45,008][main.py][line:114][INFO] Training completes in 2m 7s | best AUCAUC:0.8217 Anomaly AUC:0.6645

[2023-08-26 18:38:58,647][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00080 | loss1:0.3267 loss2:1.0560 loss3:0.0844 | AUC:0.8070 Anomaly AUC:0.6197
[2023-08-26 18:39:13,223][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00080 | loss1:0.0733 loss2:0.7965 loss3:0.0438 | AUC:0.8108 Anomaly AUC:0.6497
[2023-08-26 18:39:25,449][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00080 | loss1:0.0456 loss2:0.7421 loss3:0.0379 | AUC:0.7884 Anomaly AUC:0.6538
[2023-08-26 18:39:38,364][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00080 | loss1:0.1039 loss2:0.7754 loss3:0.0453 | AUC:0.8215 Anomaly AUC:0.6423
[2023-08-26 18:39:50,152][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00080 | loss1:0.0453 loss2:0.7231 loss3:0.0384 | AUC:0.7908 Anomaly AUC:0.6468
[2023-08-26 18:40:03,641][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00080 | loss1:0.0633 loss2:0.7291 loss3:0.0407 | AUC:0.8211 Anomaly AUC:0.6461
[2023-08-26 18:40:15,673][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00080 | loss1:0.0404 loss2:0.6929 loss3:0.0316 | AUC:0.7918 Anomaly AUC:0.6669
[2023-08-26 18:40:28,067][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00080 | loss1:0.1199 loss2:0.7754 loss3:0.0458 | AUC:0.8103 Anomaly AUC:0.6782
[2023-08-26 18:40:39,901][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00080 | loss1:0.0384 loss2:0.6857 loss3:0.0250 | AUC:0.8104 Anomaly AUC:0.6603
[2023-08-26 18:40:53,311][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00080 | loss1:0.0266 loss2:0.6439 loss3:0.0206 | AUC:0.8159 Anomaly AUC:0.6665
[2023-08-26 18:40:53,361][main.py][line:114][INFO] Training completes in 2m 8s | best AUCAUC:0.8215 Anomaly AUC:0.6423

[2023-08-26 18:41:05,766][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00050 | loss1:0.0744 loss2:0.7386 loss3:0.0567 | AUC:0.8005 Anomaly AUC:0.6422
[2023-08-26 18:41:17,544][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00050 | loss1:0.0350 loss2:0.6658 loss3:0.0483 | AUC:0.8016 Anomaly AUC:0.6447
[2023-08-26 18:41:29,497][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00050 | loss1:0.0399 loss2:0.6464 loss3:0.0508 | AUC:0.7903 Anomaly AUC:0.6415
[2023-08-26 18:41:42,992][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00050 | loss1:0.0367 loss2:0.6379 loss3:0.0553 | AUC:0.7946 Anomaly AUC:0.6241
[2023-08-26 18:41:53,871][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00050 | loss1:0.0266 loss2:0.6106 loss3:0.0541 | AUC:0.7994 Anomaly AUC:0.6550
[2023-08-26 18:42:04,765][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00050 | loss1:0.0393 loss2:0.5716 loss3:0.0594 | AUC:0.7932 Anomaly AUC:0.6396
[2023-08-26 18:42:15,760][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00050 | loss1:0.0478 loss2:0.5943 loss3:0.0609 | AUC:0.8142 Anomaly AUC:0.6518
[2023-08-26 18:42:27,341][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00050 | loss1:0.0452 loss2:0.5733 loss3:0.0584 | AUC:0.8052 Anomaly AUC:0.6351
[2023-08-26 18:42:40,049][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00050 | loss1:0.0260 loss2:0.5663 loss3:0.0727 | AUC:0.8126 Anomaly AUC:0.6607
[2023-08-26 18:42:54,426][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00050 | loss1:0.0160 loss2:0.5250 loss3:0.0498 | AUC:0.8176 Anomaly AUC:0.6566
[2023-08-26 18:42:54,477][main.py][line:114][INFO] Training completes in 2m 1s | best AUCAUC:0.8176 Anomaly AUC:0.6566

[2023-08-26 18:43:07,072][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00030 | loss1:0.0808 loss2:0.5531 loss3:0.0585 | AUC:0.7910 Anomaly AUC:0.6626
[2023-08-26 18:43:20,606][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00030 | loss1:0.0100 loss2:0.4790 loss3:0.0417 | AUC:0.8060 Anomaly AUC:0.6645
[2023-08-26 18:43:31,447][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00030 | loss1:0.0051 loss2:0.4484 loss3:0.0348 | AUC:0.8007 Anomaly AUC:0.6554
[2023-08-26 18:43:42,444][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00030 | loss1:0.0170 loss2:0.4454 loss3:0.0375 | AUC:0.7920 Anomaly AUC:0.6767
[2023-08-26 18:43:54,242][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00030 | loss1:0.0255 loss2:0.4535 loss3:0.0340 | AUC:0.8205 Anomaly AUC:0.6633
[2023-08-26 18:44:06,274][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00030 | loss1:0.0075 loss2:0.4269 loss3:0.0355 | AUC:0.8118 Anomaly AUC:0.6645
[2023-08-26 18:44:18,643][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00030 | loss1:0.0270 loss2:0.4093 loss3:0.0376 | AUC:0.8152 Anomaly AUC:0.6596
[2023-08-26 18:44:31,420][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00030 | loss1:0.0320 loss2:0.4448 loss3:0.0438 | AUC:0.8099 Anomaly AUC:0.6448
[2023-08-26 18:44:45,846][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00030 | loss1:0.0147 loss2:0.4298 loss3:0.0349 | AUC:0.8108 Anomaly AUC:0.6548
[2023-08-26 18:44:57,436][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00030 | loss1:0.0129 loss2:0.3907 loss3:0.0283 | AUC:0.8168 Anomaly AUC:0.6640
[2023-08-26 18:44:57,468][main.py][line:114][INFO] Training completes in 2m 3s | best AUCAUC:0.8205 Anomaly AUC:0.6633

[2023-08-26 18:45:11,321][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00040 | loss1:0.0976 loss2:0.6442 loss3:0.0638 | AUC:0.8186 Anomaly AUC:0.6772
[2023-08-26 18:45:23,757][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00040 | loss1:0.0144 loss2:0.4750 loss3:0.0477 | AUC:0.8168 Anomaly AUC:0.6504
[2023-08-26 18:45:35,082][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00040 | loss1:0.0058 loss2:0.4012 loss3:0.0376 | AUC:0.8044 Anomaly AUC:0.6824
[2023-08-26 18:45:46,061][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00040 | loss1:0.0030 loss2:0.3829 loss3:0.0439 | AUC:0.8158 Anomaly AUC:0.6601
[2023-08-26 18:45:57,008][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00040 | loss1:0.0024 loss2:0.3156 loss3:0.0403 | AUC:0.8115 Anomaly AUC:0.6500
[2023-08-26 18:46:10,537][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00040 | loss1:0.0040 loss2:0.3806 loss3:0.0491 | AUC:0.8126 Anomaly AUC:0.6494
[2023-08-26 18:46:23,394][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00040 | loss1:0.0020 loss2:0.3557 loss3:0.0427 | AUC:0.8102 Anomaly AUC:0.6604
[2023-08-26 18:46:35,703][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00040 | loss1:0.0010 loss2:0.3274 loss3:0.0532 | AUC:0.8166 Anomaly AUC:0.6664
[2023-08-26 18:46:52,815][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00040 | loss1:0.0186 loss2:0.3528 loss3:0.0629 | AUC:0.8152 Anomaly AUC:0.6657
[2023-08-26 18:47:05,416][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00040 | loss1:0.0532 loss2:0.4436 loss3:0.0780 | AUC:0.8211 Anomaly AUC:0.6498
[2023-08-26 18:47:05,468][main.py][line:114][INFO] Training completes in 2m 8s | best AUCAUC:0.8211 Anomaly AUC:0.6498

[2023-08-26 18:47:19,747][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00060 | loss1:0.0769 loss2:0.5891 loss3:0.0761 | AUC:0.8097 Anomaly AUC:0.6576
[2023-08-26 18:47:31,953][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00060 | loss1:0.0109 loss2:0.4146 loss3:0.0489 | AUC:0.8088 Anomaly AUC:0.6661
[2023-08-26 18:47:44,285][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00060 | loss1:0.0038 loss2:0.3593 loss3:0.0303 | AUC:0.8103 Anomaly AUC:0.6659
[2023-08-26 18:47:56,039][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00060 | loss1:0.0030 loss2:0.3277 loss3:0.0249 | AUC:0.8167 Anomaly AUC:0.6672
[2023-08-26 18:48:10,104][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00060 | loss1:0.0897 loss2:0.4042 loss3:0.0390 | AUC:0.7826 Anomaly AUC:0.6305
[2023-08-26 18:48:23,992][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00060 | loss1:0.0410 loss2:0.5574 loss3:0.0547 | AUC:0.8020 Anomaly AUC:0.6539
[2023-08-26 18:48:36,682][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00060 | loss1:0.0235 loss2:0.4265 loss3:0.0283 | AUC:0.8053 Anomaly AUC:0.6557
[2023-08-26 18:48:50,223][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00060 | loss1:0.0244 loss2:0.2652 loss3:0.0281 | AUC:0.8085 Anomaly AUC:0.6414
[2023-08-26 18:49:02,583][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00060 | loss1:0.0240 loss2:0.4169 loss3:0.0228 | AUC:0.8159 Anomaly AUC:0.6497
[2023-08-26 18:49:14,348][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00060 | loss1:0.0361 loss2:0.3897 loss3:0.0242 | AUC:0.7964 Anomaly AUC:0.6482
[2023-08-26 18:49:14,376][main.py][line:114][INFO] Training completes in 2m 9s | best AUCAUC:0.8167 Anomaly AUC:0.6672

[2023-08-26 18:49:27,892][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00010 | loss1:0.0034 loss2:0.2881 loss3:0.0273 | AUC:0.8111 Anomaly AUC:0.6648
[2023-08-26 18:49:40,036][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00010 | loss1:0.0009 loss2:0.2602 loss3:0.0248 | AUC:0.8138 Anomaly AUC:0.6634
[2023-08-26 18:49:52,273][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00010 | loss1:0.0007 loss2:0.2438 loss3:0.0242 | AUC:0.8078 Anomaly AUC:0.6615
[2023-08-26 18:50:04,579][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00010 | loss1:0.0007 loss2:0.2204 loss3:0.0244 | AUC:0.8108 Anomaly AUC:0.6640
[2023-08-26 18:50:16,354][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00010 | loss1:0.0005 loss2:0.2149 loss3:0.0261 | AUC:0.8156 Anomaly AUC:0.6661
[2023-08-26 18:50:29,206][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00010 | loss1:0.0005 loss2:0.2066 loss3:0.0252 | AUC:0.8093 Anomaly AUC:0.6641
[2023-08-26 18:50:43,001][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00010 | loss1:0.0006 loss2:0.2001 loss3:0.0284 | AUC:0.8053 Anomaly AUC:0.6647
[2023-08-26 18:50:55,403][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00010 | loss1:0.0022 loss2:0.2076 loss3:0.0315 | AUC:0.8135 Anomaly AUC:0.6724
[2023-08-26 18:51:08,327][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00010 | loss1:0.0045 loss2:0.2098 loss3:0.0341 | AUC:0.8103 Anomaly AUC:0.6734
[2023-08-26 18:51:22,291][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00010 | loss1:0.0007 loss2:0.1930 loss3:0.0304 | AUC:0.8069 Anomaly AUC:0.6686
[2023-08-26 18:51:22,341][main.py][line:114][INFO] Training completes in 2m 8s | best AUCAUC:0.8156 Anomaly AUC:0.6661

[2023-08-26 18:51:34,124][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00030 | loss1:0.0230 loss2:0.4468 loss3:0.0493 | AUC:0.8116 Anomaly AUC:0.6760
[2023-08-26 18:51:48,125][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00030 | loss1:0.0012 loss2:0.3282 loss3:0.0297 | AUC:0.8118 Anomaly AUC:0.6690
[2023-08-26 18:52:02,553][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00030 | loss1:0.0003 loss2:0.2542 loss3:0.0174 | AUC:0.8086 Anomaly AUC:0.6627
[2023-08-26 18:52:17,947][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00030 | loss1:0.0061 loss2:0.2116 loss3:0.0222 | AUC:0.8062 Anomaly AUC:0.6606
[2023-08-26 18:52:28,892][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00030 | loss1:0.0049 loss2:0.3031 loss3:0.0254 | AUC:0.7749 Anomaly AUC:0.6653
[2023-08-26 18:52:39,780][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00030 | loss1:0.0261 loss2:0.3624 loss3:0.0278 | AUC:0.8073 Anomaly AUC:0.6625
[2023-08-26 18:52:51,849][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00030 | loss1:0.0203 loss2:0.5760 loss3:0.0225 | AUC:0.8147 Anomaly AUC:0.6446
[2023-08-26 18:53:05,390][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00030 | loss1:0.0137 loss2:0.4275 loss3:0.0256 | AUC:0.8083 Anomaly AUC:0.6376
[2023-08-26 18:53:17,032][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00030 | loss1:0.0199 loss2:0.2328 loss3:0.0316 | AUC:0.8098 Anomaly AUC:0.6450
[2023-08-26 18:53:29,470][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00030 | loss1:0.0132 loss2:0.1689 loss3:0.0198 | AUC:0.7985 Anomaly AUC:0.6337
[2023-08-26 18:53:29,526][main.py][line:114][INFO] Training completes in 2m 7s | best AUCAUC:0.8147 Anomaly AUC:0.6446

[2023-08-26 18:53:41,853][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00030 | loss1:0.0720 loss2:0.4036 loss3:0.0435 | AUC:0.8118 Anomaly AUC:0.6569
[2023-08-26 18:53:55,488][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00030 | loss1:0.0022 loss2:0.2962 loss3:0.0242 | AUC:0.8042 Anomaly AUC:0.6652
[2023-08-26 18:54:09,128][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00030 | loss1:0.0007 loss2:0.1888 loss3:0.0173 | AUC:0.8096 Anomaly AUC:0.6636
[2023-08-26 18:54:21,344][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00030 | loss1:0.0029 loss2:0.2195 loss3:0.0149 | AUC:0.7962 Anomaly AUC:0.6707
[2023-08-26 18:54:34,214][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00030 | loss1:0.0033 loss2:0.2425 loss3:0.0152 | AUC:0.7898 Anomaly AUC:0.6624
[2023-08-26 18:54:48,351][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00030 | loss1:0.0206 loss2:0.2739 loss3:0.0214 | AUC:0.8034 Anomaly AUC:0.6408
[2023-08-26 18:55:00,728][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00030 | loss1:0.0121 loss2:0.2610 loss3:0.0167 | AUC:0.7819 Anomaly AUC:0.6535
[2023-08-26 18:55:13,446][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00030 | loss1:0.0809 loss2:0.3916 loss3:0.0361 | AUC:0.8090 Anomaly AUC:0.6599
[2023-08-26 18:55:25,854][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00030 | loss1:0.0165 loss2:0.3262 loss3:0.0308 | AUC:0.8042 Anomaly AUC:0.6762
[2023-08-26 18:55:39,692][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00030 | loss1:0.0104 loss2:0.2423 loss3:0.0150 | AUC:0.7811 Anomaly AUC:0.6733
[2023-08-26 18:55:39,719][main.py][line:114][INFO] Training completes in 2m 10s | best AUCAUC:0.8118 Anomaly AUC:0.6569

[2023-08-26 18:55:53,114][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00060 | loss1:0.0304 loss2:0.4964 loss3:0.0382 | AUC:0.7965 Anomaly AUC:0.6397
[2023-08-26 18:56:05,906][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00060 | loss1:0.0142 loss2:0.3023 loss3:0.0374 | AUC:0.8092 Anomaly AUC:0.6619
[2023-08-26 18:56:17,842][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00060 | loss1:0.0039 loss2:0.3096 loss3:0.0301 | AUC:0.8117 Anomaly AUC:0.6578
[2023-08-26 18:56:29,980][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00060 | loss1:0.0031 loss2:0.2550 loss3:0.0318 | AUC:0.8009 Anomaly AUC:0.6633
[2023-08-26 18:56:42,702][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00060 | loss1:0.0033 loss2:0.2319 loss3:0.0365 | AUC:0.8048 Anomaly AUC:0.6467
[2023-08-26 18:56:54,163][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00060 | loss1:0.0162 loss2:0.2436 loss3:0.0345 | AUC:0.8123 Anomaly AUC:0.6618
[2023-08-26 18:57:05,071][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00060 | loss1:0.0214 loss2:0.2275 loss3:0.0497 | AUC:0.8095 Anomaly AUC:0.6571
[2023-08-26 18:57:16,042][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00060 | loss1:0.0446 loss2:0.2806 loss3:0.0623 | AUC:0.8167 Anomaly AUC:0.6731
[2023-08-26 18:57:29,538][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00060 | loss1:0.0502 loss2:0.2871 loss3:0.1918 | AUC:0.8086 Anomaly AUC:0.6849
[2023-08-26 18:57:41,737][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00060 | loss1:0.0135 loss2:0.1662 loss3:0.0593 | AUC:0.8115 Anomaly AUC:0.6743
[2023-08-26 18:57:41,811][main.py][line:114][INFO] Training completes in 2m 2s | best AUCAUC:0.8167 Anomaly AUC:0.6731

[2023-08-26 18:57:53,527][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00020 | loss1:0.0136 loss2:0.2037 loss3:0.0474 | AUC:0.8082 Anomaly AUC:0.6669
[2023-08-26 18:58:06,773][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00020 | loss1:0.0016 loss2:0.1549 loss3:0.0349 | AUC:0.8088 Anomaly AUC:0.6670
[2023-08-26 18:58:19,154][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00020 | loss1:0.0012 loss2:0.1181 loss3:0.0355 | AUC:0.8104 Anomaly AUC:0.6657
[2023-08-26 18:58:32,056][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00020 | loss1:0.0012 loss2:0.1141 loss3:0.0317 | AUC:0.8073 Anomaly AUC:0.6688
[2023-08-26 18:58:46,207][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00020 | loss1:0.0036 loss2:0.1267 loss3:0.0353 | AUC:0.8060 Anomaly AUC:0.6640
[2023-08-26 18:58:58,026][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00020 | loss1:0.0010 loss2:0.1188 loss3:0.0392 | AUC:0.8035 Anomaly AUC:0.6628
[2023-08-26 18:59:10,717][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00020 | loss1:0.0006 loss2:0.1037 loss3:0.0324 | AUC:0.8016 Anomaly AUC:0.6632
[2023-08-26 18:59:24,082][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00020 | loss1:0.0006 loss2:0.0921 loss3:0.0294 | AUC:0.8005 Anomaly AUC:0.6656
[2023-08-26 18:59:35,783][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00020 | loss1:0.0003 loss2:0.0853 loss3:0.0245 | AUC:0.8021 Anomaly AUC:0.6652
[2023-08-26 18:59:49,540][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00020 | loss1:0.0003 loss2:0.0764 loss3:0.0242 | AUC:0.8032 Anomaly AUC:0.6670
[2023-08-26 18:59:49,592][main.py][line:114][INFO] Training completes in 2m 8s | best AUCAUC:0.8104 Anomaly AUC:0.6657

[2023-08-26 19:00:04,369][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00050 | loss1:0.0012 loss2:0.1812 loss3:0.0308 | AUC:0.8013 Anomaly AUC:0.6590
[2023-08-26 19:00:18,610][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00050 | loss1:0.0005 loss2:0.1226 loss3:0.0273 | AUC:0.7998 Anomaly AUC:0.6578
[2023-08-26 19:00:30,627][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00050 | loss1:0.0008 loss2:0.1019 loss3:0.0264 | AUC:0.7977 Anomaly AUC:0.6578
[2023-08-26 19:00:42,826][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00050 | loss1:0.0004 loss2:0.1051 loss3:0.0252 | AUC:0.8018 Anomaly AUC:0.6631
[2023-08-26 19:00:55,633][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00050 | loss1:0.0005 loss2:0.0933 loss3:0.0251 | AUC:0.8008 Anomaly AUC:0.6637
[2023-08-26 19:01:10,201][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00050 | loss1:0.0009 loss2:0.0906 loss3:0.0231 | AUC:0.7933 Anomaly AUC:0.6652
[2023-08-26 19:01:27,306][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00050 | loss1:0.0146 loss2:0.1875 loss3:0.0339 | AUC:0.8002 Anomaly AUC:0.6655
[2023-08-26 19:01:38,255][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00050 | loss1:0.0023 loss2:0.1392 loss3:0.0299 | AUC:0.7970 Anomaly AUC:0.6645
[2023-08-26 19:01:50,265][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00050 | loss1:0.0013 loss2:0.1171 loss3:0.0296 | AUC:0.7960 Anomaly AUC:0.6634
[2023-08-26 19:02:01,669][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00050 | loss1:0.0006 loss2:0.0597 loss3:0.0250 | AUC:0.7876 Anomaly AUC:0.6624
[2023-08-26 19:02:01,696][main.py][line:114][INFO] Training completes in 2m 12s | best AUCAUC:0.8018 Anomaly AUC:0.6631

[2023-08-26 19:02:12,622][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00070 | loss1:0.0849 loss2:0.4089 loss3:0.0493 | AUC:0.7987 Anomaly AUC:0.6580
[2023-08-26 19:02:23,575][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00070 | loss1:0.0196 loss2:0.1823 loss3:0.0342 | AUC:0.8004 Anomaly AUC:0.6637
[2023-08-26 19:02:36,883][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00070 | loss1:0.0342 loss2:0.1956 loss3:0.0312 | AUC:0.8043 Anomaly AUC:0.6642
[2023-08-26 19:02:47,658][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00070 | loss1:0.0147 loss2:0.1889 loss3:0.0228 | AUC:0.8009 Anomaly AUC:0.6641
[2023-08-26 19:02:58,614][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00070 | loss1:0.0217 loss2:0.1462 loss3:0.0242 | AUC:0.8125 Anomaly AUC:0.6733
[2023-08-26 19:03:10,232][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00070 | loss1:0.0451 loss2:0.1961 loss3:0.0338 | AUC:0.8045 Anomaly AUC:0.6650
[2023-08-26 19:03:22,894][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00070 | loss1:0.0149 loss2:0.1320 loss3:0.0206 | AUC:0.8070 Anomaly AUC:0.6719
[2023-08-26 19:03:37,354][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00070 | loss1:0.0235 loss2:0.1722 loss3:0.0316 | AUC:0.7990 Anomaly AUC:0.6536
[2023-08-26 19:03:49,957][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00070 | loss1:0.0081 loss2:0.1127 loss3:0.0236 | AUC:0.8078 Anomaly AUC:0.6852
[2023-08-26 19:04:04,506][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00070 | loss1:0.0027 loss2:0.0879 loss3:0.0162 | AUC:0.7983 Anomaly AUC:0.6750
[2023-08-26 19:04:04,556][main.py][line:114][INFO] Training completes in 2m 3s | best AUCAUC:0.8125 Anomaly AUC:0.6733

[2023-08-26 19:04:18,984][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00090 | loss1:0.0692 loss2:0.3797 loss3:0.0405 | AUC:0.7965 Anomaly AUC:0.6726
[2023-08-26 19:04:33,754][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00090 | loss1:0.0028 loss2:0.1999 loss3:0.0217 | AUC:0.8002 Anomaly AUC:0.6734
[2023-08-26 19:04:48,141][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00090 | loss1:0.0236 loss2:0.2287 loss3:0.0260 | AUC:0.8274 Anomaly AUC:0.6741
[2023-08-26 19:04:59,860][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00090 | loss1:0.0236 loss2:0.2426 loss3:0.0234 | AUC:0.8229 Anomaly AUC:0.6627
[2023-08-26 19:05:13,825][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00090 | loss1:0.0111 loss2:0.1618 loss3:0.0197 | AUC:0.8126 Anomaly AUC:0.6780
[2023-08-26 19:05:28,280][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00090 | loss1:0.0058 loss2:0.1351 loss3:0.0135 | AUC:0.8141 Anomaly AUC:0.6730
[2023-08-26 19:05:39,599][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00090 | loss1:0.0239 loss2:0.1668 loss3:0.0171 | AUC:0.8151 Anomaly AUC:0.6809
[2023-08-26 19:05:50,526][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00090 | loss1:0.0187 loss2:0.1888 loss3:0.0167 | AUC:0.8184 Anomaly AUC:0.6735
[2023-08-26 19:06:01,403][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00090 | loss1:0.0052 loss2:0.1214 loss3:0.0133 | AUC:0.8085 Anomaly AUC:0.6805
[2023-08-26 19:06:34,310][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00090 | loss1:0.0151 loss2:0.1364 loss3:0.0094 | AUC:0.8015 Anomaly AUC:0.6674
[2023-08-26 19:06:34,337][main.py][line:114][INFO] Training completes in 2m 30s | best AUCAUC:0.8274 Anomaly AUC:0.6741

[2023-08-26 19:06:45,259][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00100 | loss1:0.0963 loss2:0.5074 loss3:0.0364 | AUC:0.8215 Anomaly AUC:0.6507
[2023-08-26 19:06:59,222][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00100 | loss1:0.0109 loss2:0.2309 loss3:0.0213 | AUC:0.8119 Anomaly AUC:0.6684
[2023-08-26 19:07:11,670][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00100 | loss1:0.0020 loss2:0.1487 loss3:0.0178 | AUC:0.8139 Anomaly AUC:0.6709
[2023-08-26 19:07:25,325][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00100 | loss1:0.0029 loss2:0.1370 loss3:0.0136 | AUC:0.7900 Anomaly AUC:0.6768
[2023-08-26 19:07:36,304][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00100 | loss1:0.0343 loss2:0.2209 loss3:0.0207 | AUC:0.8225 Anomaly AUC:0.6680
[2023-08-26 19:07:47,206][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00100 | loss1:0.0506 loss2:0.3322 loss3:0.0248 | AUC:0.7745 Anomaly AUC:0.6698
[2023-08-26 19:07:58,085][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00100 | loss1:0.0515 loss2:0.3297 loss3:0.0338 | AUC:0.8135 Anomaly AUC:0.6514
[2023-08-26 19:08:12,125][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00100 | loss1:0.0439 loss2:0.2726 loss3:0.0367 | AUC:0.8226 Anomaly AUC:0.6862
[2023-08-26 19:08:23,574][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00100 | loss1:0.0201 loss2:0.2217 loss3:0.0203 | AUC:0.8171 Anomaly AUC:0.6860
[2023-08-26 19:08:34,437][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00100 | loss1:0.0878 loss2:0.4555 loss3:0.0358 | AUC:0.8198 Anomaly AUC:0.6691
[2023-08-26 19:08:34,464][main.py][line:114][INFO] Training completes in 2m 0s | best AUCAUC:0.8226 Anomaly AUC:0.6862

[2023-08-26 19:08:45,235][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00100 | loss1:0.1777 loss2:0.9094 loss3:0.0502 | AUC:0.8222 Anomaly AUC:0.6424
[2023-08-26 19:09:04,891][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00100 | loss1:0.0169 loss2:0.4395 loss3:0.0304 | AUC:0.8201 Anomaly AUC:0.6600
[2023-08-26 19:09:19,502][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00100 | loss1:0.0109 loss2:0.3053 loss3:0.0195 | AUC:0.8326 Anomaly AUC:0.6639
[2023-08-26 19:09:35,608][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00100 | loss1:0.0068 loss2:0.2391 loss3:0.0165 | AUC:0.8105 Anomaly AUC:0.6748
[2023-08-26 19:09:49,694][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00100 | loss1:0.0015 loss2:0.1499 loss3:0.0126 | AUC:0.8241 Anomaly AUC:0.6851
[2023-08-26 19:10:02,536][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00100 | loss1:0.0076 loss2:0.1269 loss3:0.0108 | AUC:0.8157 Anomaly AUC:0.6809
[2023-08-26 19:10:17,274][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00100 | loss1:0.0019 loss2:0.1642 loss3:0.0088 | AUC:0.8170 Anomaly AUC:0.6818
[2023-08-26 19:10:31,119][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00100 | loss1:0.0015 loss2:0.1245 loss3:0.0079 | AUC:0.8222 Anomaly AUC:0.6855
[2023-08-26 19:10:42,054][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00100 | loss1:0.0528 loss2:0.2842 loss3:0.0227 | AUC:0.8231 Anomaly AUC:0.6729
[2023-08-26 19:10:52,939][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00100 | loss1:0.0163 loss2:0.2732 loss3:0.0220 | AUC:0.8282 Anomaly AUC:0.6758
[2023-08-26 19:10:52,965][main.py][line:114][INFO] Training completes in 2m 18s | best AUCAUC:0.8326 Anomaly AUC:0.6639

[2023-08-26 19:11:03,826][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00100 | loss1:0.1833 loss2:0.7914 loss3:0.0414 | AUC:0.8184 Anomaly AUC:0.6559
[2023-08-26 19:11:17,606][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00100 | loss1:0.0088 loss2:0.5408 loss3:0.0245 | AUC:0.8180 Anomaly AUC:0.6751
[2023-08-26 19:11:32,300][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00100 | loss1:0.0034 loss2:0.4122 loss3:0.0203 | AUC:0.8209 Anomaly AUC:0.6790
[2023-08-26 19:11:45,951][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00100 | loss1:0.0019 loss2:0.3017 loss3:0.0164 | AUC:0.8186 Anomaly AUC:0.6772
[2023-08-26 19:11:56,970][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00100 | loss1:0.0055 loss2:0.2747 loss3:0.0161 | AUC:0.8140 Anomaly AUC:0.6689
[2023-08-26 19:12:07,860][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00100 | loss1:0.0233 loss2:0.3249 loss3:0.0197 | AUC:0.8168 Anomaly AUC:0.6761
[2023-08-26 19:12:21,708][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00100 | loss1:0.0104 loss2:0.3354 loss3:0.0144 | AUC:0.8051 Anomaly AUC:0.6741
[2023-08-26 19:12:34,484][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00100 | loss1:0.0119 loss2:0.2699 loss3:0.0123 | AUC:0.8128 Anomaly AUC:0.6724
[2023-08-26 19:12:45,462][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00100 | loss1:0.0066 loss2:0.2198 loss3:0.0104 | AUC:0.8111 Anomaly AUC:0.6624
[2023-08-26 19:12:56,488][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00100 | loss1:0.0083 loss2:0.2295 loss3:0.0093 | AUC:0.8128 Anomaly AUC:0.6706
[2023-08-26 19:12:56,514][main.py][line:114][INFO] Training completes in 2m 3s | best AUCAUC:0.8209 Anomaly AUC:0.6790

[2023-08-26 19:13:09,786][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00090 | loss1:0.0587 loss2:0.6436 loss3:0.0417 | AUC:0.7983 Anomaly AUC:0.6511
[2023-08-26 19:13:22,611][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00090 | loss1:0.0130 loss2:0.3299 loss3:0.0182 | AUC:0.8209 Anomaly AUC:0.6660
[2023-08-26 19:13:36,739][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00090 | loss1:0.0127 loss2:0.2669 loss3:0.0194 | AUC:0.7956 Anomaly AUC:0.6688
[2023-08-26 19:13:49,554][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00090 | loss1:0.0196 loss2:0.2276 loss3:0.0183 | AUC:0.8202 Anomaly AUC:0.6988
[2023-08-26 19:14:00,977][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00090 | loss1:0.0203 loss2:0.2377 loss3:0.0133 | AUC:0.8129 Anomaly AUC:0.6673
[2023-08-26 19:14:11,877][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00090 | loss1:0.0145 loss2:0.1945 loss3:0.0101 | AUC:0.7922 Anomaly AUC:0.6596
[2023-08-26 19:14:22,919][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00090 | loss1:0.0116 loss2:0.1801 loss3:0.0090 | AUC:0.8043 Anomaly AUC:0.6736
[2023-08-26 19:14:36,267][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00090 | loss1:0.0175 loss2:0.2004 loss3:0.0150 | AUC:0.8209 Anomaly AUC:0.6748
[2023-08-26 19:14:50,181][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00090 | loss1:0.0044 loss2:0.1848 loss3:0.0100 | AUC:0.8217 Anomaly AUC:0.6661
[2023-08-26 19:15:01,562][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00090 | loss1:0.0366 loss2:0.1828 loss3:0.0130 | AUC:0.8009 Anomaly AUC:0.6769
[2023-08-26 19:15:01,605][main.py][line:114][INFO] Training completes in 2m 5s | best AUCAUC:0.8217 Anomaly AUC:0.6661

[2023-08-26 19:15:12,475][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00090 | loss1:0.0984 loss2:0.4368 loss3:0.0220 | AUC:0.8164 Anomaly AUC:0.6672
[2023-08-26 19:15:23,288][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00090 | loss1:0.0022 loss2:0.1450 loss3:0.0092 | AUC:0.8073 Anomaly AUC:0.6741
[2023-08-26 19:15:37,370][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00090 | loss1:0.0007 loss2:0.0819 loss3:0.0078 | AUC:0.8115 Anomaly AUC:0.6761
[2023-08-26 19:15:51,842][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00090 | loss1:0.0006 loss2:0.0653 loss3:0.0069 | AUC:0.8071 Anomaly AUC:0.6697
[2023-08-26 19:16:06,301][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00090 | loss1:0.0003 loss2:0.0566 loss3:0.0073 | AUC:0.8050 Anomaly AUC:0.6658
[2023-08-26 19:16:26,618][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00090 | loss1:0.0005 loss2:0.0599 loss3:0.0063 | AUC:0.8017 Anomaly AUC:0.6696
[2023-08-26 19:16:37,575][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00090 | loss1:0.0003 loss2:0.0511 loss3:0.0069 | AUC:0.8065 Anomaly AUC:0.6661
[2023-08-26 19:16:49,752][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00090 | loss1:0.0007 loss2:0.0546 loss3:0.0059 | AUC:0.8019 Anomaly AUC:0.6649
[2023-08-26 19:17:04,154][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00090 | loss1:0.0225 loss2:0.2120 loss3:0.0144 | AUC:0.8108 Anomaly AUC:0.6773
[2023-08-26 19:17:18,056][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00090 | loss1:0.0156 loss2:0.1792 loss3:0.0150 | AUC:0.8155 Anomaly AUC:0.6635
[2023-08-26 19:17:18,084][main.py][line:114][INFO] Training completes in 2m 16s | best AUCAUC:0.8164 Anomaly AUC:0.6672

[2023-08-26 19:17:28,877][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00090 | loss1:0.0855 loss2:0.3928 loss3:0.0207 | AUC:0.8047 Anomaly AUC:0.6565
[2023-08-26 19:17:39,722][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00090 | loss1:0.0161 loss2:0.1572 loss3:0.0137 | AUC:0.8041 Anomaly AUC:0.6640
[2023-08-26 19:17:51,520][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00090 | loss1:0.0054 loss2:0.1154 loss3:0.0100 | AUC:0.7933 Anomaly AUC:0.6710
[2023-08-26 19:18:05,368][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00090 | loss1:0.0088 loss2:0.0930 loss3:0.0091 | AUC:0.8061 Anomaly AUC:0.6585
[2023-08-26 19:18:16,326][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00090 | loss1:0.0039 loss2:0.0886 loss3:0.0084 | AUC:0.8033 Anomaly AUC:0.6703
[2023-08-26 19:18:27,123][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00090 | loss1:0.0156 loss2:0.1011 loss3:0.0106 | AUC:0.7944 Anomaly AUC:0.6677
[2023-08-26 19:18:39,277][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00090 | loss1:0.0331 loss2:0.1719 loss3:0.0193 | AUC:0.8139 Anomaly AUC:0.6712
[2023-08-26 19:18:50,675][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00090 | loss1:0.0249 loss2:0.1455 loss3:0.0215 | AUC:0.8141 Anomaly AUC:0.6553
[2023-08-26 19:19:01,593][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00090 | loss1:0.0066 loss2:0.0855 loss3:0.0133 | AUC:0.8184 Anomaly AUC:0.6601
[2023-08-26 19:19:17,830][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00090 | loss1:0.0023 loss2:0.0490 loss3:0.0090 | AUC:0.8111 Anomaly AUC:0.6608
[2023-08-26 19:19:17,882][main.py][line:114][INFO] Training completes in 1m 60s | best AUCAUC:0.8184 Anomaly AUC:0.6601

[2023-08-26 19:19:30,705][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00100 | loss1:0.0508 loss2:0.8883 loss3:0.0208 | AUC:0.8187 Anomaly AUC:0.6645
[2023-08-26 19:19:44,247][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00100 | loss1:0.0078 loss2:0.7666 loss3:0.0144 | AUC:0.8194 Anomaly AUC:0.6413
[2023-08-26 19:19:55,189][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00100 | loss1:0.0159 loss2:0.6474 loss3:0.0083 | AUC:0.8105 Anomaly AUC:0.6433
[2023-08-26 19:20:08,694][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00100 | loss1:0.0055 loss2:0.5900 loss3:0.0095 | AUC:0.8181 Anomaly AUC:0.6556
[2023-08-26 19:20:20,526][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00100 | loss1:0.0011 loss2:0.4172 loss3:0.0071 | AUC:0.8159 Anomaly AUC:0.6548
[2023-08-26 19:20:34,839][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00100 | loss1:0.0020 loss2:0.2021 loss3:0.0072 | AUC:0.8088 Anomaly AUC:0.6557
[2023-08-26 19:20:47,113][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00100 | loss1:0.0511 loss2:0.8096 loss3:0.0179 | AUC:0.8129 Anomaly AUC:0.6643
[2023-08-26 19:20:58,942][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00100 | loss1:0.0138 loss2:0.9834 loss3:0.0166 | AUC:0.8001 Anomaly AUC:0.5994
[2023-08-26 19:21:13,053][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00100 | loss1:0.0342 loss2:1.0104 loss3:0.0249 | AUC:0.8036 Anomaly AUC:0.6728
[2023-08-26 19:21:28,100][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00100 | loss1:0.0162 loss2:0.8862 loss3:0.0152 | AUC:0.8250 Anomaly AUC:0.6623
[2023-08-26 19:21:28,149][main.py][line:114][INFO] Training completes in 2m 10s | best AUCAUC:0.8250 Anomaly AUC:0.6623

[2023-08-26 19:21:39,578][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00080 | loss1:0.0185 loss2:0.6837 loss3:0.0159 | AUC:0.8098 Anomaly AUC:0.6250
[2023-08-26 19:21:50,477][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00080 | loss1:0.0056 loss2:0.6233 loss3:0.0101 | AUC:0.8288 Anomaly AUC:0.6807
[2023-08-26 19:22:01,278][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00080 | loss1:0.0147 loss2:0.8409 loss3:0.0112 | AUC:0.8184 Anomaly AUC:0.6484
[2023-08-26 19:22:15,082][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00080 | loss1:0.0057 loss2:0.8237 loss3:0.0121 | AUC:0.8195 Anomaly AUC:0.6650
[2023-08-26 19:22:29,910][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00080 | loss1:0.0126 loss2:0.7686 loss3:0.0093 | AUC:0.8189 Anomaly AUC:0.6525
[2023-08-26 19:22:44,412][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00080 | loss1:0.0014 loss2:0.4474 loss3:0.0068 | AUC:0.7825 Anomaly AUC:0.5774
[2023-08-26 19:22:57,026][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00080 | loss1:0.0116 loss2:0.6334 loss3:0.0117 | AUC:0.8214 Anomaly AUC:0.6622
[2023-08-26 19:23:11,786][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00080 | loss1:0.0038 loss2:0.5136 loss3:0.0084 | AUC:0.8122 Anomaly AUC:0.6418
[2023-08-26 19:23:23,068][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00080 | loss1:0.0301 loss2:0.6423 loss3:0.0111 | AUC:0.7956 Anomaly AUC:0.6054
[2023-08-26 19:23:41,239][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00080 | loss1:0.0097 loss2:0.9072 loss3:0.0136 | AUC:0.8228 Anomaly AUC:0.6334
[2023-08-26 19:23:41,266][main.py][line:114][INFO] Training completes in 2m 13s | best AUCAUC:0.8288 Anomaly AUC:0.6807

[2023-08-26 19:23:53,105][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00080 | loss1:0.0220 loss2:0.3091 loss3:0.0100 | AUC:0.8270 Anomaly AUC:0.6580
[2023-08-26 19:24:04,562][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00080 | loss1:0.0046 loss2:0.4966 loss3:0.0088 | AUC:0.8217 Anomaly AUC:0.6818
[2023-08-26 19:24:15,571][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00080 | loss1:0.0014 loss2:0.2464 loss3:0.0081 | AUC:0.8248 Anomaly AUC:0.6734
[2023-08-26 19:24:26,587][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00080 | loss1:0.0005 loss2:0.1605 loss3:0.0070 | AUC:0.8257 Anomaly AUC:0.6724
[2023-08-26 19:24:38,694][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00080 | loss1:0.0002 loss2:0.1846 loss3:0.0062 | AUC:0.8202 Anomaly AUC:0.6739
[2023-08-26 19:24:53,215][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00080 | loss1:0.0012 loss2:0.0971 loss3:0.0067 | AUC:0.8120 Anomaly AUC:0.6665
[2023-08-26 19:25:06,852][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00080 | loss1:0.0247 loss2:0.2353 loss3:0.0104 | AUC:0.8186 Anomaly AUC:0.6671
[2023-08-26 19:25:17,733][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00080 | loss1:0.0291 loss2:0.3737 loss3:0.0169 | AUC:0.8006 Anomaly AUC:0.6764
[2023-08-26 19:25:28,661][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00080 | loss1:0.0082 loss2:0.2616 loss3:0.0099 | AUC:0.8226 Anomaly AUC:0.6701
[2023-08-26 19:25:40,550][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00080 | loss1:0.0005 loss2:0.1186 loss3:0.0073 | AUC:0.8235 Anomaly AUC:0.6788
[2023-08-26 19:25:40,603][main.py][line:114][INFO] Training completes in 1m 59s | best AUCAUC:0.8270 Anomaly AUC:0.6580

[2023-08-26 19:25:55,116][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00080 | loss1:0.0185 loss2:0.4587 loss3:0.0123 | AUC:0.8308 Anomaly AUC:0.6718
[2023-08-26 19:26:08,015][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00080 | loss1:0.0036 loss2:0.1566 loss3:0.0091 | AUC:0.8287 Anomaly AUC:0.6592
[2023-08-26 19:26:22,035][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00080 | loss1:0.0107 loss2:0.2013 loss3:0.0144 | AUC:0.7837 Anomaly AUC:0.6662
[2023-08-26 19:26:33,156][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00080 | loss1:0.0089 loss2:0.2117 loss3:0.0086 | AUC:0.8181 Anomaly AUC:0.6731
[2023-08-26 19:26:43,826][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00080 | loss1:0.0081 loss2:0.1603 loss3:0.0083 | AUC:0.8253 Anomaly AUC:0.6633
[2023-08-26 19:26:54,723][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00080 | loss1:0.0204 loss2:0.4142 loss3:0.0140 | AUC:0.8284 Anomaly AUC:0.6662
[2023-08-26 19:27:07,990][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00080 | loss1:0.0087 loss2:0.2362 loss3:0.0109 | AUC:0.8323 Anomaly AUC:0.6780
[2023-08-26 19:27:23,321][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00080 | loss1:0.0242 loss2:0.3062 loss3:0.0156 | AUC:0.8264 Anomaly AUC:0.6691
[2023-08-26 19:27:34,216][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00080 | loss1:0.0015 loss2:0.1521 loss3:0.0103 | AUC:0.8249 Anomaly AUC:0.6736
[2023-08-26 19:27:45,063][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00080 | loss1:0.0004 loss2:0.0672 loss3:0.0069 | AUC:0.8239 Anomaly AUC:0.6743
[2023-08-26 19:27:45,091][main.py][line:114][INFO] Training completes in 2m 4s | best AUCAUC:0.8323 Anomaly AUC:0.6780

[2023-08-26 19:27:59,060][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00070 | loss1:0.0108 loss2:0.2365 loss3:0.0114 | AUC:0.8367 Anomaly AUC:0.6763
[2023-08-26 19:28:11,925][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00070 | loss1:0.0023 loss2:0.1160 loss3:0.0066 | AUC:0.8239 Anomaly AUC:0.6694
[2023-08-26 19:28:23,290][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00070 | loss1:0.0007 loss2:0.1067 loss3:0.0062 | AUC:0.8277 Anomaly AUC:0.6711
[2023-08-26 19:28:33,993][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00070 | loss1:0.0003 loss2:0.1168 loss3:0.0057 | AUC:0.8317 Anomaly AUC:0.6740
[2023-08-26 19:28:44,964][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00070 | loss1:0.0040 loss2:0.0897 loss3:0.0059 | AUC:0.8121 Anomaly AUC:0.6766
[2023-08-26 19:28:59,037][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00070 | loss1:0.0140 loss2:0.1325 loss3:0.0084 | AUC:0.8275 Anomaly AUC:0.6570
[2023-08-26 19:29:12,878][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00070 | loss1:0.0280 loss2:0.1592 loss3:0.0120 | AUC:0.8254 Anomaly AUC:0.6522
[2023-08-26 19:29:23,936][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00070 | loss1:0.0107 loss2:0.1041 loss3:0.0079 | AUC:0.8279 Anomaly AUC:0.6697
[2023-08-26 19:29:34,956][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00070 | loss1:0.0036 loss2:0.0666 loss3:0.0076 | AUC:0.8179 Anomaly AUC:0.6599
[2023-08-26 19:29:46,703][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00070 | loss1:0.0054 loss2:0.0522 loss3:0.0075 | AUC:0.8220 Anomaly AUC:0.6534
[2023-08-26 19:29:46,753][main.py][line:114][INFO] Training completes in 2m 2s | best AUCAUC:0.8367 Anomaly AUC:0.6763

[2023-08-26 19:29:58,708][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00070 | loss1:0.0054 loss2:0.1216 loss3:0.0099 | AUC:0.8309 Anomaly AUC:0.6654
[2023-08-26 19:30:11,398][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00070 | loss1:0.0034 loss2:0.1517 loss3:0.0081 | AUC:0.8247 Anomaly AUC:0.6656
[2023-08-26 19:30:27,198][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00070 | loss1:0.0034 loss2:0.1042 loss3:0.0069 | AUC:0.8229 Anomaly AUC:0.6636
[2023-08-26 19:30:38,559][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00070 | loss1:0.0006 loss2:0.0820 loss3:0.0076 | AUC:0.8184 Anomaly AUC:0.6613
[2023-08-26 19:30:53,506][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00070 | loss1:0.0002 loss2:0.0349 loss3:0.0066 | AUC:0.8228 Anomaly AUC:0.6713
[2023-08-26 19:31:04,790][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00070 | loss1:0.0003 loss2:0.1161 loss3:0.0051 | AUC:0.8162 Anomaly AUC:0.6659
[2023-08-26 19:31:17,737][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00070 | loss1:0.0004 loss2:0.2359 loss3:0.0059 | AUC:0.8159 Anomaly AUC:0.6733
[2023-08-26 19:31:32,343][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00070 | loss1:0.0003 loss2:0.0821 loss3:0.0060 | AUC:0.8191 Anomaly AUC:0.6677
[2023-08-26 19:31:43,507][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00070 | loss1:0.0005 loss2:0.1369 loss3:0.0051 | AUC:0.8138 Anomaly AUC:0.6581
[2023-08-26 19:31:54,367][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00070 | loss1:0.0049 loss2:0.2416 loss3:0.0065 | AUC:0.7990 Anomaly AUC:0.6782
[2023-08-26 19:31:54,394][main.py][line:114][INFO] Training completes in 2m 8s | best AUCAUC:0.8309 Anomaly AUC:0.6654

[2023-08-26 19:32:05,275][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00070 | loss1:0.0103 loss2:0.2313 loss3:0.0112 | AUC:0.8279 Anomaly AUC:0.6754
[2023-08-26 19:32:18,954][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00070 | loss1:0.0038 loss2:0.1349 loss3:0.0078 | AUC:0.8287 Anomaly AUC:0.6803
[2023-08-26 19:32:31,450][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00070 | loss1:0.0031 loss2:0.1038 loss3:0.0072 | AUC:0.8193 Anomaly AUC:0.6639
[2023-08-26 19:32:43,476][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00070 | loss1:0.0146 loss2:0.3291 loss3:0.0131 | AUC:0.8052 Anomaly AUC:0.6150
[2023-08-26 19:32:55,932][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00070 | loss1:0.0125 loss2:0.2653 loss3:0.0201 | AUC:0.8178 Anomaly AUC:0.6379
[2023-08-26 19:33:07,698][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00070 | loss1:0.0028 loss2:0.1494 loss3:0.0116 | AUC:0.8322 Anomaly AUC:0.6695
[2023-08-26 19:33:18,729][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00070 | loss1:0.0016 loss2:0.0760 loss3:0.0062 | AUC:0.8319 Anomaly AUC:0.6706
[2023-08-26 19:33:29,735][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00070 | loss1:0.0003 loss2:0.0509 loss3:0.0057 | AUC:0.8329 Anomaly AUC:0.6714
[2023-08-26 19:33:44,139][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00070 | loss1:0.0002 loss2:0.0339 loss3:0.0055 | AUC:0.8307 Anomaly AUC:0.6737
[2023-08-26 19:33:56,421][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00070 | loss1:0.0002 loss2:0.0312 loss3:0.0051 | AUC:0.8322 Anomaly AUC:0.6740
[2023-08-26 19:33:56,474][main.py][line:114][INFO] Training completes in 2m 2s | best AUCAUC:0.8329 Anomaly AUC:0.6714

[2023-08-26 19:34:10,974][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00070 | loss1:0.0058 loss2:0.1151 loss3:0.0088 | AUC:0.8199 Anomaly AUC:0.6519
[2023-08-26 19:34:25,235][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00070 | loss1:0.0092 loss2:0.1170 loss3:0.0097 | AUC:0.8326 Anomaly AUC:0.6574
[2023-08-26 19:34:37,662][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00070 | loss1:0.0102 loss2:0.1779 loss3:0.0152 | AUC:0.8257 Anomaly AUC:0.6628
[2023-08-26 19:34:51,424][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00070 | loss1:0.0101 loss2:0.1629 loss3:0.0072 | AUC:0.8311 Anomaly AUC:0.6715
[2023-08-26 19:35:02,265][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00070 | loss1:0.0035 loss2:0.0713 loss3:0.0077 | AUC:0.8225 Anomaly AUC:0.6616
[2023-08-26 19:35:13,118][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00070 | loss1:0.0007 loss2:0.0958 loss3:0.0105 | AUC:0.8233 Anomaly AUC:0.6600
[2023-08-26 19:35:23,904][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00070 | loss1:0.0002 loss2:0.0666 loss3:0.0070 | AUC:0.8238 Anomaly AUC:0.6666
[2023-08-26 19:35:47,262][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00070 | loss1:0.0002 loss2:0.1460 loss3:0.0061 | AUC:0.8207 Anomaly AUC:0.6715
[2023-08-26 19:35:58,224][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00070 | loss1:0.0002 loss2:0.1112 loss3:0.0053 | AUC:0.8250 Anomaly AUC:0.6704
[2023-08-26 19:36:10,181][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00070 | loss1:0.0002 loss2:0.0465 loss3:0.0054 | AUC:0.8255 Anomaly AUC:0.6650
[2023-08-26 19:36:10,257][main.py][line:114][INFO] Training completes in 2m 14s | best AUCAUC:0.8326 Anomaly AUC:0.6574

[2023-08-26 19:36:21,448][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00070 | loss1:0.0093 loss2:0.2277 loss3:0.0102 | AUC:0.8326 Anomaly AUC:0.6634
[2023-08-26 19:36:32,226][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00070 | loss1:0.0057 loss2:0.3301 loss3:0.0104 | AUC:0.8249 Anomaly AUC:0.6684
[2023-08-26 19:36:42,947][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00070 | loss1:0.0038 loss2:0.0899 loss3:0.0067 | AUC:0.8035 Anomaly AUC:0.6543
[2023-08-26 19:36:57,002][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00070 | loss1:0.0050 loss2:0.3163 loss3:0.0111 | AUC:0.8206 Anomaly AUC:0.6774
[2023-08-26 19:37:08,406][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00070 | loss1:0.0115 loss2:0.1198 loss3:0.0103 | AUC:0.8288 Anomaly AUC:0.6605
[2023-08-26 19:37:19,342][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00070 | loss1:0.0098 loss2:0.1031 loss3:0.0108 | AUC:0.7932 Anomaly AUC:0.6658
[2023-08-26 19:37:30,254][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00070 | loss1:0.0099 loss2:0.1194 loss3:0.0118 | AUC:0.8229 Anomaly AUC:0.6469
[2023-08-26 19:37:42,045][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00070 | loss1:0.0102 loss2:0.0777 loss3:0.0125 | AUC:0.8246 Anomaly AUC:0.6711
[2023-08-26 19:37:56,636][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00070 | loss1:0.0008 loss2:0.0644 loss3:0.0070 | AUC:0.8234 Anomaly AUC:0.6656
[2023-08-26 19:38:10,404][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00070 | loss1:0.0002 loss2:0.0222 loss3:0.0066 | AUC:0.8247 Anomaly AUC:0.6626
[2023-08-26 19:38:10,448][main.py][line:114][INFO] Training completes in 2m 0s | best AUCAUC:0.8326 Anomaly AUC:0.6634

[2023-08-26 19:38:21,429][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00060 | loss1:0.0417 loss2:0.3617 loss3:0.0133 | AUC:0.8214 Anomaly AUC:0.6586
[2023-08-26 19:38:35,177][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00060 | loss1:0.0183 loss2:0.2955 loss3:0.0130 | AUC:0.8255 Anomaly AUC:0.6624
[2023-08-26 19:38:47,143][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00060 | loss1:0.0032 loss2:0.1193 loss3:0.0081 | AUC:0.8237 Anomaly AUC:0.6709
[2023-08-26 19:38:58,618][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00060 | loss1:0.0005 loss2:0.0605 loss3:0.0062 | AUC:0.8210 Anomaly AUC:0.6667
[2023-08-26 19:39:09,405][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00060 | loss1:0.0003 loss2:0.0400 loss3:0.0060 | AUC:0.8189 Anomaly AUC:0.6653
[2023-08-26 19:39:20,297][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00060 | loss1:0.0002 loss2:0.0177 loss3:0.0061 | AUC:0.8166 Anomaly AUC:0.6640
[2023-08-26 19:39:34,343][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00060 | loss1:0.0002 loss2:0.0270 loss3:0.0063 | AUC:0.8169 Anomaly AUC:0.6660
[2023-08-26 19:39:48,062][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00060 | loss1:0.0002 loss2:0.0283 loss3:0.0060 | AUC:0.8158 Anomaly AUC:0.6664
[2023-08-26 19:39:58,894][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00060 | loss1:0.0002 loss2:0.0433 loss3:0.0059 | AUC:0.8171 Anomaly AUC:0.6685
[2023-08-26 19:40:09,792][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00060 | loss1:0.0004 loss2:0.1082 loss3:0.0057 | AUC:0.8198 Anomaly AUC:0.6671
[2023-08-26 19:40:09,819][main.py][line:114][INFO] Training completes in 1m 59s | best AUCAUC:0.8255 Anomaly AUC:0.6624

[2023-08-26 19:40:21,811][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00070 | loss1:0.0050 loss2:0.2312 loss3:0.0076 | AUC:0.8183 Anomaly AUC:0.6669
[2023-08-26 19:40:34,087][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00070 | loss1:0.0004 loss2:0.0593 loss3:0.0076 | AUC:0.8137 Anomaly AUC:0.6684
[2023-08-26 19:40:46,425][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00070 | loss1:0.0010 loss2:0.0852 loss3:0.0056 | AUC:0.8194 Anomaly AUC:0.6679
[2023-08-26 19:41:00,899][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00070 | loss1:0.0006 loss2:0.1589 loss3:0.0050 | AUC:0.8174 Anomaly AUC:0.6683
[2023-08-26 19:41:14,596][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00070 | loss1:0.0005 loss2:0.1312 loss3:0.0048 | AUC:0.8172 Anomaly AUC:0.6654
[2023-08-26 19:41:25,607][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00070 | loss1:0.0004 loss2:0.0571 loss3:0.0056 | AUC:0.8124 Anomaly AUC:0.6609
[2023-08-26 19:41:36,354][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00070 | loss1:0.0001 loss2:0.0000 loss3:0.0047 | AUC:0.8124 Anomaly AUC:0.6595
[2023-08-26 19:41:47,086][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00070 | loss1:0.0000 loss2:0.0000 loss3:0.0045 | AUC:0.8118 Anomaly AUC:0.6591
[2023-08-26 19:42:00,822][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00070 | loss1:0.0000 loss2:0.0000 loss3:0.0044 | AUC:0.8127 Anomaly AUC:0.6614
[2023-08-26 19:42:15,169][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00070 | loss1:0.0000 loss2:0.0000 loss3:0.0041 | AUC:0.8135 Anomaly AUC:0.6631
[2023-08-26 19:42:15,220][main.py][line:114][INFO] Training completes in 2m 5s | best AUCAUC:0.8194 Anomaly AUC:0.6679

[2023-08-26 19:42:26,411][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00050 | loss1:0.0144 loss2:0.0000 loss3:0.0085 | AUC:0.8134 Anomaly AUC:0.6225
[2023-08-26 19:42:37,284][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00050 | loss1:0.0299 loss2:0.5735 loss3:0.0273 | AUC:0.8238 Anomaly AUC:0.6629
[2023-08-26 19:42:48,124][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00050 | loss1:0.0097 loss2:0.2975 loss3:0.0124 | AUC:0.8213 Anomaly AUC:0.6649
[2023-08-26 19:43:00,120][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00050 | loss1:0.0003 loss2:0.0851 loss3:0.0067 | AUC:0.8192 Anomaly AUC:0.6565
[2023-08-26 19:43:11,489][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00050 | loss1:0.0002 loss2:0.0635 loss3:0.0050 | AUC:0.8187 Anomaly AUC:0.6576
[2023-08-26 19:43:22,271][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00050 | loss1:0.0001 loss2:0.0367 loss3:0.0059 | AUC:0.8181 Anomaly AUC:0.6562
[2023-08-26 19:43:33,249][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00050 | loss1:0.0002 loss2:0.0506 loss3:0.0053 | AUC:0.8185 Anomaly AUC:0.6608
[2023-08-26 19:43:46,858][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00050 | loss1:0.0001 loss2:0.0221 loss3:0.0054 | AUC:0.8177 Anomaly AUC:0.6617
[2023-08-26 19:43:59,049][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00050 | loss1:0.0003 loss2:0.0886 loss3:0.0050 | AUC:0.8163 Anomaly AUC:0.6568
[2023-08-26 19:44:13,833][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00050 | loss1:0.0007 loss2:0.0812 loss3:0.0053 | AUC:0.8175 Anomaly AUC:0.6538
[2023-08-26 19:44:13,860][main.py][line:114][INFO] Training completes in 1m 59s | best AUCAUC:0.8238 Anomaly AUC:0.6629

[2023-08-26 19:44:24,713][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00060 | loss1:0.0117 loss2:0.0994 loss3:0.0152 | AUC:0.8218 Anomaly AUC:0.6478
[2023-08-26 19:44:35,490][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00060 | loss1:0.0015 loss2:0.0832 loss3:0.0136 | AUC:0.8193 Anomaly AUC:0.6596
[2023-08-26 19:44:47,028][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00060 | loss1:0.0001 loss2:0.0204 loss3:0.0093 | AUC:0.8217 Anomaly AUC:0.6635
[2023-08-26 19:44:58,489][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00060 | loss1:0.0000 loss2:0.0000 loss3:0.0058 | AUC:0.8229 Anomaly AUC:0.6663
[2023-08-26 19:45:11,010][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00060 | loss1:0.0000 loss2:0.0000 loss3:0.0051 | AUC:0.8238 Anomaly AUC:0.6683
[2023-08-26 19:45:21,781][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00060 | loss1:0.0000 loss2:0.0000 loss3:0.0046 | AUC:0.8244 Anomaly AUC:0.6692
[2023-08-26 19:45:35,785][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00060 | loss1:0.0000 loss2:0.0000 loss3:0.0047 | AUC:0.8238 Anomaly AUC:0.6684
[2023-08-26 19:45:47,928][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00060 | loss1:0.0000 loss2:0.0000 loss3:0.0047 | AUC:0.8236 Anomaly AUC:0.6693
[2023-08-26 19:45:59,760][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00060 | loss1:0.0000 loss2:0.0000 loss3:0.0043 | AUC:0.8234 Anomaly AUC:0.6692
[2023-08-26 19:46:12,445][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00060 | loss1:0.0000 loss2:0.0000 loss3:0.0048 | AUC:0.8234 Anomaly AUC:0.6694
[2023-08-26 19:46:12,495][main.py][line:114][INFO] Training completes in 1m 59s | best AUCAUC:0.8244 Anomaly AUC:0.6692

[2023-08-26 19:46:23,579][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00070 | loss1:0.0618 loss2:0.0752 loss3:0.0096 | AUC:0.8250 Anomaly AUC:0.6731
[2023-08-26 19:46:34,418][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00070 | loss1:0.0099 loss2:0.6545 loss3:0.0063 | AUC:0.8288 Anomaly AUC:0.6651
[2023-08-26 19:46:45,219][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00070 | loss1:0.0007 loss2:0.5940 loss3:0.0049 | AUC:0.8275 Anomaly AUC:0.6711
[2023-08-26 19:46:59,150][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00070 | loss1:0.0003 loss2:0.1733 loss3:0.0049 | AUC:0.8242 Anomaly AUC:0.6795
[2023-08-26 19:47:10,469][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00070 | loss1:0.0016 loss2:0.4500 loss3:0.0046 | AUC:0.8258 Anomaly AUC:0.6798
[2023-08-26 19:47:21,289][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00070 | loss1:0.0003 loss2:0.1786 loss3:0.0047 | AUC:0.8261 Anomaly AUC:0.6770
[2023-08-26 19:47:32,228][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00070 | loss1:0.0002 loss2:0.1054 loss3:0.0054 | AUC:0.8237 Anomaly AUC:0.6753
[2023-08-26 19:47:46,095][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00070 | loss1:0.0003 loss2:0.1040 loss3:0.0047 | AUC:0.8220 Anomaly AUC:0.6719
[2023-08-26 19:47:59,846][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00070 | loss1:0.0002 loss2:0.0636 loss3:0.0055 | AUC:0.8241 Anomaly AUC:0.6722
[2023-08-26 19:48:13,382][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00070 | loss1:0.0002 loss2:0.0513 loss3:0.0046 | AUC:0.8209 Anomaly AUC:0.6752
[2023-08-26 19:48:13,452][main.py][line:114][INFO] Training completes in 2m 1s | best AUCAUC:0.8288 Anomaly AUC:0.6651

[2023-08-26 19:48:27,883][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00070 | loss1:0.0074 loss2:0.5029 loss3:0.0107 | AUC:0.8194 Anomaly AUC:0.6543
[2023-08-26 19:48:39,911][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00070 | loss1:0.0003 loss2:0.3050 loss3:0.0056 | AUC:0.8283 Anomaly AUC:0.6680
[2023-08-26 19:48:57,215][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00070 | loss1:0.0042 loss2:0.2282 loss3:0.0061 | AUC:0.8160 Anomaly AUC:0.6689
[2023-08-26 19:49:11,781][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00070 | loss1:0.0132 loss2:0.6058 loss3:0.0099 | AUC:0.8235 Anomaly AUC:0.6615
[2023-08-26 19:49:25,480][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00070 | loss1:0.0030 loss2:0.4784 loss3:0.0068 | AUC:0.8151 Anomaly AUC:0.6624
[2023-08-26 19:49:42,217][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00070 | loss1:0.0008 loss2:0.2522 loss3:0.0046 | AUC:0.8100 Anomaly AUC:0.6673
[2023-08-26 19:49:53,113][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00070 | loss1:0.0004 loss2:0.4678 loss3:0.0045 | AUC:0.8115 Anomaly AUC:0.6694
[2023-08-26 19:50:10,766][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00070 | loss1:0.0002 loss2:0.1817 loss3:0.0047 | AUC:0.8141 Anomaly AUC:0.6698
[2023-08-26 19:50:22,172][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00070 | loss1:0.0002 loss2:0.1516 loss3:0.0052 | AUC:0.8112 Anomaly AUC:0.6693
[2023-08-26 19:50:33,046][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00070 | loss1:0.0002 loss2:0.1020 loss3:0.0044 | AUC:0.8083 Anomaly AUC:0.6665
[2023-08-26 19:50:33,072][main.py][line:114][INFO] Training completes in 2m 20s | best AUCAUC:0.8283 Anomaly AUC:0.6680

[2023-08-26 19:50:43,833][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00070 | loss1:0.0208 loss2:0.0444 loss3:0.0122 | AUC:0.8068 Anomaly AUC:0.6634
[2023-08-26 19:50:57,493][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00070 | loss1:0.0080 loss2:0.0320 loss3:0.0061 | AUC:0.8186 Anomaly AUC:0.6674
[2023-08-26 19:51:09,842][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00070 | loss1:0.0062 loss2:0.2328 loss3:0.0055 | AUC:0.8258 Anomaly AUC:0.6654
[2023-08-26 19:51:20,765][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00070 | loss1:0.0054 loss2:0.7498 loss3:0.0063 | AUC:0.8321 Anomaly AUC:0.6837
[2023-08-26 19:51:31,535][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00070 | loss1:0.0002 loss2:0.5550 loss3:0.0041 | AUC:0.8181 Anomaly AUC:0.6755
[2023-08-26 19:51:43,396][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00070 | loss1:0.0009 loss2:0.2750 loss3:0.0055 | AUC:0.8224 Anomaly AUC:0.6689
[2023-08-26 19:51:57,789][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00070 | loss1:0.0004 loss2:0.2759 loss3:0.0047 | AUC:0.8180 Anomaly AUC:0.6713
[2023-08-26 19:52:21,409][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00070 | loss1:0.0005 loss2:0.1439 loss3:0.0044 | AUC:0.8173 Anomaly AUC:0.6596
[2023-08-26 19:52:32,456][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00070 | loss1:0.0002 loss2:0.1153 loss3:0.0051 | AUC:0.8132 Anomaly AUC:0.6736
[2023-08-26 19:52:46,626][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00070 | loss1:0.0002 loss2:0.0851 loss3:0.0041 | AUC:0.8080 Anomaly AUC:0.6697
[2023-08-26 19:52:46,677][main.py][line:114][INFO] Training completes in 2m 14s | best AUCAUC:0.8321 Anomaly AUC:0.6837

[2023-08-26 19:53:01,191][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00080 | loss1:0.0010 loss2:0.5101 loss3:0.0049 | AUC:0.8126 Anomaly AUC:0.6505
[2023-08-26 19:53:13,684][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00080 | loss1:0.0073 loss2:0.1722 loss3:0.0067 | AUC:0.8264 Anomaly AUC:0.6709
[2023-08-26 19:53:28,129][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00080 | loss1:0.0063 loss2:0.3747 loss3:0.0052 | AUC:0.8245 Anomaly AUC:0.6797
[2023-08-26 19:53:40,937][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00080 | loss1:0.0121 loss2:0.2246 loss3:0.0067 | AUC:0.8223 Anomaly AUC:0.6875
[2023-08-26 19:53:52,397][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00080 | loss1:0.0007 loss2:0.1761 loss3:0.0044 | AUC:0.8180 Anomaly AUC:0.6765
[2023-08-26 19:54:03,206][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00080 | loss1:0.0003 loss2:0.1344 loss3:0.0041 | AUC:0.8169 Anomaly AUC:0.6808
[2023-08-26 19:54:14,209][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00080 | loss1:0.0002 loss2:0.1020 loss3:0.0045 | AUC:0.8207 Anomaly AUC:0.6802
[2023-08-26 19:54:26,119][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00080 | loss1:0.0001 loss2:0.1002 loss3:0.0047 | AUC:0.8203 Anomaly AUC:0.6793
[2023-08-26 19:54:40,705][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00080 | loss1:0.0002 loss2:0.0843 loss3:0.0043 | AUC:0.8153 Anomaly AUC:0.6771
[2023-08-26 19:54:54,473][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00080 | loss1:0.0002 loss2:0.0641 loss3:0.0043 | AUC:0.8174 Anomaly AUC:0.6834
[2023-08-26 19:54:54,500][main.py][line:114][INFO] Training completes in 2m 8s | best AUCAUC:0.8264 Anomaly AUC:0.6709

[2023-08-26 19:55:05,379][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00040 | loss1:0.0389 loss2:0.3832 loss3:0.0167 | AUC:0.8076 Anomaly AUC:0.6852
[2023-08-26 19:55:16,303][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00040 | loss1:0.0011 loss2:0.1702 loss3:0.0084 | AUC:0.8161 Anomaly AUC:0.6822
[2023-08-26 19:55:27,880][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00040 | loss1:0.0003 loss2:0.0976 loss3:0.0061 | AUC:0.8200 Anomaly AUC:0.6776
[2023-08-26 19:55:40,740][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00040 | loss1:0.0004 loss2:0.0654 loss3:0.0073 | AUC:0.8173 Anomaly AUC:0.6729
[2023-08-26 19:55:55,046][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00040 | loss1:0.0004 loss2:0.0514 loss3:0.0056 | AUC:0.8177 Anomaly AUC:0.6821
[2023-08-26 19:56:07,845][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00040 | loss1:0.0003 loss2:0.0380 loss3:0.0055 | AUC:0.8201 Anomaly AUC:0.6766
[2023-08-26 19:56:19,324][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00040 | loss1:0.0003 loss2:0.0340 loss3:0.0056 | AUC:0.8217 Anomaly AUC:0.6844
[2023-08-26 19:56:30,269][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00040 | loss1:0.0015 loss2:0.0236 loss3:0.0061 | AUC:0.8251 Anomaly AUC:0.6870
[2023-08-26 19:56:41,110][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00040 | loss1:0.0002 loss2:0.0156 loss3:0.0056 | AUC:0.8193 Anomaly AUC:0.6827
[2023-08-26 19:56:54,858][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00040 | loss1:0.0003 loss2:0.0145 loss3:0.0059 | AUC:0.8165 Anomaly AUC:0.6695
[2023-08-26 19:56:54,914][main.py][line:114][INFO] Training completes in 2m 0s | best AUCAUC:0.8251 Anomaly AUC:0.6870

[2023-08-26 19:57:06,619][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00060 | loss1:0.0082 loss2:0.0869 loss3:0.0073 | AUC:0.8227 Anomaly AUC:0.6892
[2023-08-26 19:57:17,579][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00060 | loss1:0.0004 loss2:0.0338 loss3:0.0069 | AUC:0.8246 Anomaly AUC:0.6851
[2023-08-26 19:57:28,528][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00060 | loss1:0.0016 loss2:0.3048 loss3:0.0060 | AUC:0.8285 Anomaly AUC:0.6772
[2023-08-26 19:57:41,838][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00060 | loss1:0.0063 loss2:0.1294 loss3:0.0061 | AUC:0.8086 Anomaly AUC:0.6784
[2023-08-26 19:57:52,700][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00060 | loss1:0.0009 loss2:0.0588 loss3:0.0061 | AUC:0.8133 Anomaly AUC:0.6782
[2023-08-26 19:58:03,663][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00060 | loss1:0.0022 loss2:0.0413 loss3:0.0053 | AUC:0.8282 Anomaly AUC:0.6845
[2023-08-26 19:58:15,188][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00060 | loss1:0.0219 loss2:0.0571 loss3:0.0074 | AUC:0.8312 Anomaly AUC:0.6697
[2023-08-26 19:58:28,114][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00060 | loss1:0.0099 loss2:0.0817 loss3:0.0082 | AUC:0.8169 Anomaly AUC:0.6770
[2023-08-26 19:58:39,495][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00060 | loss1:0.0079 loss2:0.0578 loss3:0.0069 | AUC:0.8131 Anomaly AUC:0.6760
[2023-08-26 19:58:52,356][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00060 | loss1:0.0034 loss2:0.0778 loss3:0.0063 | AUC:0.8024 Anomaly AUC:0.6706
[2023-08-26 19:58:52,383][main.py][line:114][INFO] Training completes in 1m 57s | best AUCAUC:0.8312 Anomaly AUC:0.6697

[2023-08-26 19:59:03,241][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00050 | loss1:0.0159 loss2:0.1099 loss3:0.0105 | AUC:0.8065 Anomaly AUC:0.6777
[2023-08-26 19:59:17,224][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00050 | loss1:0.0004 loss2:0.0333 loss3:0.0058 | AUC:0.8255 Anomaly AUC:0.6794
[2023-08-26 19:59:35,139][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00050 | loss1:0.0001 loss2:0.0111 loss3:0.0053 | AUC:0.8271 Anomaly AUC:0.6803
[2023-08-26 19:59:45,867][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00050 | loss1:0.0001 loss2:0.0082 loss3:0.0041 | AUC:0.8245 Anomaly AUC:0.6808
[2023-08-26 19:59:57,884][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00050 | loss1:0.0000 loss2:0.0086 loss3:0.0042 | AUC:0.8261 Anomaly AUC:0.6828
[2023-08-26 20:00:10,382][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00050 | loss1:0.0001 loss2:0.0065 loss3:0.0037 | AUC:0.8265 Anomaly AUC:0.6822
[2023-08-26 20:00:24,841][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00050 | loss1:0.0001 loss2:0.0199 loss3:0.0043 | AUC:0.8242 Anomaly AUC:0.6831
[2023-08-26 20:00:38,598][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00050 | loss1:0.0001 loss2:0.0193 loss3:0.0039 | AUC:0.8233 Anomaly AUC:0.6817
[2023-08-26 20:00:49,350][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00050 | loss1:0.0002 loss2:0.0285 loss3:0.0042 | AUC:0.8204 Anomaly AUC:0.6741
[2023-08-26 20:01:00,151][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00050 | loss1:0.0001 loss2:0.0983 loss3:0.0040 | AUC:0.8202 Anomaly AUC:0.6724
[2023-08-26 20:01:00,178][main.py][line:114][INFO] Training completes in 2m 8s | best AUCAUC:0.8271 Anomaly AUC:0.6803

[2023-08-26 20:01:11,759][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00080 | loss1:0.0144 loss2:0.2697 loss3:0.0099 | AUC:0.8369 Anomaly AUC:0.6678
[2023-08-26 20:01:24,443][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00080 | loss1:0.0180 loss2:0.1369 loss3:0.0104 | AUC:0.7977 Anomaly AUC:0.6790
[2023-08-26 20:01:38,860][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00080 | loss1:0.0203 loss2:0.1430 loss3:0.0111 | AUC:0.8290 Anomaly AUC:0.6823
[2023-08-26 20:01:51,596][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00080 | loss1:0.0037 loss2:0.0639 loss3:0.0066 | AUC:0.8240 Anomaly AUC:0.6727
[2023-08-26 20:02:06,318][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00080 | loss1:0.0027 loss2:0.0399 loss3:0.0055 | AUC:0.8243 Anomaly AUC:0.6742
[2023-08-26 20:02:20,664][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00080 | loss1:0.0025 loss2:0.0305 loss3:0.0051 | AUC:0.8141 Anomaly AUC:0.6766
[2023-08-26 20:02:33,383][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00080 | loss1:0.0024 loss2:0.0184 loss3:0.0050 | AUC:0.8206 Anomaly AUC:0.6741
[2023-08-26 20:02:45,737][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00080 | loss1:0.0022 loss2:0.0298 loss3:0.0057 | AUC:0.8202 Anomaly AUC:0.6782
[2023-08-26 20:02:56,737][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00080 | loss1:0.0022 loss2:0.0338 loss3:0.0047 | AUC:0.8145 Anomaly AUC:0.6808
[2023-08-26 20:03:07,674][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00080 | loss1:0.0020 loss2:0.0318 loss3:0.0053 | AUC:0.8158 Anomaly AUC:0.6776
[2023-08-26 20:03:07,700][main.py][line:114][INFO] Training completes in 2m 7s | best AUCAUC:0.8369 Anomaly AUC:0.6678

[2023-08-26 20:03:21,459][main.py][line:106][INFO] [Epoch:1/10]: lr:0.00080 | loss1:0.0171 loss2:0.2741 loss3:0.0112 | AUC:0.7851 Anomaly AUC:0.6736
[2023-08-26 20:03:35,859][main.py][line:106][INFO] [Epoch:2/10]: lr:0.00080 | loss1:0.0178 loss2:0.1008 loss3:0.0123 | AUC:0.8164 Anomaly AUC:0.6634
[2023-08-26 20:03:48,800][main.py][line:106][INFO] [Epoch:3/10]: lr:0.00080 | loss1:0.0142 loss2:0.1148 loss3:0.0089 | AUC:0.8193 Anomaly AUC:0.6763
[2023-08-26 20:04:00,251][main.py][line:106][INFO] [Epoch:4/10]: lr:0.00080 | loss1:0.0044 loss2:0.0639 loss3:0.0081 | AUC:0.8209 Anomaly AUC:0.6693
[2023-08-26 20:04:11,133][main.py][line:106][INFO] [Epoch:5/10]: lr:0.00080 | loss1:0.0046 loss2:0.0468 loss3:0.0069 | AUC:0.8101 Anomaly AUC:0.6907
[2023-08-26 20:04:22,168][main.py][line:106][INFO] [Epoch:6/10]: lr:0.00080 | loss1:0.0030 loss2:0.0372 loss3:0.0058 | AUC:0.8191 Anomaly AUC:0.6741
[2023-08-26 20:04:36,247][main.py][line:106][INFO] [Epoch:7/10]: lr:0.00080 | loss1:0.0004 loss2:0.0195 loss3:0.0057 | AUC:0.8169 Anomaly AUC:0.6827
[2023-08-26 20:04:51,073][main.py][line:106][INFO] [Epoch:8/10]: lr:0.00080 | loss1:0.0002 loss2:0.0229 loss3:0.0049 | AUC:0.8220 Anomaly AUC:0.6839
[2023-08-26 20:05:02,437][main.py][line:106][INFO] [Epoch:9/10]: lr:0.00080 | loss1:0.0002 loss2:0.0364 loss3:0.0049 | AUC:0.8215 Anomaly AUC:0.6757
[2023-08-26 20:05:13,343][main.py][line:106][INFO] [Epoch:10/10]: lr:0.00080 | loss1:0.0003 loss2:0.1077 loss3:0.0048 | AUC:0.8243 Anomaly AUC:0.6738
[2023-08-26 20:05:13,368][main.py][line:114][INFO] Training completes in 2m 6s | best AUCAUC:0.8243 Anomaly AUC:0.6738

[2023-08-26 20:08:26,641][main.py][line:115][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.288, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 10, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 20:08:26,776][main.py][line:151][INFO] total params:9.6689M
[2023-08-26 20:08:26,776][main.py][line:154][INFO] Training Mode
[2023-08-26 20:08:26,777][main.py][line:73][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 20:08:26,777][main.py][line:74][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0008
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0007
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 20:08:34,796][main.py][line:77][INFO] Random initialize AUCAUC:0.5276 Anomaly AUC:0.48186
[2023-08-26 20:09:01,928][main.py][line:100][INFO] [Epoch:1/10]: lr:0.00080 | loss1:0.5661 loss2:1.2751 loss3:0.3325 | AUC:0.8016 Anomaly AUC:0.6263
[2023-08-26 20:09:37,489][main.py][line:100][INFO] [Epoch:2/10]: lr:0.00080 | loss1:0.3508 loss2:1.1085 loss3:0.1060 | AUC:0.8178 Anomaly AUC:0.6267
[2023-08-26 20:10:19,889][main.py][line:100][INFO] [Epoch:3/10]: lr:0.00080 | loss1:0.2772 loss2:1.0430 loss3:0.0545 | AUC:0.8319 Anomaly AUC:0.6498
[2023-08-26 20:10:54,572][main.py][line:100][INFO] [Epoch:4/10]: lr:0.00080 | loss1:0.2110 loss2:0.9668 loss3:0.0337 | AUC:0.8390 Anomaly AUC:0.6631
[2023-08-26 20:11:47,849][main.py][line:100][INFO] [Epoch:5/10]: lr:0.00080 | loss1:0.1592 loss2:0.9053 loss3:0.0254 | AUC:0.8181 Anomaly AUC:0.6701
[2023-08-26 20:12:31,743][main.py][line:100][INFO] [Epoch:6/10]: lr:0.00080 | loss1:0.1463 loss2:0.8999 loss3:0.0240 | AUC:0.8334 Anomaly AUC:0.6734
[2023-08-26 20:13:24,303][main.py][line:100][INFO] [Epoch:7/10]: lr:0.00080 | loss1:0.1112 loss2:0.8273 loss3:0.0188 | AUC:0.8025 Anomaly AUC:0.6371
[2023-08-26 20:14:04,447][main.py][line:100][INFO] [Epoch:8/10]: lr:0.00080 | loss1:0.0861 loss2:0.7794 loss3:0.0161 | AUC:0.8173 Anomaly AUC:0.6642
[2023-08-26 20:14:53,549][main.py][line:100][INFO] [Epoch:9/10]: lr:0.00080 | loss1:0.0717 loss2:0.7491 loss3:0.0142 | AUC:0.8294 Anomaly AUC:0.6541
[2023-08-26 20:16:00,633][main.py][line:100][INFO] [Epoch:10/10]: lr:0.00080 | loss1:0.0616 loss2:0.7137 loss3:0.0123 | AUC:0.8354 Anomaly AUC:0.6619
[2023-08-26 20:16:00,668][main.py][line:108][INFO] Training completes in 7m 26s | best AUCAUC:0.8390 Anomaly AUC:0.6631

[2023-08-26 20:21:09,653][main.py][line:115][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.288, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 20:21:09,822][main.py][line:151][INFO] total params:9.6689M
[2023-08-26 20:21:09,822][main.py][line:154][INFO] Training Mode
[2023-08-26 20:21:09,822][main.py][line:73][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
    (cat): Linear(in_features=2048, out_features=1024, bias=True)
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 20:21:09,822][main.py][line:74][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0008
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0007
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 20:21:17,898][main.py][line:77][INFO] Random initialize AUCAUC:0.5276 Anomaly AUC:0.48186
[2023-08-26 20:22:05,244][main.py][line:100][INFO] [Epoch:1/100]: lr:0.00080 | loss1:0.5661 loss2:1.2751 loss3:0.3325 | AUC:0.8016 Anomaly AUC:0.6263
[2023-08-26 20:23:16,482][main.py][line:100][INFO] [Epoch:2/100]: lr:0.00080 | loss1:0.3508 loss2:1.1085 loss3:0.1060 | AUC:0.8178 Anomaly AUC:0.6267
[2023-08-26 20:24:06,649][main.py][line:100][INFO] [Epoch:3/100]: lr:0.00080 | loss1:0.2772 loss2:1.0430 loss3:0.0545 | AUC:0.8319 Anomaly AUC:0.6498
[2023-08-26 20:24:51,894][main.py][line:100][INFO] [Epoch:4/100]: lr:0.00080 | loss1:0.2110 loss2:0.9668 loss3:0.0337 | AUC:0.8390 Anomaly AUC:0.6631
[2023-08-26 20:26:07,349][main.py][line:100][INFO] [Epoch:5/100]: lr:0.00080 | loss1:0.1592 loss2:0.9053 loss3:0.0254 | AUC:0.8181 Anomaly AUC:0.6701
[2023-08-26 20:27:13,038][main.py][line:100][INFO] [Epoch:6/100]: lr:0.00080 | loss1:0.1463 loss2:0.8999 loss3:0.0240 | AUC:0.8334 Anomaly AUC:0.6734
[2023-08-26 20:28:29,961][main.py][line:100][INFO] [Epoch:7/100]: lr:0.00080 | loss1:0.1112 loss2:0.8273 loss3:0.0188 | AUC:0.8025 Anomaly AUC:0.6371
[2023-08-26 20:29:34,399][main.py][line:100][INFO] [Epoch:8/100]: lr:0.00080 | loss1:0.0861 loss2:0.7794 loss3:0.0161 | AUC:0.8173 Anomaly AUC:0.6642
[2023-08-26 20:30:44,928][main.py][line:100][INFO] [Epoch:9/100]: lr:0.00080 | loss1:0.0717 loss2:0.7491 loss3:0.0142 | AUC:0.8294 Anomaly AUC:0.6541
[2023-08-26 20:31:57,185][main.py][line:100][INFO] [Epoch:10/100]: lr:0.00080 | loss1:0.0616 loss2:0.7137 loss3:0.0123 | AUC:0.8354 Anomaly AUC:0.6619
[2023-08-26 20:32:55,681][main.py][line:100][INFO] [Epoch:11/100]: lr:0.00080 | loss1:0.0527 loss2:0.6884 loss3:0.0111 | AUC:0.8080 Anomaly AUC:0.6684
[2023-08-26 20:34:22,693][main.py][line:100][INFO] [Epoch:12/100]: lr:0.00080 | loss1:0.0461 loss2:0.6495 loss3:0.0097 | AUC:0.8139 Anomaly AUC:0.6813
[2023-08-26 20:35:31,237][main.py][line:100][INFO] [Epoch:13/100]: lr:0.00080 | loss1:0.0251 loss2:0.5978 loss3:0.0072 | AUC:0.8079 Anomaly AUC:0.6385
[2023-08-26 20:36:46,582][main.py][line:100][INFO] [Epoch:14/100]: lr:0.00080 | loss1:0.0310 loss2:0.5221 loss3:0.0065 | AUC:0.7736 Anomaly AUC:0.5806
[2023-08-26 20:37:50,185][main.py][line:100][INFO] [Epoch:15/100]: lr:0.00080 | loss1:0.0194 loss2:0.4848 loss3:0.0055 | AUC:0.8193 Anomaly AUC:0.6568
[2023-08-26 20:38:39,147][main.py][line:100][INFO] [Epoch:16/100]: lr:0.00080 | loss1:0.0220 loss2:0.3071 loss3:0.0053 | AUC:0.7685 Anomaly AUC:0.6379
[2023-08-26 20:39:33,378][main.py][line:100][INFO] [Epoch:17/100]: lr:0.00080 | loss1:0.0232 loss2:0.3946 loss3:0.0057 | AUC:0.7442 Anomaly AUC:0.5453
[2023-08-26 20:40:23,335][main.py][line:100][INFO] [Epoch:18/100]: lr:0.00080 | loss1:0.0167 loss2:0.2027 loss3:0.0045 | AUC:0.7382 Anomaly AUC:0.6006
[2023-08-26 20:41:09,804][main.py][line:100][INFO] [Epoch:19/100]: lr:0.00080 | loss1:0.0434 loss2:0.4665 loss3:0.0092 | AUC:0.8024 Anomaly AUC:0.6414
[2023-08-26 20:41:51,113][main.py][line:100][INFO] [Epoch:20/100]: lr:0.00080 | loss1:0.0191 loss2:0.4960 loss3:0.0049 | AUC:0.7627 Anomaly AUC:0.5932
[2023-08-26 20:42:37,505][main.py][line:100][INFO] [Epoch:21/100]: lr:0.00080 | loss1:0.0125 loss2:0.4059 loss3:0.0036 | AUC:0.8004 Anomaly AUC:0.6661
[2023-08-26 20:43:35,111][main.py][line:100][INFO] [Epoch:22/100]: lr:0.00080 | loss1:0.0100 loss2:0.3261 loss3:0.0035 | AUC:0.7881 Anomaly AUC:0.6447
[2023-08-26 20:44:31,573][main.py][line:115][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.288, 'seed': 2023, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__current.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.005, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-26 20:44:31,718][main.py][line:151][INFO] total params:7.5707M
[2023-08-26 20:44:31,718][main.py][line:154][INFO] Training Mode
[2023-08-26 20:44:31,719][main.py][line:73][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.5, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.5, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.5, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-26 20:44:31,719][main.py][line:74][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0008
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    lr: 0.0007
    maximize: False
    weight_decay: 5e-05
)

[2023-08-26 20:44:42,032][main.py][line:77][INFO] Random initialize AUCAUC:0.5390 Anomaly AUC:0.54580
[2023-08-26 20:45:39,741][main.py][line:100][INFO] [Epoch:1/100]: lr:0.00080 | loss1:0.3744 loss2:1.1221 loss3:0.2346 | AUC:0.8227 Anomaly AUC:0.6356
[2023-08-26 20:46:54,791][main.py][line:100][INFO] [Epoch:2/100]: lr:0.00080 | loss1:0.1542 loss2:0.8680 loss3:0.0549 | AUC:0.8145 Anomaly AUC:0.6670
[2023-08-26 20:47:47,561][main.py][line:100][INFO] [Epoch:3/100]: lr:0.00080 | loss1:0.0676 loss2:0.7569 loss3:0.0231 | AUC:0.8332 Anomaly AUC:0.6733
[2023-08-26 20:48:56,856][main.py][line:100][INFO] [Epoch:4/100]: lr:0.00080 | loss1:0.0404 loss2:0.6888 loss3:0.0139 | AUC:0.8661 Anomaly AUC:0.7058
[2023-08-26 20:50:07,067][main.py][line:100][INFO] [Epoch:5/100]: lr:0.00080 | loss1:0.0235 loss2:0.5921 loss3:0.0067 | AUC:0.8582 Anomaly AUC:0.7050
[2023-08-26 20:51:32,717][main.py][line:100][INFO] [Epoch:6/100]: lr:0.00080 | loss1:0.0222 loss2:0.5251 loss3:0.0071 | AUC:0.8472 Anomaly AUC:0.6976
[2023-08-26 20:52:54,674][main.py][line:100][INFO] [Epoch:7/100]: lr:0.00080 | loss1:0.0246 loss2:0.4537 loss3:0.0079 | AUC:0.8078 Anomaly AUC:0.6991
[2023-08-26 20:54:29,507][main.py][line:100][INFO] [Epoch:8/100]: lr:0.00080 | loss1:0.0184 loss2:0.3736 loss3:0.0068 | AUC:0.8350 Anomaly AUC:0.6601
[2023-08-26 20:56:09,328][main.py][line:100][INFO] [Epoch:9/100]: lr:0.00080 | loss1:0.0161 loss2:0.2963 loss3:0.0066 | AUC:0.8275 Anomaly AUC:0.6512
[2023-08-26 20:57:07,753][main.py][line:100][INFO] [Epoch:10/100]: lr:0.00080 | loss1:0.0302 loss2:0.2674 loss3:0.0097 | AUC:0.8339 Anomaly AUC:0.6701
[2023-08-26 20:58:47,141][main.py][line:100][INFO] [Epoch:11/100]: lr:0.00080 | loss1:0.0097 loss2:0.1757 loss3:0.0039 | AUC:0.8343 Anomaly AUC:0.6590
[2023-08-26 21:00:03,297][main.py][line:100][INFO] [Epoch:12/100]: lr:0.00080 | loss1:0.0162 loss2:0.1349 loss3:0.0047 | AUC:0.8250 Anomaly AUC:0.6457
[2023-08-26 21:01:11,565][main.py][line:100][INFO] [Epoch:13/100]: lr:0.00080 | loss1:0.0125 loss2:0.0971 loss3:0.0043 | AUC:0.8129 Anomaly AUC:0.6227
[2023-08-26 21:02:43,358][main.py][line:100][INFO] [Epoch:14/100]: lr:0.00080 | loss1:0.0064 loss2:0.0622 loss3:0.0030 | AUC:0.8274 Anomaly AUC:0.5999
[2023-08-26 21:03:48,205][main.py][line:100][INFO] [Epoch:15/100]: lr:0.00080 | loss1:0.0130 loss2:0.0570 loss3:0.0038 | AUC:0.8169 Anomaly AUC:0.5995
[2023-08-26 21:04:48,336][main.py][line:100][INFO] [Epoch:16/100]: lr:0.00080 | loss1:0.0044 loss2:0.0343 loss3:0.0020 | AUC:0.8352 Anomaly AUC:0.6216
[2023-08-26 21:05:57,406][main.py][line:100][INFO] [Epoch:17/100]: lr:0.00080 | loss1:0.0048 loss2:0.0282 loss3:0.0022 | AUC:0.8250 Anomaly AUC:0.6086
[2023-08-26 21:07:00,341][main.py][line:100][INFO] [Epoch:18/100]: lr:0.00080 | loss1:0.0068 loss2:0.0202 loss3:0.0034 | AUC:0.8257 Anomaly AUC:0.6300
[2023-08-26 21:08:28,067][main.py][line:100][INFO] [Epoch:19/100]: lr:0.00080 | loss1:0.0077 loss2:0.0391 loss3:0.0037 | AUC:0.8421 Anomaly AUC:0.6473
[2023-08-26 21:09:52,729][main.py][line:100][INFO] [Epoch:20/100]: lr:0.00080 | loss1:0.0230 loss2:0.0684 loss3:0.0076 | AUC:0.8066 Anomaly AUC:0.5968
[2023-08-26 21:11:06,254][main.py][line:100][INFO] [Epoch:21/100]: lr:0.00080 | loss1:0.0121 loss2:0.0518 loss3:0.0050 | AUC:0.8119 Anomaly AUC:0.6261
[2023-08-26 21:12:31,737][main.py][line:100][INFO] [Epoch:22/100]: lr:0.00080 | loss1:0.0056 loss2:0.0228 loss3:0.0024 | AUC:0.8075 Anomaly AUC:0.6232
[2023-08-26 21:13:33,497][main.py][line:100][INFO] [Epoch:23/100]: lr:0.00080 | loss1:0.0248 loss2:0.0642 loss3:0.0086 | AUC:0.8056 Anomaly AUC:0.5847
[2023-08-26 21:15:01,099][main.py][line:100][INFO] [Epoch:24/100]: lr:0.00080 | loss1:0.0056 loss2:0.0219 loss3:0.0025 | AUC:0.8056 Anomaly AUC:0.5896
[2023-08-26 21:16:23,066][main.py][line:100][INFO] [Epoch:25/100]: lr:0.00080 | loss1:0.0060 loss2:0.0206 loss3:0.0024 | AUC:0.8056 Anomaly AUC:0.6010
[2023-08-26 21:17:54,988][main.py][line:100][INFO] [Epoch:26/100]: lr:0.00080 | loss1:0.0091 loss2:0.0312 loss3:0.0043 | AUC:0.8084 Anomaly AUC:0.6099
[2023-08-26 21:19:20,900][main.py][line:100][INFO] [Epoch:27/100]: lr:0.00080 | loss1:0.0024 loss2:0.0101 loss3:0.0016 | AUC:0.8003 Anomaly AUC:0.5944
[2023-08-26 21:20:20,982][main.py][line:100][INFO] [Epoch:28/100]: lr:0.00080 | loss1:0.0034 loss2:0.0127 loss3:0.0017 | AUC:0.7813 Anomaly AUC:0.5801
[2023-08-26 21:21:15,276][main.py][line:100][INFO] [Epoch:29/100]: lr:0.00080 | loss1:0.0064 loss2:0.0100 loss3:0.0024 | AUC:0.7886 Anomaly AUC:0.5451
[2023-08-26 21:22:18,559][main.py][line:100][INFO] [Epoch:30/100]: lr:0.00080 | loss1:0.0053 loss2:0.0158 loss3:0.0025 | AUC:0.8124 Anomaly AUC:0.6034
[2023-08-26 21:23:25,663][main.py][line:100][INFO] [Epoch:31/100]: lr:0.00080 | loss1:0.0150 loss2:0.0423 loss3:0.0047 | AUC:0.7999 Anomaly AUC:0.5788
[2023-08-26 21:24:45,271][main.py][line:100][INFO] [Epoch:32/100]: lr:0.00080 | loss1:0.0093 loss2:0.0231 loss3:0.0038 | AUC:0.8014 Anomaly AUC:0.5764
[2023-08-26 21:25:56,963][main.py][line:100][INFO] [Epoch:33/100]: lr:0.00080 | loss1:0.0114 loss2:0.0339 loss3:0.0033 | AUC:0.7765 Anomaly AUC:0.5617
[2023-08-26 21:26:48,917][main.py][line:100][INFO] [Epoch:34/100]: lr:0.00080 | loss1:0.0092 loss2:0.0276 loss3:0.0033 | AUC:0.8176 Anomaly AUC:0.6055
