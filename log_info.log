[2023-06-26 10:22:39,411][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': '/data/pyj/feat/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-06-26 10:22:41,974][main.py][line:113][INFO] total params:1.2091M
[2023-06-26 10:22:41,975][main.py][line:116][INFO] Training Mode
[2023-06-26 10:22:41,976][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-06-26 10:22:41,976][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0005
    lr: 0.0005
    weight_decay: 0
)

[2023-06-26 10:23:04,467][main.py][line:57][INFO] Random initialize AUC:0.5444 FAR:0.67905
[2023-06-26 10:28:20,970][main.py][line:74][INFO] [Epoch:1/50]: loss1:0.3674 loss2:1.0960 | AUC:0.8476 FAR:0.00341
[2023-06-26 10:30:40,865][main.py][line:74][INFO] [Epoch:2/50]: loss1:0.1536 loss2:0.8745 | AUC:0.8541 FAR:0.00519
[2023-06-26 10:33:03,047][main.py][line:74][INFO] [Epoch:3/50]: loss1:0.0670 loss2:0.7795 | AUC:0.8590 FAR:0.00314
[2023-06-26 10:35:17,897][main.py][line:74][INFO] [Epoch:4/50]: loss1:0.0374 loss2:0.7048 | AUC:0.8545 FAR:0.00242
[2023-06-26 10:37:32,002][main.py][line:74][INFO] [Epoch:5/50]: loss1:0.0248 loss2:0.6399 | AUC:0.8560 FAR:0.00232
[2023-06-26 10:39:47,095][main.py][line:74][INFO] [Epoch:6/50]: loss1:0.0166 loss2:0.5759 | AUC:0.8636 FAR:0.00580
[2023-06-26 10:42:02,062][main.py][line:74][INFO] [Epoch:7/50]: loss1:0.0365 loss2:0.5461 | AUC:0.8545 FAR:0.00328
[2023-06-26 10:44:15,828][main.py][line:74][INFO] [Epoch:8/50]: loss1:0.0120 loss2:0.4721 | AUC:0.8556 FAR:0.00264
[2023-06-26 10:46:30,014][main.py][line:74][INFO] [Epoch:9/50]: loss1:0.0087 loss2:0.4146 | AUC:0.8574 FAR:0.00259
[2023-06-26 10:48:41,037][main.py][line:74][INFO] [Epoch:10/50]: loss1:0.0081 loss2:0.3630 | AUC:0.8525 FAR:0.00370
[2023-06-26 10:50:55,236][main.py][line:74][INFO] [Epoch:11/50]: loss1:0.0073 loss2:0.3101 | AUC:0.8548 FAR:0.00408
[2023-06-26 10:53:07,085][main.py][line:74][INFO] [Epoch:12/50]: loss1:0.0064 loss2:0.2642 | AUC:0.8562 FAR:0.00235
[2023-06-26 10:55:18,935][main.py][line:74][INFO] [Epoch:13/50]: loss1:0.0161 loss2:0.2371 | AUC:0.8499 FAR:0.00790
[2023-06-26 10:57:37,384][main.py][line:74][INFO] [Epoch:14/50]: loss1:0.0484 loss2:0.2859 | AUC:0.8452 FAR:0.00368
[2023-06-26 11:00:35,001][main.py][line:74][INFO] [Epoch:15/50]: loss1:0.0098 loss2:0.2012 | AUC:0.8551 FAR:0.00304
[2023-06-26 11:03:11,084][main.py][line:74][INFO] [Epoch:16/50]: loss1:0.0094 loss2:0.1679 | AUC:0.8519 FAR:0.00306
[2023-06-26 11:05:38,862][main.py][line:74][INFO] [Epoch:17/50]: loss1:0.0147 loss2:0.1615 | AUC:0.8490 FAR:0.00277
[2023-06-26 11:08:03,205][main.py][line:74][INFO] [Epoch:18/50]: loss1:0.0047 loss2:0.1213 | AUC:0.8487 FAR:0.00227
[2023-06-26 11:10:24,212][main.py][line:74][INFO] [Epoch:19/50]: loss1:0.0036 loss2:0.0989 | AUC:0.8450 FAR:0.00245
[2023-06-26 11:13:19,243][main.py][line:74][INFO] [Epoch:20/50]: loss1:0.0041 loss2:0.0860 | AUC:0.8418 FAR:0.00232
[2023-06-26 11:15:38,669][main.py][line:74][INFO] [Epoch:21/50]: loss1:0.0029 loss2:0.0712 | AUC:0.8417 FAR:0.00200
[2023-06-26 11:18:00,753][main.py][line:74][INFO] [Epoch:22/50]: loss1:0.0024 loss2:0.0606 | AUC:0.8462 FAR:0.00235
[2023-06-26 11:20:18,162][main.py][line:74][INFO] [Epoch:23/50]: loss1:0.0020 loss2:0.0525 | AUC:0.8444 FAR:0.00311
[2023-06-26 11:22:40,464][main.py][line:74][INFO] [Epoch:24/50]: loss1:0.0017 loss2:0.0447 | AUC:0.8455 FAR:0.00232
[2023-06-26 11:24:56,506][main.py][line:74][INFO] [Epoch:25/50]: loss1:0.0018 loss2:0.0381 | AUC:0.8451 FAR:0.00319
[2023-06-26 11:27:15,959][main.py][line:74][INFO] [Epoch:26/50]: loss1:0.0017 loss2:0.0350 | AUC:0.8471 FAR:0.00257
[2023-06-26 11:29:41,893][main.py][line:74][INFO] [Epoch:27/50]: loss1:0.0015 loss2:0.0301 | AUC:0.8467 FAR:0.00232
[2023-06-26 11:32:09,740][main.py][line:74][INFO] [Epoch:28/50]: loss1:0.0014 loss2:0.0269 | AUC:0.8492 FAR:0.00262
[2023-06-26 11:34:33,227][main.py][line:74][INFO] [Epoch:29/50]: loss1:0.0010 loss2:0.0233 | AUC:0.8457 FAR:0.00299
[2023-06-26 11:37:08,390][main.py][line:74][INFO] [Epoch:30/50]: loss1:0.0258 loss2:0.0429 | AUC:0.8526 FAR:0.00294
[2023-06-26 11:39:32,361][main.py][line:74][INFO] [Epoch:31/50]: loss1:0.0112 loss2:0.0495 | AUC:0.8467 FAR:0.00294
[2023-06-26 11:41:57,373][main.py][line:74][INFO] [Epoch:32/50]: loss1:0.0028 loss2:0.0290 | AUC:0.8500 FAR:0.00289
[2023-06-26 11:44:23,142][main.py][line:74][INFO] [Epoch:33/50]: loss1:0.0014 loss2:0.0220 | AUC:0.8508 FAR:0.00319
[2023-06-26 11:46:44,860][main.py][line:74][INFO] [Epoch:34/50]: loss1:0.0010 loss2:0.0189 | AUC:0.8506 FAR:0.00343
[2023-06-26 11:49:10,181][main.py][line:74][INFO] [Epoch:35/50]: loss1:0.0010 loss2:0.0170 | AUC:0.8502 FAR:0.00408
[2023-06-26 11:51:38,606][main.py][line:74][INFO] [Epoch:36/50]: loss1:0.0011 loss2:0.0158 | AUC:0.8518 FAR:0.00314
[2023-06-26 11:53:58,995][main.py][line:74][INFO] [Epoch:37/50]: loss1:0.0029 loss2:0.0195 | AUC:0.8469 FAR:0.00380
[2023-06-26 11:56:12,383][main.py][line:74][INFO] [Epoch:38/50]: loss1:0.0009 loss2:0.0137 | AUC:0.8522 FAR:0.00368
[2023-06-26 11:58:23,435][main.py][line:74][INFO] [Epoch:39/50]: loss1:0.0008 loss2:0.0128 | AUC:0.8518 FAR:0.00366
[2023-06-26 12:00:33,337][main.py][line:74][INFO] [Epoch:40/50]: loss1:0.0006 loss2:0.0113 | AUC:0.8514 FAR:0.00380
[2023-06-26 12:02:45,002][main.py][line:74][INFO] [Epoch:41/50]: loss1:0.0006 loss2:0.0108 | AUC:0.8512 FAR:0.00405
[2023-06-26 12:05:00,560][main.py][line:74][INFO] [Epoch:42/50]: loss1:0.0005 loss2:0.0098 | AUC:0.8499 FAR:0.00316
[2023-06-26 12:07:11,449][main.py][line:74][INFO] [Epoch:43/50]: loss1:0.0005 loss2:0.0097 | AUC:0.8504 FAR:0.00368
[2023-06-26 12:09:23,488][main.py][line:74][INFO] [Epoch:44/50]: loss1:0.0005 loss2:0.0094 | AUC:0.8504 FAR:0.00353
[2023-06-26 12:11:36,193][main.py][line:74][INFO] [Epoch:45/50]: loss1:0.0005 loss2:0.0087 | AUC:0.8506 FAR:0.00385
[2023-06-26 12:13:48,758][main.py][line:74][INFO] [Epoch:46/50]: loss1:0.0004 loss2:0.0086 | AUC:0.8507 FAR:0.00348
[2023-06-26 12:15:58,737][main.py][line:74][INFO] [Epoch:47/50]: loss1:0.0005 loss2:0.0078 | AUC:0.8506 FAR:0.00346
[2023-06-26 12:18:23,042][main.py][line:74][INFO] [Epoch:48/50]: loss1:0.0004 loss2:0.0080 | AUC:0.8501 FAR:0.00326
[2023-06-26 12:20:36,653][main.py][line:74][INFO] [Epoch:49/50]: loss1:0.0004 loss2:0.0074 | AUC:0.8503 FAR:0.00373
[2023-06-26 12:23:07,479][main.py][line:74][INFO] [Epoch:50/50]: loss1:0.0004 loss2:0.0078 | AUC:0.8499 FAR:0.00341
[2023-06-26 12:23:07,491][main.py][line:80][INFO] Training completes in 120m 3s | best AUC:0.8636 FAR:0.00580

[2023-06-26 12:58:17,606][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': '/data/pyj/feat/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-06-26 12:58:19,910][main.py][line:113][INFO] total params:1.2091M
[2023-06-26 12:58:19,910][main.py][line:120][INFO] Test Mode
[2023-06-26 12:58:19,910][main.py][line:26][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-06-26 12:58:32,117][infer.py][line:47][INFO] offline AUC:0.8676 AP:0.3399 FAR:0.0047 | Complete in 0m 12s

[2023-06-26 12:59:02,787][main.py][line:87][INFO] Config:{'dataset': 'xd-violence', 'model_name': 'xd_', 'metrics': 'AP', 'feat_prefix': '/data/pyj/feat/xd-i3d', 'train_list': './list/xd/train.list', 'test_list': './list/xd/test.list', 'token_feat': './list/xd/xd-prompt.npy', 'gt': './list/xd/xd-gt.npy', 'win_size': 9, 'gamma': 0.06, 'bias': 0.02, 'norm': False, 't_step': 3, 'temp': 0.05, 'lamda': 1, 'seed': 4, 'test_bs': 5, 'smooth': 'fixed', 'kappa': 8, 'ckpt_path': './ckpt/xd__8526.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-06-26 12:59:05,198][main.py][line:113][INFO] total params:1.2073M
[2023-06-26 12:59:05,198][main.py][line:116][INFO] Training Mode
[2023-06-26 12:59:05,199][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(3,), stride=(1,))
)

[2023-06-26 12:59:05,200][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0005
    lr: 0.0005
    weight_decay: 0
)

[2023-06-26 12:59:18,902][main.py][line:57][INFO] Random initialize AP:0.2742 FAR:0.44700
[2023-06-26 13:01:57,379][main.py][line:74][INFO] [Epoch:1/50]: loss1:0.3384 loss2:0.5558 | AUC:0.7968 FAR:0.00456
[2023-06-26 13:04:52,989][main.py][line:74][INFO] [Epoch:2/50]: loss1:0.1947 loss2:0.3543 | AUC:0.8526 FAR:0.00625
[2023-06-26 13:07:34,256][main.py][line:74][INFO] [Epoch:3/50]: loss1:0.1335 loss2:0.2872 | AUC:0.8308 FAR:0.00221
[2023-06-26 13:10:18,471][main.py][line:74][INFO] [Epoch:4/50]: loss1:0.0996 loss2:0.2413 | AUC:0.8173 FAR:0.00126
[2023-06-26 13:12:57,282][main.py][line:74][INFO] [Epoch:5/50]: loss1:0.0694 loss2:0.2068 | AUC:0.8211 FAR:0.00284
[2023-06-26 13:15:36,887][main.py][line:74][INFO] [Epoch:6/50]: loss1:0.0557 loss2:0.1810 | AUC:0.7612 FAR:0.00112
[2023-06-26 13:18:18,239][main.py][line:74][INFO] [Epoch:7/50]: loss1:0.0558 loss2:0.1695 | AUC:0.8357 FAR:0.00404
[2023-06-26 13:20:57,396][main.py][line:74][INFO] [Epoch:8/50]: loss1:0.0400 loss2:0.1440 | AUC:0.8156 FAR:0.00363
[2023-06-26 13:23:37,743][main.py][line:74][INFO] [Epoch:9/50]: loss1:0.0278 loss2:0.1172 | AUC:0.7929 FAR:0.00229
[2023-06-26 13:26:19,042][main.py][line:74][INFO] [Epoch:10/50]: loss1:0.0448 loss2:0.1164 | AUC:0.8142 FAR:0.00328
[2023-06-26 13:28:58,999][main.py][line:74][INFO] [Epoch:11/50]: loss1:0.0307 loss2:0.1071 | AUC:0.8013 FAR:0.00066
[2023-06-26 13:31:42,415][main.py][line:74][INFO] [Epoch:12/50]: loss1:0.0209 loss2:0.0798 | AUC:0.8348 FAR:0.00309
[2023-06-26 13:34:19,254][main.py][line:74][INFO] [Epoch:13/50]: loss1:0.0175 loss2:0.0514 | AUC:0.8350 FAR:0.00263
[2023-06-26 13:36:51,850][main.py][line:74][INFO] [Epoch:14/50]: loss1:0.0101 loss2:0.0470 | AUC:0.7933 FAR:0.00080
[2023-06-26 13:39:23,674][main.py][line:74][INFO] [Epoch:15/50]: loss1:0.0108 loss2:0.0437 | AUC:0.8283 FAR:0.00231
[2023-06-26 13:42:20,757][main.py][line:74][INFO] [Epoch:16/50]: loss1:0.0082 loss2:0.0198 | AUC:0.7936 FAR:0.00064
[2023-06-26 13:44:59,435][main.py][line:74][INFO] [Epoch:17/50]: loss1:0.0154 loss2:0.0166 | AUC:0.8021 FAR:0.00121
[2023-06-26 13:47:50,154][main.py][line:74][INFO] [Epoch:18/50]: loss1:0.0185 loss2:0.0014 | AUC:0.8113 FAR:0.00184
[2023-06-26 13:50:30,184][main.py][line:74][INFO] [Epoch:19/50]: loss1:0.0046 loss2:0.0000 | AUC:0.8097 FAR:0.00215
[2023-06-26 13:53:36,445][main.py][line:74][INFO] [Epoch:20/50]: loss1:0.0036 loss2:0.0000 | AUC:0.8255 FAR:0.00179
[2023-06-26 13:56:21,920][main.py][line:74][INFO] [Epoch:21/50]: loss1:0.0255 loss2:0.0442 | AUC:0.7577 FAR:0.00151
[2023-06-26 13:58:58,932][main.py][line:74][INFO] [Epoch:22/50]: loss1:0.0109 loss2:0.0460 | AUC:0.7752 FAR:0.00054
[2023-06-26 14:01:49,618][main.py][line:74][INFO] [Epoch:23/50]: loss1:0.0079 loss2:0.0030 | AUC:0.8155 FAR:0.00156
[2023-06-26 14:04:31,046][main.py][line:74][INFO] [Epoch:24/50]: loss1:0.0082 loss2:0.0057 | AUC:0.8271 FAR:0.00207
[2023-06-26 14:07:17,468][main.py][line:74][INFO] [Epoch:25/50]: loss1:0.0022 loss2:0.0000 | AUC:0.8208 FAR:0.00239
[2023-06-26 14:10:09,596][main.py][line:74][INFO] [Epoch:26/50]: loss1:0.0061 loss2:0.0000 | AUC:0.8141 FAR:0.00144
[2023-06-26 14:13:11,678][main.py][line:74][INFO] [Epoch:27/50]: loss1:0.0033 loss2:0.0000 | AUC:0.8114 FAR:0.00133
[2023-06-26 14:15:41,063][main.py][line:74][INFO] [Epoch:28/50]: loss1:0.0025 loss2:0.0000 | AUC:0.8147 FAR:0.00180
[2023-06-26 14:18:21,049][main.py][line:74][INFO] [Epoch:29/50]: loss1:0.0018 loss2:0.0000 | AUC:0.8146 FAR:0.00144
[2023-06-26 14:21:01,533][main.py][line:74][INFO] [Epoch:30/50]: loss1:0.0010 loss2:0.0000 | AUC:0.8137 FAR:0.00170
[2023-06-26 14:23:50,767][main.py][line:74][INFO] [Epoch:31/50]: loss1:0.0116 loss2:0.0000 | AUC:0.8052 FAR:0.00183
[2023-06-26 14:26:37,664][main.py][line:74][INFO] [Epoch:32/50]: loss1:0.0133 loss2:0.0085 | AUC:0.8202 FAR:0.00126
[2023-06-26 14:29:21,201][main.py][line:74][INFO] [Epoch:33/50]: loss1:0.0022 loss2:0.0000 | AUC:0.8125 FAR:0.00354
[2023-06-26 14:32:20,565][main.py][line:74][INFO] [Epoch:34/50]: loss1:0.0011 loss2:0.0000 | AUC:0.8175 FAR:0.00199
[2023-06-26 14:35:02,375][main.py][line:74][INFO] [Epoch:35/50]: loss1:0.0018 loss2:0.0000 | AUC:0.8223 FAR:0.00252
[2023-06-26 14:37:52,408][main.py][line:74][INFO] [Epoch:36/50]: loss1:0.0009 loss2:0.0000 | AUC:0.8187 FAR:0.00286
[2023-06-26 14:40:35,544][main.py][line:74][INFO] [Epoch:37/50]: loss1:0.0007 loss2:0.0000 | AUC:0.8142 FAR:0.00266
[2023-06-26 14:43:26,219][main.py][line:74][INFO] [Epoch:38/50]: loss1:0.0006 loss2:0.0000 | AUC:0.8145 FAR:0.00217
[2023-06-26 14:46:16,282][main.py][line:74][INFO] [Epoch:39/50]: loss1:0.0006 loss2:0.0000 | AUC:0.8158 FAR:0.00236
[2023-06-26 14:49:05,279][main.py][line:74][INFO] [Epoch:40/50]: loss1:0.0006 loss2:0.0000 | AUC:0.8171 FAR:0.00236
[2023-06-26 14:51:52,563][main.py][line:74][INFO] [Epoch:41/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8156 FAR:0.00224
[2023-06-26 14:54:41,250][main.py][line:74][INFO] [Epoch:42/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8161 FAR:0.00212
[2023-06-26 14:57:32,924][main.py][line:74][INFO] [Epoch:43/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8148 FAR:0.00222
[2023-06-26 15:00:19,503][main.py][line:74][INFO] [Epoch:44/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8143 FAR:0.00239
[2023-06-26 15:03:07,044][main.py][line:74][INFO] [Epoch:45/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8150 FAR:0.00221
[2023-06-26 15:05:51,733][main.py][line:74][INFO] [Epoch:46/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8160 FAR:0.00236
[2023-06-26 15:08:43,028][main.py][line:74][INFO] [Epoch:47/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8150 FAR:0.00204
[2023-06-26 15:11:28,315][main.py][line:74][INFO] [Epoch:48/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8138 FAR:0.00220
[2023-06-26 15:14:14,464][main.py][line:74][INFO] [Epoch:49/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8136 FAR:0.00221
[2023-06-26 15:16:59,857][main.py][line:74][INFO] [Epoch:50/50]: loss1:0.0005 loss2:0.0000 | AUC:0.8146 FAR:0.00222
[2023-06-26 15:16:59,870][main.py][line:80][INFO] Training completes in 137m 41s | best AP:0.8526 FAR:0.00625

[2023-06-26 15:41:47,285][main.py][line:87][INFO] Config:{'dataset': 'xd-violence', 'model_name': 'xd_', 'metrics': 'AP', 'feat_prefix': '/data/pyj/feat/xd-i3d', 'train_list': './list/xd/train.list', 'test_list': './list/xd/test.list', 'token_feat': './list/xd/xd-prompt.npy', 'gt': './list/xd/xd-gt.npy', 'win_size': 9, 'gamma': 0.06, 'bias': 0.02, 'norm': False, 't_step': 3, 'temp': 0.05, 'lamda': 1, 'seed': 4, 'test_bs': 5, 'smooth': 'fixed', 'kappa': 8, 'ckpt_path': './ckpt/xd__8526.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-06-26 15:41:49,642][main.py][line:113][INFO] total params:1.2073M
[2023-06-26 15:41:49,643][main.py][line:120][INFO] Test Mode
[2023-06-26 15:41:49,643][main.py][line:26][INFO] loading pretrained checkpoint from ./ckpt/xd__8526.pkl.
[2023-06-26 15:42:03,950][infer.py][line:47][INFO] offline AUC:0.9494 AP:0.8559 FAR:0.0057 | Complete in 0m 14s

[2023-06-26 15:57:20,503][main.py][line:87][INFO] Config:{'dataset': 'shanghaiTech', 'model_name': 'SH_', 'metrics': 'AUC', 'feat_prefix': '/data/pyj/feat/SHTech-i3d', 'train_list': './list/sh/train.list', 'test_list': './list/sh/test.list', 'token_feat': './list/sh/sh-prompt.npy', 'abn_label': './list/sh/relabel.list', 'gt': './list/sh/sh-gt.npy', 'win_size': 5, 'gamma': 0.08, 'bias': 0.1, 'norm': True, 't_step': 3, 'temp': 0.2, 'lamda': 9, 'seed': 0, 'test_bs': 10, 'smooth': 'slide', 'kappa': 3, 'ckpt_path': './ckpt/SH__98.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-06-26 15:57:22,852][main.py][line:113][INFO] total params:1.2073M
[2023-06-26 15:57:22,852][main.py][line:116][INFO] Training Mode
[2023-06-26 15:57:22,853][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(3,), stride=(1,))
)

[2023-06-26 15:57:22,853][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    initial_lr: 0.0005
    lr: 0.0005
    weight_decay: 0
)

[2023-06-26 15:57:28,770][main.py][line:57][INFO] Random initialize AUC:0.5546 FAR:0.00402
[2023-06-26 15:57:47,743][main.py][line:74][INFO] [Epoch:1/50]: loss1:0.4849 loss2:0.7652 | AUC:0.9503 FAR:0.00013
[2023-06-26 15:58:02,767][main.py][line:74][INFO] [Epoch:2/50]: loss1:0.2230 loss2:0.6820 | AUC:0.9743 FAR:0.00013
[2023-06-26 15:58:17,780][main.py][line:74][INFO] [Epoch:3/50]: loss1:0.1478 loss2:0.6645 | AUC:0.9720 FAR:0.00052
[2023-06-26 15:58:33,830][main.py][line:74][INFO] [Epoch:4/50]: loss1:0.1041 loss2:0.6497 | AUC:0.9708 FAR:0.00675
[2023-06-26 15:58:48,718][main.py][line:74][INFO] [Epoch:5/50]: loss1:0.0817 loss2:0.6001 | AUC:0.9727 FAR:0.00117
[2023-06-26 15:59:03,862][main.py][line:74][INFO] [Epoch:6/50]: loss1:0.0786 loss2:0.5964 | AUC:0.9701 FAR:0.00221
[2023-06-26 15:59:25,136][main.py][line:74][INFO] [Epoch:7/50]: loss1:0.0591 loss2:0.5651 | AUC:0.9710 FAR:0.00065
[2023-06-26 15:59:44,337][main.py][line:74][INFO] [Epoch:8/50]: loss1:0.0509 loss2:0.5515 | AUC:0.9725 FAR:0.00039
[2023-06-26 15:59:59,596][main.py][line:74][INFO] [Epoch:9/50]: loss1:0.0404 loss2:0.5450 | AUC:0.9747 FAR:0.00039
[2023-06-26 16:00:16,175][main.py][line:74][INFO] [Epoch:10/50]: loss1:0.0459 loss2:0.5249 | AUC:0.9747 FAR:0.00286
[2023-06-26 16:00:31,393][main.py][line:74][INFO] [Epoch:11/50]: loss1:0.0296 loss2:0.4967 | AUC:0.9746 FAR:0.00026
[2023-06-26 16:00:46,321][main.py][line:74][INFO] [Epoch:12/50]: loss1:0.0291 loss2:0.4867 | AUC:0.9745 FAR:0.00208
[2023-06-26 16:01:01,580][main.py][line:74][INFO] [Epoch:13/50]: loss1:0.0219 loss2:0.4663 | AUC:0.9758 FAR:0.00234
[2023-06-26 16:01:16,639][main.py][line:74][INFO] [Epoch:14/50]: loss1:0.0229 loss2:0.4645 | AUC:0.9757 FAR:0.00013
[2023-06-26 16:01:31,589][main.py][line:74][INFO] [Epoch:15/50]: loss1:0.0174 loss2:0.4635 | AUC:0.9765 FAR:0.00026
[2023-06-26 16:01:46,888][main.py][line:74][INFO] [Epoch:16/50]: loss1:0.0178 loss2:0.4456 | AUC:0.9756 FAR:0.00104
[2023-06-26 16:02:03,523][main.py][line:74][INFO] [Epoch:17/50]: loss1:0.0147 loss2:0.4356 | AUC:0.9780 FAR:0.00039
[2023-06-26 16:02:18,675][main.py][line:74][INFO] [Epoch:18/50]: loss1:0.0140 loss2:0.4257 | AUC:0.9786 FAR:0.00000
[2023-06-26 16:02:33,844][main.py][line:74][INFO] [Epoch:19/50]: loss1:0.0131 loss2:0.4216 | AUC:0.9764 FAR:0.00026
[2023-06-26 16:02:49,216][main.py][line:74][INFO] [Epoch:20/50]: loss1:0.0161 loss2:0.4072 | AUC:0.9791 FAR:0.00013
[2023-06-26 16:03:04,618][main.py][line:74][INFO] [Epoch:21/50]: loss1:0.0127 loss2:0.3953 | AUC:0.9773 FAR:0.00026
[2023-06-26 16:03:20,056][main.py][line:74][INFO] [Epoch:22/50]: loss1:0.0160 loss2:0.4061 | AUC:0.9800 FAR:0.00000
[2023-06-26 16:03:35,280][main.py][line:74][INFO] [Epoch:23/50]: loss1:0.0083 loss2:0.3886 | AUC:0.9787 FAR:0.00052
[2023-06-26 16:03:50,522][main.py][line:74][INFO] [Epoch:24/50]: loss1:0.0090 loss2:0.3822 | AUC:0.9796 FAR:0.00091
[2023-06-26 16:04:05,581][main.py][line:74][INFO] [Epoch:25/50]: loss1:0.0085 loss2:0.3805 | AUC:0.9793 FAR:0.00052
[2023-06-26 16:04:20,777][main.py][line:74][INFO] [Epoch:26/50]: loss1:0.0087 loss2:0.3793 | AUC:0.9785 FAR:0.00026
[2023-06-26 16:04:36,022][main.py][line:74][INFO] [Epoch:27/50]: loss1:0.0082 loss2:0.3715 | AUC:0.9787 FAR:0.00117
[2023-06-26 16:04:51,156][main.py][line:74][INFO] [Epoch:28/50]: loss1:0.0069 loss2:0.3495 | AUC:0.9791 FAR:0.00026
[2023-06-26 16:05:06,556][main.py][line:74][INFO] [Epoch:29/50]: loss1:0.0068 loss2:0.3575 | AUC:0.9794 FAR:0.00026
[2023-06-26 16:05:21,932][main.py][line:74][INFO] [Epoch:30/50]: loss1:0.0066 loss2:0.3542 | AUC:0.9788 FAR:0.00052
[2023-06-26 16:05:37,223][main.py][line:74][INFO] [Epoch:31/50]: loss1:0.0071 loss2:0.3470 | AUC:0.9789 FAR:0.00039
[2023-06-26 16:05:52,259][main.py][line:74][INFO] [Epoch:32/50]: loss1:0.0077 loss2:0.3470 | AUC:0.9764 FAR:0.00026
[2023-06-26 16:06:07,467][main.py][line:74][INFO] [Epoch:33/50]: loss1:0.0122 loss2:0.3454 | AUC:0.9787 FAR:0.00052
[2023-06-26 16:06:26,627][main.py][line:74][INFO] [Epoch:34/50]: loss1:0.0067 loss2:0.3325 | AUC:0.9787 FAR:0.00026
[2023-06-26 16:06:41,889][main.py][line:74][INFO] [Epoch:35/50]: loss1:0.0075 loss2:0.3349 | AUC:0.9791 FAR:0.00078
[2023-06-26 16:06:57,134][main.py][line:74][INFO] [Epoch:36/50]: loss1:0.0073 loss2:0.3387 | AUC:0.9782 FAR:0.00026
[2023-06-26 16:07:12,229][main.py][line:74][INFO] [Epoch:37/50]: loss1:0.0064 loss2:0.3327 | AUC:0.9781 FAR:0.00039
[2023-06-26 16:07:27,618][main.py][line:74][INFO] [Epoch:38/50]: loss1:0.0057 loss2:0.3290 | AUC:0.9792 FAR:0.00026
[2023-06-26 16:07:42,658][main.py][line:74][INFO] [Epoch:39/50]: loss1:0.0060 loss2:0.3263 | AUC:0.9782 FAR:0.00026
[2023-06-26 16:07:57,784][main.py][line:74][INFO] [Epoch:40/50]: loss1:0.0056 loss2:0.3296 | AUC:0.9785 FAR:0.00026
[2023-06-26 16:08:12,894][main.py][line:74][INFO] [Epoch:41/50]: loss1:0.0053 loss2:0.3223 | AUC:0.9791 FAR:0.00026
[2023-06-26 16:08:28,308][main.py][line:74][INFO] [Epoch:42/50]: loss1:0.0051 loss2:0.3198 | AUC:0.9784 FAR:0.00026
[2023-06-26 16:08:43,714][main.py][line:74][INFO] [Epoch:43/50]: loss1:0.0047 loss2:0.3193 | AUC:0.9782 FAR:0.00026
[2023-06-26 16:08:59,230][main.py][line:74][INFO] [Epoch:44/50]: loss1:0.0052 loss2:0.3182 | AUC:0.9784 FAR:0.00013
[2023-06-26 16:09:14,430][main.py][line:74][INFO] [Epoch:45/50]: loss1:0.0055 loss2:0.3144 | AUC:0.9780 FAR:0.00039
[2023-06-26 16:09:29,465][main.py][line:74][INFO] [Epoch:46/50]: loss1:0.0051 loss2:0.3161 | AUC:0.9782 FAR:0.00052
[2023-06-26 16:09:44,569][main.py][line:74][INFO] [Epoch:47/50]: loss1:0.0054 loss2:0.3129 | AUC:0.9780 FAR:0.00026
[2023-06-26 16:09:59,630][main.py][line:74][INFO] [Epoch:48/50]: loss1:0.0052 loss2:0.3086 | AUC:0.9780 FAR:0.00026
[2023-06-26 16:10:14,719][main.py][line:74][INFO] [Epoch:49/50]: loss1:0.0053 loss2:0.3102 | AUC:0.9776 FAR:0.00026
[2023-06-26 16:10:30,256][main.py][line:74][INFO] [Epoch:50/50]: loss1:0.0054 loss2:0.3068 | AUC:0.9778 FAR:0.00026
[2023-06-26 16:10:30,266][main.py][line:80][INFO] Training completes in 13m 1s | best AUC:0.9800 FAR:0.00000

[2023-06-26 16:11:33,636][main.py][line:87][INFO] Config:{'dataset': 'shanghaiTech', 'model_name': 'SH_', 'metrics': 'AUC', 'feat_prefix': '/data/pyj/feat/SHTech-i3d', 'train_list': './list/sh/train.list', 'test_list': './list/sh/test.list', 'token_feat': './list/sh/sh-prompt.npy', 'abn_label': './list/sh/relabel.list', 'gt': './list/sh/sh-gt.npy', 'win_size': 5, 'gamma': 0.08, 'bias': 0.1, 'norm': True, 't_step': 3, 'temp': 0.2, 'lamda': 9, 'seed': 0, 'test_bs': 10, 'smooth': 'slide', 'kappa': 3, 'ckpt_path': './ckpt/SH__98.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-06-26 16:11:36,131][main.py][line:113][INFO] total params:1.2073M
[2023-06-26 16:11:36,132][main.py][line:120][INFO] Test Mode
[2023-06-26 16:11:36,132][main.py][line:26][INFO] loading pretrained checkpoint from ./ckpt/SH__98.pkl.
[2023-06-26 16:11:39,240][infer.py][line:47][INFO] offline AUC:0.9814 AP:0.7256 FAR:0.0000 | Complete in 0m 3s

[2023-07-18 18:54:03,714][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 18:59:39,683][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 18:59:39,770][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 18:59:39,770][main.py][line:116][INFO] Training Mode
[2023-07-18 18:59:39,770][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 18:59:39,770][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 19:00:55,941][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 19:00:56,021][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 19:00:56,021][main.py][line:116][INFO] Training Mode
[2023-07-18 19:00:56,021][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 19:00:56,021][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 19:01:19,432][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 19:01:19,510][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 19:01:19,510][main.py][line:116][INFO] Training Mode
[2023-07-18 19:01:19,510][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 19:01:19,510][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 21:09:03,798][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 21:09:03,867][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 21:09:03,867][main.py][line:116][INFO] Training Mode
[2023-07-18 21:09:03,868][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 21:09:03,868][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 21:10:13,301][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 21:10:13,386][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 21:10:13,386][main.py][line:116][INFO] Training Mode
[2023-07-18 21:10:13,386][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 21:10:13,386][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 21:11:15,753][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': 'data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 21:11:15,839][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 21:11:15,839][main.py][line:116][INFO] Training Mode
[2023-07-18 21:11:15,839][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 21:11:15,839][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 21:13:07,296][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 21:13:07,372][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 21:13:07,372][main.py][line:116][INFO] Training Mode
[2023-07-18 21:13:07,372][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 21:13:07,372][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-18 21:19:16,657][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-18 21:19:16,735][main.py][line:113][INFO] total params:1.2091M
[2023-07-18 21:19:16,735][main.py][line:116][INFO] Training Mode
[2023-07-18 21:19:16,736][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-18 21:19:16,736][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 11:27:03,988][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 11:27:04,068][main.py][line:113][INFO] total params:1.2091M
[2023-07-19 11:27:04,068][main.py][line:116][INFO] Training Mode
[2023-07-19 11:27:04,068][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-19 11:27:04,068][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 11:27:09,343][main.py][line:57][INFO] Random initialize AUC:0.5444 FAR:0.67905
[2023-07-19 12:21:54,239][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 12:21:54,309][main.py][line:113][INFO] total params:1.2091M
[2023-07-19 12:21:54,309][main.py][line:116][INFO] Training Mode
[2023-07-19 12:21:54,309][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-19 12:21:54,309][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 12:22:00,012][main.py][line:57][INFO] Random initialize AUC:0.5444 FAR:0.67905
[2023-07-19 12:23:08,184][main.py][line:74][INFO] [Epoch:1/50]: loss1:0.3876 loss2:1.1033 | AUC:0.8392 FAR:0.01675
[2023-07-19 12:24:18,179][main.py][line:74][INFO] [Epoch:2/50]: loss1:0.1549 loss2:0.8760 | AUC:0.8480 FAR:0.00432
[2023-07-19 12:25:21,828][main.py][line:74][INFO] [Epoch:3/50]: loss1:0.0676 loss2:0.7808 | AUC:0.8484 FAR:0.00615
[2023-07-19 12:26:25,442][main.py][line:74][INFO] [Epoch:4/50]: loss1:0.0359 loss2:0.7089 | AUC:0.8434 FAR:0.01408
[2023-07-19 12:27:20,958][main.py][line:74][INFO] [Epoch:5/50]: loss1:0.0322 loss2:0.6461 | AUC:0.8439 FAR:0.00445
[2023-07-19 12:28:19,012][main.py][line:74][INFO] [Epoch:6/50]: loss1:0.0299 loss2:0.5980 | AUC:0.8548 FAR:0.00457
[2023-07-19 12:29:19,856][main.py][line:74][INFO] [Epoch:7/50]: loss1:0.0124 loss2:0.5263 | AUC:0.8540 FAR:0.00385
[2023-07-19 12:30:19,107][main.py][line:74][INFO] [Epoch:8/50]: loss1:0.0097 loss2:0.4665 | AUC:0.8489 FAR:0.00336
[2023-07-19 12:31:18,359][main.py][line:74][INFO] [Epoch:9/50]: loss1:0.0145 loss2:0.4156 | AUC:0.8466 FAR:0.02181
[2023-07-19 12:32:18,710][main.py][line:74][INFO] [Epoch:10/50]: loss1:0.0372 loss2:0.4206 | AUC:0.8433 FAR:0.00766
[2023-07-19 12:33:18,271][main.py][line:74][INFO] [Epoch:11/50]: loss1:0.0131 loss2:0.3500 | AUC:0.8461 FAR:0.00257
[2023-07-19 12:34:14,807][main.py][line:74][INFO] [Epoch:12/50]: loss1:0.0120 loss2:0.2901 | AUC:0.8480 FAR:0.00450
[2023-07-19 12:35:12,484][main.py][line:74][INFO] [Epoch:13/50]: loss1:0.0063 loss2:0.2259 | AUC:0.8495 FAR:0.00336
[2023-07-19 12:36:15,644][main.py][line:74][INFO] [Epoch:14/50]: loss1:0.0100 loss2:0.1968 | AUC:0.8492 FAR:0.00454
[2023-07-19 12:37:14,230][main.py][line:74][INFO] [Epoch:15/50]: loss1:0.0049 loss2:0.1675 | AUC:0.8493 FAR:0.00412
[2023-07-19 12:38:15,076][main.py][line:74][INFO] [Epoch:16/50]: loss1:0.0040 loss2:0.1473 | AUC:0.8468 FAR:0.00247
[2023-07-19 12:39:14,637][main.py][line:74][INFO] [Epoch:17/50]: loss1:0.0035 loss2:0.1242 | AUC:0.8470 FAR:0.00346
[2023-07-19 12:40:12,584][main.py][line:74][INFO] [Epoch:18/50]: loss1:0.0032 loss2:0.1100 | AUC:0.8485 FAR:0.00309
[2023-07-19 12:41:10,767][main.py][line:74][INFO] [Epoch:19/50]: loss1:0.0030 loss2:0.0976 | AUC:0.8466 FAR:0.00306
[2023-07-19 12:42:10,567][main.py][line:74][INFO] [Epoch:20/50]: loss1:0.0158 loss2:0.1086 | AUC:0.8364 FAR:0.00232
[2023-07-19 12:43:11,065][main.py][line:74][INFO] [Epoch:21/50]: loss1:0.0228 loss2:0.1320 | AUC:0.8434 FAR:0.00427
[2023-07-19 12:44:10,795][main.py][line:74][INFO] [Epoch:22/50]: loss1:0.0101 loss2:0.1010 | AUC:0.8441 FAR:0.00521
[2023-07-19 12:45:10,883][main.py][line:74][INFO] [Epoch:23/50]: loss1:0.0045 loss2:0.0745 | AUC:0.8465 FAR:0.00370
[2023-07-19 12:46:08,643][main.py][line:74][INFO] [Epoch:24/50]: loss1:0.0030 loss2:0.0618 | AUC:0.8506 FAR:0.00442
[2023-07-19 12:47:08,362][main.py][line:74][INFO] [Epoch:25/50]: loss1:0.0022 loss2:0.0517 | AUC:0.8491 FAR:0.00469
[2023-07-19 12:48:07,082][main.py][line:74][INFO] [Epoch:26/50]: loss1:0.0017 loss2:0.0433 | AUC:0.8502 FAR:0.00383
[2023-07-19 12:49:05,367][main.py][line:74][INFO] [Epoch:27/50]: loss1:0.0015 loss2:0.0376 | AUC:0.8500 FAR:0.00400
[2023-07-19 12:50:05,385][main.py][line:74][INFO] [Epoch:28/50]: loss1:0.0017 loss2:0.0341 | AUC:0.8437 FAR:0.00351
[2023-07-19 12:51:03,628][main.py][line:74][INFO] [Epoch:29/50]: loss1:0.0015 loss2:0.0298 | AUC:0.8479 FAR:0.00390
[2023-07-19 12:52:00,475][main.py][line:74][INFO] [Epoch:30/50]: loss1:0.0013 loss2:0.0263 | AUC:0.8473 FAR:0.00408
[2023-07-19 12:52:58,913][main.py][line:74][INFO] [Epoch:31/50]: loss1:0.0019 loss2:0.0247 | AUC:0.8495 FAR:0.00383
[2023-07-19 12:54:03,204][main.py][line:74][INFO] [Epoch:32/50]: loss1:0.0014 loss2:0.0247 | AUC:0.8509 FAR:0.00333
[2023-07-19 12:55:04,813][main.py][line:74][INFO] [Epoch:33/50]: loss1:0.0011 loss2:0.0219 | AUC:0.8533 FAR:0.00380
[2023-07-19 12:56:03,081][main.py][line:74][INFO] [Epoch:34/50]: loss1:0.0010 loss2:0.0196 | AUC:0.8535 FAR:0.00398
[2023-07-19 12:57:01,575][main.py][line:74][INFO] [Epoch:35/50]: loss1:0.0009 loss2:0.0185 | AUC:0.8520 FAR:0.00351
[2023-07-19 12:57:59,037][main.py][line:74][INFO] [Epoch:36/50]: loss1:0.0008 loss2:0.0169 | AUC:0.8509 FAR:0.00363
[2023-07-19 12:58:56,710][main.py][line:74][INFO] [Epoch:37/50]: loss1:0.0007 loss2:0.0148 | AUC:0.8505 FAR:0.00388
[2023-07-19 12:59:53,102][main.py][line:74][INFO] [Epoch:38/50]: loss1:0.0007 loss2:0.0150 | AUC:0.8505 FAR:0.00341
[2023-07-19 13:00:50,637][main.py][line:74][INFO] [Epoch:39/50]: loss1:0.0007 loss2:0.0135 | AUC:0.8520 FAR:0.00385
[2023-07-19 13:01:46,874][main.py][line:74][INFO] [Epoch:40/50]: loss1:0.0006 loss2:0.0131 | AUC:0.8513 FAR:0.00388
[2023-07-19 13:02:44,088][main.py][line:74][INFO] [Epoch:41/50]: loss1:0.0006 loss2:0.0121 | AUC:0.8509 FAR:0.00338
[2023-07-19 13:03:40,512][main.py][line:74][INFO] [Epoch:42/50]: loss1:0.0007 loss2:0.0123 | AUC:0.8483 FAR:0.00405
[2023-07-19 13:04:39,407][main.py][line:74][INFO] [Epoch:43/50]: loss1:0.0006 loss2:0.0115 | AUC:0.8496 FAR:0.00403
[2023-07-19 13:05:38,419][main.py][line:74][INFO] [Epoch:44/50]: loss1:0.0005 loss2:0.0106 | AUC:0.8506 FAR:0.00383
[2023-07-19 13:06:39,686][main.py][line:74][INFO] [Epoch:45/50]: loss1:0.0005 loss2:0.0100 | AUC:0.8501 FAR:0.00378
[2023-07-19 13:07:36,798][main.py][line:74][INFO] [Epoch:46/50]: loss1:0.0005 loss2:0.0094 | AUC:0.8489 FAR:0.00375
[2023-07-19 13:08:36,666][main.py][line:74][INFO] [Epoch:47/50]: loss1:0.0004 loss2:0.0093 | AUC:0.8492 FAR:0.00378
[2023-07-19 13:09:35,876][main.py][line:74][INFO] [Epoch:48/50]: loss1:0.0005 loss2:0.0092 | AUC:0.8489 FAR:0.00348
[2023-07-19 13:10:34,812][main.py][line:74][INFO] [Epoch:49/50]: loss1:0.0004 loss2:0.0091 | AUC:0.8498 FAR:0.00370
[2023-07-19 13:11:34,259][main.py][line:74][INFO] [Epoch:50/50]: loss1:0.0004 loss2:0.0083 | AUC:0.8498 FAR:0.00366
[2023-07-19 13:11:34,271][main.py][line:80][INFO] Training completes in 49m 34s | best AUC:0.8548 FAR:0.00457

[2023-07-19 13:34:44,147][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 13:34:44,242][main.py][line:113][INFO] total params:1.2091M
[2023-07-19 13:34:44,242][main.py][line:120][INFO] Test Mode
[2023-07-19 13:34:44,242][main.py][line:26][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-19 13:34:49,601][infer.py][line:47][INFO] offline AUC:0.8676 AP:0.3399 FAR:0.0047 | Complete in 0m 5s

[2023-07-19 13:36:37,769][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 13:36:37,837][main.py][line:113][INFO] total params:1.2091M
[2023-07-19 13:36:37,837][main.py][line:120][INFO] Test Mode
[2023-07-19 13:36:37,837][main.py][line:26][INFO] loading pretrained checkpoint from ./ckpt/ucf__8548.pkl.
[2023-07-19 13:36:43,176][infer.py][line:47][INFO] offline AUC:0.8601 AP:0.3172 FAR:0.0036 | Complete in 0m 5s

[2023-07-19 13:44:17,248][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 13:44:17,327][main.py][line:113][INFO] total params:1.2091M
[2023-07-19 13:44:17,327][main.py][line:116][INFO] Training Mode
[2023-07-19 13:44:17,328][main.py][line:53][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-19 13:44:17,328][main.py][line:54][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 13:44:22,210][main.py][line:57][INFO] Random initialize AUC:0.5444 FAR:0.67905
[2023-07-19 13:45:12,135][main.py][line:74][INFO] [Epoch:1/50]: loss1:0.3876 loss2:1.1033 | AUC:0.8392 FAR:0.01675
[2023-07-19 13:46:04,114][main.py][line:74][INFO] [Epoch:2/50]: loss1:0.1549 loss2:0.8760 | AUC:0.8480 FAR:0.00432
[2023-07-19 13:46:55,996][main.py][line:74][INFO] [Epoch:3/50]: loss1:0.0676 loss2:0.7808 | AUC:0.8484 FAR:0.00615
[2023-07-19 13:47:46,716][main.py][line:74][INFO] [Epoch:4/50]: loss1:0.0359 loss2:0.7089 | AUC:0.8434 FAR:0.01408
[2023-07-19 13:48:38,106][main.py][line:74][INFO] [Epoch:5/50]: loss1:0.0322 loss2:0.6461 | AUC:0.8439 FAR:0.00445
[2023-07-19 13:49:30,838][main.py][line:74][INFO] [Epoch:6/50]: loss1:0.0299 loss2:0.5980 | AUC:0.8548 FAR:0.00457
[2023-07-19 13:50:22,555][main.py][line:74][INFO] [Epoch:7/50]: loss1:0.0124 loss2:0.5263 | AUC:0.8540 FAR:0.00385
[2023-07-19 13:51:14,730][main.py][line:74][INFO] [Epoch:8/50]: loss1:0.0097 loss2:0.4665 | AUC:0.8489 FAR:0.00336
[2023-07-19 13:52:06,086][main.py][line:74][INFO] [Epoch:9/50]: loss1:0.0145 loss2:0.4156 | AUC:0.8466 FAR:0.02181
[2023-07-19 13:52:58,214][main.py][line:74][INFO] [Epoch:10/50]: loss1:0.0372 loss2:0.4206 | AUC:0.8433 FAR:0.00766
[2023-07-19 13:53:49,869][main.py][line:74][INFO] [Epoch:11/50]: loss1:0.0131 loss2:0.3500 | AUC:0.8461 FAR:0.00257
[2023-07-19 13:54:43,000][main.py][line:74][INFO] [Epoch:12/50]: loss1:0.0120 loss2:0.2901 | AUC:0.8480 FAR:0.00450
[2023-07-19 13:55:34,854][main.py][line:74][INFO] [Epoch:13/50]: loss1:0.0063 loss2:0.2259 | AUC:0.8495 FAR:0.00336
[2023-07-19 13:56:27,173][main.py][line:74][INFO] [Epoch:14/50]: loss1:0.0100 loss2:0.1968 | AUC:0.8492 FAR:0.00454
[2023-07-19 13:57:19,376][main.py][line:74][INFO] [Epoch:15/50]: loss1:0.0049 loss2:0.1675 | AUC:0.8493 FAR:0.00412
[2023-07-19 13:58:11,296][main.py][line:74][INFO] [Epoch:16/50]: loss1:0.0040 loss2:0.1473 | AUC:0.8468 FAR:0.00247
[2023-07-19 13:59:02,315][main.py][line:74][INFO] [Epoch:17/50]: loss1:0.0035 loss2:0.1242 | AUC:0.8470 FAR:0.00346
[2023-07-19 13:59:52,658][main.py][line:74][INFO] [Epoch:18/50]: loss1:0.0032 loss2:0.1100 | AUC:0.8485 FAR:0.00309
[2023-07-19 14:00:43,211][main.py][line:74][INFO] [Epoch:19/50]: loss1:0.0030 loss2:0.0976 | AUC:0.8466 FAR:0.00306
[2023-07-19 14:01:33,752][main.py][line:74][INFO] [Epoch:20/50]: loss1:0.0158 loss2:0.1086 | AUC:0.8364 FAR:0.00232
[2023-07-19 14:02:25,479][main.py][line:74][INFO] [Epoch:21/50]: loss1:0.0228 loss2:0.1320 | AUC:0.8434 FAR:0.00427
[2023-07-19 14:03:17,481][main.py][line:74][INFO] [Epoch:22/50]: loss1:0.0101 loss2:0.1010 | AUC:0.8441 FAR:0.00521
[2023-07-19 14:04:08,212][main.py][line:74][INFO] [Epoch:23/50]: loss1:0.0045 loss2:0.0745 | AUC:0.8465 FAR:0.00370
[2023-07-19 14:04:59,895][main.py][line:74][INFO] [Epoch:24/50]: loss1:0.0030 loss2:0.0618 | AUC:0.8506 FAR:0.00442
[2023-07-19 14:05:51,942][main.py][line:74][INFO] [Epoch:25/50]: loss1:0.0022 loss2:0.0517 | AUC:0.8491 FAR:0.00469
[2023-07-19 14:06:43,910][main.py][line:74][INFO] [Epoch:26/50]: loss1:0.0017 loss2:0.0433 | AUC:0.8502 FAR:0.00383
[2023-07-19 14:07:34,779][main.py][line:74][INFO] [Epoch:27/50]: loss1:0.0015 loss2:0.0376 | AUC:0.8500 FAR:0.00400
[2023-07-19 14:08:26,450][main.py][line:74][INFO] [Epoch:28/50]: loss1:0.0017 loss2:0.0341 | AUC:0.8437 FAR:0.00351
[2023-07-19 14:09:18,383][main.py][line:74][INFO] [Epoch:29/50]: loss1:0.0015 loss2:0.0298 | AUC:0.8479 FAR:0.00390
[2023-07-19 14:10:09,184][main.py][line:74][INFO] [Epoch:30/50]: loss1:0.0013 loss2:0.0263 | AUC:0.8473 FAR:0.00408
[2023-07-19 14:11:00,238][main.py][line:74][INFO] [Epoch:31/50]: loss1:0.0019 loss2:0.0247 | AUC:0.8495 FAR:0.00383
[2023-07-19 14:11:51,064][main.py][line:74][INFO] [Epoch:32/50]: loss1:0.0014 loss2:0.0247 | AUC:0.8509 FAR:0.00333
[2023-07-19 14:12:43,198][main.py][line:74][INFO] [Epoch:33/50]: loss1:0.0011 loss2:0.0219 | AUC:0.8533 FAR:0.00380
[2023-07-19 14:13:33,490][main.py][line:74][INFO] [Epoch:34/50]: loss1:0.0010 loss2:0.0196 | AUC:0.8535 FAR:0.00398
[2023-07-19 14:14:24,571][main.py][line:74][INFO] [Epoch:35/50]: loss1:0.0009 loss2:0.0185 | AUC:0.8520 FAR:0.00351
[2023-07-19 14:15:15,101][main.py][line:74][INFO] [Epoch:36/50]: loss1:0.0008 loss2:0.0169 | AUC:0.8509 FAR:0.00363
[2023-07-19 14:16:06,224][main.py][line:74][INFO] [Epoch:37/50]: loss1:0.0007 loss2:0.0148 | AUC:0.8505 FAR:0.00388
[2023-07-19 14:16:57,093][main.py][line:74][INFO] [Epoch:38/50]: loss1:0.0007 loss2:0.0150 | AUC:0.8505 FAR:0.00341
[2023-07-19 14:17:47,626][main.py][line:74][INFO] [Epoch:39/50]: loss1:0.0007 loss2:0.0135 | AUC:0.8520 FAR:0.00385
[2023-07-19 14:18:39,840][main.py][line:74][INFO] [Epoch:40/50]: loss1:0.0006 loss2:0.0131 | AUC:0.8513 FAR:0.00388
[2023-07-19 14:19:31,497][main.py][line:74][INFO] [Epoch:41/50]: loss1:0.0006 loss2:0.0121 | AUC:0.8509 FAR:0.00338
[2023-07-19 14:20:22,261][main.py][line:74][INFO] [Epoch:42/50]: loss1:0.0007 loss2:0.0123 | AUC:0.8483 FAR:0.00405
[2023-07-19 14:21:14,083][main.py][line:74][INFO] [Epoch:43/50]: loss1:0.0006 loss2:0.0115 | AUC:0.8496 FAR:0.00403
[2023-07-19 14:22:05,324][main.py][line:74][INFO] [Epoch:44/50]: loss1:0.0005 loss2:0.0106 | AUC:0.8506 FAR:0.00383
[2023-07-19 14:22:57,235][main.py][line:74][INFO] [Epoch:45/50]: loss1:0.0005 loss2:0.0100 | AUC:0.8501 FAR:0.00378
[2023-07-19 14:23:47,949][main.py][line:74][INFO] [Epoch:46/50]: loss1:0.0005 loss2:0.0094 | AUC:0.8489 FAR:0.00375
[2023-07-19 14:24:38,447][main.py][line:74][INFO] [Epoch:47/50]: loss1:0.0004 loss2:0.0093 | AUC:0.8492 FAR:0.00378
[2023-07-19 14:25:29,430][main.py][line:74][INFO] [Epoch:48/50]: loss1:0.0005 loss2:0.0092 | AUC:0.8489 FAR:0.00348
[2023-07-19 14:26:20,997][main.py][line:74][INFO] [Epoch:49/50]: loss1:0.0004 loss2:0.0091 | AUC:0.8498 FAR:0.00370
[2023-07-19 14:27:12,147][main.py][line:74][INFO] [Epoch:50/50]: loss1:0.0004 loss2:0.0083 | AUC:0.8498 FAR:0.00366
[2023-07-19 14:27:12,160][main.py][line:80][INFO] Training completes in 42m 50s | best AUC:0.8548 FAR:0.00457

[2023-07-19 14:31:40,316][main.py][line:87][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 14:31:40,425][main.py][line:113][INFO] total params:1.2091M
[2023-07-19 14:31:40,425][main.py][line:120][INFO] Test Mode
[2023-07-19 14:31:40,425][main.py][line:26][INFO] loading pretrained checkpoint from ./ckpt/ucf__8548.pkl.
[2023-07-19 14:31:46,121][infer.py][line:47][INFO] offline AUC:0.8601 AP:0.3172 FAR:0.0036 | Complete in 0m 6s

[2023-07-19 14:46:54,402][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 14:46:54,485][main.py][line:108][INFO] total params:1.2091M
[2023-07-19 14:46:54,485][main.py][line:111][INFO] Training Mode
[2023-07-19 14:46:54,486][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-19 14:46:54,486][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 14:48:43,190][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 14:48:43,272][main.py][line:108][INFO] total params:1.2091M
[2023-07-19 14:48:43,272][main.py][line:111][INFO] Training Mode
[2023-07-19 14:48:43,272][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-07-19 14:48:43,272][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 14:58:30,622][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 14:58:30,788][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 14:58:30,788][main.py][line:111][INFO] Training Mode
[2023-07-19 14:58:30,789][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
)

[2023-07-19 14:58:30,789][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:08:44,535][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:08:44,693][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:08:44,693][main.py][line:111][INFO] Training Mode
[2023-07-19 15:08:44,694][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
)

[2023-07-19 15:08:44,694][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:09:58,519][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:09:58,667][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:09:58,667][main.py][line:111][INFO] Training Mode
[2023-07-19 15:09:58,667][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
)

[2023-07-19 15:09:58,667][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:10:41,077][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8548.pkl', 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:11:58,286][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:11:58,446][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:11:58,446][main.py][line:111][INFO] Training Mode
[2023-07-19 15:11:58,446][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
)

[2023-07-19 15:11:58,446][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:12:33,472][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:12:33,631][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:12:33,631][main.py][line:111][INFO] Training Mode
[2023-07-19 15:12:33,632][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:12:33,632][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:13:25,037][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:13:25,201][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:13:25,201][main.py][line:111][INFO] Training Mode
[2023-07-19 15:13:25,201][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:13:25,201][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:13:37,921][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:13:38,078][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:13:38,078][main.py][line:111][INFO] Training Mode
[2023-07-19 15:13:38,079][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:13:38,079][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:14:03,343][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:14:03,506][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:14:03,506][main.py][line:111][INFO] Training Mode
[2023-07-19 15:14:03,506][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:14:03,506][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:39:27,713][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:39:40,531][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:39:40,679][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:39:40,679][main.py][line:111][INFO] Training Mode
[2023-07-19 15:39:40,679][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:39:40,679][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:40:05,811][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:40:05,969][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:40:05,969][main.py][line:111][INFO] Training Mode
[2023-07-19 15:40:05,969][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:40:05,969][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:43:33,112][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:43:33,272][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:43:33,272][main.py][line:111][INFO] Training Mode
[2023-07-19 15:43:33,272][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:43:33,272][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:44:58,268][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:44:58,418][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:44:58,418][main.py][line:111][INFO] Training Mode
[2023-07-19 15:44:58,418][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:44:58,418][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:45:26,066][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:45:26,214][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:45:26,214][main.py][line:111][INFO] Training Mode
[2023-07-19 15:45:26,214][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:45:26,214][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:59:14,813][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:59:14,972][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:59:14,972][main.py][line:111][INFO] Training Mode
[2023-07-19 15:59:14,972][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:59:14,972][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 15:59:26,260][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 15:59:26,409][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 15:59:26,409][main.py][line:111][INFO] Training Mode
[2023-07-19 15:59:26,410][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 15:59:26,410][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:00:17,464][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:00:17,623][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:00:17,623][main.py][line:111][INFO] Training Mode
[2023-07-19 16:00:17,624][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:00:17,624][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:00:27,960][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:00:28,109][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:00:28,109][main.py][line:111][INFO] Training Mode
[2023-07-19 16:00:28,109][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:00:28,109][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:01:28,931][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:01:29,091][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:01:29,091][main.py][line:111][INFO] Training Mode
[2023-07-19 16:01:29,091][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:01:29,091][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:01:57,114][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:01:57,271][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:01:57,271][main.py][line:111][INFO] Training Mode
[2023-07-19 16:01:57,272][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:01:57,272][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:02:15,599][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:02:15,757][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:02:15,758][main.py][line:111][INFO] Training Mode
[2023-07-19 16:02:15,758][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:02:15,758][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:02:25,387][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:02:25,544][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:02:25,544][main.py][line:111][INFO] Training Mode
[2023-07-19 16:02:25,544][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:02:25,544][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:02:54,098][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:02:54,258][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:02:54,258][main.py][line:111][INFO] Training Mode
[2023-07-19 16:02:54,258][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:02:54,258][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:03:13,069][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:03:13,227][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:03:13,227][main.py][line:111][INFO] Training Mode
[2023-07-19 16:03:13,228][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:03:13,228][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:03:55,900][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:03:56,066][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:03:56,066][main.py][line:111][INFO] Training Mode
[2023-07-19 16:03:56,067][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:03:56,067][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:04:47,740][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:04:47,904][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:04:47,904][main.py][line:111][INFO] Training Mode
[2023-07-19 16:04:47,904][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:04:47,904][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:05:02,269][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:05:02,420][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:05:02,420][main.py][line:111][INFO] Training Mode
[2023-07-19 16:05:02,420][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:05:02,420][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:06:20,525][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:06:20,675][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:06:20,675][main.py][line:111][INFO] Training Mode
[2023-07-19 16:06:20,675][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:06:20,676][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:11:53,816][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:11:53,971][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:11:53,971][main.py][line:111][INFO] Training Mode
[2023-07-19 16:11:53,972][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:11:53,972][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:16:58,189][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:16:58,345][main.py][line:108][INFO] total params:27.0045M
[2023-07-19 16:16:58,345][main.py][line:111][INFO] Training Mode
[2023-07-19 16:16:58,345][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:16:58,345][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:23:34,186][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:23:34,342][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:23:34,342][main.py][line:111][INFO] Training Mode
[2023-07-19 16:23:34,343][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:23:34,343][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:24:25,160][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:24:25,326][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:24:25,326][main.py][line:111][INFO] Training Mode
[2023-07-19 16:24:25,327][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:24:25,327][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:27:12,296][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:27:12,455][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:27:12,455][main.py][line:111][INFO] Training Mode
[2023-07-19 16:27:12,455][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:27:12,455][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:27:24,611][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:27:24,778][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:27:24,778][main.py][line:111][INFO] Training Mode
[2023-07-19 16:27:24,778][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:27:24,778][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:28:41,579][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:28:41,732][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:28:41,732][main.py][line:111][INFO] Training Mode
[2023-07-19 16:28:41,732][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:28:41,732][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:30:16,308][main.py][line:82][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:30:16,477][main.py][line:108][INFO] total params:27.0270M
[2023-07-19 16:30:16,477][main.py][line:111][INFO] Training Mode
[2023-07-19 16:30:16,477][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:30:16,478][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:32:44,531][main.py][line:83][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:32:44,694][main.py][line:109][INFO] total params:27.0270M
[2023-07-19 16:32:44,694][main.py][line:112][INFO] Training Mode
[2023-07-19 16:32:44,695][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:32:44,695][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:34:07,788][main.py][line:83][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:34:07,951][main.py][line:109][INFO] total params:27.0270M
[2023-07-19 16:34:07,951][main.py][line:112][INFO] Training Mode
[2023-07-19 16:34:07,951][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:34:07,951][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:34:15,549][main.py][line:52][INFO] Random initialize AUC:initial AUC:0.5452 initial AUC2:0.5444 FAR:0.67905
[2023-07-19 16:36:01,443][main.py][line:83][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:36:01,606][main.py][line:109][INFO] total params:27.0270M
[2023-07-19 16:36:01,606][main.py][line:112][INFO] Training Mode
[2023-07-19 16:36:01,606][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:36:01,606][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:36:09,149][main.py][line:52][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-19 16:38:29,607][main.py][line:83][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 16:38:29,782][main.py][line:109][INFO] total params:27.0270M
[2023-07-19 16:38:29,782][main.py][line:112][INFO] Training Mode
[2023-07-19 16:38:29,782][main.py][line:48][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 16:38:29,782][main.py][line:49][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 16:38:37,322][main.py][line:52][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-19 16:39:43,780][main.py][line:70][INFO] [Epoch:1/50]: loss1:0.3749 loss2:1.1640 | AUC:0.8316 AUC2:0.8316 FAR:0.00830
[2023-07-19 16:40:49,846][main.py][line:70][INFO] [Epoch:2/50]: loss1:0.1347 loss2:0.9541 | AUC:0.8518 AUC2:0.8517 FAR:0.00990
[2023-07-19 16:41:56,816][main.py][line:70][INFO] [Epoch:3/50]: loss1:0.0532 loss2:0.8623 | AUC:0.8554 AUC2:0.8553 FAR:0.01148
[2023-07-19 16:43:03,490][main.py][line:70][INFO] [Epoch:4/50]: loss1:0.0257 loss2:0.7901 | AUC:0.8447 AUC2:0.8553 FAR:0.00314
[2023-07-19 16:44:10,005][main.py][line:70][INFO] [Epoch:5/50]: loss1:0.0181 loss2:0.7232 | AUC:0.8501 AUC2:0.8553 FAR:0.00687
[2023-07-19 16:45:16,784][main.py][line:70][INFO] [Epoch:6/50]: loss1:0.0233 loss2:0.6746 | AUC:0.8471 AUC2:0.8553 FAR:0.00531
[2023-07-19 16:46:23,514][main.py][line:70][INFO] [Epoch:7/50]: loss1:0.0070 loss2:0.6079 | AUC:0.8466 AUC2:0.8553 FAR:0.00198
[2023-07-19 16:47:30,262][main.py][line:70][INFO] [Epoch:8/50]: loss1:0.0055 loss2:0.5477 | AUC:0.8531 AUC2:0.8553 FAR:0.00240
[2023-07-19 16:48:36,972][main.py][line:70][INFO] [Epoch:9/50]: loss1:0.0049 loss2:0.4848 | AUC:0.8494 AUC2:0.8553 FAR:0.00230
[2023-07-19 16:49:43,650][main.py][line:70][INFO] [Epoch:10/50]: loss1:0.0044 loss2:0.4338 | AUC:0.8456 AUC2:0.8553 FAR:0.00254
[2023-07-19 16:50:50,242][main.py][line:70][INFO] [Epoch:11/50]: loss1:0.0047 loss2:0.3830 | AUC:0.8392 AUC2:0.8553 FAR:0.00672
[2023-07-19 16:51:56,625][main.py][line:70][INFO] [Epoch:12/50]: loss1:0.0379 loss2:0.4065 | AUC:0.8534 AUC2:0.8553 FAR:0.00926
[2023-07-19 16:53:03,544][main.py][line:70][INFO] [Epoch:13/50]: loss1:0.0222 loss2:0.3520 | AUC:0.8516 AUC2:0.8553 FAR:0.00948
[2023-07-19 16:54:10,193][main.py][line:70][INFO] [Epoch:14/50]: loss1:0.0054 loss2:0.2840 | AUC:0.8504 AUC2:0.8553 FAR:0.00501
[2023-07-19 16:55:17,334][main.py][line:70][INFO] [Epoch:15/50]: loss1:0.0030 loss2:0.2417 | AUC:0.8510 AUC2:0.8553 FAR:0.00511
[2023-07-19 16:56:24,108][main.py][line:70][INFO] [Epoch:16/50]: loss1:0.0024 loss2:0.2048 | AUC:0.8512 AUC2:0.8553 FAR:0.00445
[2023-07-19 16:57:31,159][main.py][line:70][INFO] [Epoch:17/50]: loss1:0.0023 loss2:0.1751 | AUC:0.8478 AUC2:0.8553 FAR:0.00467
[2023-07-19 16:58:37,880][main.py][line:70][INFO] [Epoch:18/50]: loss1:0.0019 loss2:0.1487 | AUC:0.8490 AUC2:0.8553 FAR:0.00462
[2023-07-19 16:59:44,768][main.py][line:70][INFO] [Epoch:19/50]: loss1:0.0018 loss2:0.1273 | AUC:0.8506 AUC2:0.8553 FAR:0.00450
[2023-07-19 17:00:51,397][main.py][line:70][INFO] [Epoch:20/50]: loss1:0.0016 loss2:0.1072 | AUC:0.8478 AUC2:0.8553 FAR:0.00457
[2023-07-19 17:06:51,490][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0001, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 400, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 17:06:51,700][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 17:06:51,700][main.py][line:119][INFO] Training Mode
[2023-07-19 17:06:51,700][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 17:06:51,700][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0
)

[2023-07-19 17:06:59,538][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-19 17:07:54,176][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.4485 loss2:1.2754 main_loss:2.1725 | AUC:0.8194 AUC2:0.8194 FAR:0.02433
[2023-07-19 17:08:50,124][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.2570 loss2:1.1698 main_loss:1.6838 | AUC:0.8389 AUC2:0.8389 FAR:0.01223
[2023-07-19 17:09:46,478][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.1547 loss2:1.0519 main_loss:1.3613 | AUC:0.8474 AUC2:0.8474 FAR:0.00958
[2023-07-19 17:11:39,916][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 17:11:40,109][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 17:11:40,110][main.py][line:119][INFO] Training Mode
[2023-07-19 17:11:40,110][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 17:11:40,110][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0003
    lr: 0.0003
    maximize: False
    weight_decay: 0
)

[2023-07-19 17:11:48,068][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-19 17:13:22,557][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3629 loss2:1.1955 main_loss:1.9213 | AUC:0.8264 AUC2:0.8264 FAR:0.03816
[2023-07-19 17:14:56,395][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1381 loss2:1.0275 main_loss:1.3038 | AUC:0.8410 AUC2:0.8410 FAR:0.02023
[2023-07-19 17:16:26,214][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0442 loss2:0.9445 main_loss:1.0328 | AUC:0.8454 AUC2:0.8454 FAR:0.01319
[2023-07-19 17:17:52,735][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0233 loss2:0.8820 main_loss:0.9287 | AUC:0.8375 AUC2:0.8454 FAR:0.01512
[2023-07-19 17:19:25,363][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0129 loss2:0.8164 main_loss:0.8422 | AUC:0.8473 AUC2:0.8473 FAR:0.01487
[2023-07-19 17:20:49,699][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0100 loss2:0.7686 main_loss:0.7886 | AUC:0.8449 AUC2:0.8473 FAR:0.01218
[2023-07-19 17:22:11,673][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0111 loss2:0.7032 main_loss:0.7253 | AUC:0.8430 AUC2:0.8473 FAR:0.01420
[2023-07-19 17:23:31,803][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0178 loss2:0.6556 main_loss:0.6913 | AUC:0.8475 AUC2:0.8474 FAR:0.02737
[2023-07-19 17:24:46,241][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0074 loss2:0.5936 main_loss:0.6085 | AUC:0.8531 AUC2:0.8531 FAR:0.00489
[2023-07-19 17:26:01,668][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0071 loss2:0.5268 main_loss:0.5410 | AUC:0.8504 AUC2:0.8531 FAR:0.02220
[2023-07-19 17:27:19,595][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.0111 loss2:0.4812 main_loss:0.5035 | AUC:0.8531 AUC2:0.8531 FAR:0.00943
[2023-07-19 17:28:38,521][main.py][line:76][INFO] [Epoch:12/100]: loss1:0.0082 loss2:0.4237 main_loss:0.4400 | AUC:0.8474 AUC2:0.8531 FAR:0.01146
[2023-07-19 17:30:06,568][main.py][line:76][INFO] [Epoch:13/100]: loss1:0.0052 loss2:0.3560 main_loss:0.3663 | AUC:0.8493 AUC2:0.8531 FAR:0.01531
[2023-07-19 17:31:13,212][main.py][line:76][INFO] [Epoch:14/100]: loss1:0.0042 loss2:0.3048 main_loss:0.3132 | AUC:0.8518 AUC2:0.8531 FAR:0.01470
[2023-07-19 17:32:20,754][main.py][line:76][INFO] [Epoch:15/100]: loss1:0.0034 loss2:0.2458 main_loss:0.2527 | AUC:0.8500 AUC2:0.8531 FAR:0.00919
[2023-07-19 17:33:33,166][main.py][line:76][INFO] [Epoch:16/100]: loss1:0.0036 loss2:0.2038 main_loss:0.2110 | AUC:0.8522 AUC2:0.8531 FAR:0.01558
[2023-07-19 17:34:49,879][main.py][line:76][INFO] [Epoch:17/100]: loss1:0.0041 loss2:0.1666 main_loss:0.1748 | AUC:0.8470 AUC2:0.8531 FAR:0.01778
[2023-07-19 17:36:01,448][main.py][line:76][INFO] [Epoch:18/100]: loss1:0.0154 loss2:0.1745 main_loss:0.2052 | AUC:0.8399 AUC2:0.8531 FAR:0.04611
[2023-07-19 17:37:08,646][main.py][line:76][INFO] [Epoch:19/100]: loss1:0.0083 loss2:0.1454 main_loss:0.1620 | AUC:0.8486 AUC2:0.8531 FAR:0.01460
[2023-07-19 17:38:17,270][main.py][line:76][INFO] [Epoch:20/100]: loss1:0.0096 loss2:0.1003 main_loss:0.1195 | AUC:0.8418 AUC2:0.8531 FAR:0.01907
[2023-07-19 17:39:21,493][main.py][line:76][INFO] [Epoch:21/100]: loss1:0.0117 loss2:0.0891 main_loss:0.1125 | AUC:0.8451 AUC2:0.8531 FAR:0.02206
[2023-07-19 17:40:23,342][main.py][line:76][INFO] [Epoch:22/100]: loss1:0.0017 loss2:0.0657 main_loss:0.0690 | AUC:0.8458 AUC2:0.8531 FAR:0.02396
[2023-07-19 17:41:29,408][main.py][line:76][INFO] [Epoch:23/100]: loss1:0.0024 loss2:0.0572 main_loss:0.0620 | AUC:0.8437 AUC2:0.8531 FAR:0.01761
[2023-07-19 17:42:37,390][main.py][line:76][INFO] [Epoch:24/100]: loss1:0.0012 loss2:0.0448 main_loss:0.0472 | AUC:0.8473 AUC2:0.8531 FAR:0.01344
[2023-07-19 17:43:50,878][main.py][line:76][INFO] [Epoch:25/100]: loss1:0.0008 loss2:0.0362 main_loss:0.0378 | AUC:0.8481 AUC2:0.8531 FAR:0.01894
[2023-07-19 17:45:04,074][main.py][line:76][INFO] [Epoch:26/100]: loss1:0.0006 loss2:0.0280 main_loss:0.0293 | AUC:0.8501 AUC2:0.8531 FAR:0.01576
[2023-07-19 17:46:14,035][main.py][line:76][INFO] [Epoch:27/100]: loss1:0.0006 loss2:0.0238 main_loss:0.0250 | AUC:0.8495 AUC2:0.8531 FAR:0.01447
[2023-07-19 17:47:25,870][main.py][line:76][INFO] [Epoch:28/100]: loss1:0.0005 loss2:0.0190 main_loss:0.0199 | AUC:0.8501 AUC2:0.8531 FAR:0.01255
[2023-07-19 17:48:43,655][main.py][line:76][INFO] [Epoch:29/100]: loss1:0.0004 loss2:0.0173 main_loss:0.0181 | AUC:0.8499 AUC2:0.8531 FAR:0.01423
[2023-07-19 17:50:06,776][main.py][line:76][INFO] [Epoch:30/100]: loss1:0.0004 loss2:0.0146 main_loss:0.0154 | AUC:0.8498 AUC2:0.8531 FAR:0.01665
[2023-07-19 17:51:28,772][main.py][line:76][INFO] [Epoch:31/100]: loss1:0.0014 loss2:0.0145 main_loss:0.0173 | AUC:0.8488 AUC2:0.8531 FAR:0.01334
[2023-07-19 17:52:33,413][main.py][line:76][INFO] [Epoch:32/100]: loss1:0.0003 loss2:0.0117 main_loss:0.0124 | AUC:0.8493 AUC2:0.8531 FAR:0.01344
[2023-07-19 17:53:40,997][main.py][line:76][INFO] [Epoch:33/100]: loss1:0.0003 loss2:0.0100 main_loss:0.0106 | AUC:0.8492 AUC2:0.8531 FAR:0.01349
[2023-07-19 17:54:50,752][main.py][line:76][INFO] [Epoch:34/100]: loss1:0.0007 loss2:0.0106 main_loss:0.0121 | AUC:0.8480 AUC2:0.8531 FAR:0.01314
[2023-07-19 17:56:01,694][main.py][line:76][INFO] [Epoch:35/100]: loss1:0.0003 loss2:0.0089 main_loss:0.0094 | AUC:0.8500 AUC2:0.8531 FAR:0.01319
[2023-07-19 17:57:12,364][main.py][line:76][INFO] [Epoch:36/100]: loss1:0.0002 loss2:0.0072 main_loss:0.0077 | AUC:0.8500 AUC2:0.8531 FAR:0.01405
[2023-07-19 17:58:24,434][main.py][line:76][INFO] [Epoch:37/100]: loss1:0.0041 loss2:0.0122 main_loss:0.0204 | AUC:0.8411 AUC2:0.8531 FAR:0.01729
[2023-07-19 17:59:37,657][main.py][line:76][INFO] [Epoch:38/100]: loss1:0.0024 loss2:0.0146 main_loss:0.0195 | AUC:0.8486 AUC2:0.8531 FAR:0.01326
[2023-07-19 18:00:49,750][main.py][line:76][INFO] [Epoch:39/100]: loss1:0.0004 loss2:0.0078 main_loss:0.0086 | AUC:0.8508 AUC2:0.8531 FAR:0.01358
[2023-07-19 18:02:09,513][main.py][line:76][INFO] [Epoch:40/100]: loss1:0.0003 loss2:0.0067 main_loss:0.0074 | AUC:0.8480 AUC2:0.8531 FAR:0.01566
[2023-07-19 18:03:20,202][main.py][line:76][INFO] [Epoch:41/100]: loss1:0.0003 loss2:0.0062 main_loss:0.0068 | AUC:0.8506 AUC2:0.8531 FAR:0.01625
[2023-07-19 18:04:35,435][main.py][line:76][INFO] [Epoch:42/100]: loss1:0.0002 loss2:0.0057 main_loss:0.0062 | AUC:0.8507 AUC2:0.8531 FAR:0.01554
[2023-07-19 18:05:44,239][main.py][line:76][INFO] [Epoch:43/100]: loss1:0.0002 loss2:0.0052 main_loss:0.0056 | AUC:0.8499 AUC2:0.8531 FAR:0.01603
[2023-07-19 18:07:00,009][main.py][line:76][INFO] [Epoch:44/100]: loss1:0.0018 loss2:0.0093 main_loss:0.0128 | AUC:0.8444 AUC2:0.8531 FAR:0.02576
[2023-07-19 18:08:20,508][main.py][line:76][INFO] [Epoch:45/100]: loss1:0.0003 loss2:0.0056 main_loss:0.0061 | AUC:0.8463 AUC2:0.8531 FAR:0.01620
[2023-07-19 18:09:27,513][main.py][line:76][INFO] [Epoch:46/100]: loss1:0.0002 loss2:0.0049 main_loss:0.0053 | AUC:0.8469 AUC2:0.8531 FAR:0.01635
[2023-07-19 18:10:38,493][main.py][line:76][INFO] [Epoch:47/100]: loss1:0.0002 loss2:0.0043 main_loss:0.0046 | AUC:0.8472 AUC2:0.8531 FAR:0.01613
[2023-07-19 18:11:57,701][main.py][line:76][INFO] [Epoch:48/100]: loss1:0.0001 loss2:0.0041 main_loss:0.0044 | AUC:0.8475 AUC2:0.8531 FAR:0.01576
[2023-07-19 18:13:16,841][main.py][line:76][INFO] [Epoch:49/100]: loss1:0.0001 loss2:0.0039 main_loss:0.0042 | AUC:0.8478 AUC2:0.8531 FAR:0.01529
[2023-07-19 18:14:32,305][main.py][line:76][INFO] [Epoch:50/100]: loss1:0.0001 loss2:0.0037 main_loss:0.0040 | AUC:0.8480 AUC2:0.8531 FAR:0.01546
[2023-07-19 18:15:47,656][main.py][line:76][INFO] [Epoch:51/100]: loss1:0.0001 loss2:0.0036 main_loss:0.0038 | AUC:0.8482 AUC2:0.8531 FAR:0.01504
[2023-07-19 18:17:05,706][main.py][line:76][INFO] [Epoch:52/100]: loss1:0.0001 loss2:0.0034 main_loss:0.0036 | AUC:0.8483 AUC2:0.8531 FAR:0.01558
[2023-07-19 18:18:15,379][main.py][line:76][INFO] [Epoch:53/100]: loss1:0.0001 loss2:0.0035 main_loss:0.0037 | AUC:0.8484 AUC2:0.8531 FAR:0.01521
[2023-07-19 18:19:25,668][main.py][line:76][INFO] [Epoch:54/100]: loss1:0.0001 loss2:0.0033 main_loss:0.0036 | AUC:0.8485 AUC2:0.8531 FAR:0.01529
[2023-07-19 18:20:35,727][main.py][line:76][INFO] [Epoch:55/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0035 | AUC:0.8485 AUC2:0.8531 FAR:0.01534
[2023-07-19 18:21:48,012][main.py][line:76][INFO] [Epoch:56/100]: loss1:0.0001 loss2:0.0034 main_loss:0.0036 | AUC:0.8486 AUC2:0.8531 FAR:0.01531
[2023-07-19 18:22:52,817][main.py][line:76][INFO] [Epoch:57/100]: loss1:0.0001 loss2:0.0030 main_loss:0.0033 | AUC:0.8486 AUC2:0.8531 FAR:0.01534
[2023-07-19 18:24:01,597][main.py][line:76][INFO] [Epoch:58/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0034 | AUC:0.8487 AUC2:0.8531 FAR:0.01620
[2023-07-19 18:25:15,296][main.py][line:76][INFO] [Epoch:59/100]: loss1:0.0001 loss2:0.0033 main_loss:0.0035 | AUC:0.8487 AUC2:0.8531 FAR:0.01608
[2023-07-19 18:26:36,903][main.py][line:76][INFO] [Epoch:60/100]: loss1:0.0001 loss2:0.0033 main_loss:0.0035 | AUC:0.8487 AUC2:0.8531 FAR:0.01600
[2023-07-19 18:27:46,452][main.py][line:76][INFO] [Epoch:61/100]: loss1:0.0001 loss2:0.0031 main_loss:0.0033 | AUC:0.8487 AUC2:0.8531 FAR:0.01600
[2023-07-19 18:28:51,162][main.py][line:76][INFO] [Epoch:62/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0034 | AUC:0.8487 AUC2:0.8531 FAR:0.01600
[2023-07-19 18:30:07,543][main.py][line:76][INFO] [Epoch:63/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0035 | AUC:0.8487 AUC2:0.8531 FAR:0.01581
[2023-07-19 18:31:17,366][main.py][line:76][INFO] [Epoch:64/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0034 | AUC:0.8487 AUC2:0.8531 FAR:0.01571
[2023-07-19 18:32:28,097][main.py][line:76][INFO] [Epoch:65/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0034 | AUC:0.8488 AUC2:0.8531 FAR:0.01551
[2023-07-19 18:33:43,775][main.py][line:76][INFO] [Epoch:66/100]: loss1:0.0001 loss2:0.0031 main_loss:0.0033 | AUC:0.8488 AUC2:0.8531 FAR:0.01509
[2023-07-19 18:34:52,319][main.py][line:76][INFO] [Epoch:67/100]: loss1:0.0001 loss2:0.0032 main_loss:0.0034 | AUC:0.8488 AUC2:0.8531 FAR:0.01531
[2023-07-19 18:36:11,436][main.py][line:76][INFO] [Epoch:68/100]: loss1:0.0001 loss2:0.0031 main_loss:0.0033 | AUC:0.8489 AUC2:0.8531 FAR:0.01502
[2023-07-19 18:37:25,506][main.py][line:76][INFO] [Epoch:69/100]: loss1:0.0001 loss2:0.0028 main_loss:0.0030 | AUC:0.8489 AUC2:0.8531 FAR:0.01465
[2023-07-19 18:38:40,558][main.py][line:76][INFO] [Epoch:70/100]: loss1:0.0002 loss2:0.0033 main_loss:0.0036 | AUC:0.8476 AUC2:0.8531 FAR:0.01450
[2023-07-19 18:40:00,807][main.py][line:76][INFO] [Epoch:71/100]: loss1:0.0001 loss2:0.0029 main_loss:0.0031 | AUC:0.8476 AUC2:0.8531 FAR:0.01447
[2023-07-19 18:41:06,392][main.py][line:76][INFO] [Epoch:72/100]: loss1:0.0001 loss2:0.0025 main_loss:0.0027 | AUC:0.8471 AUC2:0.8531 FAR:0.01571
[2023-07-19 18:42:18,240][main.py][line:76][INFO] [Epoch:73/100]: loss1:0.0003 loss2:0.0034 main_loss:0.0040 | AUC:0.8446 AUC2:0.8531 FAR:0.01763
[2023-07-19 18:43:31,400][main.py][line:76][INFO] [Epoch:74/100]: loss1:0.0001 loss2:0.0029 main_loss:0.0031 | AUC:0.8458 AUC2:0.8531 FAR:0.01628
[2023-07-19 18:44:39,476][main.py][line:76][INFO] [Epoch:75/100]: loss1:0.0001 loss2:0.0026 main_loss:0.0028 | AUC:0.8454 AUC2:0.8531 FAR:0.01114
[2023-07-19 18:46:01,233][main.py][line:76][INFO] [Epoch:76/100]: loss1:0.0001 loss2:0.0027 main_loss:0.0029 | AUC:0.8460 AUC2:0.8531 FAR:0.01474
[2023-07-19 18:47:14,436][main.py][line:76][INFO] [Epoch:77/100]: loss1:0.0001 loss2:0.0023 main_loss:0.0025 | AUC:0.8476 AUC2:0.8531 FAR:0.01524
[2023-07-19 18:48:27,219][main.py][line:76][INFO] [Epoch:78/100]: loss1:0.0001 loss2:0.0021 main_loss:0.0022 | AUC:0.8457 AUC2:0.8531 FAR:0.01514
[2023-07-19 18:49:44,929][main.py][line:76][INFO] [Epoch:79/100]: loss1:0.0001 loss2:0.0027 main_loss:0.0030 | AUC:0.8437 AUC2:0.8531 FAR:0.01106
[2023-07-19 18:50:56,390][main.py][line:76][INFO] [Epoch:80/100]: loss1:0.0013 loss2:0.0046 main_loss:0.0071 | AUC:0.8406 AUC2:0.8531 FAR:0.01267
[2023-07-19 18:52:09,394][main.py][line:76][INFO] [Epoch:81/100]: loss1:0.0001 loss2:0.0023 main_loss:0.0025 | AUC:0.8410 AUC2:0.8531 FAR:0.01121
[2023-07-19 18:53:18,676][main.py][line:76][INFO] [Epoch:82/100]: loss1:0.0001 loss2:0.0019 main_loss:0.0021 | AUC:0.8419 AUC2:0.8531 FAR:0.01161
[2023-07-19 18:54:37,585][main.py][line:76][INFO] [Epoch:83/100]: loss1:0.0001 loss2:0.0017 main_loss:0.0018 | AUC:0.8420 AUC2:0.8531 FAR:0.01141
[2023-07-19 18:55:55,349][main.py][line:76][INFO] [Epoch:84/100]: loss1:0.0000 loss2:0.0016 main_loss:0.0017 | AUC:0.8420 AUC2:0.8531 FAR:0.01042
[2023-07-19 18:57:16,231][main.py][line:76][INFO] [Epoch:85/100]: loss1:0.0099 loss2:0.0126 main_loss:0.0324 | AUC:0.8359 AUC2:0.8531 FAR:0.02294
[2023-07-19 18:58:36,771][main.py][line:76][INFO] [Epoch:86/100]: loss1:0.0011 loss2:0.0064 main_loss:0.0086 | AUC:0.8405 AUC2:0.8531 FAR:0.01889
[2023-07-19 19:00:01,733][main.py][line:76][INFO] [Epoch:87/100]: loss1:0.0039 loss2:0.0089 main_loss:0.0166 | AUC:0.8401 AUC2:0.8531 FAR:0.01986
[2023-07-19 19:01:12,801][main.py][line:76][INFO] [Epoch:88/100]: loss1:0.0003 loss2:0.0038 main_loss:0.0044 | AUC:0.8386 AUC2:0.8531 FAR:0.01904
[2023-07-19 19:02:24,944][main.py][line:76][INFO] [Epoch:89/100]: loss1:0.0003 loss2:0.0027 main_loss:0.0034 | AUC:0.8376 AUC2:0.8531 FAR:0.02218
[2023-07-19 19:03:34,789][main.py][line:76][INFO] [Epoch:90/100]: loss1:0.0003 loss2:0.0027 main_loss:0.0032 | AUC:0.8396 AUC2:0.8531 FAR:0.02159
[2023-07-19 19:04:58,918][main.py][line:76][INFO] [Epoch:91/100]: loss1:0.0003 loss2:0.0022 main_loss:0.0027 | AUC:0.8391 AUC2:0.8531 FAR:0.01568
[2023-07-19 19:06:22,645][main.py][line:76][INFO] [Epoch:92/100]: loss1:0.0002 loss2:0.0019 main_loss:0.0023 | AUC:0.8403 AUC2:0.8531 FAR:0.01689
[2023-07-19 19:07:45,054][main.py][line:76][INFO] [Epoch:93/100]: loss1:0.0001 loss2:0.0016 main_loss:0.0019 | AUC:0.8405 AUC2:0.8531 FAR:0.01714
[2023-07-19 19:08:58,211][main.py][line:76][INFO] [Epoch:94/100]: loss1:0.0001 loss2:0.0015 main_loss:0.0016 | AUC:0.8411 AUC2:0.8531 FAR:0.01494
[2023-07-19 19:10:22,884][main.py][line:76][INFO] [Epoch:95/100]: loss1:0.0001 loss2:0.0012 main_loss:0.0013 | AUC:0.8416 AUC2:0.8531 FAR:0.01482
[2023-07-19 19:11:48,900][main.py][line:76][INFO] [Epoch:96/100]: loss1:0.0000 loss2:0.0013 main_loss:0.0014 | AUC:0.8419 AUC2:0.8531 FAR:0.01400
[2023-07-19 19:13:36,554][main.py][line:76][INFO] [Epoch:97/100]: loss1:0.0001 loss2:0.0010 main_loss:0.0011 | AUC:0.8409 AUC2:0.8531 FAR:0.01494
[2023-07-19 19:14:57,196][main.py][line:76][INFO] [Epoch:98/100]: loss1:0.0001 loss2:0.0014 main_loss:0.0015 | AUC:0.8412 AUC2:0.8531 FAR:0.00753
[2023-07-19 19:16:34,649][main.py][line:76][INFO] [Epoch:99/100]: loss1:0.0486 loss2:0.0482 main_loss:0.1455 | AUC:0.8388 AUC2:0.8531 FAR:0.00778
[2023-07-19 19:17:58,102][main.py][line:76][INFO] [Epoch:100/100]: loss1:0.0092 loss2:0.0164 main_loss:0.0348 | AUC:0.8301 AUC2:0.8531 FAR:0.01754
[2023-07-19 19:17:58,104][main.py][line:82][INFO] Training completes in 126m 10s | best AUC:0.8531 FAR:0.00489

[2023-07-19 20:28:54,913][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8548.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:28:55,094][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:28:55,095][main.py][line:123][INFO] Test Mode
[2023-07-19 20:31:00,761][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8531.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:31:00,921][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:31:00,921][main.py][line:123][INFO] Test Mode
[2023-07-19 20:32:43,985][main.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': ('./ckpt/ucf__8531.pkl',), 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:32:44,145][main.py][line:117][INFO] total params:27.0270M
[2023-07-19 20:32:44,146][main.py][line:124][INFO] Test Mode
[2023-07-19 20:33:15,846][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:33:15,995][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:33:15,996][main.py][line:123][INFO] Test Mode
[2023-07-19 20:33:15,996][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8531.pkl.
[2023-07-19 20:34:48,895][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:34:49,044][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:34:49,044][main.py][line:123][INFO] Test Mode
[2023-07-19 20:34:49,044][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8531.pkl.
[2023-07-19 20:35:46,979][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:35:47,126][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:35:47,127][main.py][line:123][INFO] Test Mode
[2023-07-19 20:35:47,127][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8531.pkl.
[2023-07-19 20:35:55,296][infer_bert.py][line:55][INFO] offline AUC:0.8531 AUC2:0.8568 AP:0.3223 FAR:0.0040 | Complete in 0m 8s

[2023-07-19 20:39:16,844][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:39:17,005][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:39:17,005][main.py][line:123][INFO] Test Mode
[2023-07-19 20:39:17,005][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8531.pkl.
[2023-07-19 20:39:23,634][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0003, 'dropout': 0.1, 'train_bs': 64, 'max_seqlen': 500, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:39:23,781][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:39:23,781][main.py][line:119][INFO] Training Mode
[2023-07-19 20:39:23,782][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 20:39:23,782][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0003
    lr: 0.0003
    maximize: False
    weight_decay: 0
)

[2023-07-19 20:39:31,301][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-19 20:40:29,063][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3642 loss2:1.1187 main_loss:1.4829 | AUC:0.8266 AUC2:0.8266 FAR:0.04483
[2023-07-19 20:41:28,490][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1438 loss2:0.9801 main_loss:1.1239 | AUC:0.8429 AUC2:0.8429 FAR:0.01894
[2023-07-19 20:42:27,619][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0586 loss2:0.8905 main_loss:0.9491 | AUC:0.8530 AUC2:0.8530 FAR:0.00773
[2023-07-19 20:43:27,620][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0403 loss2:0.7955 main_loss:0.8359 | AUC:0.8409 AUC2:0.8530 FAR:0.00328
[2023-07-19 20:44:27,087][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0270 loss2:0.7031 main_loss:0.7301 | AUC:0.8427 AUC2:0.8530 FAR:0.01274
[2023-07-19 20:45:24,872][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0271 loss2:0.6249 main_loss:0.6520 | AUC:0.8363 AUC2:0.8530 FAR:0.00882
[2023-07-19 20:46:24,055][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0177 loss2:0.5493 main_loss:0.5670 | AUC:0.8475 AUC2:0.8530 FAR:0.00674
[2023-07-19 20:47:23,770][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0202 loss2:0.4792 main_loss:0.4994 | AUC:0.8384 AUC2:0.8530 FAR:0.00212
[2023-07-19 20:48:23,221][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0240 loss2:0.4227 main_loss:0.4467 | AUC:0.8515 AUC2:0.8530 FAR:0.01168
[2023-07-19 20:49:23,291][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0254 loss2:0.3722 main_loss:0.3975 | AUC:0.8383 AUC2:0.8530 FAR:0.01512
[2023-07-19 20:50:20,328][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 55, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 256, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 20:50:20,511][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 20:50:20,511][main.py][line:119][INFO] Training Mode
[2023-07-19 20:50:20,511][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 20:50:20,511][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 20:50:28,781][main.py][line:53][INFO] Random initialize AUC:0.5760 initial_AUC2:0.5763 FAR:0.05021
[2023-07-19 20:54:07,818][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.4335 loss2:1.1767 main_loss:1.6102 | AUC:0.8263 AUC2:0.8263 FAR:0.01336
[2023-07-19 20:57:25,356][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.2136 loss2:0.9531 main_loss:1.1667 | AUC:0.8301 AUC2:0.8301 FAR:0.00635
[2023-07-19 21:00:33,003][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0978 loss2:0.8595 main_loss:0.9573 | AUC:0.8421 AUC2:0.8422 FAR:0.00314
[2023-07-19 21:03:14,116][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0562 loss2:0.8048 main_loss:0.8610 | AUC:0.8359 AUC2:0.8422 FAR:0.00380
[2023-07-19 21:06:23,396][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0304 loss2:0.7535 main_loss:0.7838 | AUC:0.8375 AUC2:0.8422 FAR:0.00148
[2023-07-19 21:09:12,046][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0229 loss2:0.7113 main_loss:0.7341 | AUC:0.8394 AUC2:0.8422 FAR:0.00479
[2023-07-19 21:11:57,250][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0252 loss2:0.6820 main_loss:0.7073 | AUC:0.8199 AUC2:0.8422 FAR:0.00637
[2023-07-19 21:14:37,112][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0161 loss2:0.6451 main_loss:0.6612 | AUC:0.8368 AUC2:0.8422 FAR:0.00405
[2023-07-19 21:17:34,684][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0104 loss2:0.6044 main_loss:0.6149 | AUC:0.8390 AUC2:0.8422 FAR:0.00432
[2023-07-19 21:20:39,798][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0188 loss2:0.5791 main_loss:0.5979 | AUC:0.8356 AUC2:0.8422 FAR:0.00526
[2023-07-19 21:23:35,423][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.0205 loss2:0.5566 main_loss:0.5771 | AUC:0.8469 AUC2:0.8469 FAR:0.00479
[2023-07-19 21:26:19,109][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8531.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-19 21:26:19,301][main.py][line:116][INFO] total params:27.0270M
[2023-07-19 21:26:19,301][main.py][line:119][INFO] Training Mode
[2023-07-19 21:26:19,301][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-19 21:26:19,301][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-19 21:26:27,452][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-19 21:28:45,247][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3725 loss2:1.0986 main_loss:1.4711 | AUC:0.8345 AUC2:0.8345 FAR:0.00450
[2023-07-19 21:31:00,212][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1418 loss2:0.8771 main_loss:1.0189 | AUC:0.8550 AUC2:0.8549 FAR:0.01173
[2023-07-19 21:32:50,431][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0635 loss2:0.7803 main_loss:0.8438 | AUC:0.8592 AUC2:0.8592 FAR:0.00200
[2023-07-19 21:34:34,061][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0409 loss2:0.7101 main_loss:0.7510 | AUC:0.8563 AUC2:0.8592 FAR:0.00756
[2023-07-19 21:36:40,099][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0246 loss2:0.6418 main_loss:0.6665 | AUC:0.8490 AUC2:0.8592 FAR:0.02648
[2023-07-19 21:39:00,233][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0297 loss2:0.5912 main_loss:0.6209 | AUC:0.8484 AUC2:0.8592 FAR:0.00462
[2023-07-19 21:41:18,336][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0185 loss2:0.5318 main_loss:0.5502 | AUC:0.8498 AUC2:0.8592 FAR:0.00450
[2023-07-19 21:43:38,854][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0116 loss2:0.4712 main_loss:0.4828 | AUC:0.8494 AUC2:0.8592 FAR:0.00450
[2023-07-19 21:45:19,089][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0098 loss2:0.4143 main_loss:0.4242 | AUC:0.8478 AUC2:0.8592 FAR:0.00254
[2023-07-19 21:47:08,281][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0162 loss2:0.3738 main_loss:0.3900 | AUC:0.8499 AUC2:0.8592 FAR:0.01457
[2023-07-19 21:49:31,350][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0303 loss2:0.3672 main_loss:0.3975 | AUC:0.8432 AUC2:0.8592 FAR:0.00580
[2023-07-19 21:52:01,306][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0184 loss2:0.3154 main_loss:0.3338 | AUC:0.8480 AUC2:0.8592 FAR:0.00321
[2023-07-19 21:53:54,356][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0063 loss2:0.2549 main_loss:0.2612 | AUC:0.8534 AUC2:0.8592 FAR:0.00405
[2023-07-19 21:55:53,513][main.py][line:76][INFO] [Epoch:14/50]: loss1:0.0050 loss2:0.2093 main_loss:0.2143 | AUC:0.8515 AUC2:0.8592 FAR:0.00358
[2023-07-19 21:58:13,411][main.py][line:76][INFO] [Epoch:15/50]: loss1:0.0045 loss2:0.1803 main_loss:0.1848 | AUC:0.8537 AUC2:0.8592 FAR:0.00319
[2023-07-19 22:00:26,459][main.py][line:76][INFO] [Epoch:16/50]: loss1:0.0041 loss2:0.1505 main_loss:0.1546 | AUC:0.8530 AUC2:0.8592 FAR:0.00400
[2023-07-19 22:02:22,186][main.py][line:76][INFO] [Epoch:17/50]: loss1:0.0036 loss2:0.1242 main_loss:0.1278 | AUC:0.8533 AUC2:0.8592 FAR:0.00378
[2023-07-19 22:05:01,623][main.py][line:76][INFO] [Epoch:18/50]: loss1:0.0209 loss2:0.1376 main_loss:0.1585 | AUC:0.8508 AUC2:0.8592 FAR:0.00877
[2023-07-19 22:07:37,911][main.py][line:76][INFO] [Epoch:19/50]: loss1:0.0205 loss2:0.1492 main_loss:0.1697 | AUC:0.8433 AUC2:0.8592 FAR:0.00556
[2023-07-19 22:09:48,582][main.py][line:76][INFO] [Epoch:20/50]: loss1:0.0046 loss2:0.0993 main_loss:0.1039 | AUC:0.8472 AUC2:0.8592 FAR:0.00469
[2023-07-19 22:11:57,487][main.py][line:76][INFO] [Epoch:21/50]: loss1:0.0031 loss2:0.0783 main_loss:0.0814 | AUC:0.8478 AUC2:0.8592 FAR:0.00356
[2023-07-19 22:14:05,746][main.py][line:76][INFO] [Epoch:22/50]: loss1:0.0025 loss2:0.0653 main_loss:0.0678 | AUC:0.8484 AUC2:0.8592 FAR:0.00415
[2023-07-19 22:16:38,353][main.py][line:76][INFO] [Epoch:23/50]: loss1:0.0022 loss2:0.0556 main_loss:0.0578 | AUC:0.8506 AUC2:0.8592 FAR:0.00353
[2023-07-19 22:18:30,701][main.py][line:76][INFO] [Epoch:24/50]: loss1:0.0021 loss2:0.0488 main_loss:0.0509 | AUC:0.8483 AUC2:0.8592 FAR:0.00309
[2023-07-19 22:20:34,902][main.py][line:76][INFO] [Epoch:25/50]: loss1:0.0020 loss2:0.0426 main_loss:0.0446 | AUC:0.8494 AUC2:0.8592 FAR:0.00336
[2023-07-19 22:22:27,756][main.py][line:76][INFO] [Epoch:26/50]: loss1:0.0017 loss2:0.0370 main_loss:0.0387 | AUC:0.8479 AUC2:0.8592 FAR:0.00380
[2023-07-19 22:24:51,858][main.py][line:76][INFO] [Epoch:27/50]: loss1:0.0014 loss2:0.0322 main_loss:0.0336 | AUC:0.8502 AUC2:0.8592 FAR:0.00370
[2023-07-19 22:26:50,108][main.py][line:76][INFO] [Epoch:28/50]: loss1:0.0013 loss2:0.0284 main_loss:0.0296 | AUC:0.8507 AUC2:0.8592 FAR:0.00326
[2023-07-19 22:29:05,625][main.py][line:76][INFO] [Epoch:29/50]: loss1:0.0014 loss2:0.0258 main_loss:0.0272 | AUC:0.8509 AUC2:0.8592 FAR:0.00306
[2023-07-19 22:31:25,037][main.py][line:76][INFO] [Epoch:30/50]: loss1:0.0010 loss2:0.0226 main_loss:0.0236 | AUC:0.8505 AUC2:0.8592 FAR:0.00351
[2023-07-19 22:33:09,828][main.py][line:76][INFO] [Epoch:31/50]: loss1:0.0010 loss2:0.0206 main_loss:0.0217 | AUC:0.8481 AUC2:0.8592 FAR:0.00346
[2023-07-19 22:35:30,957][main.py][line:76][INFO] [Epoch:32/50]: loss1:0.0010 loss2:0.0194 main_loss:0.0204 | AUC:0.8427 AUC2:0.8592 FAR:0.00227
[2023-07-19 22:37:22,930][main.py][line:76][INFO] [Epoch:33/50]: loss1:0.0009 loss2:0.0172 main_loss:0.0180 | AUC:0.8483 AUC2:0.8592 FAR:0.00417
[2023-07-19 22:39:30,077][main.py][line:76][INFO] [Epoch:34/50]: loss1:0.0008 loss2:0.0156 main_loss:0.0164 | AUC:0.8485 AUC2:0.8592 FAR:0.00425
[2023-07-19 22:41:23,668][main.py][line:76][INFO] [Epoch:35/50]: loss1:0.0009 loss2:0.0145 main_loss:0.0154 | AUC:0.8450 AUC2:0.8592 FAR:0.00245
[2023-07-19 22:43:40,817][main.py][line:76][INFO] [Epoch:36/50]: loss1:0.0008 loss2:0.0144 main_loss:0.0153 | AUC:0.8463 AUC2:0.8592 FAR:0.00338
[2023-07-19 22:45:58,384][main.py][line:76][INFO] [Epoch:37/50]: loss1:0.0007 loss2:0.0134 main_loss:0.0141 | AUC:0.8468 AUC2:0.8592 FAR:0.00316
[2023-07-19 22:47:56,321][main.py][line:76][INFO] [Epoch:38/50]: loss1:0.0009 loss2:0.0120 main_loss:0.0129 | AUC:0.8495 AUC2:0.8592 FAR:0.00753
[2023-07-19 22:49:49,275][main.py][line:76][INFO] [Epoch:39/50]: loss1:0.0007 loss2:0.0122 main_loss:0.0129 | AUC:0.8503 AUC2:0.8592 FAR:0.00331
[2023-07-19 22:52:15,879][main.py][line:76][INFO] [Epoch:40/50]: loss1:0.0005 loss2:0.0108 main_loss:0.0113 | AUC:0.8501 AUC2:0.8592 FAR:0.00338
[2023-07-19 22:54:34,549][main.py][line:76][INFO] [Epoch:41/50]: loss1:0.0005 loss2:0.0098 main_loss:0.0102 | AUC:0.8500 AUC2:0.8592 FAR:0.00351
[2023-07-19 22:56:21,810][main.py][line:76][INFO] [Epoch:42/50]: loss1:0.0005 loss2:0.0090 main_loss:0.0094 | AUC:0.8463 AUC2:0.8592 FAR:0.00259
[2023-07-19 22:58:21,596][main.py][line:76][INFO] [Epoch:43/50]: loss1:0.0005 loss2:0.0092 main_loss:0.0097 | AUC:0.8493 AUC2:0.8592 FAR:0.00324
[2023-07-19 23:00:36,589][main.py][line:76][INFO] [Epoch:44/50]: loss1:0.0005 loss2:0.0087 main_loss:0.0091 | AUC:0.8493 AUC2:0.8592 FAR:0.00333
[2023-07-19 23:02:38,542][main.py][line:76][INFO] [Epoch:45/50]: loss1:0.0004 loss2:0.0087 main_loss:0.0091 | AUC:0.8501 AUC2:0.8592 FAR:0.00319
[2023-07-19 23:04:27,142][main.py][line:76][INFO] [Epoch:46/50]: loss1:0.0007 loss2:0.0085 main_loss:0.0092 | AUC:0.8492 AUC2:0.8592 FAR:0.00274
[2023-07-19 23:06:08,470][main.py][line:76][INFO] [Epoch:47/50]: loss1:0.0004 loss2:0.0076 main_loss:0.0080 | AUC:0.8500 AUC2:0.8592 FAR:0.00282
[2023-07-19 23:08:25,323][main.py][line:76][INFO] [Epoch:48/50]: loss1:0.0004 loss2:0.0079 main_loss:0.0083 | AUC:0.8496 AUC2:0.8592 FAR:0.00314
[2023-07-19 23:10:17,999][main.py][line:76][INFO] [Epoch:49/50]: loss1:0.0004 loss2:0.0072 main_loss:0.0076 | AUC:0.8492 AUC2:0.8592 FAR:0.00304
[2023-07-19 23:11:57,878][main.py][line:76][INFO] [Epoch:50/50]: loss1:0.0003 loss2:0.0070 main_loss:0.0074 | AUC:0.8496 AUC2:0.8592 FAR:0.00304
[2023-07-19 23:11:57,879][main.py][line:82][INFO] Training completes in 105m 30s | best AUC:0.8592 FAR:0.00200

[2023-07-20 00:38:12,146][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:38:12,332][main.py][line:116][INFO] total params:27.0270M
[2023-07-20 00:38:12,333][main.py][line:123][INFO] Test Mode
[2023-07-20 00:38:12,333][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8592.pkl.
[2023-07-20 00:38:20,607][infer_bert.py][line:55][INFO] offline AUC:0.8592 AUC2:0.8651 AP:0.3193 FAR:0.0016 | Complete in 0m 8s

[2023-07-20 00:41:10,896][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:41:11,059][main.py][line:116][INFO] total params:27.0270M
[2023-07-20 00:41:11,060][main.py][line:119][INFO] Training Mode
[2023-07-20 00:41:11,060][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 00:41:11,060][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 00:41:18,661][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 00:42:08,444][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:42:08,596][main.py][line:116][INFO] total params:27.0270M
[2023-07-20 00:42:08,596][main.py][line:119][INFO] Training Mode
[2023-07-20 00:42:08,596][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 00:42:08,596][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 00:42:16,228][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 00:43:34,123][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:43:34,286][main.py][line:116][INFO] total params:27.0270M
[2023-07-20 00:43:34,286][main.py][line:119][INFO] Training Mode
[2023-07-20 00:43:34,287][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 00:43:34,287][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 00:43:41,858][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 00:45:18,225][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:45:18,374][main.py][line:116][INFO] total params:27.0270M
[2023-07-20 00:45:18,375][main.py][line:119][INFO] Training Mode
[2023-07-20 00:45:18,375][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 00:45:18,375][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 00:45:25,937][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 00:48:05,720][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:48:05,881][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 00:48:05,881][main.py][line:119][INFO] Training Mode
[2023-07-20 00:48:05,881][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 00:48:05,881][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 00:48:25,167][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 00:51:18,656][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3729 loss2:1.0986 main_loss:1.4714 | AUC:0.8271 AUC2:0.8271 FAR:0.00583
[2023-07-20 00:52:46,800][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 00:52:46,970][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 00:52:46,970][main.py][line:119][INFO] Training Mode
[2023-07-20 00:52:46,970][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 00:52:46,970][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 00:53:06,469][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 00:54:34,804][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3729 loss2:1.0986 main_loss:1.4714 | AUC:0.8271 AUC2:0.8271 FAR:0.00583
[2023-07-20 00:56:04,999][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1468 loss2:0.8741 main_loss:1.0209 | AUC:0.8501 AUC2:0.8501 FAR:0.00603
[2023-07-20 00:57:33,786][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0684 loss2:0.7777 main_loss:0.8461 | AUC:0.8417 AUC2:0.8501 FAR:0.00832
[2023-07-20 00:59:00,669][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0314 loss2:0.7010 main_loss:0.7324 | AUC:0.8486 AUC2:0.8501 FAR:0.00326
[2023-07-20 01:00:28,883][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0191 loss2:0.6276 main_loss:0.6466 | AUC:0.8481 AUC2:0.8501 FAR:0.00168
[2023-07-20 01:01:56,438][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0402 loss2:0.5925 main_loss:0.6327 | AUC:0.8405 AUC2:0.8501 FAR:0.00440
[2023-07-20 01:04:54,755][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 01:04:54,954][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 01:04:54,954][main.py][line:119][INFO] Training Mode
[2023-07-20 01:04:54,955][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 01:04:54,955][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 01:05:14,596][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 01:06:53,830][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3825 loss2:1.0427 main_loss:1.4681 | AUC:0.8352 AUC2:0.8295 FAR:0.00706
[2023-07-20 01:08:41,923][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1690 loss2:0.8141 main_loss:1.0624 | AUC:0.8464 AUC2:0.8425 FAR:0.00499
[2023-07-20 01:10:22,808][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.1025 loss2:0.7199 main_loss:0.9184 | AUC:0.8554 AUC2:0.8522 FAR:0.00958
[2023-07-20 01:12:05,880][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0625 loss2:0.6487 main_loss:0.8023 | AUC:0.8522 AUC2:0.8522 FAR:0.00405
[2023-07-20 01:13:47,661][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0512 loss2:0.5879 main_loss:0.7336 | AUC:0.8535 AUC2:0.8522 FAR:0.00309
[2023-07-20 01:15:32,146][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0369 loss2:0.5276 main_loss:0.6522 | AUC:0.8450 AUC2:0.8522 FAR:0.00242
[2023-07-20 01:17:12,360][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0727 loss2:0.4973 main_loss:0.6333 | AUC:0.8564 AUC2:0.8466 FAR:0.00210
[2023-07-20 01:19:01,699][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0243 loss2:0.4257 main_loss:0.5225 | AUC:0.8527 AUC2:0.8466 FAR:0.00190
[2023-07-20 01:20:43,282][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0189 loss2:0.3701 main_loss:0.4747 | AUC:0.8585 AUC2:0.8477 FAR:0.00225
[2023-07-20 01:22:30,322][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0158 loss2:0.3204 main_loss:0.4300 | AUC:0.8565 AUC2:0.8477 FAR:0.00133
[2023-07-20 01:24:22,205][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0149 loss2:0.2746 main_loss:0.3767 | AUC:0.8600 AUC2:0.8490 FAR:0.00286
[2023-07-20 01:26:09,383][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0127 loss2:0.2297 main_loss:0.3385 | AUC:0.8550 AUC2:0.8490 FAR:0.00207
[2023-07-20 01:27:46,821][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0435 loss2:0.2312 main_loss:0.3430 | AUC:0.8442 AUC2:0.8490 FAR:0.02149
[2023-07-20 01:29:25,395][main.py][line:76][INFO] [Epoch:14/50]: loss1:0.0543 loss2:0.2415 main_loss:0.3462 | AUC:0.8447 AUC2:0.8490 FAR:0.00353
[2023-07-20 01:31:05,005][main.py][line:76][INFO] [Epoch:15/50]: loss1:0.0214 loss2:0.1784 main_loss:0.2673 | AUC:0.8519 AUC2:0.8490 FAR:0.00499
[2023-07-20 01:32:44,964][main.py][line:76][INFO] [Epoch:16/50]: loss1:0.0118 loss2:0.1409 main_loss:0.2258 | AUC:0.8520 AUC2:0.8490 FAR:0.00284
[2023-07-20 01:34:25,662][main.py][line:76][INFO] [Epoch:17/50]: loss1:0.0092 loss2:0.1146 main_loss:0.1900 | AUC:0.8505 AUC2:0.8490 FAR:0.00232
[2023-07-20 01:36:05,436][main.py][line:76][INFO] [Epoch:18/50]: loss1:0.0073 loss2:0.0936 main_loss:0.1657 | AUC:0.8464 AUC2:0.8490 FAR:0.00210
[2023-07-20 01:37:44,883][main.py][line:76][INFO] [Epoch:19/50]: loss1:0.0071 loss2:0.0786 main_loss:0.1509 | AUC:0.8456 AUC2:0.8490 FAR:0.00153
[2023-07-20 01:39:26,853][main.py][line:76][INFO] [Epoch:20/50]: loss1:0.0058 loss2:0.0673 main_loss:0.1510 | AUC:0.8466 AUC2:0.8490 FAR:0.00170
[2023-07-20 01:41:07,356][main.py][line:76][INFO] [Epoch:21/50]: loss1:0.0049 loss2:0.0566 main_loss:0.1347 | AUC:0.8486 AUC2:0.8490 FAR:0.00205
[2023-07-20 01:42:53,645][main.py][line:76][INFO] [Epoch:22/50]: loss1:0.0046 loss2:0.0485 main_loss:0.1339 | AUC:0.8500 AUC2:0.8490 FAR:0.00198
[2023-07-20 01:44:30,429][main.py][line:76][INFO] [Epoch:23/50]: loss1:0.0042 loss2:0.0425 main_loss:0.1187 | AUC:0.8412 AUC2:0.8490 FAR:0.00205
[2023-07-20 01:46:05,156][main.py][line:76][INFO] [Epoch:24/50]: loss1:0.0037 loss2:0.0371 main_loss:0.1042 | AUC:0.8451 AUC2:0.8490 FAR:0.00220
[2023-07-20 01:47:47,872][main.py][line:76][INFO] [Epoch:25/50]: loss1:0.0034 loss2:0.0323 main_loss:0.0969 | AUC:0.8503 AUC2:0.8490 FAR:0.00237
[2023-07-20 01:49:26,185][main.py][line:76][INFO] [Epoch:26/50]: loss1:0.0032 loss2:0.0283 main_loss:0.0909 | AUC:0.8531 AUC2:0.8490 FAR:0.00203
[2023-07-20 01:51:04,904][main.py][line:76][INFO] [Epoch:27/50]: loss1:0.0026 loss2:0.0250 main_loss:0.0826 | AUC:0.8465 AUC2:0.8490 FAR:0.00188
[2023-07-20 01:52:46,316][main.py][line:76][INFO] [Epoch:28/50]: loss1:0.0028 loss2:0.0223 main_loss:0.0773 | AUC:0.8500 AUC2:0.8490 FAR:0.00212
[2023-07-20 01:54:22,609][main.py][line:76][INFO] [Epoch:29/50]: loss1:0.0023 loss2:0.0205 main_loss:0.0738 | AUC:0.8493 AUC2:0.8490 FAR:0.00222
[2023-07-20 01:55:57,981][main.py][line:76][INFO] [Epoch:30/50]: loss1:0.0022 loss2:0.0183 main_loss:0.0672 | AUC:0.8472 AUC2:0.8490 FAR:0.00301
[2023-07-20 01:57:39,023][main.py][line:76][INFO] [Epoch:31/50]: loss1:0.0128 loss2:0.0314 main_loss:0.0841 | AUC:0.8463 AUC2:0.8490 FAR:0.00059
[2023-07-20 01:59:17,308][main.py][line:76][INFO] [Epoch:32/50]: loss1:0.0338 loss2:0.0733 main_loss:0.1339 | AUC:0.8501 AUC2:0.8490 FAR:0.00543
[2023-07-20 02:00:53,223][main.py][line:76][INFO] [Epoch:33/50]: loss1:0.0056 loss2:0.0267 main_loss:0.0712 | AUC:0.8479 AUC2:0.8490 FAR:0.00395
[2023-07-20 02:02:28,782][main.py][line:76][INFO] [Epoch:34/50]: loss1:0.0032 loss2:0.0189 main_loss:0.0679 | AUC:0.8508 AUC2:0.8490 FAR:0.00333
[2023-07-20 02:04:08,125][main.py][line:76][INFO] [Epoch:35/50]: loss1:0.0025 loss2:0.0157 main_loss:0.0563 | AUC:0.8535 AUC2:0.8490 FAR:0.00311
[2023-07-20 02:05:46,639][main.py][line:76][INFO] [Epoch:36/50]: loss1:0.0031 loss2:0.0150 main_loss:0.0527 | AUC:0.8502 AUC2:0.8490 FAR:0.00412
[2023-07-20 02:07:24,294][main.py][line:76][INFO] [Epoch:37/50]: loss1:0.0025 loss2:0.0136 main_loss:0.0541 | AUC:0.8517 AUC2:0.8490 FAR:0.00286
[2023-07-20 02:09:01,487][main.py][line:76][INFO] [Epoch:38/50]: loss1:0.0018 loss2:0.0123 main_loss:0.0528 | AUC:0.8493 AUC2:0.8490 FAR:0.00279
[2023-07-20 02:10:41,784][main.py][line:76][INFO] [Epoch:39/50]: loss1:0.0017 loss2:0.0113 main_loss:0.0495 | AUC:0.8501 AUC2:0.8490 FAR:0.00262
[2023-07-20 02:12:20,983][main.py][line:76][INFO] [Epoch:40/50]: loss1:0.0017 loss2:0.0104 main_loss:0.0464 | AUC:0.8504 AUC2:0.8490 FAR:0.00286
[2023-07-20 02:13:58,100][main.py][line:76][INFO] [Epoch:41/50]: loss1:0.0016 loss2:0.0100 main_loss:0.0430 | AUC:0.8506 AUC2:0.8490 FAR:0.00264
[2023-07-20 02:15:33,988][main.py][line:76][INFO] [Epoch:42/50]: loss1:0.0016 loss2:0.0096 main_loss:0.0434 | AUC:0.8515 AUC2:0.8490 FAR:0.00274
[2023-07-20 02:17:10,608][main.py][line:76][INFO] [Epoch:43/50]: loss1:0.0014 loss2:0.0091 main_loss:0.0389 | AUC:0.8523 AUC2:0.8490 FAR:0.00269
[2023-07-20 02:18:46,134][main.py][line:76][INFO] [Epoch:44/50]: loss1:0.0013 loss2:0.0087 main_loss:0.0349 | AUC:0.8518 AUC2:0.8490 FAR:0.00284
[2023-07-20 02:20:23,049][main.py][line:76][INFO] [Epoch:45/50]: loss1:0.0011 loss2:0.0082 main_loss:0.0355 | AUC:0.8518 AUC2:0.8490 FAR:0.00279
[2023-07-20 02:22:03,520][main.py][line:76][INFO] [Epoch:46/50]: loss1:0.0012 loss2:0.0079 main_loss:0.0338 | AUC:0.8519 AUC2:0.8490 FAR:0.00262
[2023-07-20 02:23:44,085][main.py][line:76][INFO] [Epoch:47/50]: loss1:0.0012 loss2:0.0077 main_loss:0.0329 | AUC:0.8535 AUC2:0.8490 FAR:0.00279
[2023-07-20 02:25:18,471][main.py][line:76][INFO] [Epoch:48/50]: loss1:0.0011 loss2:0.0075 main_loss:0.0306 | AUC:0.8509 AUC2:0.8490 FAR:0.00279
[2023-07-20 02:26:57,674][main.py][line:76][INFO] [Epoch:49/50]: loss1:0.0013 loss2:0.0072 main_loss:0.0310 | AUC:0.8493 AUC2:0.8490 FAR:0.00284
[2023-07-20 02:28:34,558][main.py][line:76][INFO] [Epoch:50/50]: loss1:0.0010 loss2:0.0071 main_loss:0.0309 | AUC:0.8522 AUC2:0.8490 FAR:0.00286
[2023-07-20 02:28:34,684][main.py][line:82][INFO] Training completes in 83m 20s | best AUC:0.8600 FAR:0.00286

[2023-07-20 03:39:08,526][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 03:39:11,740][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8592.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 03:39:11,894][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 03:39:11,894][main.py][line:123][INFO] Test Mode
[2023-07-20 03:39:11,894][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8592.pkl.
[2023-07-20 03:39:11,951][main.py][line:32][INFO] bert.embedding.learnedPosition.pe size mismatch: load torch.Size([1, 33, 1024]) given torch.Size([1, 201, 1024])
[2023-07-20 03:39:34,358][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 03:39:34,518][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 03:39:34,518][main.py][line:123][INFO] Test Mode
[2023-07-20 03:39:34,518][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__86.pkl.
[2023-07-20 03:39:54,300][infer_bert.py][line:55][INFO] offline AUC:0.8600 AUC2:0.8541 AP:0.3277 FAR:0.0022 | Complete in 0m 20s

[2023-07-20 03:42:11,529][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 500, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 03:42:11,696][main.py][line:116][INFO] total params:27.5062M
[2023-07-20 03:42:11,696][main.py][line:119][INFO] Training Mode
[2023-07-20 03:42:11,696][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 03:42:11,696][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 03:42:50,611][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 03:47:11,406][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 500, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 03:47:11,571][main.py][line:116][INFO] total params:27.5062M
[2023-07-20 03:47:11,571][main.py][line:119][INFO] Training Mode
[2023-07-20 03:47:11,572][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 03:47:11,572][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 03:47:49,418][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 03:49:08,328][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 03:49:08,491][main.py][line:116][INFO] total params:27.3014M
[2023-07-20 03:49:08,491][main.py][line:119][INFO] Training Mode
[2023-07-20 03:49:08,491][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 03:49:08,491][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 03:49:33,864][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 03:51:16,449][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.5132 loss2:1.0940 main_loss:1.5696 | AUC:0.8343 AUC2:0.8315 FAR:0.00953
[2023-07-20 03:52:58,978][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.2477 loss2:0.8751 main_loss:1.1400 | AUC:0.8451 AUC2:0.8470 FAR:0.00934
[2023-07-20 03:54:42,505][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.1487 loss2:0.7792 main_loss:0.9739 | AUC:0.8471 AUC2:0.8437 FAR:0.00855
[2023-07-20 03:56:25,494][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0812 loss2:0.7029 main_loss:0.8626 | AUC:0.8469 AUC2:0.8437 FAR:0.00408
[2023-07-20 03:58:08,164][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0551 loss2:0.6406 main_loss:0.7698 | AUC:0.8438 AUC2:0.8437 FAR:0.00304
[2023-07-20 03:59:51,207][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0410 loss2:0.5811 main_loss:0.6909 | AUC:0.8450 AUC2:0.8437 FAR:0.00709
[2023-07-20 04:01:34,188][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0315 loss2:0.5271 main_loss:0.6334 | AUC:0.8507 AUC2:0.8412 FAR:0.01040
[2023-07-20 04:03:17,526][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0273 loss2:0.4768 main_loss:0.5930 | AUC:0.8473 AUC2:0.8412 FAR:0.00664
[2023-07-20 04:05:00,746][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0178 loss2:0.4176 main_loss:0.5344 | AUC:0.8411 AUC2:0.8412 FAR:0.00333
[2023-07-20 04:06:44,380][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0254 loss2:0.3845 main_loss:0.5093 | AUC:0.8334 AUC2:0.8412 FAR:0.00291
[2023-07-20 04:08:27,466][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0151 loss2:0.3326 main_loss:0.4768 | AUC:0.8438 AUC2:0.8412 FAR:0.00435
[2023-07-20 04:10:10,309][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0183 loss2:0.2957 main_loss:0.4374 | AUC:0.8489 AUC2:0.8412 FAR:0.00447
[2023-07-20 04:11:53,502][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0445 loss2:0.2989 main_loss:0.4424 | AUC:0.8290 AUC2:0.8412 FAR:0.01595
[2023-07-20 04:13:36,890][main.py][line:76][INFO] [Epoch:14/50]: loss1:0.0259 loss2:0.2631 main_loss:0.4036 | AUC:0.8307 AUC2:0.8412 FAR:0.00625
[2023-07-20 04:15:20,193][main.py][line:76][INFO] [Epoch:15/50]: loss1:0.0110 loss2:0.2054 main_loss:0.3332 | AUC:0.8404 AUC2:0.8412 FAR:0.00506
[2023-07-20 04:17:03,390][main.py][line:76][INFO] [Epoch:16/50]: loss1:0.0089 loss2:0.1717 main_loss:0.2996 | AUC:0.8327 AUC2:0.8412 FAR:0.00427
[2023-07-20 04:18:46,365][main.py][line:76][INFO] [Epoch:17/50]: loss1:0.0092 loss2:0.1515 main_loss:0.2639 | AUC:0.8383 AUC2:0.8412 FAR:0.00479
[2023-07-20 04:20:29,209][main.py][line:76][INFO] [Epoch:18/50]: loss1:0.0064 loss2:0.1241 main_loss:0.2348 | AUC:0.8400 AUC2:0.8412 FAR:0.00380
[2023-07-20 04:22:12,208][main.py][line:76][INFO] [Epoch:19/50]: loss1:0.0061 loss2:0.1063 main_loss:0.2159 | AUC:0.8340 AUC2:0.8412 FAR:0.00711
[2023-07-20 04:23:55,233][main.py][line:76][INFO] [Epoch:20/50]: loss1:0.0074 loss2:0.0926 main_loss:0.1969 | AUC:0.8406 AUC2:0.8412 FAR:0.00491
[2023-07-20 04:25:38,155][main.py][line:76][INFO] [Epoch:21/50]: loss1:0.0089 loss2:0.0895 main_loss:0.2048 | AUC:0.8262 AUC2:0.8412 FAR:0.00388
[2023-07-20 04:27:21,873][main.py][line:76][INFO] [Epoch:22/50]: loss1:0.0216 loss2:0.1048 main_loss:0.2203 | AUC:0.8363 AUC2:0.8412 FAR:0.00654
[2023-07-20 04:29:05,532][main.py][line:76][INFO] [Epoch:23/50]: loss1:0.0064 loss2:0.0721 main_loss:0.1789 | AUC:0.8201 AUC2:0.8412 FAR:0.01265
[2023-07-20 04:30:48,513][main.py][line:76][INFO] [Epoch:24/50]: loss1:0.0059 loss2:0.0598 main_loss:0.1606 | AUC:0.8199 AUC2:0.8412 FAR:0.00309
[2023-07-20 04:32:31,800][main.py][line:76][INFO] [Epoch:25/50]: loss1:0.0046 loss2:0.0518 main_loss:0.1480 | AUC:0.8196 AUC2:0.8412 FAR:0.01042
[2023-07-20 04:34:14,888][main.py][line:76][INFO] [Epoch:26/50]: loss1:0.0047 loss2:0.0449 main_loss:0.1357 | AUC:0.8318 AUC2:0.8412 FAR:0.00664
[2023-07-20 04:35:58,003][main.py][line:76][INFO] [Epoch:27/50]: loss1:0.0029 loss2:0.0385 main_loss:0.1258 | AUC:0.8149 AUC2:0.8412 FAR:0.00282
[2023-07-20 04:37:40,947][main.py][line:76][INFO] [Epoch:28/50]: loss1:0.0028 loss2:0.0340 main_loss:0.1192 | AUC:0.8223 AUC2:0.8412 FAR:0.00813
[2023-07-20 04:39:24,203][main.py][line:76][INFO] [Epoch:29/50]: loss1:0.0027 loss2:0.0314 main_loss:0.1106 | AUC:0.8130 AUC2:0.8412 FAR:0.00721
[2023-07-20 04:41:06,809][main.py][line:76][INFO] [Epoch:30/50]: loss1:0.0028 loss2:0.0279 main_loss:0.1134 | AUC:0.8238 AUC2:0.8412 FAR:0.00605
[2023-07-20 04:42:50,615][main.py][line:76][INFO] [Epoch:31/50]: loss1:0.0026 loss2:0.0250 main_loss:0.1094 | AUC:0.8157 AUC2:0.8412 FAR:0.00887
[2023-07-20 04:46:13,498][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 04:46:13,687][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 04:46:13,687][main.py][line:119][INFO] Training Mode
[2023-07-20 04:46:13,688][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 04:46:13,688][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 04:48:27,498][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 04:48:27,653][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 04:48:27,653][main.py][line:119][INFO] Training Mode
[2023-07-20 04:48:27,653][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 04:48:27,653][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 04:51:15,542][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 04:51:15,705][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 04:51:15,705][main.py][line:119][INFO] Training Mode
[2023-07-20 04:51:15,706][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 04:51:15,706][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 04:51:49,040][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 04:51:49,196][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 04:51:49,196][main.py][line:119][INFO] Training Mode
[2023-07-20 04:51:49,196][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 04:51:49,196][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 04:52:10,739][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 04:52:10,885][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 04:52:10,885][main.py][line:119][INFO] Training Mode
[2023-07-20 04:52:10,886][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 04:52:10,886][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 04:54:42,532][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 04:54:42,677][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 04:54:42,677][main.py][line:119][INFO] Training Mode
[2023-07-20 04:54:42,677][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 04:54:42,677][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:00:48,367][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:00:48,523][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:00:48,523][main.py][line:119][INFO] Training Mode
[2023-07-20 05:00:48,523][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:00:48,524][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:01:02,545][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:01:02,701][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:01:02,701][main.py][line:119][INFO] Training Mode
[2023-07-20 05:01:02,701][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:01:02,701][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:01:58,555][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:01:58,698][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:01:58,698][main.py][line:119][INFO] Training Mode
[2023-07-20 05:01:58,699][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:01:58,699][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:02:12,582][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:02:12,738][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:02:12,738][main.py][line:119][INFO] Training Mode
[2023-07-20 05:02:12,738][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:02:12,738][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:03:22,983][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:03:23,136][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:03:23,136][main.py][line:119][INFO] Training Mode
[2023-07-20 05:03:23,136][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:03:23,136][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:03:58,043][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:03:58,205][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:03:58,206][main.py][line:119][INFO] Training Mode
[2023-07-20 05:03:58,206][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:03:58,206][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:04:17,673][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:04:17,833][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:04:17,833][main.py][line:119][INFO] Training Mode
[2023-07-20 05:04:17,834][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:04:17,834][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:04:48,733][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:04:48,889][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:04:48,889][main.py][line:119][INFO] Training Mode
[2023-07-20 05:04:48,889][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:04:48,890][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:05:11,063][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:05:11,220][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:05:11,220][main.py][line:119][INFO] Training Mode
[2023-07-20 05:05:11,220][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:05:11,220][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:07:38,827][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:07:38,973][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:07:38,973][main.py][line:119][INFO] Training Mode
[2023-07-20 05:07:38,973][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:07:38,974][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:08:58,932][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:08:59,090][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:08:59,090][main.py][line:119][INFO] Training Mode
[2023-07-20 05:08:59,090][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:08:59,090][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:09:31,927][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:09:32,075][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:09:32,075][main.py][line:119][INFO] Training Mode
[2023-07-20 05:09:32,075][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:09:32,075][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:10:45,224][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:10:45,388][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:10:45,388][main.py][line:119][INFO] Training Mode
[2023-07-20 05:10:45,389][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:10:45,389][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:11:49,602][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:11:49,758][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:11:49,758][main.py][line:119][INFO] Training Mode
[2023-07-20 05:11:49,758][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:11:49,758][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:12:25,527][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:12:25,686][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:12:25,686][main.py][line:119][INFO] Training Mode
[2023-07-20 05:12:25,687][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:12:25,687][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:13:01,198][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:13:01,357][main.py][line:116][INFO] total params:27.3014M
[2023-07-20 05:13:01,357][main.py][line:119][INFO] Training Mode
[2023-07-20 05:13:01,358][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:13:01,358][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:13:57,632][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:13:57,793][main.py][line:116][INFO] total params:27.3014M
[2023-07-20 05:13:57,793][main.py][line:119][INFO] Training Mode
[2023-07-20 05:13:57,793][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:13:57,793][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:14:23,602][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 05:20:15,852][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:20:16,012][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:20:16,012][main.py][line:119][INFO] Training Mode
[2023-07-20 05:20:16,013][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:20:16,013][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:20:37,617][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:20:37,783][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:20:37,783][main.py][line:119][INFO] Training Mode
[2023-07-20 05:20:37,783][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:20:37,783][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:21:09,244][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:21:09,405][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:21:09,405][main.py][line:119][INFO] Training Mode
[2023-07-20 05:21:09,406][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:21:09,406][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:21:37,426][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:21:37,573][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:21:37,573][main.py][line:119][INFO] Training Mode
[2023-07-20 05:21:37,573][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:21:37,573][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:22:15,734][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:22:15,879][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:22:15,879][main.py][line:119][INFO] Training Mode
[2023-07-20 05:22:15,879][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:22:15,879][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:23:35,496][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:23:35,653][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:23:35,653][main.py][line:119][INFO] Training Mode
[2023-07-20 05:23:35,653][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:23:35,653][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:24:32,805][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:24:32,951][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:24:32,951][main.py][line:119][INFO] Training Mode
[2023-07-20 05:24:32,952][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:24:32,952][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:24:41,264][main.py][line:53][INFO] Random initialize AUC:0.5446 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 05:26:59,883][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:27:00,048][main.py][line:116][INFO] total params:26.9953M
[2023-07-20 05:27:00,048][main.py][line:119][INFO] Training Mode
[2023-07-20 05:27:00,048][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.5, inplace=False)
    (dropout2): Dropout(p=0.5, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:27:00,048][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:27:08,284][main.py][line:53][INFO] Random initialize AUC:0.5446 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 05:30:02,880][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.5295 loss2:1.1985 main_loss:1.8068 | AUC:0.8353 AUC2:0.8351 FAR:0.01608
[2023-07-20 05:32:58,821][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.2921 loss2:0.9614 main_loss:1.3893 | AUC:0.8337 AUC2:0.8351 FAR:0.01025
[2023-07-20 05:35:38,227][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.1680 loss2:0.8312 main_loss:1.1463 | AUC:0.8372 AUC2:0.8518 FAR:0.00662
[2023-07-20 05:38:25,122][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0906 loss2:0.7292 main_loss:0.9934 | AUC:0.8370 AUC2:0.8518 FAR:0.00605
[2023-07-20 05:41:10,598][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0656 loss2:0.6605 main_loss:0.9070 | AUC:0.8312 AUC2:0.8518 FAR:0.00247
[2023-07-20 05:44:59,155][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:45:37,305][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:45:43,679][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:47:46,735][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:47:59,772][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:48:07,232][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:48:07,392][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 05:48:07,392][main.py][line:119][INFO] Training Mode
[2023-07-20 05:48:07,393][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:48:07,393][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:48:21,136][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:48:21,356][main.py][line:116][INFO] total params:52.3915M
[2023-07-20 05:48:21,356][main.py][line:119][INFO] Training Mode
[2023-07-20 05:48:21,357][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:48:21,357][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:48:42,491][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 05:49:41,975][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 05:49:42,223][main.py][line:116][INFO] total params:52.3915M
[2023-07-20 05:49:42,223][main.py][line:119][INFO] Training Mode
[2023-07-20 05:49:42,224][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 05:49:42,224][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 05:50:02,516][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 05:51:49,821][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3750 loss2:1.0443 main_loss:1.5780 | AUC:0.8327 AUC2:0.8327 FAR:0.00976
[2023-07-20 05:53:37,394][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1707 loss2:0.8155 main_loss:1.2475 | AUC:0.8428 AUC2:0.8428 FAR:0.00304
[2023-07-20 05:55:26,258][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0984 loss2:0.7261 main_loss:1.1219 | AUC:0.8391 AUC2:0.8428 FAR:0.00123
[2023-07-20 05:57:14,800][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0533 loss2:0.6461 main_loss:1.0194 | AUC:0.8495 AUC2:0.8495 FAR:0.00487
[2023-07-20 05:59:03,598][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0396 loss2:0.5823 main_loss:0.9487 | AUC:0.8442 AUC2:0.8495 FAR:0.00437
[2023-07-20 06:00:52,407][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0341 loss2:0.5232 main_loss:0.8867 | AUC:0.8431 AUC2:0.8495 FAR:0.00183
[2023-07-20 06:02:41,042][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0357 loss2:0.4766 main_loss:0.8409 | AUC:0.8474 AUC2:0.8495 FAR:0.00477
[2023-07-20 06:04:30,888][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0293 loss2:0.4206 main_loss:0.7812 | AUC:0.8473 AUC2:0.8495 FAR:0.00249
[2023-07-20 06:06:20,349][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0218 loss2:0.3662 main_loss:0.6621 | AUC:0.8480 AUC2:0.8495 FAR:0.00284
[2023-07-20 06:08:08,906][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0177 loss2:0.3195 main_loss:0.5655 | AUC:0.8486 AUC2:0.8495 FAR:0.00319
[2023-07-20 06:09:58,122][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0133 loss2:0.2680 main_loss:0.4706 | AUC:0.8541 AUC2:0.8479 FAR:0.00338
[2023-07-20 06:11:47,227][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0122 loss2:0.2235 main_loss:0.3941 | AUC:0.8570 AUC2:0.8499 FAR:0.00123
[2023-07-20 06:13:35,800][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0123 loss2:0.1928 main_loss:0.3446 | AUC:0.8549 AUC2:0.8499 FAR:0.00163
[2023-07-20 06:15:24,296][main.py][line:76][INFO] [Epoch:14/50]: loss1:0.0328 loss2:0.2002 main_loss:0.3557 | AUC:0.8497 AUC2:0.8499 FAR:0.00269
[2023-07-20 06:17:13,293][main.py][line:76][INFO] [Epoch:15/50]: loss1:0.0415 loss2:0.2006 main_loss:0.3507 | AUC:0.8567 AUC2:0.8499 FAR:0.00906
[2023-07-20 06:19:02,245][main.py][line:76][INFO] [Epoch:16/50]: loss1:0.0312 loss2:0.1695 main_loss:0.3077 | AUC:0.8569 AUC2:0.8499 FAR:0.00257
[2023-07-20 06:20:51,591][main.py][line:76][INFO] [Epoch:17/50]: loss1:0.0098 loss2:0.1184 main_loss:0.2429 | AUC:0.8584 AUC2:0.8498 FAR:0.00175
[2023-07-20 06:22:40,369][main.py][line:76][INFO] [Epoch:18/50]: loss1:0.0071 loss2:0.0956 main_loss:0.2251 | AUC:0.8576 AUC2:0.8498 FAR:0.00254
[2023-07-20 06:24:29,489][main.py][line:76][INFO] [Epoch:19/50]: loss1:0.0063 loss2:0.0789 main_loss:0.2057 | AUC:0.8578 AUC2:0.8498 FAR:0.00165
[2023-07-20 06:26:18,684][main.py][line:76][INFO] [Epoch:20/50]: loss1:0.0091 loss2:0.0687 main_loss:0.1838 | AUC:0.8522 AUC2:0.8498 FAR:0.00101
[2023-07-20 06:28:08,017][main.py][line:76][INFO] [Epoch:21/50]: loss1:0.0063 loss2:0.0604 main_loss:0.1669 | AUC:0.8544 AUC2:0.8498 FAR:0.00109
[2023-07-20 06:29:57,892][main.py][line:76][INFO] [Epoch:22/50]: loss1:0.0048 loss2:0.0503 main_loss:0.1473 | AUC:0.8529 AUC2:0.8498 FAR:0.00168
[2023-07-20 06:31:46,327][main.py][line:76][INFO] [Epoch:23/50]: loss1:0.0054 loss2:0.0455 main_loss:0.1501 | AUC:0.8548 AUC2:0.8498 FAR:0.00126
[2023-07-20 06:33:35,381][main.py][line:76][INFO] [Epoch:24/50]: loss1:0.0038 loss2:0.0383 main_loss:0.1413 | AUC:0.8552 AUC2:0.8498 FAR:0.00089
[2023-07-20 06:35:23,850][main.py][line:76][INFO] [Epoch:25/50]: loss1:0.0034 loss2:0.0334 main_loss:0.1274 | AUC:0.8555 AUC2:0.8498 FAR:0.00106
[2023-07-20 06:37:12,667][main.py][line:76][INFO] [Epoch:26/50]: loss1:0.0041 loss2:0.0312 main_loss:0.1233 | AUC:0.8530 AUC2:0.8498 FAR:0.00165
[2023-07-20 06:39:01,821][main.py][line:76][INFO] [Epoch:27/50]: loss1:0.0331 loss2:0.0810 main_loss:0.1881 | AUC:0.8563 AUC2:0.8498 FAR:0.00410
[2023-07-20 06:40:51,201][main.py][line:76][INFO] [Epoch:28/50]: loss1:0.0086 loss2:0.0407 main_loss:0.1318 | AUC:0.8526 AUC2:0.8498 FAR:0.00425
[2023-07-20 06:42:39,572][main.py][line:76][INFO] [Epoch:29/50]: loss1:0.0039 loss2:0.0277 main_loss:0.1151 | AUC:0.8535 AUC2:0.8498 FAR:0.00388
[2023-07-20 06:44:28,948][main.py][line:76][INFO] [Epoch:30/50]: loss1:0.0036 loss2:0.0233 main_loss:0.1058 | AUC:0.8514 AUC2:0.8498 FAR:0.00326
[2023-07-20 06:46:17,956][main.py][line:76][INFO] [Epoch:31/50]: loss1:0.0028 loss2:0.0205 main_loss:0.0989 | AUC:0.8525 AUC2:0.8498 FAR:0.00282
[2023-07-20 06:48:06,915][main.py][line:76][INFO] [Epoch:32/50]: loss1:0.0026 loss2:0.0179 main_loss:0.1001 | AUC:0.8527 AUC2:0.8498 FAR:0.00203
[2023-07-20 06:49:55,910][main.py][line:76][INFO] [Epoch:33/50]: loss1:0.0024 loss2:0.0161 main_loss:0.0889 | AUC:0.8521 AUC2:0.8498 FAR:0.00257
[2023-07-20 06:51:44,997][main.py][line:76][INFO] [Epoch:34/50]: loss1:0.0019 loss2:0.0148 main_loss:0.0892 | AUC:0.8523 AUC2:0.8498 FAR:0.00195
[2023-07-20 06:53:33,801][main.py][line:76][INFO] [Epoch:35/50]: loss1:0.0018 loss2:0.0137 main_loss:0.0838 | AUC:0.8527 AUC2:0.8498 FAR:0.00203
[2023-07-20 06:55:22,113][main.py][line:76][INFO] [Epoch:36/50]: loss1:0.0020 loss2:0.0133 main_loss:0.0822 | AUC:0.8517 AUC2:0.8498 FAR:0.00188
[2023-07-20 06:57:10,459][main.py][line:76][INFO] [Epoch:37/50]: loss1:0.0017 loss2:0.0116 main_loss:0.0806 | AUC:0.8514 AUC2:0.8498 FAR:0.00188
[2023-07-20 06:58:59,181][main.py][line:76][INFO] [Epoch:38/50]: loss1:0.0015 loss2:0.0112 main_loss:0.0817 | AUC:0.8544 AUC2:0.8498 FAR:0.00195
[2023-07-20 07:00:48,207][main.py][line:76][INFO] [Epoch:39/50]: loss1:0.0014 loss2:0.0103 main_loss:0.0767 | AUC:0.8535 AUC2:0.8498 FAR:0.00188
[2023-07-20 07:02:36,676][main.py][line:76][INFO] [Epoch:40/50]: loss1:0.0012 loss2:0.0096 main_loss:0.0700 | AUC:0.8535 AUC2:0.8498 FAR:0.00190
[2023-07-20 07:04:26,339][main.py][line:76][INFO] [Epoch:41/50]: loss1:0.0012 loss2:0.0092 main_loss:0.0686 | AUC:0.8503 AUC2:0.8498 FAR:0.00175
[2023-07-20 07:06:14,749][main.py][line:76][INFO] [Epoch:42/50]: loss1:0.0013 loss2:0.0092 main_loss:0.0690 | AUC:0.8520 AUC2:0.8498 FAR:0.00212
[2023-07-20 07:08:03,525][main.py][line:76][INFO] [Epoch:43/50]: loss1:0.0012 loss2:0.0087 main_loss:0.0667 | AUC:0.8534 AUC2:0.8498 FAR:0.00230
[2023-07-20 07:09:53,430][main.py][line:76][INFO] [Epoch:44/50]: loss1:0.0012 loss2:0.0084 main_loss:0.0633 | AUC:0.8525 AUC2:0.8498 FAR:0.00190
[2023-07-20 07:11:42,484][main.py][line:76][INFO] [Epoch:45/50]: loss1:0.0016 loss2:0.0083 main_loss:0.0634 | AUC:0.8509 AUC2:0.8498 FAR:0.00240
[2023-07-20 07:13:30,823][main.py][line:76][INFO] [Epoch:46/50]: loss1:0.0011 loss2:0.0077 main_loss:0.0604 | AUC:0.8519 AUC2:0.8498 FAR:0.00178
[2023-07-20 07:15:19,445][main.py][line:76][INFO] [Epoch:47/50]: loss1:0.0010 loss2:0.0073 main_loss:0.0616 | AUC:0.8529 AUC2:0.8498 FAR:0.00195
[2023-07-20 07:17:08,844][main.py][line:76][INFO] [Epoch:48/50]: loss1:0.0012 loss2:0.0073 main_loss:0.0612 | AUC:0.8509 AUC2:0.8498 FAR:0.00180
[2023-07-20 07:18:57,687][main.py][line:76][INFO] [Epoch:49/50]: loss1:0.0010 loss2:0.0071 main_loss:0.0585 | AUC:0.8524 AUC2:0.8498 FAR:0.00173
[2023-07-20 07:20:47,024][main.py][line:76][INFO] [Epoch:50/50]: loss1:0.0011 loss2:0.0070 main_loss:0.0588 | AUC:0.8530 AUC2:0.8498 FAR:0.00168
[2023-07-20 07:20:47,201][main.py][line:82][INFO] Training completes in 90m 45s | best AUC:0.8584 FAR:0.00175

[2023-07-20 14:12:08,126][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__86.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 14:12:08,386][main.py][line:116][INFO] total params:52.4939M
[2023-07-20 14:12:08,386][main.py][line:123][INFO] Test Mode
[2023-07-20 14:12:08,386][main.py][line:37][INFO] Not found pretrained checkpoint file.
[2023-07-20 14:12:42,743][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8584.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.5, 'train_bs': 128, 'max_seqlen': 300, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 14:12:42,974][main.py][line:116][INFO] total params:52.4939M
[2023-07-20 14:12:42,974][main.py][line:123][INFO] Test Mode
[2023-07-20 14:12:42,974][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8584.pkl.
[2023-07-20 14:12:43,032][main.py][line:32][INFO] bert.embedding.learnedPosition.pe size mismatch: load torch.Size([1, 201, 1024]) given torch.Size([1, 301, 1024])
[2023-07-20 14:13:11,072][infer_bert.py][line:55][INFO] offline AUC:0.8592 AUC2:0.8557 AP:0.3162 FAR:0.0011 | Complete in 0m 28s

[2023-07-20 14:22:07,101][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.5, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8584.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 14:22:07,342][main.py][line:116][INFO] total params:52.2891M
[2023-07-20 14:22:07,342][main.py][line:119][INFO] Training Mode
[2023-07-20 14:22:07,342][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 14:22:07,343][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 14:22:20,401][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 14:23:35,016][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3651 loss2:1.2105 main_loss:1.2431 | AUC:0.8272 AUC2:0.8273 FAR:0.00585
[2023-07-20 14:24:49,839][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1384 loss2:1.0035 main_loss:0.8672 | AUC:0.8501 AUC2:0.8441 FAR:0.00336
[2023-07-20 14:26:05,238][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0547 loss2:0.9084 main_loss:0.6741 | AUC:0.8534 AUC2:0.8487 FAR:0.00422
[2023-07-20 14:27:20,442][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0247 loss2:0.8165 main_loss:0.5637 | AUC:0.8482 AUC2:0.8487 FAR:0.00341
[2023-07-20 14:28:35,593][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0198 loss2:0.7432 main_loss:0.5005 | AUC:0.8494 AUC2:0.8487 FAR:0.00180
[2023-07-20 14:29:51,124][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0172 loss2:0.6822 main_loss:0.4538 | AUC:0.8509 AUC2:0.8487 FAR:0.00731
[2023-07-20 14:31:06,409][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0127 loss2:0.6207 main_loss:0.4130 | AUC:0.8525 AUC2:0.8487 FAR:0.00415
[2023-07-20 14:32:21,688][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0103 loss2:0.5571 main_loss:0.3806 | AUC:0.8450 AUC2:0.8487 FAR:0.00131
[2023-07-20 14:33:37,610][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0077 loss2:0.4899 main_loss:0.3390 | AUC:0.8563 AUC2:0.8470 FAR:0.00245
[2023-07-20 14:34:52,869][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0064 loss2:0.4361 main_loss:0.2934 | AUC:0.8416 AUC2:0.8470 FAR:0.00235
[2023-07-20 14:36:08,298][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0052 loss2:0.3728 main_loss:0.2636 | AUC:0.8379 AUC2:0.8470 FAR:0.00264
[2023-07-20 14:37:24,063][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0042 loss2:0.3249 main_loss:0.2223 | AUC:0.8520 AUC2:0.8470 FAR:0.00242
[2023-07-20 14:38:39,222][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0041 loss2:0.2819 main_loss:0.1958 | AUC:0.8529 AUC2:0.8470 FAR:0.00215
[2023-07-20 14:39:54,619][main.py][line:76][INFO] [Epoch:14/50]: loss1:0.0544 loss2:0.3312 main_loss:0.2756 | AUC:0.8589 AUC2:0.8506 FAR:0.00405
[2023-07-20 14:41:09,817][main.py][line:76][INFO] [Epoch:15/50]: loss1:0.0061 loss2:0.2414 main_loss:0.1759 | AUC:0.8586 AUC2:0.8506 FAR:0.00205
[2023-07-20 14:42:25,183][main.py][line:76][INFO] [Epoch:16/50]: loss1:0.0032 loss2:0.1975 main_loss:0.1506 | AUC:0.8612 AUC2:0.8528 FAR:0.00203
[2023-07-20 14:43:40,520][main.py][line:76][INFO] [Epoch:17/50]: loss1:0.0023 loss2:0.1623 main_loss:0.1225 | AUC:0.8578 AUC2:0.8528 FAR:0.00215
[2023-07-20 14:44:55,846][main.py][line:76][INFO] [Epoch:18/50]: loss1:0.0021 loss2:0.1481 main_loss:0.1219 | AUC:0.8585 AUC2:0.8528 FAR:0.00193
[2023-07-20 14:46:11,179][main.py][line:76][INFO] [Epoch:19/50]: loss1:0.0018 loss2:0.1172 main_loss:0.0975 | AUC:0.8579 AUC2:0.8528 FAR:0.00198
[2023-07-20 14:47:26,279][main.py][line:76][INFO] [Epoch:20/50]: loss1:0.0017 loss2:0.1021 main_loss:0.0863 | AUC:0.8541 AUC2:0.8528 FAR:0.00210
[2023-07-20 14:48:41,890][main.py][line:76][INFO] [Epoch:21/50]: loss1:0.0015 loss2:0.0896 main_loss:0.0807 | AUC:0.8558 AUC2:0.8528 FAR:0.00200
[2023-07-20 14:49:57,390][main.py][line:76][INFO] [Epoch:22/50]: loss1:0.0015 loss2:0.0787 main_loss:0.0726 | AUC:0.8638 AUC2:0.8490 FAR:0.00212
[2023-07-20 14:51:12,829][main.py][line:76][INFO] [Epoch:23/50]: loss1:0.0015 loss2:0.0686 main_loss:0.0630 | AUC:0.8586 AUC2:0.8490 FAR:0.00249
[2023-07-20 14:52:28,436][main.py][line:76][INFO] [Epoch:24/50]: loss1:0.0013 loss2:0.0601 main_loss:0.1247 | AUC:0.8501 AUC2:0.8490 FAR:0.00207
[2023-07-20 14:53:43,801][main.py][line:76][INFO] [Epoch:25/50]: loss1:0.0014 loss2:0.0533 main_loss:0.2221 | AUC:0.8543 AUC2:0.8490 FAR:0.00227
[2023-07-20 14:54:59,158][main.py][line:76][INFO] [Epoch:26/50]: loss1:0.0011 loss2:0.0458 main_loss:0.1437 | AUC:0.8554 AUC2:0.8490 FAR:0.00215
[2023-07-20 14:56:14,700][main.py][line:76][INFO] [Epoch:27/50]: loss1:0.0009 loss2:0.0382 main_loss:0.1172 | AUC:0.8516 AUC2:0.8490 FAR:0.00289
[2023-07-20 14:57:30,061][main.py][line:76][INFO] [Epoch:28/50]: loss1:0.0017 loss2:0.0424 main_loss:0.1018 | AUC:0.8500 AUC2:0.8490 FAR:0.00190
[2023-07-20 14:58:45,034][main.py][line:76][INFO] [Epoch:29/50]: loss1:0.0010 loss2:0.0346 main_loss:0.0842 | AUC:0.8519 AUC2:0.8490 FAR:0.00138
[2023-07-20 15:00:00,422][main.py][line:76][INFO] [Epoch:30/50]: loss1:0.0008 loss2:0.0303 main_loss:0.0776 | AUC:0.8531 AUC2:0.8490 FAR:0.00163
[2023-07-20 15:01:16,209][main.py][line:76][INFO] [Epoch:31/50]: loss1:0.0007 loss2:0.0278 main_loss:0.0737 | AUC:0.8543 AUC2:0.8490 FAR:0.00178
[2023-07-20 15:02:31,500][main.py][line:76][INFO] [Epoch:32/50]: loss1:0.0006 loss2:0.0264 main_loss:0.0764 | AUC:0.8603 AUC2:0.8490 FAR:0.00190
[2023-07-20 15:03:46,580][main.py][line:76][INFO] [Epoch:33/50]: loss1:0.0005 loss2:0.0213 main_loss:0.0918 | AUC:0.8584 AUC2:0.8490 FAR:0.00148
[2023-07-20 15:05:02,030][main.py][line:76][INFO] [Epoch:34/50]: loss1:0.0006 loss2:0.0211 main_loss:0.1323 | AUC:0.8550 AUC2:0.8490 FAR:0.00161
[2023-07-20 15:06:17,522][main.py][line:76][INFO] [Epoch:35/50]: loss1:0.0004 loss2:0.0192 main_loss:0.1724 | AUC:0.8572 AUC2:0.8490 FAR:0.00143
[2023-07-20 15:07:32,847][main.py][line:76][INFO] [Epoch:36/50]: loss1:0.0029 loss2:0.0225 main_loss:0.1524 | AUC:0.8526 AUC2:0.8490 FAR:0.00726
[2023-07-20 15:08:47,917][main.py][line:76][INFO] [Epoch:37/50]: loss1:0.0117 loss2:0.0520 main_loss:0.1695 | AUC:0.8563 AUC2:0.8490 FAR:0.00195
[2023-07-20 15:10:03,300][main.py][line:76][INFO] [Epoch:38/50]: loss1:0.0016 loss2:0.0258 main_loss:0.1673 | AUC:0.8546 AUC2:0.8490 FAR:0.00254
[2023-07-20 15:11:18,556][main.py][line:76][INFO] [Epoch:39/50]: loss1:0.0007 loss2:0.0205 main_loss:0.1581 | AUC:0.8577 AUC2:0.8490 FAR:0.00222
[2023-07-20 15:12:33,990][main.py][line:76][INFO] [Epoch:40/50]: loss1:0.0006 loss2:0.0170 main_loss:0.1495 | AUC:0.8580 AUC2:0.8490 FAR:0.00193
[2023-07-20 15:13:49,291][main.py][line:76][INFO] [Epoch:41/50]: loss1:0.0004 loss2:0.0159 main_loss:0.1399 | AUC:0.8587 AUC2:0.8490 FAR:0.00200
[2023-07-20 15:15:04,329][main.py][line:76][INFO] [Epoch:42/50]: loss1:0.0004 loss2:0.0149 main_loss:0.1291 | AUC:0.8589 AUC2:0.8490 FAR:0.00190
[2023-07-20 15:16:19,518][main.py][line:76][INFO] [Epoch:43/50]: loss1:0.0004 loss2:0.0137 main_loss:0.1243 | AUC:0.8590 AUC2:0.8490 FAR:0.00203
[2023-07-20 15:17:35,133][main.py][line:76][INFO] [Epoch:44/50]: loss1:0.0003 loss2:0.0134 main_loss:0.1171 | AUC:0.8592 AUC2:0.8490 FAR:0.00198
[2023-07-20 15:18:50,397][main.py][line:76][INFO] [Epoch:45/50]: loss1:0.0003 loss2:0.0122 main_loss:0.1165 | AUC:0.8600 AUC2:0.8490 FAR:0.00190
[2023-07-20 15:20:05,802][main.py][line:76][INFO] [Epoch:46/50]: loss1:0.0003 loss2:0.0126 main_loss:0.1114 | AUC:0.8610 AUC2:0.8490 FAR:0.00207
[2023-07-20 15:21:21,038][main.py][line:76][INFO] [Epoch:47/50]: loss1:0.0003 loss2:0.0105 main_loss:0.1082 | AUC:0.8611 AUC2:0.8490 FAR:0.00205
[2023-07-20 15:22:36,431][main.py][line:76][INFO] [Epoch:48/50]: loss1:0.0003 loss2:0.0108 main_loss:0.1048 | AUC:0.8606 AUC2:0.8490 FAR:0.00203
[2023-07-20 15:23:51,905][main.py][line:76][INFO] [Epoch:49/50]: loss1:0.0003 loss2:0.0108 main_loss:0.1032 | AUC:0.8609 AUC2:0.8490 FAR:0.00188
[2023-07-20 15:25:06,990][main.py][line:76][INFO] [Epoch:50/50]: loss1:0.0003 loss2:0.0100 main_loss:0.0983 | AUC:0.8606 AUC2:0.8490 FAR:0.00188
[2023-07-20 15:25:07,118][main.py][line:82][INFO] Training completes in 62m 47s | best AUC:0.8638 FAR:0.00212

[2023-07-20 15:34:00,531][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.5, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 15:34:00,813][main.py][line:116][INFO] total params:52.2891M
[2023-07-20 15:34:00,813][main.py][line:123][INFO] Test Mode
[2023-07-20 15:34:00,813][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-20 15:34:14,614][infer_bert.py][line:55][INFO] offline AUC:0.8638 AUC2:0.8558 AP:0.3289 FAR:0.0014 | Complete in 0m 14s

[2023-07-20 15:35:32,774][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.5, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 15:35:33,011][main.py][line:116][INFO] total params:52.2891M
[2023-07-20 15:35:33,011][main.py][line:119][INFO] Training Mode
[2023-07-20 15:35:33,011][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 15:35:33,012][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 15:35:46,042][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 15:37:00,743][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3684 loss2:1.3709 main_loss:4.6427 | AUC:0.8216 AUC2:0.8233 FAR:0.02131
[2023-07-20 15:38:15,422][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1426 loss2:1.3015 main_loss:2.3037 | AUC:0.8487 AUC2:0.8460 FAR:0.01319
[2023-07-20 15:39:30,790][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0390 loss2:1.2560 main_loss:1.1836 | AUC:0.8428 AUC2:0.8460 FAR:0.00617
[2023-07-20 15:40:46,036][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0236 loss2:1.2090 main_loss:0.9709 | AUC:0.8461 AUC2:0.8460 FAR:0.01452
[2023-07-20 15:42:01,313][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0090 loss2:1.1655 main_loss:0.7813 | AUC:0.8429 AUC2:0.8460 FAR:0.01057
[2023-07-20 15:43:17,120][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0234 loss2:1.1307 main_loss:0.8951 | AUC:0.8425 AUC2:0.8460 FAR:0.00677
[2023-07-20 15:44:32,429][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0025 loss2:1.0662 main_loss:0.6476 | AUC:0.8388 AUC2:0.8460 FAR:0.00916
[2023-07-20 15:45:47,748][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0010 loss2:1.0185 main_loss:0.6106 | AUC:0.8417 AUC2:0.8460 FAR:0.00556
[2023-07-20 15:47:03,275][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0007 loss2:0.9457 main_loss:0.5662 | AUC:0.8468 AUC2:0.8460 FAR:0.00529
[2023-07-20 15:48:18,572][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0007 loss2:0.8906 main_loss:0.5211 | AUC:0.8432 AUC2:0.8460 FAR:0.00450
[2023-07-20 15:49:34,210][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0007 loss2:0.8371 main_loss:0.4973 | AUC:0.8385 AUC2:0.8460 FAR:0.00338
[2023-07-20 15:50:49,955][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0007 loss2:0.7563 main_loss:0.4408 | AUC:0.8473 AUC2:0.8460 FAR:0.00412
[2023-07-20 15:52:05,386][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0006 loss2:0.7114 main_loss:0.4129 | AUC:0.8478 AUC2:0.8460 FAR:0.00304
[2023-07-20 15:53:21,095][main.py][line:76][INFO] [Epoch:14/50]: loss1:0.0007 loss2:0.6177 main_loss:0.3713 | AUC:0.8493 AUC2:0.8467 FAR:0.00316
[2023-07-20 15:54:36,551][main.py][line:76][INFO] [Epoch:15/50]: loss1:0.0006 loss2:0.5304 main_loss:0.3199 | AUC:0.8493 AUC2:0.8484 FAR:0.00316
[2023-07-20 15:55:52,087][main.py][line:76][INFO] [Epoch:16/50]: loss1:0.0005 loss2:0.4756 main_loss:0.2918 | AUC:0.8533 AUC2:0.8496 FAR:0.00368
[2023-07-20 15:57:07,392][main.py][line:76][INFO] [Epoch:17/50]: loss1:0.0006 loss2:0.4529 main_loss:0.2717 | AUC:0.8529 AUC2:0.8496 FAR:0.00336
[2023-07-20 15:58:23,170][main.py][line:76][INFO] [Epoch:18/50]: loss1:0.0455 loss2:0.4921 main_loss:0.7469 | AUC:0.8446 AUC2:0.8496 FAR:0.00161
[2023-07-20 15:59:38,854][main.py][line:76][INFO] [Epoch:19/50]: loss1:0.0306 loss2:0.6235 main_loss:0.6549 | AUC:0.8433 AUC2:0.8496 FAR:0.01642
[2023-07-20 16:00:54,144][main.py][line:76][INFO] [Epoch:20/50]: loss1:0.0044 loss2:0.4530 main_loss:0.3035 | AUC:0.8389 AUC2:0.8496 FAR:0.00709
[2023-07-20 16:02:09,582][main.py][line:76][INFO] [Epoch:21/50]: loss1:0.0007 loss2:0.3035 main_loss:0.1931 | AUC:0.8424 AUC2:0.8496 FAR:0.00531
[2023-07-20 16:03:24,631][main.py][line:76][INFO] [Epoch:22/50]: loss1:0.0004 loss2:0.2555 main_loss:0.1636 | AUC:0.8490 AUC2:0.8496 FAR:0.00494
[2023-07-20 16:04:39,618][main.py][line:76][INFO] [Epoch:23/50]: loss1:0.0004 loss2:0.2559 main_loss:0.1596 | AUC:0.8461 AUC2:0.8496 FAR:0.00489
[2023-07-20 16:05:54,851][main.py][line:76][INFO] [Epoch:24/50]: loss1:0.0004 loss2:0.1888 main_loss:0.1916 | AUC:0.8392 AUC2:0.8496 FAR:0.00482
[2023-07-20 16:07:09,627][main.py][line:76][INFO] [Epoch:25/50]: loss1:0.0003 loss2:0.1495 main_loss:0.2715 | AUC:0.8396 AUC2:0.8496 FAR:0.00531
[2023-07-20 16:08:24,522][main.py][line:76][INFO] [Epoch:26/50]: loss1:0.0002 loss2:0.1257 main_loss:0.1849 | AUC:0.8435 AUC2:0.8496 FAR:0.00435
[2023-07-20 16:08:45,648][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 0.5, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 16:08:45,903][main.py][line:116][INFO] total params:52.2891M
[2023-07-20 16:08:45,903][main.py][line:119][INFO] Training Mode
[2023-07-20 16:08:45,903][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 16:08:45,903][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-07-20 16:08:59,016][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 16:10:13,864][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3554 loss2:1.1499 main_loss:1.2712 | AUC:0.8341 AUC2:0.8283 FAR:0.00277
[2023-07-20 16:11:28,744][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1050 loss2:0.9077 main_loss:0.8439 | AUC:0.8450 AUC2:0.8417 FAR:0.00351
[2023-07-20 16:12:44,232][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0406 loss2:0.7850 main_loss:0.7339 | AUC:0.8411 AUC2:0.8417 FAR:0.00321
[2023-07-20 16:13:59,660][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0311 loss2:0.6588 main_loss:0.6656 | AUC:0.8230 AUC2:0.8417 FAR:0.00222
[2023-07-20 16:15:15,186][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0268 loss2:0.5569 main_loss:0.5745 | AUC:0.8410 AUC2:0.8417 FAR:0.01203
[2023-07-20 16:16:30,541][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0178 loss2:0.4723 main_loss:0.5150 | AUC:0.8289 AUC2:0.8417 FAR:0.00264
[2023-07-20 16:16:51,311][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.001, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 16:16:51,565][main.py][line:116][INFO] total params:52.3915M
[2023-07-20 16:16:51,565][main.py][line:119][INFO] Training Mode
[2023-07-20 16:16:51,565][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 16:16:51,565][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-07-20 16:17:12,213][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 16:19:04,406][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3464 loss2:1.0336 main_loss:1.9267 | AUC:0.8347 AUC2:0.8310 FAR:0.00437
[2023-07-20 16:21:00,939][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1192 loss2:0.7991 main_loss:1.2829 | AUC:0.8351 AUC2:0.8309 FAR:0.00696
[2023-07-20 16:22:59,313][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0540 loss2:0.6838 main_loss:1.0823 | AUC:0.8465 AUC2:0.8386 FAR:0.00889
[2023-07-20 16:24:51,444][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0542 loss2:0.5902 main_loss:0.9522 | AUC:0.8438 AUC2:0.8386 FAR:0.00699
[2023-07-20 16:26:42,347][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0333 loss2:0.5055 main_loss:0.8395 | AUC:0.8395 AUC2:0.8386 FAR:0.00274
[2023-07-20 16:28:36,398][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0126 loss2:0.3935 main_loss:0.7542 | AUC:0.8490 AUC2:0.8458 FAR:0.00277
[2023-07-20 16:30:29,384][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0146 loss2:0.3005 main_loss:0.6515 | AUC:0.8522 AUC2:0.8376 FAR:0.00645
[2023-07-20 16:32:22,683][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0348 loss2:0.2895 main_loss:0.6443 | AUC:0.8463 AUC2:0.8376 FAR:0.00450
[2023-07-20 16:34:13,710][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0078 loss2:0.1830 main_loss:0.5324 | AUC:0.8455 AUC2:0.8376 FAR:0.00417
[2023-07-20 16:36:04,452][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0073 loss2:0.1310 main_loss:0.4769 | AUC:0.8391 AUC2:0.8376 FAR:0.00099
[2023-07-20 16:37:55,108][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0522 loss2:0.1893 main_loss:0.5910 | AUC:0.8475 AUC2:0.8376 FAR:0.00694
[2023-07-20 16:39:46,729][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0099 loss2:0.1059 main_loss:0.5641 | AUC:0.8408 AUC2:0.8376 FAR:0.00696
[2023-07-20 16:41:38,625][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0045 loss2:0.0603 main_loss:0.5816 | AUC:0.8419 AUC2:0.8376 FAR:0.00761
[2023-07-20 16:41:47,971][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.999, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.001, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 50, 'workers': 4, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 16:41:48,233][main.py][line:116][INFO] total params:52.3915M
[2023-07-20 16:41:48,233][main.py][line:119][INFO] Training Mode
[2023-07-20 16:41:48,234][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 16:41:48,234][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.001
    lr: 0.001
    maximize: False
    weight_decay: 0
)

[2023-07-20 16:42:08,591][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 16:43:56,618][main.py][line:76][INFO] [Epoch:1/50]: loss1:0.3464 loss2:1.0336 main_loss:1.3805 | AUC:0.8305 AUC2:0.8310 FAR:0.00437
[2023-07-20 16:45:45,023][main.py][line:76][INFO] [Epoch:2/50]: loss1:0.1192 loss2:0.7991 main_loss:0.9187 | AUC:0.8377 AUC2:0.8309 FAR:0.00696
[2023-07-20 16:47:34,590][main.py][line:76][INFO] [Epoch:3/50]: loss1:0.0540 loss2:0.6838 main_loss:0.7382 | AUC:0.8418 AUC2:0.8386 FAR:0.00889
[2023-07-20 16:49:23,658][main.py][line:76][INFO] [Epoch:4/50]: loss1:0.0542 loss2:0.5902 main_loss:0.6448 | AUC:0.8385 AUC2:0.8386 FAR:0.00699
[2023-07-20 16:51:12,507][main.py][line:76][INFO] [Epoch:5/50]: loss1:0.0333 loss2:0.5055 main_loss:0.5391 | AUC:0.8380 AUC2:0.8386 FAR:0.00274
[2023-07-20 16:53:01,676][main.py][line:76][INFO] [Epoch:6/50]: loss1:0.0126 loss2:0.3935 main_loss:0.4064 | AUC:0.8497 AUC2:0.8458 FAR:0.00277
[2023-07-20 16:54:50,746][main.py][line:76][INFO] [Epoch:7/50]: loss1:0.0146 loss2:0.3005 main_loss:0.3154 | AUC:0.8493 AUC2:0.8458 FAR:0.00645
[2023-07-20 16:56:40,000][main.py][line:76][INFO] [Epoch:8/50]: loss1:0.0348 loss2:0.2895 main_loss:0.3247 | AUC:0.8444 AUC2:0.8458 FAR:0.00450
[2023-07-20 16:58:29,246][main.py][line:76][INFO] [Epoch:9/50]: loss1:0.0078 loss2:0.1830 main_loss:0.1911 | AUC:0.8411 AUC2:0.8458 FAR:0.00417
[2023-07-20 17:00:18,290][main.py][line:76][INFO] [Epoch:10/50]: loss1:0.0073 loss2:0.1310 main_loss:0.1386 | AUC:0.8383 AUC2:0.8458 FAR:0.00099
[2023-07-20 17:02:07,200][main.py][line:76][INFO] [Epoch:11/50]: loss1:0.0522 loss2:0.1893 main_loss:0.2417 | AUC:0.8471 AUC2:0.8458 FAR:0.00694
[2023-07-20 17:03:56,512][main.py][line:76][INFO] [Epoch:12/50]: loss1:0.0099 loss2:0.1059 main_loss:0.1161 | AUC:0.8431 AUC2:0.8458 FAR:0.00696
[2023-07-20 17:05:48,810][main.py][line:76][INFO] [Epoch:13/50]: loss1:0.0045 loss2:0.0603 main_loss:0.0650 | AUC:0.8446 AUC2:0.8458 FAR:0.00761
[2023-07-20 17:06:18,298][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.99, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 17:06:18,554][main.py][line:116][INFO] total params:52.3915M
[2023-07-20 17:06:18,554][main.py][line:119][INFO] Training Mode
[2023-07-20 17:06:18,555][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 17:06:18,555][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 17:06:39,261][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 17:09:05,867][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3649 loss2:1.0963 main_loss:1.4672 | AUC:0.8341 AUC2:0.8342 FAR:0.00734
[2023-07-20 17:11:45,277][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1498 loss2:0.8753 main_loss:1.0284 | AUC:0.8554 AUC2:0.8502 FAR:0.00462
[2023-07-20 17:14:20,246][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0607 loss2:0.7820 main_loss:0.8452 | AUC:0.8569 AUC2:0.8538 FAR:0.00442
[2023-07-20 17:16:38,267][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0353 loss2:0.7062 main_loss:0.7438 | AUC:0.8552 AUC2:0.8538 FAR:0.00474
[2023-07-20 17:19:15,825][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0349 loss2:0.6479 main_loss:0.6852 | AUC:0.8543 AUC2:0.8538 FAR:0.00810
[2023-07-20 17:21:53,406][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0298 loss2:0.6011 main_loss:0.6346 | AUC:0.8607 AUC2:0.8550 FAR:0.00462
[2023-07-20 17:24:29,926][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0121 loss2:0.5310 main_loss:0.5455 | AUC:0.8617 AUC2:0.8551 FAR:0.00188
[2023-07-20 17:27:13,274][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0100 loss2:0.4704 main_loss:0.4827 | AUC:0.8584 AUC2:0.8551 FAR:0.00237
[2023-07-20 17:29:41,108][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0089 loss2:0.4148 main_loss:0.4257 | AUC:0.8611 AUC2:0.8551 FAR:0.00212
[2023-07-20 17:32:17,550][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0081 loss2:0.3618 main_loss:0.3717 | AUC:0.8593 AUC2:0.8551 FAR:0.00291
[2023-07-20 17:35:07,656][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.0081 loss2:0.3139 main_loss:0.3237 | AUC:0.8593 AUC2:0.8551 FAR:0.00291
[2023-07-20 17:37:50,610][main.py][line:76][INFO] [Epoch:12/100]: loss1:0.0367 loss2:0.3315 main_loss:0.3699 | AUC:0.8551 AUC2:0.8551 FAR:0.00188
[2023-07-20 17:40:34,733][main.py][line:76][INFO] [Epoch:13/100]: loss1:0.0232 loss2:0.2938 main_loss:0.3188 | AUC:0.8477 AUC2:0.8551 FAR:0.00284
[2023-07-20 17:43:05,823][main.py][line:76][INFO] [Epoch:14/100]: loss1:0.0198 loss2:0.2561 main_loss:0.2780 | AUC:0.8483 AUC2:0.8551 FAR:0.00289
[2023-07-20 17:45:49,426][main.py][line:76][INFO] [Epoch:15/100]: loss1:0.0057 loss2:0.1958 main_loss:0.2035 | AUC:0.8534 AUC2:0.8551 FAR:0.00366
[2023-07-20 17:48:33,661][main.py][line:76][INFO] [Epoch:16/100]: loss1:0.0043 loss2:0.1638 main_loss:0.1698 | AUC:0.8519 AUC2:0.8551 FAR:0.00356
[2023-07-20 17:51:11,166][main.py][line:76][INFO] [Epoch:17/100]: loss1:0.0037 loss2:0.1360 main_loss:0.1414 | AUC:0.8489 AUC2:0.8551 FAR:0.00380
[2023-07-20 17:54:02,204][main.py][line:76][INFO] [Epoch:18/100]: loss1:0.0031 loss2:0.1142 main_loss:0.1190 | AUC:0.8494 AUC2:0.8551 FAR:0.00279
[2023-07-20 17:56:42,336][main.py][line:76][INFO] [Epoch:19/100]: loss1:0.0031 loss2:0.0964 main_loss:0.1010 | AUC:0.8508 AUC2:0.8551 FAR:0.00338
[2023-07-20 17:59:30,503][main.py][line:76][INFO] [Epoch:20/100]: loss1:0.0028 loss2:0.0827 main_loss:0.0873 | AUC:0.8533 AUC2:0.8551 FAR:0.00346
[2023-07-20 18:02:07,393][main.py][line:76][INFO] [Epoch:21/100]: loss1:0.0024 loss2:0.0703 main_loss:0.0742 | AUC:0.8502 AUC2:0.8551 FAR:0.00274
[2023-07-20 18:04:44,109][main.py][line:76][INFO] [Epoch:22/100]: loss1:0.0021 loss2:0.0592 main_loss:0.0626 | AUC:0.8488 AUC2:0.8551 FAR:0.00200
[2023-07-20 18:07:24,281][main.py][line:76][INFO] [Epoch:23/100]: loss1:0.0020 loss2:0.0525 main_loss:0.0557 | AUC:0.8504 AUC2:0.8551 FAR:0.00188
[2023-07-20 18:10:02,110][main.py][line:76][INFO] [Epoch:24/100]: loss1:0.0021 loss2:0.0444 main_loss:0.0477 | AUC:0.8485 AUC2:0.8551 FAR:0.00254
[2023-07-20 18:12:56,340][main.py][line:76][INFO] [Epoch:25/100]: loss1:0.0022 loss2:0.0408 main_loss:0.0443 | AUC:0.8542 AUC2:0.8551 FAR:0.00274
[2023-07-20 18:15:35,227][main.py][line:76][INFO] [Epoch:26/100]: loss1:0.0349 loss2:0.0996 main_loss:0.1356 | AUC:0.8534 AUC2:0.8551 FAR:0.00642
[2023-07-20 18:18:19,348][main.py][line:76][INFO] [Epoch:27/100]: loss1:0.0099 loss2:0.0632 main_loss:0.0742 | AUC:0.8464 AUC2:0.8551 FAR:0.00452
[2023-07-20 18:21:16,773][main.py][line:76][INFO] [Epoch:28/100]: loss1:0.0027 loss2:0.0399 main_loss:0.0436 | AUC:0.8487 AUC2:0.8551 FAR:0.00245
[2023-07-20 18:24:55,811][main.py][line:76][INFO] [Epoch:29/100]: loss1:0.0019 loss2:0.0313 main_loss:0.0344 | AUC:0.8465 AUC2:0.8551 FAR:0.00272
[2023-07-20 18:27:55,106][main.py][line:76][INFO] [Epoch:30/100]: loss1:0.0013 loss2:0.0267 main_loss:0.0290 | AUC:0.8490 AUC2:0.8551 FAR:0.00338
[2023-07-20 18:31:54,549][main.py][line:76][INFO] [Epoch:31/100]: loss1:0.0012 loss2:0.0234 main_loss:0.0254 | AUC:0.8447 AUC2:0.8551 FAR:0.00259
[2023-07-20 18:36:50,389][main.py][line:76][INFO] [Epoch:32/100]: loss1:0.0011 loss2:0.0208 main_loss:0.0228 | AUC:0.8465 AUC2:0.8551 FAR:0.00356
[2023-07-20 18:41:14,375][main.py][line:76][INFO] [Epoch:33/100]: loss1:0.0010 loss2:0.0186 main_loss:0.0205 | AUC:0.8512 AUC2:0.8551 FAR:0.00316
[2023-07-20 18:44:55,821][main.py][line:76][INFO] [Epoch:34/100]: loss1:0.0009 loss2:0.0172 main_loss:0.0190 | AUC:0.8489 AUC2:0.8551 FAR:0.00311
[2023-07-20 18:48:40,872][main.py][line:76][INFO] [Epoch:35/100]: loss1:0.0012 loss2:0.0173 main_loss:0.0193 | AUC:0.8479 AUC2:0.8551 FAR:0.00306
[2023-07-20 18:52:22,886][main.py][line:76][INFO] [Epoch:36/100]: loss1:0.0008 loss2:0.0154 main_loss:0.0170 | AUC:0.8493 AUC2:0.8551 FAR:0.00286
[2023-07-20 18:55:23,009][main.py][line:76][INFO] [Epoch:37/100]: loss1:0.0007 loss2:0.0140 main_loss:0.0154 | AUC:0.8516 AUC2:0.8551 FAR:0.00301
[2023-07-20 18:58:39,517][main.py][line:76][INFO] [Epoch:38/100]: loss1:0.0007 loss2:0.0136 main_loss:0.0150 | AUC:0.8509 AUC2:0.8551 FAR:0.00309
[2023-07-20 19:01:26,155][main.py][line:76][INFO] [Epoch:39/100]: loss1:0.0006 loss2:0.0125 main_loss:0.0138 | AUC:0.8478 AUC2:0.8551 FAR:0.00309
[2023-07-20 19:04:49,289][main.py][line:76][INFO] [Epoch:40/100]: loss1:0.0006 loss2:0.0113 main_loss:0.0126 | AUC:0.8469 AUC2:0.8551 FAR:0.00316
[2023-07-20 19:07:22,159][main.py][line:76][INFO] [Epoch:41/100]: loss1:0.0005 loss2:0.0108 main_loss:0.0120 | AUC:0.8491 AUC2:0.8551 FAR:0.00326
[2023-07-20 19:10:03,555][main.py][line:76][INFO] [Epoch:42/100]: loss1:0.0006 loss2:0.0107 main_loss:0.0119 | AUC:0.8498 AUC2:0.8551 FAR:0.00309
[2023-07-20 19:12:55,334][main.py][line:76][INFO] [Epoch:43/100]: loss1:0.0006 loss2:0.0103 main_loss:0.0115 | AUC:0.8515 AUC2:0.8551 FAR:0.00316
[2023-07-20 19:15:51,626][main.py][line:76][INFO] [Epoch:44/100]: loss1:0.0006 loss2:0.0099 main_loss:0.0112 | AUC:0.8507 AUC2:0.8551 FAR:0.00319
[2023-07-20 19:18:37,868][main.py][line:76][INFO] [Epoch:45/100]: loss1:0.0005 loss2:0.0095 main_loss:0.0106 | AUC:0.8517 AUC2:0.8551 FAR:0.00336
[2023-07-20 19:21:50,191][main.py][line:76][INFO] [Epoch:46/100]: loss1:0.0005 loss2:0.0091 main_loss:0.0102 | AUC:0.8521 AUC2:0.8551 FAR:0.00301
[2023-07-20 19:24:37,311][main.py][line:76][INFO] [Epoch:47/100]: loss1:0.0005 loss2:0.0088 main_loss:0.0098 | AUC:0.8520 AUC2:0.8551 FAR:0.00331
[2023-07-20 19:27:15,838][main.py][line:76][INFO] [Epoch:48/100]: loss1:0.0004 loss2:0.0082 main_loss:0.0091 | AUC:0.8518 AUC2:0.8551 FAR:0.00336
[2023-07-20 19:29:56,164][main.py][line:76][INFO] [Epoch:49/100]: loss1:0.0004 loss2:0.0081 main_loss:0.0091 | AUC:0.8518 AUC2:0.8551 FAR:0.00309
[2023-07-20 19:32:23,511][main.py][line:76][INFO] [Epoch:50/100]: loss1:0.0004 loss2:0.0079 main_loss:0.0088 | AUC:0.8519 AUC2:0.8551 FAR:0.00333
[2023-07-20 19:35:26,695][main.py][line:76][INFO] [Epoch:51/100]: loss1:0.0004 loss2:0.0079 main_loss:0.0088 | AUC:0.8523 AUC2:0.8551 FAR:0.00328
[2023-07-20 19:38:21,227][main.py][line:76][INFO] [Epoch:52/100]: loss1:0.0004 loss2:0.0077 main_loss:0.0085 | AUC:0.8531 AUC2:0.8551 FAR:0.00333
[2023-07-20 19:41:12,854][main.py][line:76][INFO] [Epoch:53/100]: loss1:0.0004 loss2:0.0077 main_loss:0.0086 | AUC:0.8528 AUC2:0.8551 FAR:0.00405
[2023-07-20 19:43:57,688][main.py][line:76][INFO] [Epoch:54/100]: loss1:0.0005 loss2:0.0077 main_loss:0.0086 | AUC:0.8527 AUC2:0.8551 FAR:0.00351
[2023-07-20 19:46:36,972][main.py][line:76][INFO] [Epoch:55/100]: loss1:0.0004 loss2:0.0076 main_loss:0.0085 | AUC:0.8529 AUC2:0.8551 FAR:0.00346
[2023-07-20 19:49:19,973][main.py][line:76][INFO] [Epoch:56/100]: loss1:0.0004 loss2:0.0073 main_loss:0.0082 | AUC:0.8528 AUC2:0.8551 FAR:0.00341
[2023-07-20 19:52:10,271][main.py][line:76][INFO] [Epoch:57/100]: loss1:0.0004 loss2:0.0073 main_loss:0.0081 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 19:54:46,514][main.py][line:76][INFO] [Epoch:58/100]: loss1:0.0004 loss2:0.0073 main_loss:0.0082 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 19:57:47,752][main.py][line:76][INFO] [Epoch:59/100]: loss1:0.0004 loss2:0.0075 main_loss:0.0083 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:00:53,481][main.py][line:76][INFO] [Epoch:60/100]: loss1:0.0004 loss2:0.0071 main_loss:0.0079 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:03:33,926][main.py][line:76][INFO] [Epoch:61/100]: loss1:0.0004 loss2:0.0071 main_loss:0.0080 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:06:18,833][main.py][line:76][INFO] [Epoch:62/100]: loss1:0.0004 loss2:0.0072 main_loss:0.0081 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:09:32,790][main.py][line:76][INFO] [Epoch:63/100]: loss1:0.0004 loss2:0.0071 main_loss:0.0079 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:12:48,226][main.py][line:76][INFO] [Epoch:64/100]: loss1:0.0004 loss2:0.0074 main_loss:0.0082 | AUC:0.8526 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:15:37,814][main.py][line:76][INFO] [Epoch:65/100]: loss1:0.0004 loss2:0.0074 main_loss:0.0083 | AUC:0.8526 AUC2:0.8551 FAR:0.00343
[2023-07-20 20:18:40,647][main.py][line:76][INFO] [Epoch:66/100]: loss1:0.0004 loss2:0.0073 main_loss:0.0082 | AUC:0.8525 AUC2:0.8551 FAR:0.00341
[2023-07-20 20:21:31,348][main.py][line:76][INFO] [Epoch:67/100]: loss1:0.0004 loss2:0.0074 main_loss:0.0082 | AUC:0.8522 AUC2:0.8551 FAR:0.00343
[2023-07-20 20:24:21,129][main.py][line:76][INFO] [Epoch:68/100]: loss1:0.0004 loss2:0.0070 main_loss:0.0078 | AUC:0.8517 AUC2:0.8551 FAR:0.00326
[2023-07-20 20:27:10,900][main.py][line:76][INFO] [Epoch:69/100]: loss1:0.0004 loss2:0.0072 main_loss:0.0080 | AUC:0.8523 AUC2:0.8551 FAR:0.00289
[2023-07-20 20:29:48,028][main.py][line:76][INFO] [Epoch:70/100]: loss1:0.0003 loss2:0.0068 main_loss:0.0076 | AUC:0.8516 AUC2:0.8551 FAR:0.00304
[2023-07-20 20:32:43,160][main.py][line:76][INFO] [Epoch:71/100]: loss1:0.0003 loss2:0.0067 main_loss:0.0075 | AUC:0.8527 AUC2:0.8551 FAR:0.00304
[2023-07-20 20:35:17,050][main.py][line:76][INFO] [Epoch:72/100]: loss1:0.0004 loss2:0.0067 main_loss:0.0075 | AUC:0.8525 AUC2:0.8551 FAR:0.00311
[2023-07-20 20:37:50,544][main.py][line:76][INFO] [Epoch:73/100]: loss1:0.0003 loss2:0.0064 main_loss:0.0071 | AUC:0.8520 AUC2:0.8551 FAR:0.00299
[2023-07-20 20:41:04,186][main.py][line:76][INFO] [Epoch:74/100]: loss1:0.0005 loss2:0.0063 main_loss:0.0073 | AUC:0.8523 AUC2:0.8551 FAR:0.00314
[2023-07-20 20:43:56,091][main.py][line:76][INFO] [Epoch:75/100]: loss1:0.0008 loss2:0.0068 main_loss:0.0080 | AUC:0.8484 AUC2:0.8551 FAR:0.00267
[2023-07-20 20:46:31,093][main.py][line:76][INFO] [Epoch:76/100]: loss1:0.0004 loss2:0.0061 main_loss:0.0069 | AUC:0.8492 AUC2:0.8551 FAR:0.00324
[2023-07-20 20:48:44,358][main.py][line:76][INFO] [Epoch:77/100]: loss1:0.0004 loss2:0.0058 main_loss:0.0066 | AUC:0.8467 AUC2:0.8551 FAR:0.00331
[2023-07-20 20:50:52,796][main.py][line:76][INFO] [Epoch:78/100]: loss1:0.0004 loss2:0.0052 main_loss:0.0060 | AUC:0.8504 AUC2:0.8551 FAR:0.00301
[2023-07-20 20:52:53,617][main.py][line:76][INFO] [Epoch:79/100]: loss1:0.0003 loss2:0.0049 main_loss:0.0057 | AUC:0.8492 AUC2:0.8551 FAR:0.00336
[2023-07-20 20:54:56,371][main.py][line:76][INFO] [Epoch:80/100]: loss1:0.0090 loss2:0.0216 main_loss:0.0311 | AUC:0.8475 AUC2:0.8551 FAR:0.00721
[2023-07-20 20:56:58,570][main.py][line:76][INFO] [Epoch:81/100]: loss1:0.0029 loss2:0.0122 main_loss:0.0156 | AUC:0.8545 AUC2:0.8551 FAR:0.00425
[2023-07-20 20:58:54,898][main.py][line:76][INFO] [Epoch:82/100]: loss1:0.0008 loss2:0.0061 main_loss:0.0075 | AUC:0.8544 AUC2:0.8551 FAR:0.00358
[2023-07-20 21:00:53,567][main.py][line:76][INFO] [Epoch:83/100]: loss1:0.0006 loss2:0.0051 main_loss:0.0062 | AUC:0.8555 AUC2:0.8551 FAR:0.00440
[2023-07-20 21:02:48,499][main.py][line:76][INFO] [Epoch:84/100]: loss1:0.0005 loss2:0.0044 main_loss:0.0054 | AUC:0.8529 AUC2:0.8551 FAR:0.00454
[2023-07-20 21:04:42,293][main.py][line:76][INFO] [Epoch:85/100]: loss1:0.0003 loss2:0.0041 main_loss:0.0049 | AUC:0.8521 AUC2:0.8551 FAR:0.00430
[2023-07-20 21:06:39,617][main.py][line:76][INFO] [Epoch:86/100]: loss1:0.0003 loss2:0.0035 main_loss:0.0044 | AUC:0.8530 AUC2:0.8551 FAR:0.00417
[2023-07-20 21:08:38,586][main.py][line:76][INFO] [Epoch:87/100]: loss1:0.0003 loss2:0.0033 main_loss:0.0040 | AUC:0.8525 AUC2:0.8551 FAR:0.00442
[2023-07-20 21:10:35,088][main.py][line:76][INFO] [Epoch:88/100]: loss1:0.0004 loss2:0.0035 main_loss:0.0045 | AUC:0.8542 AUC2:0.8551 FAR:0.00427
[2023-07-20 21:12:33,349][main.py][line:76][INFO] [Epoch:89/100]: loss1:0.0203 loss2:0.0314 main_loss:0.0522 | AUC:0.8474 AUC2:0.8551 FAR:0.00412
[2023-07-20 21:14:31,431][main.py][line:76][INFO] [Epoch:90/100]: loss1:0.0191 loss2:0.0362 main_loss:0.0557 | AUC:0.8527 AUC2:0.8551 FAR:0.00701
[2023-07-20 21:16:32,742][main.py][line:76][INFO] [Epoch:91/100]: loss1:0.0024 loss2:0.0104 main_loss:0.0132 | AUC:0.8512 AUC2:0.8551 FAR:0.00398
[2023-07-20 21:18:28,483][main.py][line:76][INFO] [Epoch:92/100]: loss1:0.0012 loss2:0.0060 main_loss:0.0077 | AUC:0.8531 AUC2:0.8551 FAR:0.00437
[2023-07-20 21:20:26,376][main.py][line:76][INFO] [Epoch:93/100]: loss1:0.0009 loss2:0.0051 main_loss:0.0065 | AUC:0.8551 AUC2:0.8551 FAR:0.00506
[2023-07-20 21:22:24,233][main.py][line:76][INFO] [Epoch:94/100]: loss1:0.0005 loss2:0.0036 main_loss:0.0047 | AUC:0.8567 AUC2:0.8551 FAR:0.00467
[2023-07-20 21:24:20,683][main.py][line:76][INFO] [Epoch:95/100]: loss1:0.0046 loss2:0.0086 main_loss:0.0137 | AUC:0.8515 AUC2:0.8551 FAR:0.00632
[2023-07-20 21:26:19,133][main.py][line:76][INFO] [Epoch:96/100]: loss1:0.0013 loss2:0.0052 main_loss:0.0072 | AUC:0.8493 AUC2:0.8551 FAR:0.00314
[2023-07-20 21:28:18,574][main.py][line:76][INFO] [Epoch:97/100]: loss1:0.0007 loss2:0.0033 main_loss:0.0047 | AUC:0.8480 AUC2:0.8551 FAR:0.00328
[2023-07-20 21:30:14,438][main.py][line:76][INFO] [Epoch:98/100]: loss1:0.0005 loss2:0.0027 main_loss:0.0044 | AUC:0.8496 AUC2:0.8551 FAR:0.00348
[2023-07-20 21:32:12,494][main.py][line:76][INFO] [Epoch:99/100]: loss1:0.0003 loss2:0.0021 main_loss:0.0034 | AUC:0.8543 AUC2:0.8551 FAR:0.00336
[2023-07-20 21:34:04,753][main.py][line:76][INFO] [Epoch:100/100]: loss1:0.0004 loss2:0.0023 main_loss:0.0035 | AUC:0.8524 AUC2:0.8551 FAR:0.00301
[2023-07-20 21:34:04,889][main.py][line:82][INFO] Training completes in 267m 25s | best AUC:0.8617 FAR:0.00188

[2023-07-20 22:10:06,816][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.99, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-20 22:10:07,012][main.py][line:116][INFO] total params:27.1990M
[2023-07-20 22:10:07,012][main.py][line:119][INFO] Training Mode
[2023-07-20 22:10:07,013][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-20 22:10:07,013][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-20 22:10:26,209][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-20 22:11:50,594][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3729 loss2:1.0986 main_loss:1.4758 | AUC:0.8320 AUC2:0.8271 FAR:0.00583
[2023-07-20 22:13:15,472][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1468 loss2:0.8741 main_loss:1.0236 | AUC:0.8540 AUC2:0.8501 FAR:0.00603
[2023-07-20 22:14:42,280][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0684 loss2:0.7777 main_loss:0.8482 | AUC:0.8495 AUC2:0.8501 FAR:0.00832
[2023-07-20 22:16:07,524][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0314 loss2:0.7010 main_loss:0.7343 | AUC:0.8516 AUC2:0.8501 FAR:0.00326
[2023-07-20 22:17:32,113][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0191 loss2:0.6276 main_loss:0.6486 | AUC:0.8504 AUC2:0.8501 FAR:0.00168
[2023-07-20 22:18:57,708][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0402 loss2:0.5925 main_loss:0.6343 | AUC:0.8497 AUC2:0.8501 FAR:0.00440
[2023-07-20 22:20:22,477][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0187 loss2:0.5309 main_loss:0.5512 | AUC:0.8549 AUC2:0.8439 FAR:0.00232
[2023-07-20 22:21:48,210][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0105 loss2:0.4652 main_loss:0.4770 | AUC:0.8560 AUC2:0.8526 FAR:0.00368
[2023-07-20 22:23:13,149][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0180 loss2:0.4175 main_loss:0.4367 | AUC:0.8512 AUC2:0.8526 FAR:0.00701
[2023-07-20 22:24:37,597][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0336 loss2:0.4118 main_loss:0.4466 | AUC:0.8440 AUC2:0.8526 FAR:0.00645
[2023-07-20 22:26:03,201][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.0138 loss2:0.3477 main_loss:0.3626 | AUC:0.8507 AUC2:0.8526 FAR:0.00343
[2023-07-20 22:27:29,468][main.py][line:76][INFO] [Epoch:12/100]: loss1:0.0075 loss2:0.2939 main_loss:0.3025 | AUC:0.8514 AUC2:0.8526 FAR:0.00573
[2023-07-20 22:28:54,938][main.py][line:76][INFO] [Epoch:13/100]: loss1:0.0078 loss2:0.2532 main_loss:0.2621 | AUC:0.8538 AUC2:0.8526 FAR:0.00430
[2023-07-20 22:30:20,972][main.py][line:76][INFO] [Epoch:14/100]: loss1:0.0058 loss2:0.2097 main_loss:0.2174 | AUC:0.8455 AUC2:0.8526 FAR:0.01151
[2023-07-20 22:31:47,246][main.py][line:76][INFO] [Epoch:15/100]: loss1:0.0078 loss2:0.1895 main_loss:0.1994 | AUC:0.8484 AUC2:0.8526 FAR:0.00309
[2023-07-20 22:33:12,356][main.py][line:76][INFO] [Epoch:16/100]: loss1:0.0040 loss2:0.1521 main_loss:0.1578 | AUC:0.8548 AUC2:0.8526 FAR:0.00388
[2023-07-20 22:34:37,211][main.py][line:76][INFO] [Epoch:17/100]: loss1:0.0033 loss2:0.1268 main_loss:0.1319 | AUC:0.8517 AUC2:0.8526 FAR:0.00467
[2023-07-20 22:36:02,719][main.py][line:76][INFO] [Epoch:18/100]: loss1:0.0032 loss2:0.1065 main_loss:0.1119 | AUC:0.8516 AUC2:0.8526 FAR:0.00351
[2023-07-20 22:37:27,711][main.py][line:76][INFO] [Epoch:19/100]: loss1:0.0027 loss2:0.0887 main_loss:0.0931 | AUC:0.8491 AUC2:0.8526 FAR:0.00279
[2023-07-20 22:38:53,564][main.py][line:76][INFO] [Epoch:20/100]: loss1:0.0025 loss2:0.0751 main_loss:0.0792 | AUC:0.8510 AUC2:0.8526 FAR:0.00249
[2023-07-20 22:40:18,063][main.py][line:76][INFO] [Epoch:21/100]: loss1:0.0022 loss2:0.0629 main_loss:0.0664 | AUC:0.8493 AUC2:0.8526 FAR:0.00477
[2023-07-20 22:41:42,837][main.py][line:76][INFO] [Epoch:22/100]: loss1:0.0020 loss2:0.0540 main_loss:0.0572 | AUC:0.8466 AUC2:0.8526 FAR:0.00230
[2023-07-20 22:43:08,164][main.py][line:76][INFO] [Epoch:23/100]: loss1:0.0229 loss2:0.0840 main_loss:0.1081 | AUC:0.8453 AUC2:0.8526 FAR:0.00664
[2023-07-20 22:44:32,913][main.py][line:76][INFO] [Epoch:24/100]: loss1:0.0318 loss2:0.1159 main_loss:0.1490 | AUC:0.8461 AUC2:0.8526 FAR:0.00420
[2023-07-20 22:45:58,918][main.py][line:76][INFO] [Epoch:25/100]: loss1:0.0115 loss2:0.0764 main_loss:0.0891 | AUC:0.8450 AUC2:0.8526 FAR:0.00820
[2023-07-20 22:47:25,792][main.py][line:76][INFO] [Epoch:26/100]: loss1:0.0032 loss2:0.0489 main_loss:0.0531 | AUC:0.8506 AUC2:0.8526 FAR:0.00437
[2023-07-20 22:48:51,865][main.py][line:76][INFO] [Epoch:27/100]: loss1:0.0020 loss2:0.0387 main_loss:0.0417 | AUC:0.8470 AUC2:0.8526 FAR:0.00445
[2023-07-20 22:50:17,637][main.py][line:76][INFO] [Epoch:28/100]: loss1:0.0016 loss2:0.0321 main_loss:0.0348 | AUC:0.8488 AUC2:0.8526 FAR:0.00459
[2023-07-20 22:51:43,156][main.py][line:76][INFO] [Epoch:29/100]: loss1:0.0015 loss2:0.0288 main_loss:0.0314 | AUC:0.8514 AUC2:0.8526 FAR:0.00427
[2023-07-20 22:53:11,052][main.py][line:76][INFO] [Epoch:30/100]: loss1:0.0013 loss2:0.0248 main_loss:0.0270 | AUC:0.8510 AUC2:0.8526 FAR:0.00311
[2023-07-20 22:54:38,279][main.py][line:76][INFO] [Epoch:31/100]: loss1:0.0012 loss2:0.0227 main_loss:0.0249 | AUC:0.8517 AUC2:0.8526 FAR:0.00370
[2023-07-20 22:56:05,408][main.py][line:76][INFO] [Epoch:32/100]: loss1:0.0009 loss2:0.0198 main_loss:0.0216 | AUC:0.8531 AUC2:0.8526 FAR:0.00410
[2023-07-20 22:57:31,188][main.py][line:76][INFO] [Epoch:33/100]: loss1:0.0009 loss2:0.0185 main_loss:0.0203 | AUC:0.8527 AUC2:0.8526 FAR:0.00403
[2023-07-20 22:58:56,635][main.py][line:76][INFO] [Epoch:34/100]: loss1:0.0008 loss2:0.0169 main_loss:0.0186 | AUC:0.8564 AUC2:0.8459 FAR:0.00432
[2023-07-20 23:00:24,219][main.py][line:76][INFO] [Epoch:35/100]: loss1:0.0007 loss2:0.0146 main_loss:0.0162 | AUC:0.8497 AUC2:0.8459 FAR:0.00353
[2023-07-20 23:01:51,598][main.py][line:76][INFO] [Epoch:36/100]: loss1:0.0008 loss2:0.0140 main_loss:0.0157 | AUC:0.8517 AUC2:0.8459 FAR:0.00390
[2023-07-20 23:03:17,900][main.py][line:76][INFO] [Epoch:37/100]: loss1:0.0008 loss2:0.0131 main_loss:0.0148 | AUC:0.8540 AUC2:0.8459 FAR:0.00437
[2023-07-20 23:04:44,058][main.py][line:76][INFO] [Epoch:38/100]: loss1:0.0006 loss2:0.0119 main_loss:0.0133 | AUC:0.8527 AUC2:0.8459 FAR:0.00361
[2023-07-20 23:06:08,698][main.py][line:76][INFO] [Epoch:39/100]: loss1:0.0006 loss2:0.0117 main_loss:0.0130 | AUC:0.8512 AUC2:0.8459 FAR:0.00309
[2023-07-20 23:07:34,120][main.py][line:76][INFO] [Epoch:40/100]: loss1:0.0006 loss2:0.0108 main_loss:0.0122 | AUC:0.8566 AUC2:0.8468 FAR:0.00410
[2023-07-20 23:09:00,163][main.py][line:76][INFO] [Epoch:41/100]: loss1:0.0006 loss2:0.0104 main_loss:0.0117 | AUC:0.8555 AUC2:0.8468 FAR:0.00363
[2023-07-20 23:10:25,603][main.py][line:76][INFO] [Epoch:42/100]: loss1:0.0005 loss2:0.0096 main_loss:0.0108 | AUC:0.8551 AUC2:0.8468 FAR:0.00361
[2023-07-20 23:11:51,787][main.py][line:76][INFO] [Epoch:43/100]: loss1:0.0005 loss2:0.0092 main_loss:0.0104 | AUC:0.8557 AUC2:0.8468 FAR:0.00328
[2023-07-20 23:13:17,603][main.py][line:76][INFO] [Epoch:44/100]: loss1:0.0005 loss2:0.0091 main_loss:0.0103 | AUC:0.8555 AUC2:0.8468 FAR:0.00321
[2023-07-20 23:14:42,929][main.py][line:76][INFO] [Epoch:45/100]: loss1:0.0008 loss2:0.0092 main_loss:0.0106 | AUC:0.8559 AUC2:0.8468 FAR:0.00321
[2023-07-20 23:16:10,078][main.py][line:76][INFO] [Epoch:46/100]: loss1:0.0005 loss2:0.0083 main_loss:0.0093 | AUC:0.8564 AUC2:0.8468 FAR:0.00321
[2023-07-20 23:17:37,640][main.py][line:76][INFO] [Epoch:47/100]: loss1:0.0005 loss2:0.0080 main_loss:0.0090 | AUC:0.8555 AUC2:0.8468 FAR:0.00319
[2023-07-20 23:19:03,550][main.py][line:76][INFO] [Epoch:48/100]: loss1:0.0004 loss2:0.0079 main_loss:0.0089 | AUC:0.8560 AUC2:0.8468 FAR:0.00294
[2023-07-20 23:20:29,251][main.py][line:76][INFO] [Epoch:49/100]: loss1:0.0004 loss2:0.0073 main_loss:0.0082 | AUC:0.8530 AUC2:0.8468 FAR:0.00299
[2023-07-20 23:21:55,458][main.py][line:76][INFO] [Epoch:50/100]: loss1:0.0004 loss2:0.0075 main_loss:0.0085 | AUC:0.8541 AUC2:0.8468 FAR:0.00316
[2023-07-20 23:23:21,101][main.py][line:76][INFO] [Epoch:51/100]: loss1:0.0004 loss2:0.0070 main_loss:0.0078 | AUC:0.8542 AUC2:0.8468 FAR:0.00319
[2023-07-20 23:24:47,887][main.py][line:76][INFO] [Epoch:52/100]: loss1:0.0004 loss2:0.0072 main_loss:0.0081 | AUC:0.8544 AUC2:0.8468 FAR:0.00319
[2023-07-20 23:26:14,324][main.py][line:76][INFO] [Epoch:53/100]: loss1:0.0004 loss2:0.0072 main_loss:0.0080 | AUC:0.8538 AUC2:0.8468 FAR:0.00284
[2023-07-20 23:27:40,211][main.py][line:76][INFO] [Epoch:54/100]: loss1:0.0004 loss2:0.0065 main_loss:0.0073 | AUC:0.8546 AUC2:0.8468 FAR:0.00301
[2023-07-20 23:29:06,769][main.py][line:76][INFO] [Epoch:55/100]: loss1:0.0003 loss2:0.0065 main_loss:0.0074 | AUC:0.8547 AUC2:0.8468 FAR:0.00309
[2023-07-20 23:30:34,617][main.py][line:76][INFO] [Epoch:56/100]: loss1:0.0003 loss2:0.0063 main_loss:0.0072 | AUC:0.8548 AUC2:0.8468 FAR:0.00309
[2023-07-20 23:32:02,763][main.py][line:76][INFO] [Epoch:57/100]: loss1:0.0003 loss2:0.0065 main_loss:0.0073 | AUC:0.8545 AUC2:0.8468 FAR:0.00286
[2023-07-20 23:33:29,492][main.py][line:76][INFO] [Epoch:58/100]: loss1:0.0004 loss2:0.0065 main_loss:0.0073 | AUC:0.8545 AUC2:0.8468 FAR:0.00286
[2023-07-20 23:34:55,572][main.py][line:76][INFO] [Epoch:59/100]: loss1:0.0004 loss2:0.0069 main_loss:0.0078 | AUC:0.8544 AUC2:0.8468 FAR:0.00286
[2023-07-20 23:36:22,011][main.py][line:76][INFO] [Epoch:60/100]: loss1:0.0004 loss2:0.0064 main_loss:0.0073 | AUC:0.8544 AUC2:0.8468 FAR:0.00286
[2023-07-20 23:37:47,670][main.py][line:76][INFO] [Epoch:61/100]: loss1:0.0004 loss2:0.0067 main_loss:0.0075 | AUC:0.8544 AUC2:0.8468 FAR:0.00286
[2023-07-20 23:39:14,467][main.py][line:76][INFO] [Epoch:62/100]: loss1:0.0004 loss2:0.0066 main_loss:0.0074 | AUC:0.8544 AUC2:0.8468 FAR:0.00286
[2023-07-20 23:40:40,550][main.py][line:76][INFO] [Epoch:63/100]: loss1:0.0004 loss2:0.0064 main_loss:0.0073 | AUC:0.8544 AUC2:0.8468 FAR:0.00296
[2023-07-20 23:42:07,975][main.py][line:76][INFO] [Epoch:64/100]: loss1:0.0003 loss2:0.0065 main_loss:0.0073 | AUC:0.8543 AUC2:0.8468 FAR:0.00301
[2023-07-20 23:43:34,789][main.py][line:76][INFO] [Epoch:65/100]: loss1:0.0004 loss2:0.0066 main_loss:0.0074 | AUC:0.8543 AUC2:0.8468 FAR:0.00309
[2023-07-20 23:45:00,932][main.py][line:76][INFO] [Epoch:66/100]: loss1:0.0003 loss2:0.0063 main_loss:0.0071 | AUC:0.8542 AUC2:0.8468 FAR:0.00304
[2023-07-20 23:46:27,519][main.py][line:76][INFO] [Epoch:67/100]: loss1:0.0003 loss2:0.0064 main_loss:0.0072 | AUC:0.8538 AUC2:0.8468 FAR:0.00304
[2023-07-20 23:47:54,072][main.py][line:76][INFO] [Epoch:68/100]: loss1:0.0004 loss2:0.0066 main_loss:0.0074 | AUC:0.8540 AUC2:0.8468 FAR:0.00314
[2023-07-20 23:49:18,404][main.py][line:76][INFO] [Epoch:69/100]: loss1:0.0004 loss2:0.0068 main_loss:0.0076 | AUC:0.8545 AUC2:0.8468 FAR:0.00314
[2023-07-20 23:50:44,485][main.py][line:76][INFO] [Epoch:70/100]: loss1:0.0004 loss2:0.0064 main_loss:0.0073 | AUC:0.8555 AUC2:0.8468 FAR:0.00306
[2023-07-20 23:52:11,276][main.py][line:76][INFO] [Epoch:71/100]: loss1:0.0003 loss2:0.0060 main_loss:0.0067 | AUC:0.8567 AUC2:0.8475 FAR:0.00309
[2023-07-20 23:53:38,196][main.py][line:76][INFO] [Epoch:72/100]: loss1:0.0003 loss2:0.0058 main_loss:0.0066 | AUC:0.8564 AUC2:0.8475 FAR:0.00311
[2023-07-20 23:55:04,959][main.py][line:76][INFO] [Epoch:73/100]: loss1:0.0004 loss2:0.0064 main_loss:0.0072 | AUC:0.8524 AUC2:0.8475 FAR:0.00269
[2023-07-20 23:56:30,494][main.py][line:76][INFO] [Epoch:74/100]: loss1:0.0004 loss2:0.0061 main_loss:0.0070 | AUC:0.8538 AUC2:0.8475 FAR:0.00284
[2023-07-20 23:57:57,094][main.py][line:76][INFO] [Epoch:75/100]: loss1:0.0003 loss2:0.0056 main_loss:0.0064 | AUC:0.8548 AUC2:0.8475 FAR:0.00282
[2023-07-20 23:59:24,338][main.py][line:76][INFO] [Epoch:76/100]: loss1:0.0004 loss2:0.0058 main_loss:0.0066 | AUC:0.8520 AUC2:0.8475 FAR:0.00222
[2023-07-21 00:00:51,908][main.py][line:76][INFO] [Epoch:77/100]: loss1:0.0003 loss2:0.0050 main_loss:0.0058 | AUC:0.8558 AUC2:0.8475 FAR:0.00336
[2023-07-21 00:02:18,468][main.py][line:76][INFO] [Epoch:78/100]: loss1:0.0003 loss2:0.0046 main_loss:0.0053 | AUC:0.8578 AUC2:0.8462 FAR:0.00390
[2023-07-21 00:03:45,478][main.py][line:76][INFO] [Epoch:79/100]: loss1:0.0003 loss2:0.0046 main_loss:0.0055 | AUC:0.8536 AUC2:0.8462 FAR:0.00279
[2023-07-21 00:05:12,306][main.py][line:76][INFO] [Epoch:80/100]: loss1:0.0002 loss2:0.0037 main_loss:0.0044 | AUC:0.8566 AUC2:0.8462 FAR:0.00257
[2023-07-21 00:07:19,291][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.9, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.01, 'dropout': 0.7, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 00:07:19,480][main.py][line:116][INFO] total params:27.1990M
[2023-07-21 00:07:19,480][main.py][line:119][INFO] Training Mode
[2023-07-21 00:07:19,481][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.7, inplace=False)
    (dropout2): Dropout(p=0.7, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.7, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 00:07:19,481][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    weight_decay: 0
)

[2023-07-21 00:07:39,057][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 00:09:11,409][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.8998 loss2:1.3436 main_loss:2.3135 | AUC:0.7824 AUC2:0.7820 FAR:0.07370
[2023-07-21 00:10:43,575][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.6268 loss2:1.2556 main_loss:1.9515 | AUC:0.7244 AUC2:0.7820 FAR:0.28909
[2023-07-21 00:12:20,057][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.6203 loss2:1.2129 main_loss:1.9028 | AUC:0.7705 AUC2:0.7820 FAR:0.10269
[2023-07-21 00:13:58,633][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.5557 loss2:1.1780 main_loss:1.8033 | AUC:0.7720 AUC2:0.7820 FAR:0.11514
[2023-07-21 00:15:37,382][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.4971 loss2:1.1395 main_loss:1.7061 | AUC:0.7931 AUC2:0.7931 FAR:0.08785
[2023-07-21 00:17:14,649][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.5410 loss2:1.1643 main_loss:1.7747 | AUC:0.8166 AUC2:0.8166 FAR:0.02159
[2023-07-21 00:18:49,209][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.5975 loss2:1.1909 main_loss:1.8578 | AUC:0.8235 AUC2:0.8235 FAR:0.00000
[2023-07-21 00:20:27,016][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.6054 loss2:1.2629 main_loss:1.9377 | AUC:0.8240 AUC2:0.8240 FAR:0.03354
[2023-07-21 00:21:59,779][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.4657 loss2:1.1555 main_loss:1.6905 | AUC:0.8190 AUC2:0.8240 FAR:0.00200
[2023-07-21 00:23:34,149][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.4374 loss2:1.0944 main_loss:1.6011 | AUC:0.8173 AUC2:0.8240 FAR:0.00089
[2023-07-21 00:25:16,146][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.4410 loss2:1.1013 main_loss:1.6116 | AUC:0.8277 AUC2:0.8277 FAR:0.00650
[2023-07-21 00:26:54,749][main.py][line:76][INFO] [Epoch:12/100]: loss1:0.4040 loss2:1.0806 main_loss:1.5539 | AUC:0.8150 AUC2:0.8277 FAR:0.00245
[2023-07-21 00:28:36,847][main.py][line:76][INFO] [Epoch:13/100]: loss1:0.4098 loss2:1.0789 main_loss:1.5581 | AUC:0.7989 AUC2:0.8277 FAR:0.00022
[2023-07-21 00:30:16,966][main.py][line:76][INFO] [Epoch:14/100]: loss1:0.4110 loss2:1.0726 main_loss:1.5529 | AUC:0.8220 AUC2:0.8277 FAR:0.00000
[2023-07-21 00:31:56,666][main.py][line:76][INFO] [Epoch:15/100]: loss1:0.3934 loss2:1.0688 main_loss:1.5316 | AUC:0.8239 AUC2:0.8277 FAR:0.00037
[2023-07-21 00:33:38,429][main.py][line:76][INFO] [Epoch:16/100]: loss1:0.3795 loss2:1.0626 main_loss:1.5115 | AUC:0.8248 AUC2:0.8277 FAR:0.00000
[2023-07-21 00:35:15,424][main.py][line:76][INFO] [Epoch:17/100]: loss1:0.3950 loss2:1.0641 main_loss:1.5286 | AUC:0.8057 AUC2:0.8277 FAR:0.00000
[2023-07-21 00:36:48,110][main.py][line:76][INFO] [Epoch:18/100]: loss1:0.3754 loss2:1.0583 main_loss:1.5032 | AUC:0.8227 AUC2:0.8277 FAR:0.00000
[2023-07-21 00:38:28,801][main.py][line:76][INFO] [Epoch:19/100]: loss1:0.3654 loss2:1.0476 main_loss:1.4825 | AUC:0.8328 AUC2:0.8327 FAR:0.00000
[2023-07-21 00:40:06,082][main.py][line:76][INFO] [Epoch:20/100]: loss1:0.3736 loss2:1.0447 main_loss:1.4878 | AUC:0.8003 AUC2:0.8327 FAR:0.00000
[2023-07-21 00:41:41,216][main.py][line:76][INFO] [Epoch:21/100]: loss1:0.3865 loss2:1.0238 main_loss:1.4797 | AUC:0.8405 AUC2:0.8405 FAR:0.00000
[2023-07-21 00:43:16,706][main.py][line:76][INFO] [Epoch:22/100]: loss1:0.3583 loss2:1.0492 main_loss:1.4768 | AUC:0.8398 AUC2:0.8405 FAR:0.00007
[2023-07-21 00:44:47,099][main.py][line:76][INFO] [Epoch:23/100]: loss1:0.3621 loss2:1.0528 main_loss:1.4843 | AUC:0.8344 AUC2:0.8405 FAR:0.00000
[2023-07-21 00:46:20,914][main.py][line:76][INFO] [Epoch:24/100]: loss1:0.3684 loss2:1.0548 main_loss:1.4926 | AUC:0.8359 AUC2:0.8405 FAR:0.00000
[2023-07-21 00:48:00,989][main.py][line:76][INFO] [Epoch:25/100]: loss1:0.3432 loss2:1.0431 main_loss:1.4557 | AUC:0.8092 AUC2:0.8405 FAR:0.00037
[2023-07-21 00:49:38,492][main.py][line:76][INFO] [Epoch:26/100]: loss1:0.3441 loss2:1.0427 main_loss:1.4561 | AUC:0.8411 AUC2:0.8411 FAR:0.00007
[2023-07-21 00:51:11,194][main.py][line:76][INFO] [Epoch:27/100]: loss1:0.3348 loss2:1.0350 main_loss:1.4391 | AUC:0.8196 AUC2:0.8411 FAR:0.00000
[2023-07-21 00:52:48,223][main.py][line:76][INFO] [Epoch:28/100]: loss1:0.3458 loss2:1.0408 main_loss:1.4559 | AUC:0.8167 AUC2:0.8411 FAR:0.00000
[2023-07-21 00:54:23,141][main.py][line:76][INFO] [Epoch:29/100]: loss1:0.3267 loss2:1.0351 main_loss:1.4312 | AUC:0.8148 AUC2:0.8411 FAR:0.00000
[2023-07-21 00:56:01,029][main.py][line:76][INFO] [Epoch:30/100]: loss1:0.9663 loss2:1.0637 main_loss:2.0993 | AUC:0.6786 AUC2:0.8411 FAR:0.00000
[2023-07-21 00:57:35,602][main.py][line:76][INFO] [Epoch:31/100]: loss1:0.6455 loss2:1.1963 main_loss:1.9112 | AUC:0.6740 AUC2:0.8411 FAR:0.00000
[2023-07-21 00:59:10,769][main.py][line:76][INFO] [Epoch:32/100]: loss1:0.4749 loss2:1.0931 main_loss:1.6374 | AUC:0.6979 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:00:49,232][main.py][line:76][INFO] [Epoch:33/100]: loss1:0.4291 loss2:1.0770 main_loss:1.5754 | AUC:0.7419 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:02:32,385][main.py][line:76][INFO] [Epoch:34/100]: loss1:0.3971 loss2:1.0707 main_loss:1.5371 | AUC:0.6181 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:04:10,644][main.py][line:76][INFO] [Epoch:35/100]: loss1:0.3828 loss2:1.0567 main_loss:1.5088 | AUC:0.6787 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:05:51,786][main.py][line:76][INFO] [Epoch:36/100]: loss1:0.3715 loss2:1.0447 main_loss:1.4855 | AUC:0.6937 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:07:30,177][main.py][line:76][INFO] [Epoch:37/100]: loss1:0.3503 loss2:1.0456 main_loss:1.4653 | AUC:0.6879 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:09:15,046][main.py][line:76][INFO] [Epoch:38/100]: loss1:0.3385 loss2:1.0313 main_loss:1.4392 | AUC:0.7207 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:10:49,962][main.py][line:76][INFO] [Epoch:39/100]: loss1:0.3318 loss2:1.0346 main_loss:1.4357 | AUC:0.6993 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:12:23,365][main.py][line:76][INFO] [Epoch:40/100]: loss1:0.3227 loss2:1.0294 main_loss:1.4215 | AUC:0.8309 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:14:01,624][main.py][line:76][INFO] [Epoch:41/100]: loss1:0.3160 loss2:1.0282 main_loss:1.4135 | AUC:0.8338 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:15:34,659][main.py][line:76][INFO] [Epoch:42/100]: loss1:0.3091 loss2:1.0218 main_loss:1.4003 | AUC:0.8365 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:17:06,960][main.py][line:76][INFO] [Epoch:43/100]: loss1:0.3038 loss2:1.0206 main_loss:1.3937 | AUC:0.8322 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:18:36,329][main.py][line:76][INFO] [Epoch:44/100]: loss1:0.2924 loss2:1.0079 main_loss:1.3697 | AUC:0.8320 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:20:14,187][main.py][line:76][INFO] [Epoch:45/100]: loss1:0.2822 loss2:1.0133 main_loss:1.3649 | AUC:0.8365 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:21:46,326][main.py][line:76][INFO] [Epoch:46/100]: loss1:0.2724 loss2:0.9959 main_loss:1.3376 | AUC:0.8363 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:23:20,305][main.py][line:76][INFO] [Epoch:47/100]: loss1:0.2743 loss2:1.0053 main_loss:1.3490 | AUC:0.8352 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:24:59,473][main.py][line:76][INFO] [Epoch:48/100]: loss1:0.2604 loss2:1.0047 main_loss:1.3344 | AUC:0.8345 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:26:33,126][main.py][line:76][INFO] [Epoch:49/100]: loss1:0.2477 loss2:0.9956 main_loss:1.3126 | AUC:0.8325 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:28:03,439][main.py][line:76][INFO] [Epoch:50/100]: loss1:0.2459 loss2:0.9955 main_loss:1.3108 | AUC:0.8294 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:29:35,863][main.py][line:76][INFO] [Epoch:51/100]: loss1:0.2380 loss2:0.9829 main_loss:1.2902 | AUC:0.8306 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:31:10,862][main.py][line:76][INFO] [Epoch:52/100]: loss1:0.2366 loss2:0.9917 main_loss:1.2975 | AUC:0.8322 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:32:49,965][main.py][line:76][INFO] [Epoch:53/100]: loss1:0.2296 loss2:0.9891 main_loss:1.2880 | AUC:0.8313 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:34:28,358][main.py][line:76][INFO] [Epoch:54/100]: loss1:0.2293 loss2:0.9864 main_loss:1.2850 | AUC:0.8290 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:36:05,348][main.py][line:76][INFO] [Epoch:55/100]: loss1:0.2250 loss2:0.9852 main_loss:1.2795 | AUC:0.8285 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:37:34,957][main.py][line:76][INFO] [Epoch:56/100]: loss1:0.2219 loss2:0.9833 main_loss:1.2745 | AUC:0.8282 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:39:14,660][main.py][line:76][INFO] [Epoch:57/100]: loss1:0.2227 loss2:0.9819 main_loss:1.2739 | AUC:0.8290 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:40:41,834][main.py][line:76][INFO] [Epoch:58/100]: loss1:0.2221 loss2:0.9832 main_loss:1.2746 | AUC:0.8274 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:42:10,424][main.py][line:76][INFO] [Epoch:59/100]: loss1:0.2175 loss2:0.9832 main_loss:1.2700 | AUC:0.8275 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:43:40,058][main.py][line:76][INFO] [Epoch:60/100]: loss1:0.2201 loss2:0.9816 main_loss:1.2710 | AUC:0.8275 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:45:04,907][main.py][line:76][INFO] [Epoch:61/100]: loss1:0.2230 loss2:0.9797 main_loss:1.2721 | AUC:0.8275 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:46:31,333][main.py][line:76][INFO] [Epoch:62/100]: loss1:0.2200 loss2:0.9808 main_loss:1.2701 | AUC:0.8274 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:47:58,089][main.py][line:76][INFO] [Epoch:63/100]: loss1:0.2224 loss2:0.9839 main_loss:1.2756 | AUC:0.8279 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:49:24,631][main.py][line:76][INFO] [Epoch:64/100]: loss1:0.2178 loss2:0.9813 main_loss:1.2684 | AUC:0.8275 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:50:56,200][main.py][line:76][INFO] [Epoch:65/100]: loss1:0.2193 loss2:0.9806 main_loss:1.2692 | AUC:0.8272 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:52:21,828][main.py][line:76][INFO] [Epoch:66/100]: loss1:0.2211 loss2:0.9800 main_loss:1.2704 | AUC:0.8294 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:53:48,620][main.py][line:76][INFO] [Epoch:67/100]: loss1:0.2189 loss2:0.9830 main_loss:1.2712 | AUC:0.8291 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:55:17,716][main.py][line:76][INFO] [Epoch:68/100]: loss1:0.2211 loss2:0.9822 main_loss:1.2726 | AUC:0.8259 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:56:47,463][main.py][line:76][INFO] [Epoch:69/100]: loss1:0.2203 loss2:0.9822 main_loss:1.2718 | AUC:0.8251 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:58:16,346][main.py][line:76][INFO] [Epoch:70/100]: loss1:0.2221 loss2:0.9760 main_loss:1.2674 | AUC:0.8248 AUC2:0.8411 FAR:0.00000
[2023-07-21 01:59:44,256][main.py][line:76][INFO] [Epoch:71/100]: loss1:0.2163 loss2:0.9797 main_loss:1.2654 | AUC:0.8223 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:01:09,814][main.py][line:76][INFO] [Epoch:72/100]: loss1:0.2246 loss2:0.9748 main_loss:1.2688 | AUC:0.8240 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:02:37,307][main.py][line:76][INFO] [Epoch:73/100]: loss1:0.2180 loss2:0.9800 main_loss:1.2673 | AUC:0.8205 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:04:04,033][main.py][line:76][INFO] [Epoch:74/100]: loss1:0.2254 loss2:0.9840 main_loss:1.2787 | AUC:0.8213 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:05:32,076][main.py][line:76][INFO] [Epoch:75/100]: loss1:0.2188 loss2:0.9776 main_loss:1.2657 | AUC:0.8222 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:07:00,426][main.py][line:76][INFO] [Epoch:76/100]: loss1:0.2122 loss2:0.9814 main_loss:1.2630 | AUC:0.8206 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:08:28,573][main.py][line:76][INFO] [Epoch:77/100]: loss1:0.2180 loss2:0.9809 main_loss:1.2682 | AUC:0.8118 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:09:55,028][main.py][line:76][INFO] [Epoch:78/100]: loss1:0.2355 loss2:0.9884 main_loss:1.2932 | AUC:0.8125 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:11:25,046][main.py][line:76][INFO] [Epoch:79/100]: loss1:0.2176 loss2:0.9730 main_loss:1.2599 | AUC:0.8180 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:12:51,041][main.py][line:76][INFO] [Epoch:80/100]: loss1:0.2210 loss2:0.9627 main_loss:1.2531 | AUC:0.8194 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:14:22,236][main.py][line:76][INFO] [Epoch:81/100]: loss1:0.2236 loss2:0.9841 main_loss:1.2770 | AUC:0.8296 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:15:47,916][main.py][line:76][INFO] [Epoch:82/100]: loss1:0.2098 loss2:0.9763 main_loss:1.2554 | AUC:0.8255 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:17:16,291][main.py][line:76][INFO] [Epoch:83/100]: loss1:0.2079 loss2:0.9704 main_loss:1.2477 | AUC:0.8241 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:18:43,800][main.py][line:76][INFO] [Epoch:84/100]: loss1:0.2160 loss2:0.9746 main_loss:1.2600 | AUC:0.8028 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:20:10,911][main.py][line:76][INFO] [Epoch:85/100]: loss1:0.1960 loss2:0.9618 main_loss:1.2272 | AUC:0.8068 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:21:39,597][main.py][line:76][INFO] [Epoch:86/100]: loss1:0.2060 loss2:0.9706 main_loss:1.2459 | AUC:0.7689 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:23:07,053][main.py][line:76][INFO] [Epoch:87/100]: loss1:0.2165 loss2:0.9744 main_loss:1.2602 | AUC:0.7710 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:24:33,235][main.py][line:76][INFO] [Epoch:88/100]: loss1:0.2271 loss2:0.9838 main_loss:1.2804 | AUC:0.7344 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:26:01,278][main.py][line:76][INFO] [Epoch:89/100]: loss1:0.2045 loss2:0.9696 main_loss:1.2435 | AUC:0.7663 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:27:28,398][main.py][line:76][INFO] [Epoch:90/100]: loss1:0.1962 loss2:0.9569 main_loss:1.2225 | AUC:0.6980 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:28:55,426][main.py][line:76][INFO] [Epoch:91/100]: loss1:0.2169 loss2:0.9764 main_loss:1.2628 | AUC:0.6207 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:30:23,231][main.py][line:76][INFO] [Epoch:92/100]: loss1:0.2004 loss2:0.9620 main_loss:1.2320 | AUC:0.7438 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:31:48,744][main.py][line:76][INFO] [Epoch:93/100]: loss1:0.2409 loss2:0.9891 main_loss:1.2994 | AUC:0.7477 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:33:15,328][main.py][line:76][INFO] [Epoch:94/100]: loss1:0.2448 loss2:1.0021 main_loss:1.3162 | AUC:0.6361 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:34:46,153][main.py][line:76][INFO] [Epoch:95/100]: loss1:0.3872 loss2:1.0493 main_loss:1.5059 | AUC:0.5861 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:36:13,505][main.py][line:76][INFO] [Epoch:96/100]: loss1:0.2966 loss2:1.0213 main_loss:1.3872 | AUC:0.5754 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:37:38,969][main.py][line:76][INFO] [Epoch:97/100]: loss1:0.2610 loss2:1.0074 main_loss:1.3378 | AUC:0.5068 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:39:04,630][main.py][line:76][INFO] [Epoch:98/100]: loss1:0.2694 loss2:1.0143 main_loss:1.3531 | AUC:0.5118 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:40:32,506][main.py][line:76][INFO] [Epoch:99/100]: loss1:0.2808 loss2:1.0180 main_loss:1.3681 | AUC:0.5554 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:41:59,684][main.py][line:76][INFO] [Epoch:100/100]: loss1:0.2762 loss2:1.0143 main_loss:1.3599 | AUC:0.5292 AUC2:0.8411 FAR:0.00000
[2023-07-21 02:41:59,808][main.py][line:82][INFO] Training completes in 154m 21s | best AUC:0.8411 FAR:0.00007

[2023-07-21 07:09:52,700][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.01, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:09:52,883][main.py][line:116][INFO] total params:27.1990M
[2023-07-21 07:09:52,883][main.py][line:119][INFO] Training Mode
[2023-07-21 07:09:52,883][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:09:52,883][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.01
    lr: 0.01
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:10:12,326][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 07:11:37,049][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.7744 loss2:1.2974 main_loss:2.4210 | AUC:0.8082 AUC2:0.8082 FAR:0.02208
[2023-07-21 07:13:02,633][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.4365 loss2:1.1233 main_loss:1.9065 | AUC:0.7915 AUC2:0.8082 FAR:0.04535
[2023-07-21 07:14:28,635][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.4073 loss2:1.0743 main_loss:1.8282 | AUC:0.7899 AUC2:0.8082 FAR:0.02114
[2023-07-21 07:14:35,571][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:14:35,756][main.py][line:116][INFO] total params:27.1990M
[2023-07-21 07:14:35,756][main.py][line:119][INFO] Training Mode
[2023-07-21 07:14:35,757][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-1): 2 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:14:35,757][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:14:55,361][main.py][line:53][INFO] Random initialize AUC:0.5452 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 07:16:31,730][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3729 loss2:1.0986 main_loss:1.7109 | AUC:0.8270 AUC2:0.8271 FAR:0.00583
[2023-07-21 07:18:08,419][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1468 loss2:0.8741 main_loss:1.1814 | AUC:0.8538 AUC2:0.8501 FAR:0.00603
[2023-07-21 07:19:44,625][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0684 loss2:0.7777 main_loss:0.9736 | AUC:0.8485 AUC2:0.8501 FAR:0.00832
[2023-07-21 07:21:17,937][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0314 loss2:0.7010 main_loss:0.8391 | AUC:0.8548 AUC2:0.8486 FAR:0.00326
[2023-07-21 07:22:55,214][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0191 loss2:0.6276 main_loss:0.7481 | AUC:0.8519 AUC2:0.8486 FAR:0.00168
[2023-07-21 07:24:38,573][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0402 loss2:0.5925 main_loss:0.7369 | AUC:0.8527 AUC2:0.8486 FAR:0.00440
[2023-07-21 07:26:16,110][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0187 loss2:0.5309 main_loss:0.6517 | AUC:0.8555 AUC2:0.8439 FAR:0.00232
[2023-07-21 07:26:53,106][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:26:53,290][main.py][line:116][INFO] total params:27.1990M
[2023-07-21 07:26:53,291][main.py][line:123][INFO] Test Mode
[2023-07-21 07:26:53,291][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-21 07:26:53,397][main.py][line:32][INFO] bert.embedding.learnedPosition.pe size mismatch: load torch.Size([1, 101, 1024]) given torch.Size([1, 201, 1024])
[2023-07-21 07:26:53,397][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.0.weight not found in model dict.
[2023-07-21 07:26:53,397][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.0.bias not found in model dict.
[2023-07-21 07:26:53,397][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.1.weight not found in model dict.
[2023-07-21 07:26:53,397][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.1.bias not found in model dict.
[2023-07-21 07:26:53,397][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.2.weight not found in model dict.
[2023-07-21 07:26:53,397][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.2.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.attention.output_linear.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.attention.output_linear.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_1.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_1.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_2.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_2.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.input_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.input_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.output_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.2.output_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.0.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.0.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.1.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.1.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.2.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.2.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.output_linear.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.attention.output_linear.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_1.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_1.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_2.weight not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_2.bias not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.input_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.input_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.output_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:26:53,398][main.py][line:35][INFO] bert.transformer_blocks.3.output_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:29:19,714][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8617.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:29:19,864][main.py][line:116][INFO] total params:27.1990M
[2023-07-21 07:29:19,865][main.py][line:123][INFO] Test Mode
[2023-07-21 07:29:19,865][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8617.pkl.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.0.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.0.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.1.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.1.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.2.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.linear_layers.2.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.output_linear.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.attention.output_linear.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_1.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_1.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_2.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.feed_forward.w_2.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.input_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.input_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.output_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.2.output_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.0.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.0.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.1.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.1.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.2.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.linear_layers.2.bias not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.output_linear.weight not found in model dict.
[2023-07-21 07:29:19,971][main.py][line:35][INFO] bert.transformer_blocks.3.attention.output_linear.bias not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_1.weight not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_1.bias not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_2.weight not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.feed_forward.w_2.bias not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.input_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.input_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.output_sublayer.norm.a_2 not found in model dict.
[2023-07-21 07:29:19,972][main.py][line:35][INFO] bert.transformer_blocks.3.output_sublayer.norm.b_2 not found in model dict.
[2023-07-21 07:29:39,551][infer_bert.py][line:65][INFO] offline AUC:0.8623 AUC2:0.8623 AP:0.3394 FAR:0.0011 | Complete in 0m 20s

[2023-07-21 07:31:12,970][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:31:13,205][main.py][line:116][INFO] total params:52.3915M
[2023-07-21 07:31:13,205][main.py][line:123][INFO] Test Mode
[2023-07-21 07:31:13,205][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-21 07:31:13,267][main.py][line:32][INFO] bert.embedding.learnedPosition.pe size mismatch: load torch.Size([1, 101, 1024]) given torch.Size([1, 201, 1024])
[2023-07-21 07:31:34,493][infer_bert.py][line:65][INFO] offline AUC:0.8601 AUC2:0.8558 AP:0.3281 FAR:0.0014 | Complete in 0m 21s

[2023-07-21 07:32:37,754][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:32:37,978][main.py][line:116][INFO] total params:52.2891M
[2023-07-21 07:32:37,978][main.py][line:123][INFO] Test Mode
[2023-07-21 07:32:37,978][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-21 07:32:51,628][infer_bert.py][line:65][INFO] offline AUC:0.8638 AUC2:0.8558 AP:0.3289 FAR:0.0014 | Complete in 0m 14s

[2023-07-21 07:36:38,085][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:36:38,319][main.py][line:116][INFO] total params:52.2891M
[2023-07-21 07:36:38,319][main.py][line:123][INFO] Test Mode
[2023-07-21 07:36:38,319][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-21 07:36:52,072][infer_bert.py][line:66][INFO] offline AUC:0.8638 AUC2:0.8558 AP:0.3289 FAR:0.0014 | Complete in 0m 14s

[2023-07-21 07:39:31,241][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:39:31,463][main.py][line:116][INFO] total params:52.2891M
[2023-07-21 07:39:31,464][main.py][line:123][INFO] Test Mode
[2023-07-21 07:39:31,464][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-21 07:42:36,303][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:42:36,527][main.py][line:116][INFO] total params:52.2891M
[2023-07-21 07:42:36,527][main.py][line:123][INFO] Test Mode
[2023-07-21 07:42:36,527][main.py][line:22][INFO] loading pretrained checkpoint from ./ckpt/ucf__8638.pkl.
[2023-07-21 07:45:10,554][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:45:10,770][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:45:10,770][main.py][line:119][INFO] Training Mode
[2023-07-21 07:45:10,771][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:45:10,771][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:45:45,073][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:45:45,305][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:45:45,305][main.py][line:119][INFO] Training Mode
[2023-07-21 07:45:45,306][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:45:45,306][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:46:13,025][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:46:13,253][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:46:13,253][main.py][line:119][INFO] Training Mode
[2023-07-21 07:46:13,254][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:46:13,254][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:47:29,414][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:47:29,631][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:47:29,631][main.py][line:119][INFO] Training Mode
[2023-07-21 07:47:29,631][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:47:29,631][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:47:37,174][main.py][line:53][INFO] Random initialize AUC:0.5445 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 07:51:23,960][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:51:24,193][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:51:24,193][main.py][line:119][INFO] Training Mode
[2023-07-21 07:51:24,193][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:51:24,193][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:52:24,654][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 100, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:52:24,892][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:52:24,892][main.py][line:119][INFO] Training Mode
[2023-07-21 07:52:24,893][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:52:24,893][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:52:32,510][main.py][line:53][INFO] Random initialize AUC:0.5445 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 07:53:40,428][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:53:40,652][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:53:40,652][main.py][line:119][INFO] Training Mode
[2023-07-21 07:53:40,652][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:53:40,652][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:53:48,151][main.py][line:53][INFO] Random initialize AUC:0.5445 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 07:55:50,690][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 07:55:50,930][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 07:55:50,930][main.py][line:119][INFO] Training Mode
[2023-07-21 07:55:50,931][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 07:55:50,931][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 07:55:58,500][main.py][line:53][INFO] Random initialize AUC:0.5445 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 07:57:03,192][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3674 loss2:1.0975 main_loss:1.7620 | AUC:0.8312 AUC2:0.8341 FAR:0.00632
[2023-07-21 07:58:07,551][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1423 loss2:0.8743 main_loss:1.1856 | AUC:0.8502 AUC2:0.8497 FAR:0.00491
[2023-07-21 07:59:12,432][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0602 loss2:0.7808 main_loss:1.0242 | AUC:0.8416 AUC2:0.8497 FAR:0.00235
[2023-07-21 08:00:18,535][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0475 loss2:0.7119 main_loss:0.9152 | AUC:0.8495 AUC2:0.8497 FAR:0.00595
[2023-07-21 08:01:26,665][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0257 loss2:0.6487 main_loss:0.8159 | AUC:0.8558 AUC2:0.8514 FAR:0.00185
[2023-07-21 08:02:33,454][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0211 loss2:0.5865 main_loss:0.7438 | AUC:0.8531 AUC2:0.8514 FAR:0.00961
[2023-07-21 08:03:37,377][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0152 loss2:0.5311 main_loss:0.6717 | AUC:0.8501 AUC2:0.8514 FAR:0.00519
[2023-07-21 08:04:40,253][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0155 loss2:0.4769 main_loss:0.6136 | AUC:0.8447 AUC2:0.8514 FAR:0.00593
[2023-07-21 08:05:46,919][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0231 loss2:0.4407 main_loss:0.5780 | AUC:0.8545 AUC2:0.8514 FAR:0.00696
[2023-07-21 08:06:55,159][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0127 loss2:0.3883 main_loss:0.5159 | AUC:0.8424 AUC2:0.8514 FAR:0.00291
[2023-07-21 08:08:00,282][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.0078 loss2:0.3309 main_loss:0.4446 | AUC:0.8492 AUC2:0.8514 FAR:0.00306
[2023-07-21 08:09:06,910][main.py][line:76][INFO] [Epoch:12/100]: loss1:0.0064 loss2:0.2811 main_loss:0.3884 | AUC:0.8443 AUC2:0.8514 FAR:0.00126
[2023-07-21 08:10:11,947][main.py][line:76][INFO] [Epoch:13/100]: loss1:0.0067 loss2:0.2447 main_loss:0.3535 | AUC:0.8505 AUC2:0.8514 FAR:0.00326
[2023-07-21 08:11:19,804][main.py][line:76][INFO] [Epoch:14/100]: loss1:0.0053 loss2:0.2033 main_loss:0.3156 | AUC:0.8492 AUC2:0.8514 FAR:0.00393
[2023-07-21 08:12:27,146][main.py][line:76][INFO] [Epoch:15/100]: loss1:0.0047 loss2:0.1689 main_loss:0.2876 | AUC:0.8520 AUC2:0.8514 FAR:0.00336
[2023-07-21 08:13:32,940][main.py][line:76][INFO] [Epoch:16/100]: loss1:0.0046 loss2:0.1405 main_loss:0.2417 | AUC:0.8478 AUC2:0.8514 FAR:0.00237
[2023-07-21 08:14:38,298][main.py][line:76][INFO] [Epoch:17/100]: loss1:0.0053 loss2:0.1200 main_loss:0.2177 | AUC:0.8474 AUC2:0.8514 FAR:0.00247
[2023-07-21 08:15:42,761][main.py][line:76][INFO] [Epoch:18/100]: loss1:0.0549 loss2:0.2049 main_loss:0.3492 | AUC:0.8378 AUC2:0.8514 FAR:0.00393
[2023-07-21 08:16:45,499][main.py][line:76][INFO] [Epoch:19/100]: loss1:0.0133 loss2:0.1330 main_loss:0.2316 | AUC:0.8444 AUC2:0.8514 FAR:0.00511
[2023-07-21 08:17:50,153][main.py][line:76][INFO] [Epoch:20/100]: loss1:0.0170 loss2:0.1153 main_loss:0.2154 | AUC:0.8443 AUC2:0.8514 FAR:0.00309
[2023-07-21 08:18:55,819][main.py][line:76][INFO] [Epoch:21/100]: loss1:0.0035 loss2:0.0713 main_loss:0.1533 | AUC:0.8440 AUC2:0.8514 FAR:0.00301
[2023-07-21 08:20:02,027][main.py][line:76][INFO] [Epoch:22/100]: loss1:0.0024 loss2:0.0573 main_loss:0.1412 | AUC:0.8466 AUC2:0.8514 FAR:0.00388
[2023-07-21 08:21:05,546][main.py][line:76][INFO] [Epoch:23/100]: loss1:0.0021 loss2:0.0515 main_loss:0.1280 | AUC:0.8450 AUC2:0.8514 FAR:0.00358
[2023-07-21 09:18:34,480][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 09:18:34,749][main.py][line:116][INFO] total params:52.1969M
[2023-07-21 09:18:34,749][main.py][line:119][INFO] Training Mode
[2023-07-21 09:18:34,749][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 09:18:34,749][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 09:19:35,800][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 09:19:36,035][main.py][line:116][INFO] total params:52.2195M
[2023-07-21 09:19:36,035][main.py][line:119][INFO] Training Mode
[2023-07-21 09:19:36,035][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 09:19:36,035][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 09:19:57,275][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 09:19:57,510][main.py][line:116][INFO] total params:52.2195M
[2023-07-21 09:19:57,510][main.py][line:119][INFO] Training Mode
[2023-07-21 09:19:57,511][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 09:19:57,511][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 09:20:18,725][main.py][line:90][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 09:20:18,957][main.py][line:116][INFO] total params:52.2195M
[2023-07-21 09:20:18,958][main.py][line:119][INFO] Training Mode
[2023-07-21 09:20:18,958][main.py][line:49][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 09:20:18,958][main.py][line:50][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 09:20:27,190][main.py][line:53][INFO] Random initialize AUC:0.5448 initial_AUC2:0.5444 FAR:0.67905
[2023-07-21 09:21:21,093][main.py][line:76][INFO] [Epoch:1/100]: loss1:0.3930 loss2:1.1859 main_loss:1.9055 | AUC:0.8045 AUC2:0.8102 FAR:0.01499
[2023-07-21 09:22:14,818][main.py][line:76][INFO] [Epoch:2/100]: loss1:0.1667 loss2:0.9458 main_loss:1.4324 | AUC:0.8342 AUC2:0.8332 FAR:0.00563
[2023-07-21 09:23:09,000][main.py][line:76][INFO] [Epoch:3/100]: loss1:0.0713 loss2:0.8367 main_loss:1.1644 | AUC:0.8362 AUC2:0.8328 FAR:0.00237
[2023-07-21 09:24:03,497][main.py][line:76][INFO] [Epoch:4/100]: loss1:0.0419 loss2:0.7443 main_loss:0.9675 | AUC:0.8446 AUC2:0.8394 FAR:0.00193
[2023-07-21 09:24:57,712][main.py][line:76][INFO] [Epoch:5/100]: loss1:0.0287 loss2:0.6708 main_loss:0.8435 | AUC:0.8523 AUC2:0.8473 FAR:0.00121
[2023-07-21 09:25:51,635][main.py][line:76][INFO] [Epoch:6/100]: loss1:0.0238 loss2:0.6029 main_loss:0.7490 | AUC:0.8517 AUC2:0.8473 FAR:0.00259
[2023-07-21 09:26:45,682][main.py][line:76][INFO] [Epoch:7/100]: loss1:0.0182 loss2:0.5426 main_loss:0.6660 | AUC:0.8505 AUC2:0.8473 FAR:0.00143
[2023-07-21 09:27:39,810][main.py][line:76][INFO] [Epoch:8/100]: loss1:0.0146 loss2:0.4737 main_loss:0.5836 | AUC:0.8460 AUC2:0.8473 FAR:0.00306
[2023-07-21 09:28:34,163][main.py][line:76][INFO] [Epoch:9/100]: loss1:0.0156 loss2:0.4290 main_loss:0.5333 | AUC:0.8535 AUC2:0.8443 FAR:0.00131
[2023-07-21 09:29:28,086][main.py][line:76][INFO] [Epoch:10/100]: loss1:0.0129 loss2:0.3660 main_loss:0.4684 | AUC:0.8502 AUC2:0.8443 FAR:0.00163
[2023-07-21 09:30:22,157][main.py][line:76][INFO] [Epoch:11/100]: loss1:0.0112 loss2:0.3342 main_loss:0.4228 | AUC:0.8472 AUC2:0.8443 FAR:0.00215
[2023-07-21 09:31:17,036][main.py][line:76][INFO] [Epoch:12/100]: loss1:0.0099 loss2:0.2940 main_loss:0.4149 | AUC:0.8533 AUC2:0.8443 FAR:0.00237
[2023-07-21 09:32:11,066][main.py][line:76][INFO] [Epoch:13/100]: loss1:0.0077 loss2:0.2522 main_loss:0.3523 | AUC:0.8476 AUC2:0.8443 FAR:0.00116
[2023-07-21 09:33:05,658][main.py][line:76][INFO] [Epoch:14/100]: loss1:0.0085 loss2:0.2193 main_loss:0.2988 | AUC:0.8579 AUC2:0.8462 FAR:0.00106
[2023-07-21 09:33:59,988][main.py][line:76][INFO] [Epoch:15/100]: loss1:0.0100 loss2:0.1900 main_loss:0.2637 | AUC:0.8447 AUC2:0.8462 FAR:0.00044
[2023-07-21 09:34:54,318][main.py][line:76][INFO] [Epoch:16/100]: loss1:0.0274 loss2:0.2005 main_loss:0.2879 | AUC:0.8539 AUC2:0.8462 FAR:0.00111
[2023-07-21 09:35:48,318][main.py][line:76][INFO] [Epoch:17/100]: loss1:0.0060 loss2:0.1352 main_loss:0.1914 | AUC:0.8521 AUC2:0.8462 FAR:0.00077
[2023-07-21 09:36:42,565][main.py][line:76][INFO] [Epoch:18/100]: loss1:0.0046 loss2:0.1112 main_loss:0.1618 | AUC:0.8563 AUC2:0.8462 FAR:0.00116
[2023-07-21 09:37:36,771][main.py][line:76][INFO] [Epoch:19/100]: loss1:0.0038 loss2:0.0980 main_loss:0.1390 | AUC:0.8555 AUC2:0.8462 FAR:0.00077
[2023-07-21 09:38:30,857][main.py][line:76][INFO] [Epoch:20/100]: loss1:0.0039 loss2:0.0823 main_loss:0.1175 | AUC:0.8536 AUC2:0.8462 FAR:0.00133
[2023-07-21 09:39:25,208][main.py][line:76][INFO] [Epoch:21/100]: loss1:0.0064 loss2:0.0801 main_loss:0.1189 | AUC:0.8557 AUC2:0.8462 FAR:0.00133
[2023-07-21 09:40:19,740][main.py][line:76][INFO] [Epoch:22/100]: loss1:0.0038 loss2:0.0646 main_loss:0.1000 | AUC:0.8591 AUC2:0.8525 FAR:0.00099
[2023-07-21 09:41:13,936][main.py][line:76][INFO] [Epoch:23/100]: loss1:0.0043 loss2:0.0571 main_loss:0.0927 | AUC:0.8525 AUC2:0.8525 FAR:0.00091
[2023-07-21 09:42:08,273][main.py][line:76][INFO] [Epoch:24/100]: loss1:0.0030 loss2:0.0484 main_loss:0.1361 | AUC:0.8481 AUC2:0.8525 FAR:0.00089
[2023-07-21 09:43:02,133][main.py][line:76][INFO] [Epoch:25/100]: loss1:0.0020 loss2:0.0434 main_loss:0.0984 | AUC:0.8546 AUC2:0.8525 FAR:0.00074
[2023-07-21 09:43:56,149][main.py][line:76][INFO] [Epoch:26/100]: loss1:0.0024 loss2:0.0388 main_loss:0.0811 | AUC:0.8518 AUC2:0.8525 FAR:0.00077
[2023-07-21 09:44:49,970][main.py][line:76][INFO] [Epoch:27/100]: loss1:0.0026 loss2:0.0372 main_loss:0.1137 | AUC:0.8518 AUC2:0.8525 FAR:0.00082
[2023-07-21 09:45:43,979][main.py][line:76][INFO] [Epoch:28/100]: loss1:0.0017 loss2:0.0330 main_loss:0.0909 | AUC:0.8500 AUC2:0.8525 FAR:0.00089
[2023-07-21 09:46:38,038][main.py][line:76][INFO] [Epoch:29/100]: loss1:0.0011 loss2:0.0264 main_loss:0.0666 | AUC:0.8526 AUC2:0.8525 FAR:0.00079
[2023-07-21 09:47:31,992][main.py][line:76][INFO] [Epoch:30/100]: loss1:0.0010 loss2:0.0249 main_loss:0.0630 | AUC:0.8490 AUC2:0.8525 FAR:0.00096
[2023-07-21 09:48:25,853][main.py][line:76][INFO] [Epoch:31/100]: loss1:0.0017 loss2:0.0249 main_loss:0.0625 | AUC:0.8519 AUC2:0.8525 FAR:0.00114
[2023-07-21 09:49:19,886][main.py][line:76][INFO] [Epoch:32/100]: loss1:0.0012 loss2:0.0222 main_loss:0.0565 | AUC:0.8522 AUC2:0.8525 FAR:0.00094
[2023-07-21 09:50:13,768][main.py][line:76][INFO] [Epoch:33/100]: loss1:0.0013 loss2:0.0190 main_loss:0.0464 | AUC:0.8529 AUC2:0.8525 FAR:0.00188
[2023-07-21 09:51:07,723][main.py][line:76][INFO] [Epoch:34/100]: loss1:0.0016 loss2:0.0210 main_loss:0.0480 | AUC:0.8559 AUC2:0.8525 FAR:0.00109
[2023-07-21 09:52:02,144][main.py][line:76][INFO] [Epoch:35/100]: loss1:0.0029 loss2:0.0242 main_loss:0.0515 | AUC:0.8538 AUC2:0.8525 FAR:0.00165
[2023-07-21 09:52:56,033][main.py][line:76][INFO] [Epoch:36/100]: loss1:0.0016 loss2:0.0199 main_loss:0.0497 | AUC:0.8501 AUC2:0.8525 FAR:0.00084
[2023-07-21 09:53:49,924][main.py][line:76][INFO] [Epoch:37/100]: loss1:0.0010 loss2:0.0170 main_loss:0.0441 | AUC:0.8501 AUC2:0.8525 FAR:0.00153
[2023-07-21 09:54:43,625][main.py][line:76][INFO] [Epoch:38/100]: loss1:0.0007 loss2:0.0131 main_loss:0.0360 | AUC:0.8497 AUC2:0.8525 FAR:0.00089
[2023-07-21 09:55:37,556][main.py][line:76][INFO] [Epoch:39/100]: loss1:0.0007 loss2:0.0145 main_loss:0.0362 | AUC:0.8513 AUC2:0.8525 FAR:0.00091
[2023-07-21 09:56:31,557][main.py][line:76][INFO] [Epoch:40/100]: loss1:0.0006 loss2:0.0115 main_loss:0.0308 | AUC:0.8511 AUC2:0.8525 FAR:0.00089
[2023-07-21 09:57:25,658][main.py][line:76][INFO] [Epoch:41/100]: loss1:0.0005 loss2:0.0103 main_loss:0.0299 | AUC:0.8499 AUC2:0.8525 FAR:0.00074
[2023-07-21 09:58:19,318][main.py][line:76][INFO] [Epoch:42/100]: loss1:0.0006 loss2:0.0118 main_loss:0.0284 | AUC:0.8524 AUC2:0.8525 FAR:0.00096
[2023-07-21 09:59:13,132][main.py][line:76][INFO] [Epoch:43/100]: loss1:0.0010 loss2:0.0113 main_loss:0.0294 | AUC:0.8474 AUC2:0.8525 FAR:0.00146
[2023-07-21 10:00:07,668][main.py][line:76][INFO] [Epoch:44/100]: loss1:0.0005 loss2:0.0102 main_loss:0.0271 | AUC:0.8482 AUC2:0.8525 FAR:0.00091
[2023-07-21 10:01:01,547][main.py][line:76][INFO] [Epoch:45/100]: loss1:0.0005 loss2:0.0100 main_loss:0.0251 | AUC:0.8495 AUC2:0.8525 FAR:0.00099
[2023-07-21 10:01:55,378][main.py][line:76][INFO] [Epoch:46/100]: loss1:0.0004 loss2:0.0099 main_loss:0.0244 | AUC:0.8510 AUC2:0.8525 FAR:0.00089
[2023-07-21 10:02:49,524][main.py][line:76][INFO] [Epoch:47/100]: loss1:0.0004 loss2:0.0093 main_loss:0.0255 | AUC:0.8507 AUC2:0.8525 FAR:0.00091
[2023-07-21 10:03:43,680][main.py][line:76][INFO] [Epoch:48/100]: loss1:0.0004 loss2:0.0087 main_loss:0.0226 | AUC:0.8517 AUC2:0.8525 FAR:0.00099
[2023-07-21 10:04:37,608][main.py][line:76][INFO] [Epoch:49/100]: loss1:0.0004 loss2:0.0079 main_loss:0.0208 | AUC:0.8490 AUC2:0.8525 FAR:0.00074
[2023-07-21 10:05:31,589][main.py][line:76][INFO] [Epoch:50/100]: loss1:0.0004 loss2:0.0084 main_loss:0.0219 | AUC:0.8507 AUC2:0.8525 FAR:0.00079
[2023-07-21 10:06:25,412][main.py][line:76][INFO] [Epoch:51/100]: loss1:0.0004 loss2:0.0087 main_loss:0.0220 | AUC:0.8510 AUC2:0.8525 FAR:0.00089
[2023-07-21 10:07:19,456][main.py][line:76][INFO] [Epoch:52/100]: loss1:0.0004 loss2:0.0090 main_loss:0.0200 | AUC:0.8498 AUC2:0.8525 FAR:0.00077
[2023-07-21 10:08:13,786][main.py][line:76][INFO] [Epoch:53/100]: loss1:0.0004 loss2:0.0083 main_loss:0.0201 | AUC:0.8504 AUC2:0.8525 FAR:0.00086
[2023-07-21 10:09:07,621][main.py][line:76][INFO] [Epoch:54/100]: loss1:0.0003 loss2:0.0081 main_loss:0.0195 | AUC:0.8510 AUC2:0.8525 FAR:0.00086
[2023-07-21 10:10:01,789][main.py][line:76][INFO] [Epoch:55/100]: loss1:0.0003 loss2:0.0091 main_loss:0.0207 | AUC:0.8508 AUC2:0.8525 FAR:0.00086
[2023-07-21 10:10:56,634][main.py][line:76][INFO] [Epoch:56/100]: loss1:0.0004 loss2:0.0071 main_loss:0.0182 | AUC:0.8511 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:11:50,877][main.py][line:76][INFO] [Epoch:57/100]: loss1:0.0003 loss2:0.0078 main_loss:0.0184 | AUC:0.8510 AUC2:0.8525 FAR:0.00086
[2023-07-21 10:12:44,697][main.py][line:76][INFO] [Epoch:58/100]: loss1:0.0003 loss2:0.0083 main_loss:0.0191 | AUC:0.8511 AUC2:0.8525 FAR:0.00082
[2023-07-21 10:13:38,848][main.py][line:76][INFO] [Epoch:59/100]: loss1:0.0003 loss2:0.0082 main_loss:0.0186 | AUC:0.8511 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:14:32,741][main.py][line:76][INFO] [Epoch:60/100]: loss1:0.0003 loss2:0.0075 main_loss:0.0186 | AUC:0.8511 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:15:26,831][main.py][line:76][INFO] [Epoch:61/100]: loss1:0.0003 loss2:0.0079 main_loss:0.0188 | AUC:0.8511 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:16:21,254][main.py][line:76][INFO] [Epoch:62/100]: loss1:0.0003 loss2:0.0082 main_loss:0.0191 | AUC:0.8511 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:17:15,153][main.py][line:76][INFO] [Epoch:63/100]: loss1:0.0003 loss2:0.0083 main_loss:0.0186 | AUC:0.8510 AUC2:0.8525 FAR:0.00086
[2023-07-21 10:18:09,031][main.py][line:76][INFO] [Epoch:64/100]: loss1:0.0003 loss2:0.0080 main_loss:0.0185 | AUC:0.8508 AUC2:0.8525 FAR:0.00077
[2023-07-21 10:19:03,030][main.py][line:76][INFO] [Epoch:65/100]: loss1:0.0003 loss2:0.0074 main_loss:0.0187 | AUC:0.8509 AUC2:0.8525 FAR:0.00089
[2023-07-21 10:19:57,013][main.py][line:76][INFO] [Epoch:66/100]: loss1:0.0003 loss2:0.0077 main_loss:0.0183 | AUC:0.8508 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:20:50,899][main.py][line:76][INFO] [Epoch:67/100]: loss1:0.0003 loss2:0.0075 main_loss:0.0186 | AUC:0.8505 AUC2:0.8525 FAR:0.00074
[2023-07-21 10:21:44,821][main.py][line:76][INFO] [Epoch:68/100]: loss1:0.0003 loss2:0.0066 main_loss:0.0190 | AUC:0.8515 AUC2:0.8525 FAR:0.00091
[2023-07-21 10:22:38,812][main.py][line:76][INFO] [Epoch:69/100]: loss1:0.0004 loss2:0.0065 main_loss:0.0179 | AUC:0.8512 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:23:33,065][main.py][line:76][INFO] [Epoch:70/100]: loss1:0.0003 loss2:0.0073 main_loss:0.0178 | AUC:0.8511 AUC2:0.8525 FAR:0.00086
[2023-07-21 10:24:27,106][main.py][line:76][INFO] [Epoch:71/100]: loss1:0.0003 loss2:0.0068 main_loss:0.0185 | AUC:0.8527 AUC2:0.8525 FAR:0.00091
[2023-07-21 10:25:21,327][main.py][line:76][INFO] [Epoch:72/100]: loss1:0.0004 loss2:0.0079 main_loss:0.0173 | AUC:0.8504 AUC2:0.8525 FAR:0.00082
[2023-07-21 10:26:15,608][main.py][line:76][INFO] [Epoch:73/100]: loss1:0.0004 loss2:0.0076 main_loss:0.0183 | AUC:0.8523 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:27:09,780][main.py][line:76][INFO] [Epoch:74/100]: loss1:0.0005 loss2:0.0074 main_loss:0.0215 | AUC:0.8517 AUC2:0.8525 FAR:0.00089
[2023-07-21 10:28:03,815][main.py][line:76][INFO] [Epoch:75/100]: loss1:0.0004 loss2:0.0055 main_loss:0.0166 | AUC:0.8533 AUC2:0.8525 FAR:0.00094
[2023-07-21 10:28:58,129][main.py][line:76][INFO] [Epoch:76/100]: loss1:0.0008 loss2:0.0052 main_loss:0.0180 | AUC:0.8555 AUC2:0.8525 FAR:0.00084
[2023-07-21 10:29:52,156][main.py][line:76][INFO] [Epoch:77/100]: loss1:0.0012 loss2:0.0108 main_loss:0.0236 | AUC:0.8531 AUC2:0.8525 FAR:0.00074
[2023-07-21 10:30:46,142][main.py][line:76][INFO] [Epoch:78/100]: loss1:0.0004 loss2:0.0071 main_loss:0.0172 | AUC:0.8498 AUC2:0.8525 FAR:0.00044
[2023-07-21 10:31:04,712][main.py][line:118][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 10:31:05,090][main.py][line:144][INFO] total params:52.2195M
[2023-07-21 10:31:05,090][main.py][line:147][INFO] Training Mode
[2023-07-21 10:32:07,909][main.py][line:118][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 10:32:08,246][main.py][line:144][INFO] total params:52.2195M
[2023-07-21 10:32:08,246][main.py][line:147][INFO] Training Mode
[2023-07-21 10:32:08,247][main.py][line:73][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 10:32:08,247][main.py][line:74][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 2
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 10:32:08,247][main.py][line:75][INFO] Optimizer_bert:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0

Parameter Group 2
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0

Parameter Group 3
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 0
)

[2023-07-21 10:32:16,429][main.py][line:79][INFO] Random initialize AUC:0.6173 initial_AUC2:0.6194 FAR:0.02739
[2023-07-21 10:33:11,936][main.py][line:104][INFO] [Epoch:1/100]: loss1:0.3887 loss2:1.1476 main_loss:1.5362 | AUC:0.8213 AUC2:0.8190 FAR:0.00373
[2023-07-21 10:34:09,680][main.py][line:104][INFO] [Epoch:2/100]: loss1:0.1699 loss2:0.9332 main_loss:1.1031 | AUC:0.8308 AUC2:0.8277 FAR:0.00269
[2023-07-21 10:35:05,940][main.py][line:104][INFO] [Epoch:3/100]: loss1:0.0681 loss2:0.8294 main_loss:0.8975 | AUC:0.8470 AUC2:0.8370 FAR:0.00267
[2023-07-21 10:36:04,019][main.py][line:104][INFO] [Epoch:4/100]: loss1:0.0391 loss2:0.7387 main_loss:0.7778 | AUC:0.8359 AUC2:0.8370 FAR:0.00067
[2023-07-21 10:37:00,015][main.py][line:104][INFO] [Epoch:5/100]: loss1:0.0278 loss2:0.6635 main_loss:0.6913 | AUC:0.8391 AUC2:0.8370 FAR:0.00215
[2023-07-21 10:37:55,044][main.py][line:104][INFO] [Epoch:6/100]: loss1:0.0222 loss2:0.5996 main_loss:0.6218 | AUC:0.8330 AUC2:0.8370 FAR:0.00247
[2023-07-21 10:38:51,410][main.py][line:104][INFO] [Epoch:7/100]: loss1:0.0173 loss2:0.5342 main_loss:0.5515 | AUC:0.8353 AUC2:0.8370 FAR:0.00163
[2023-07-21 10:39:47,834][main.py][line:104][INFO] [Epoch:8/100]: loss1:0.0157 loss2:0.4846 main_loss:0.5004 | AUC:0.8234 AUC2:0.8370 FAR:0.00082
[2023-07-21 10:40:44,137][main.py][line:104][INFO] [Epoch:9/100]: loss1:0.0170 loss2:0.4337 main_loss:0.4507 | AUC:0.8350 AUC2:0.8370 FAR:0.00282
[2023-07-21 10:41:21,919][main.py][line:118][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 32, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 10:41:22,301][main.py][line:144][INFO] total params:52.2195M
[2023-07-21 10:41:22,301][main.py][line:147][INFO] Training Mode
[2023-07-21 10:41:22,310][main.py][line:73][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 10:41:22,310][main.py][line:74][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 2
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 10:41:22,310][main.py][line:75][INFO] Optimizer_bert:Adagrad (
Parameter Group 0
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513

Parameter Group 1
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513

Parameter Group 2
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513

Parameter Group 3
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513
)

[2023-07-21 10:41:31,509][main.py][line:79][INFO] Random initialize AUC:0.6173 initial_AUC2:0.6194 FAR:0.02739
[2023-07-21 10:42:35,059][main.py][line:104][INFO] [Epoch:1/100]: loss1:0.3887 loss2:1.1476 main_loss:1.5362 | AUC:0.8206 AUC2:0.8190 FAR:0.00373
[2023-07-21 10:43:38,581][main.py][line:104][INFO] [Epoch:2/100]: loss1:0.1699 loss2:0.9332 main_loss:1.1031 | AUC:0.8306 AUC2:0.8277 FAR:0.00269
[2023-07-21 10:44:43,329][main.py][line:104][INFO] [Epoch:3/100]: loss1:0.0681 loss2:0.8294 main_loss:0.8975 | AUC:0.8407 AUC2:0.8370 FAR:0.00267
[2023-07-21 10:45:47,146][main.py][line:104][INFO] [Epoch:4/100]: loss1:0.0391 loss2:0.7387 main_loss:0.7778 | AUC:0.8341 AUC2:0.8370 FAR:0.00067
[2023-07-21 10:46:52,733][main.py][line:104][INFO] [Epoch:5/100]: loss1:0.0278 loss2:0.6635 main_loss:0.6913 | AUC:0.8388 AUC2:0.8370 FAR:0.00215
[2023-07-21 10:47:54,386][main.py][line:104][INFO] [Epoch:6/100]: loss1:0.0222 loss2:0.5996 main_loss:0.6218 | AUC:0.8354 AUC2:0.8370 FAR:0.00247
[2023-07-21 10:48:56,829][main.py][line:104][INFO] [Epoch:7/100]: loss1:0.0173 loss2:0.5342 main_loss:0.5515 | AUC:0.8390 AUC2:0.8370 FAR:0.00163
[2023-07-21 10:49:59,302][main.py][line:104][INFO] [Epoch:8/100]: loss1:0.0157 loss2:0.4846 main_loss:0.5004 | AUC:0.8322 AUC2:0.8370 FAR:0.00082
[2023-07-21 10:50:06,734][main.py][line:118][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8638.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 10:50:07,110][main.py][line:144][INFO] total params:52.3915M
[2023-07-21 10:50:07,110][main.py][line:147][INFO] Training Mode
[2023-07-21 10:50:07,119][main.py][line:73][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 10:50:07,119][main.py][line:74][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0

Parameter Group 2
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-07-21 10:50:07,119][main.py][line:75][INFO] Optimizer_bert:Adagrad (
Parameter Group 0
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513

Parameter Group 1
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513

Parameter Group 2
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513

Parameter Group 3
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513
)

[2023-07-21 10:50:27,766][main.py][line:79][INFO] Random initialize AUC:0.6172 initial_AUC2:0.6194 FAR:0.02739
[2023-07-21 10:52:25,267][main.py][line:104][INFO] [Epoch:1/100]: loss1:0.3669 loss2:1.0650 main_loss:1.4319 | AUC:0.8283 AUC2:0.8286 FAR:0.01242
[2023-07-21 10:54:32,214][main.py][line:104][INFO] [Epoch:2/100]: loss1:0.1425 loss2:0.8575 main_loss:1.0000 | AUC:0.8376 AUC2:0.8338 FAR:0.00220
[2023-07-21 10:56:46,426][main.py][line:104][INFO] [Epoch:3/100]: loss1:0.0624 loss2:0.7667 main_loss:0.8291 | AUC:0.8480 AUC2:0.8458 FAR:0.01097
[2023-07-21 10:58:51,953][main.py][line:104][INFO] [Epoch:4/100]: loss1:0.0381 loss2:0.6961 main_loss:0.7342 | AUC:0.8472 AUC2:0.8458 FAR:0.00294
[2023-07-21 11:00:58,932][main.py][line:104][INFO] [Epoch:5/100]: loss1:0.0275 loss2:0.6346 main_loss:0.6621 | AUC:0.8454 AUC2:0.8458 FAR:0.00188
[2023-07-21 11:03:05,773][main.py][line:104][INFO] [Epoch:6/100]: loss1:0.0161 loss2:0.5695 main_loss:0.5855 | AUC:0.8407 AUC2:0.8458 FAR:0.00190
[2023-07-21 11:22:57,879][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 11:22:58,243][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 11:22:58,243][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 11:22:58,243][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 11:22:58,255][main_bert_v2.py][line:56][INFO] Model:BertModel(
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 11:22:58,255][main_bert_v2.py][line:57][INFO] Optimizer:Adagrad (
Parameter Group 0
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513
)

[2023-07-21 11:23:19,600][main_bert_v2.py][line:60][INFO] Random initialize AUC:0.8632 initial_AUC2:0.8635 FAR:0.00620
[2023-07-21 11:25:19,932][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 11:25:20,277][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 11:25:20,277][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 11:25:20,277][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 11:25:20,286][main_bert_v2.py][line:56][INFO] Model:BertModel(
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 11:25:20,286][main_bert_v2.py][line:57][INFO] Optimizer:Adagrad (
Parameter Group 0
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513
)

[2023-07-21 11:25:40,699][main_bert_v2.py][line:60][INFO] Random initialize AUC:0.8632 initial_AUC2:0.8635 FAR:0.00620
[2023-07-21 11:27:01,163][main_bert_v2.py][line:77][INFO] [Epoch:1/100]: loss:0.4221 | AUC:0.8614 AUC2:0.8632 FAR:0.00622
[2023-07-21 11:28:28,119][main_bert_v2.py][line:77][INFO] [Epoch:2/100]: loss:0.3021 | AUC:0.8619 AUC2:0.8634 FAR:0.00605
[2023-07-21 11:30:02,078][main_bert_v2.py][line:77][INFO] [Epoch:3/100]: loss:0.2497 | AUC:0.8634 AUC2:0.8634 FAR:0.00613
[2023-07-21 11:31:32,117][main_bert_v2.py][line:77][INFO] [Epoch:4/100]: loss:0.2055 | AUC:0.8604 AUC2:0.8634 FAR:0.00622
[2023-07-21 11:33:07,122][main_bert_v2.py][line:77][INFO] [Epoch:5/100]: loss:0.1723 | AUC:0.8636 AUC2:0.8630 FAR:0.00637
[2023-07-21 11:34:31,500][main_bert_v2.py][line:77][INFO] [Epoch:6/100]: loss:0.1488 | AUC:0.8639 AUC2:0.8630 FAR:0.00605
[2023-07-21 11:36:02,252][main_bert_v2.py][line:77][INFO] [Epoch:7/100]: loss:0.1259 | AUC:0.8634 AUC2:0.8630 FAR:0.00615
[2023-07-21 11:37:35,404][main_bert_v2.py][line:77][INFO] [Epoch:8/100]: loss:0.1096 | AUC:0.8648 AUC2:0.8631 FAR:0.00625
[2023-07-21 11:39:07,112][main_bert_v2.py][line:77][INFO] [Epoch:9/100]: loss:0.0971 | AUC:0.8645 AUC2:0.8631 FAR:0.00608
[2023-07-21 11:40:37,911][main_bert_v2.py][line:77][INFO] [Epoch:10/100]: loss:0.0833 | AUC:0.8641 AUC2:0.8631 FAR:0.00605
[2023-07-21 11:42:04,388][main_bert_v2.py][line:77][INFO] [Epoch:11/100]: loss:0.0769 | AUC:0.8649 AUC2:0.8634 FAR:0.00627
[2023-07-21 11:43:29,072][main_bert_v2.py][line:77][INFO] [Epoch:12/100]: loss:0.0672 | AUC:0.8640 AUC2:0.8634 FAR:0.00647
[2023-07-21 11:44:54,760][main_bert_v2.py][line:77][INFO] [Epoch:13/100]: loss:0.0640 | AUC:0.8646 AUC2:0.8634 FAR:0.00627
[2023-07-21 11:46:33,040][main_bert_v2.py][line:77][INFO] [Epoch:14/100]: loss:0.0559 | AUC:0.8641 AUC2:0.8634 FAR:0.00613
[2023-07-21 11:47:54,192][main_bert_v2.py][line:77][INFO] [Epoch:15/100]: loss:0.0525 | AUC:0.8638 AUC2:0.8634 FAR:0.00650
[2023-07-21 11:49:28,451][main_bert_v2.py][line:77][INFO] [Epoch:16/100]: loss:0.0473 | AUC:0.8646 AUC2:0.8634 FAR:0.00632
[2023-07-21 11:51:05,548][main_bert_v2.py][line:77][INFO] [Epoch:17/100]: loss:0.0454 | AUC:0.8638 AUC2:0.8634 FAR:0.00617
[2023-07-21 11:52:37,344][main_bert_v2.py][line:77][INFO] [Epoch:18/100]: loss:0.0401 | AUC:0.8645 AUC2:0.8634 FAR:0.00620
[2023-07-21 11:54:03,999][main_bert_v2.py][line:77][INFO] [Epoch:19/100]: loss:0.0362 | AUC:0.8631 AUC2:0.8634 FAR:0.00605
[2023-07-21 11:55:34,457][main_bert_v2.py][line:77][INFO] [Epoch:20/100]: loss:0.0349 | AUC:0.8642 AUC2:0.8634 FAR:0.00605
[2023-07-21 11:57:00,297][main_bert_v2.py][line:77][INFO] [Epoch:21/100]: loss:0.0303 | AUC:0.8648 AUC2:0.8634 FAR:0.00613
[2023-07-21 11:58:45,875][main_bert_v2.py][line:77][INFO] [Epoch:22/100]: loss:0.0296 | AUC:0.8639 AUC2:0.8634 FAR:0.00603
[2023-07-21 12:00:19,824][main_bert_v2.py][line:77][INFO] [Epoch:23/100]: loss:0.0293 | AUC:0.8633 AUC2:0.8634 FAR:0.00645
[2023-07-21 12:01:57,359][main_bert_v2.py][line:77][INFO] [Epoch:24/100]: loss:0.0270 | AUC:0.8633 AUC2:0.8634 FAR:0.00613
[2023-07-21 12:03:10,606][main_bert_v2.py][line:77][INFO] [Epoch:25/100]: loss:0.0253 | AUC:0.8639 AUC2:0.8634 FAR:0.00605
[2023-07-21 12:04:23,636][main_bert_v2.py][line:77][INFO] [Epoch:26/100]: loss:0.0224 | AUC:0.8638 AUC2:0.8634 FAR:0.00595
[2023-07-21 12:05:45,357][main_bert_v2.py][line:77][INFO] [Epoch:27/100]: loss:0.0211 | AUC:0.8636 AUC2:0.8634 FAR:0.00627
[2023-07-21 12:10:18,807][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 12:10:19,178][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 12:10:19,178][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 12:10:19,178][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 12:10:19,192][main_bert_v2.py][line:56][INFO] Model:BertModel(
  (bert): BERT5(
    (embedding): BERTEmbedding2(
      (learnedPosition): LearnedPositionalEmbedding2()
      (dropout): Dropout(p=0.1, inplace=False)
    )
    (transformer_blocks): ModuleList(
      (0-3): 4 x TransformerBlock(
        (attention): MultiHeadedAttention(
          (linear_layers): ModuleList(
            (0-2): 3 x Linear(in_features=1024, out_features=1024, bias=True)
          )
          (output_linear): Linear(in_features=1024, out_features=1024, bias=True)
          (attention): Attention()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (feed_forward): PositionwiseFeedForward(
          (w_1): Linear(in_features=1024, out_features=4096, bias=True)
          (w_2): Linear(in_features=4096, out_features=1024, bias=True)
          (dropout): Dropout(p=0.1, inplace=False)
          (activation): GELU()
        )
        (input_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (output_sublayer): SublayerConnection(
          (norm): LayerNorm()
          (dropout): Dropout(p=0.1, inplace=False)
        )
        (dropout): Dropout(p=0.1, inplace=False)
      )
    )
  )
  (fc1_2): Linear(in_features=1024, out_features=512, bias=True)
  (fc2_2): Linear(in_features=512, out_features=128, bias=True)
  (fc3_2): Linear(in_features=128, out_features=1, bias=True)
  (drop_out): Dropout(p=0.1, inplace=False)
  (relu): ReLU()
  (sigmoid): Sigmoid()
)

[2023-07-21 12:10:19,192][main_bert_v2.py][line:57][INFO] Optimizer:Adagrad (
Parameter Group 0
    differentiable: False
    eps: 1e-10
    foreach: None
    initial_accumulator_value: 0
    initial_lr: 0.0001
    lr: 0.0001
    lr_decay: 0
    maximize: False
    weight_decay: 0.0010000000474974513
)

[2023-07-21 12:10:39,916][main_bert_v2.py][line:60][INFO] Random initialize AUC:0.8632 initial_AUC2:0.8635 FAR:0.00620
[2023-07-21 12:11:49,155][main_bert_v2.py][line:77][INFO] [Epoch:1/100]: loss:0.4221 | AUC:0.8618 AUC2:0.8632 FAR:0.00622
[2023-07-21 12:13:00,472][main_bert_v2.py][line:77][INFO] [Epoch:2/100]: loss:0.3021 | AUC:0.8622 AUC2:0.8634 FAR:0.00605
[2023-07-21 12:14:16,661][main_bert_v2.py][line:77][INFO] [Epoch:3/100]: loss:0.2497 | AUC:0.8637 AUC2:0.8634 FAR:0.00613
[2023-07-21 12:15:35,593][main_bert_v2.py][line:77][INFO] [Epoch:4/100]: loss:0.2055 | AUC:0.8609 AUC2:0.8634 FAR:0.00622
[2023-07-21 12:16:48,682][main_bert_v2.py][line:77][INFO] [Epoch:5/100]: loss:0.1723 | AUC:0.8637 AUC2:0.8634 FAR:0.00637
[2023-07-21 12:18:04,078][main_bert_v2.py][line:77][INFO] [Epoch:6/100]: loss:0.1488 | AUC:0.8641 AUC2:0.8630 FAR:0.00605
[2023-07-21 12:19:17,052][main_bert_v2.py][line:77][INFO] [Epoch:7/100]: loss:0.1259 | AUC:0.8633 AUC2:0.8630 FAR:0.00615
[2023-07-21 12:20:33,945][main_bert_v2.py][line:77][INFO] [Epoch:8/100]: loss:0.1096 | AUC:0.8648 AUC2:0.8631 FAR:0.00625
[2023-07-21 12:21:49,245][main_bert_v2.py][line:77][INFO] [Epoch:9/100]: loss:0.0971 | AUC:0.8644 AUC2:0.8631 FAR:0.00608
[2023-07-21 12:23:06,691][main_bert_v2.py][line:77][INFO] [Epoch:10/100]: loss:0.0833 | AUC:0.8638 AUC2:0.8631 FAR:0.00605
[2023-07-21 12:24:22,233][main_bert_v2.py][line:77][INFO] [Epoch:11/100]: loss:0.0769 | AUC:0.8647 AUC2:0.8631 FAR:0.00627
[2023-07-21 12:25:36,995][main_bert_v2.py][line:77][INFO] [Epoch:12/100]: loss:0.0672 | AUC:0.8641 AUC2:0.8631 FAR:0.00647
[2023-07-21 12:26:55,316][main_bert_v2.py][line:77][INFO] [Epoch:13/100]: loss:0.0640 | AUC:0.8646 AUC2:0.8631 FAR:0.00627
[2023-07-21 12:28:14,837][main_bert_v2.py][line:77][INFO] [Epoch:14/100]: loss:0.0559 | AUC:0.8641 AUC2:0.8631 FAR:0.00613
[2023-07-21 12:29:26,429][main_bert_v2.py][line:77][INFO] [Epoch:15/100]: loss:0.0525 | AUC:0.8631 AUC2:0.8631 FAR:0.00650
[2023-07-21 12:30:46,305][main_bert_v2.py][line:77][INFO] [Epoch:16/100]: loss:0.0473 | AUC:0.8645 AUC2:0.8631 FAR:0.00632
[2023-07-21 12:32:08,301][main_bert_v2.py][line:77][INFO] [Epoch:17/100]: loss:0.0454 | AUC:0.8641 AUC2:0.8631 FAR:0.00617
[2023-07-21 12:33:25,809][main_bert_v2.py][line:77][INFO] [Epoch:18/100]: loss:0.0401 | AUC:0.8654 AUC2:0.8633 FAR:0.00620
[2023-07-21 12:34:38,302][main_bert_v2.py][line:77][INFO] [Epoch:19/100]: loss:0.0362 | AUC:0.8630 AUC2:0.8633 FAR:0.00605
[2023-07-21 12:35:53,679][main_bert_v2.py][line:77][INFO] [Epoch:20/100]: loss:0.0349 | AUC:0.8645 AUC2:0.8633 FAR:0.00605
[2023-07-21 12:37:08,452][main_bert_v2.py][line:77][INFO] [Epoch:21/100]: loss:0.0303 | AUC:0.8649 AUC2:0.8633 FAR:0.00613
[2023-07-21 12:38:26,095][main_bert_v2.py][line:77][INFO] [Epoch:22/100]: loss:0.0296 | AUC:0.8645 AUC2:0.8633 FAR:0.00603
[2023-07-21 12:39:38,170][main_bert_v2.py][line:77][INFO] [Epoch:23/100]: loss:0.0293 | AUC:0.8639 AUC2:0.8633 FAR:0.00645
[2023-07-21 12:40:57,825][main_bert_v2.py][line:77][INFO] [Epoch:24/100]: loss:0.0270 | AUC:0.8637 AUC2:0.8633 FAR:0.00613
[2023-07-21 12:42:13,320][main_bert_v2.py][line:77][INFO] [Epoch:25/100]: loss:0.0253 | AUC:0.8639 AUC2:0.8633 FAR:0.00605
[2023-07-21 12:43:27,084][main_bert_v2.py][line:77][INFO] [Epoch:26/100]: loss:0.0224 | AUC:0.8639 AUC2:0.8633 FAR:0.00595
[2023-07-21 12:44:48,822][main_bert_v2.py][line:77][INFO] [Epoch:27/100]: loss:0.0211 | AUC:0.8639 AUC2:0.8633 FAR:0.00627
[2023-07-21 12:46:03,003][main_bert_v2.py][line:77][INFO] [Epoch:28/100]: loss:0.0213 | AUC:0.8642 AUC2:0.8633 FAR:0.00610
[2023-07-21 12:47:20,929][main_bert_v2.py][line:77][INFO] [Epoch:29/100]: loss:0.0207 | AUC:0.8647 AUC2:0.8633 FAR:0.00613
[2023-07-21 12:48:37,354][main_bert_v2.py][line:77][INFO] [Epoch:30/100]: loss:0.0191 | AUC:0.8640 AUC2:0.8633 FAR:0.00615
[2023-07-21 12:49:58,085][main_bert_v2.py][line:77][INFO] [Epoch:31/100]: loss:0.0166 | AUC:0.8652 AUC2:0.8633 FAR:0.00613
[2023-07-21 12:51:15,001][main_bert_v2.py][line:77][INFO] [Epoch:32/100]: loss:0.0167 | AUC:0.8642 AUC2:0.8633 FAR:0.00603
[2023-07-21 12:52:30,839][main_bert_v2.py][line:77][INFO] [Epoch:33/100]: loss:0.0153 | AUC:0.8640 AUC2:0.8633 FAR:0.00620
[2023-07-21 12:53:42,291][main_bert_v2.py][line:77][INFO] [Epoch:34/100]: loss:0.0134 | AUC:0.8641 AUC2:0.8633 FAR:0.00635
[2023-07-21 12:54:55,279][main_bert_v2.py][line:77][INFO] [Epoch:35/100]: loss:0.0140 | AUC:0.8623 AUC2:0.8633 FAR:0.00610
[2023-07-21 12:56:10,793][main_bert_v2.py][line:77][INFO] [Epoch:36/100]: loss:0.0123 | AUC:0.8634 AUC2:0.8633 FAR:0.00620
[2023-07-21 12:57:24,189][main_bert_v2.py][line:77][INFO] [Epoch:37/100]: loss:0.0126 | AUC:0.8634 AUC2:0.8633 FAR:0.00615
[2023-07-21 12:58:44,226][main_bert_v2.py][line:77][INFO] [Epoch:38/100]: loss:0.0119 | AUC:0.8620 AUC2:0.8633 FAR:0.00603
[2023-07-21 13:00:00,323][main_bert_v2.py][line:77][INFO] [Epoch:39/100]: loss:0.0095 | AUC:0.8627 AUC2:0.8633 FAR:0.00615
[2023-07-21 13:01:15,377][main_bert_v2.py][line:77][INFO] [Epoch:40/100]: loss:0.0091 | AUC:0.8615 AUC2:0.8633 FAR:0.00647
[2023-07-21 13:02:35,897][main_bert_v2.py][line:77][INFO] [Epoch:41/100]: loss:0.0090 | AUC:0.8613 AUC2:0.8633 FAR:0.00637
[2023-07-21 13:03:50,985][main_bert_v2.py][line:77][INFO] [Epoch:42/100]: loss:0.0078 | AUC:0.8621 AUC2:0.8633 FAR:0.00620
[2023-07-21 13:05:05,282][main_bert_v2.py][line:77][INFO] [Epoch:43/100]: loss:0.0077 | AUC:0.8630 AUC2:0.8633 FAR:0.00615
[2023-07-21 13:06:23,773][main_bert_v2.py][line:77][INFO] [Epoch:44/100]: loss:0.0077 | AUC:0.8633 AUC2:0.8633 FAR:0.00625
[2023-07-21 13:07:42,038][main_bert_v2.py][line:77][INFO] [Epoch:45/100]: loss:0.0076 | AUC:0.8621 AUC2:0.8633 FAR:0.00635
[2023-07-21 13:09:00,992][main_bert_v2.py][line:77][INFO] [Epoch:46/100]: loss:0.0080 | AUC:0.8609 AUC2:0.8633 FAR:0.00598
[2023-07-21 13:10:19,820][main_bert_v2.py][line:77][INFO] [Epoch:47/100]: loss:0.0072 | AUC:0.8608 AUC2:0.8633 FAR:0.00630
[2023-07-21 13:11:32,110][main_bert_v2.py][line:77][INFO] [Epoch:48/100]: loss:0.0065 | AUC:0.8623 AUC2:0.8633 FAR:0.00630
[2023-07-21 13:12:43,274][main_bert_v2.py][line:77][INFO] [Epoch:49/100]: loss:0.0063 | AUC:0.8616 AUC2:0.8633 FAR:0.00627
[2023-07-21 13:14:07,146][main_bert_v2.py][line:77][INFO] [Epoch:50/100]: loss:0.0064 | AUC:0.8621 AUC2:0.8633 FAR:0.00608
[2023-07-21 13:15:24,131][main_bert_v2.py][line:77][INFO] [Epoch:51/100]: loss:0.0061 | AUC:0.8619 AUC2:0.8633 FAR:0.00613
[2023-07-21 13:16:43,668][main_bert_v2.py][line:77][INFO] [Epoch:52/100]: loss:0.0062 | AUC:0.8619 AUC2:0.8633 FAR:0.00605
[2023-07-21 13:17:56,111][main_bert_v2.py][line:77][INFO] [Epoch:53/100]: loss:0.0058 | AUC:0.8619 AUC2:0.8633 FAR:0.00595
[2023-07-21 13:19:22,414][main_bert_v2.py][line:77][INFO] [Epoch:54/100]: loss:0.0059 | AUC:0.8624 AUC2:0.8633 FAR:0.00625
[2023-07-21 13:20:34,040][main_bert_v2.py][line:77][INFO] [Epoch:55/100]: loss:0.0055 | AUC:0.8627 AUC2:0.8633 FAR:0.00617
[2023-07-21 13:21:50,759][main_bert_v2.py][line:77][INFO] [Epoch:56/100]: loss:0.0054 | AUC:0.8623 AUC2:0.8633 FAR:0.00615
[2023-07-21 13:23:11,155][main_bert_v2.py][line:77][INFO] [Epoch:57/100]: loss:0.0057 | AUC:0.8622 AUC2:0.8633 FAR:0.00615
[2023-07-21 13:24:28,553][main_bert_v2.py][line:77][INFO] [Epoch:58/100]: loss:0.0054 | AUC:0.8623 AUC2:0.8633 FAR:0.00598
[2023-07-21 13:25:38,015][main_bert_v2.py][line:77][INFO] [Epoch:59/100]: loss:0.0057 | AUC:0.8623 AUC2:0.8633 FAR:0.00650
[2023-07-21 13:26:56,183][main_bert_v2.py][line:77][INFO] [Epoch:60/100]: loss:0.0059 | AUC:0.8624 AUC2:0.8633 FAR:0.00640
[2023-07-21 13:28:17,323][main_bert_v2.py][line:77][INFO] [Epoch:61/100]: loss:0.0059 | AUC:0.8628 AUC2:0.8633 FAR:0.00608
[2023-07-21 13:29:30,246][main_bert_v2.py][line:77][INFO] [Epoch:62/100]: loss:0.0056 | AUC:0.8628 AUC2:0.8633 FAR:0.00615
[2023-07-21 13:30:45,683][main_bert_v2.py][line:77][INFO] [Epoch:63/100]: loss:0.0055 | AUC:0.8628 AUC2:0.8633 FAR:0.00625
[2023-07-21 13:31:59,473][main_bert_v2.py][line:77][INFO] [Epoch:64/100]: loss:0.0059 | AUC:0.8625 AUC2:0.8633 FAR:0.00605
[2023-07-21 13:33:15,335][main_bert_v2.py][line:77][INFO] [Epoch:65/100]: loss:0.0057 | AUC:0.8626 AUC2:0.8633 FAR:0.00598
[2023-07-21 13:36:44,123][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:36:44,500][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:36:44,500][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:36:44,500][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:36:44,506][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:37:01,026][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:37:01,361][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:37:01,361][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:37:01,361][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:37:01,364][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:37:35,773][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:37:36,095][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:37:36,095][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:37:36,095][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:37:36,098][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:38:12,482][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:38:12,807][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:38:12,807][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:38:12,807][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:38:12,809][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:38:29,800][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:38:30,135][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:38:30,135][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:38:30,135][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:38:30,138][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:39:02,876][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:39:03,216][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:39:03,216][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:39:03,216][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:39:03,218][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:39:20,767][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-21 13:39:21,100][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-21 13:39:21,100][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-21 13:39:21,100][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-21 13:39:21,102][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-21 13:39:42,610][infer_bert_v2.py][line:70][INFO] offline AUC:0.8681 AUC2:0.8676 AP:0.3320 FAR:0.0050 | Complete in 0m 21s

[2023-07-22 11:44:14,991][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-22 11:44:15,325][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-22 11:44:15,325][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-22 11:44:15,325][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-22 11:44:15,327][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-22 11:44:41,184][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-22 11:44:41,521][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-22 11:44:41,521][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-22 11:44:41,521][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-22 11:44:41,524][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-22 11:45:02,663][infer_bert_v2.py][line:71][INFO] offline AUC:0.8667 AUC2:0.8676 AP:0.3294 FAR:0.0050 | Complete in 0m 21s

[2023-07-22 11:46:43,072][main_bert_v2.py][line:91][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-07-22 11:46:43,399][main_bert_v2.py][line:119][INFO] total params:51.1823M
[2023-07-22 11:46:43,400][main_bert_v2.py][line:121][INFO] Train BERT Mode
[2023-07-22 11:46:43,400][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/ucf__8636.pkl.
[2023-07-22 11:46:43,402][main_bert_v2.py][line:27][INFO] loading pretrained checkpoint from ./ckpt/bert_current.pkl.
[2023-07-22 11:47:04,663][infer_bert_v2.py][line:70][INFO] offline AUC:0.8681 AUC2:0.8676 AP:0.3320 FAR:0.0050 | Complete in 0m 21s

[2023-08-21 18:10:41,056][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:10:41,157][main.py][line:120][INFO] total params:1.2091M
[2023-08-21 18:10:41,157][main.py][line:123][INFO] Training Mode
[2023-08-21 18:10:41,157][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 18:10:41,157][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 18:11:33,067][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:11:33,160][main.py][line:120][INFO] total params:1.2091M
[2023-08-21 18:11:33,160][main.py][line:123][INFO] Training Mode
[2023-08-21 18:11:33,161][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 18:11:33,161][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 18:42:46,239][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:43:34,870][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:45:12,918][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:46:06,383][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 128, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:46:24,920][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:47:05,726][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:48:16,614][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 18:48:16,689][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 18:48:16,689][main.py][line:129][INFO] Training Mode
[2023-08-21 20:49:21,258][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 20:49:21,330][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 20:49:21,330][main.py][line:129][INFO] Training Mode
[2023-08-21 20:49:21,330][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 20:49:21,330][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 20:55:09,587][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 20:55:09,663][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 20:55:09,664][main.py][line:129][INFO] Training Mode
[2023-08-21 20:55:09,664][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 20:55:09,664][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 20:58:58,676][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 20:58:58,751][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 20:58:58,751][main.py][line:129][INFO] Training Mode
[2023-08-21 20:58:58,751][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 20:58:58,751][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 20:59:34,705][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 20:59:34,776][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 20:59:34,776][main.py][line:129][INFO] Training Mode
[2023-08-21 20:59:34,777][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 20:59:34,777][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 21:00:49,663][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 21:00:49,736][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 21:00:49,736][main.py][line:129][INFO] Training Mode
[2023-08-21 21:00:49,736][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 21:00:49,736][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 21:01:05,612][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 21:01:05,705][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 21:01:05,705][main.py][line:129][INFO] Training Mode
[2023-08-21 21:01:05,705][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 21:01:05,705][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 21:01:10,471][main.py][line:58][INFO] Random initialize AUCAUC:0.4984 Anomaly AUC:0.51606
[2023-08-21 21:01:25,712][main.py][line:94][INFO] Config:{'dataset': 'ucf-crime', 'model_name': 'ucf_', 'metrics': 'AUC', 'feat_prefix': './data/ucf-i3d', 'train_list': './list/ucf/train.list', 'test_list': './list/ucf/test.list', 'token_feat': './list/ucf/ucf-prompt.npy', 'gt': './list/ucf/ucf-gt.npy', 'win_size': 9, 'gamma': 0.6, 'bias': 0.2, 'norm': True, 't_step': 9, 'temp': 0.09, 'lamda': 1.0, 'seed': 9, 'test_bs': 10, 'smooth': 'slide', 'kappa': 7, 'ckpt_path': './ckpt/ucf__8636.pkl', 'ckpt_bert_path': './ckpt/bert_current.pkl', 'bert': True, 'beta': 0.5, 'feat_dim': 1024, 'head_num': 1, 'hid_dim': 32, 'out_dim': 300, 'lr': 0.0005, 'dropout': 0.1, 'train_bs': 128, 'max_seqlen': 200, 'max_epoch': 100, 'workers': 8, 'save_dir': './ckpt/', 'logs_dir': './log_info.log'}
[2023-08-21 21:01:25,797][main.py][line:126][INFO] total params:0.8156M
[2023-08-21 21:01:25,797][main.py][line:129][INFO] Training Mode
[2023-08-21 21:01:25,797][main.py][line:54][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=32, bias=True)
      (k): Linear(in_features=1024, out_features=32, bias=True)
      (v): Linear(in_features=1024, out_features=32, bias=True)
      (o): Linear(in_features=32, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
)

[2023-08-21 21:01:25,797][main.py][line:55][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)

[2023-08-21 21:01:31,054][main.py][line:58][INFO] Random initialize AUCAUC:0.4984 Anomaly AUC:0.51606
