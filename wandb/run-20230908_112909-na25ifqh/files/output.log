[2023-09-08 11:29:11,060][main.py][line:297][INFO] total params:1.2091M
[2023-09-08 11:29:11,060][main.py][line:300][INFO] Training Mode
8000 8100 2900
[2023-09-08 11:29:16,174][main.py][line:160][INFO] Random initialize AUCAUC:0.4774 Anomaly AUC:0.48817
[2023-09-08 11:29:20,227][main.py][line:163][INFO] Random initialize AUCAUC:0.3413 Anomaly AUC:0.50247









































Predict video 8100 | num abnormal video:713: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8100/8100 [01:22<00:00, 98.09it/s]
28856360
New train anomaly dataset length : 28856360
[2023-09-08 11:31:09,937][main.py][line:217][INFO] [Epoch:1/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0421 loss2:0.1215 loss3:1.0124 co-loss:0.6325 | PEL.AUC:0.5600 An-AUC:0.5787, UR.AUC:0.5345 An-AUC:0.5581
[2023-09-08 11:31:36,285][main.py][line:217][INFO] [Epoch:2/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0011 loss2:0.0436 loss3:0.6989 co-loss:0.2979 | PEL.AUC:0.5449 An-AUC:0.5680, UR.AUC:0.5443 An-AUC:0.5658
[2023-09-08 11:32:03,282][main.py][line:217][INFO] [Epoch:3/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0007 loss2:0.0298 loss3:0.4997 co-loss:0.1030 | PEL.AUC:0.5390 An-AUC:0.5624, UR.AUC:0.5649 An-AUC:0.5711
[2023-09-08 11:32:29,639][main.py][line:217][INFO] [Epoch:4/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0004 loss2:0.0205 loss3:0.4344 co-loss:0.0427 | PEL.AUC:0.5263 An-AUC:0.5555, UR.AUC:0.5743 An-AUC:0.5735
[2023-09-08 11:32:56,275][main.py][line:217][INFO] [Epoch:5/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0002 loss2:0.0160 loss3:0.4098 co-loss:0.0213 | PEL.AUC:0.5161 An-AUC:0.5459, UR.AUC:0.5814 An-AUC:0.5758
[2023-09-08 11:33:22,909][main.py][line:217][INFO] [Epoch:6/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0002 loss2:0.0134 loss3:0.3977 co-loss:0.0120 | PEL.AUC:0.5162 An-AUC:0.5437, UR.AUC:0.5860 An-AUC:0.5777
[2023-09-08 11:33:49,779][main.py][line:217][INFO] [Epoch:7/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0001 loss2:0.0112 loss3:0.3904 co-loss:0.0072 | PEL.AUC:0.5000 An-AUC:0.5310, UR.AUC:0.5891 An-AUC:0.5793
[2023-09-08 11:34:16,384][main.py][line:217][INFO] [Epoch:8/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0001 loss2:0.0097 loss3:0.3849 co-loss:0.0046 | PEL.AUC:0.4871 An-AUC:0.5235, UR.AUC:0.5925 An-AUC:0.5804
[2023-09-08 11:34:43,657][main.py][line:217][INFO] [Epoch:9/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0001 loss2:0.0086 loss3:0.3802 co-loss:0.0030 | PEL.AUC:0.4729 An-AUC:0.5158, UR.AUC:0.5956 An-AUC:0.5814
[2023-09-08 11:35:11,177][main.py][line:217][INFO] [Epoch:10/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0000 loss2:0.0077 loss3:0.3756 co-loss:0.0020 | PEL.AUC:0.4668 An-AUC:0.5139, UR.AUC:0.5986 An-AUC:0.5825
[2023-09-08 11:35:37,637][main.py][line:217][INFO] [Epoch:11/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0000 loss2:0.0069 loss3:0.3707 co-loss:0.0013 | PEL.AUC:0.4604 An-AUC:0.5110, UR.AUC:0.6006 An-AUC:0.5834
[2023-09-08 11:36:04,596][main.py][line:217][INFO] [Epoch:12/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0000 loss2:0.0062 loss3:0.3652 co-loss:0.0009 | PEL.AUC:0.4580 An-AUC:0.5094, UR.AUC:0.6013 An-AUC:0.5837
[2023-09-08 11:36:31,463][main.py][line:217][INFO] [Epoch:13/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0000 loss2:0.0055 loss3:0.3589 co-loss:0.0005 | PEL.AUC:0.4537 An-AUC:0.5057, UR.AUC:0.6028 An-AUC:0.5848
[2023-09-08 11:36:58,138][main.py][line:217][INFO] [Epoch:14/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0000 loss2:0.0049 loss3:0.3517 co-loss:0.0003 | PEL.AUC:0.4513 An-AUC:0.5038, UR.AUC:0.6044 An-AUC:0.5858
[2023-09-08 11:37:24,724][main.py][line:217][INFO] [Epoch:15/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0000 loss2:0.0043 loss3:0.3435 co-loss:0.0002 | PEL.AUC:0.4517 An-AUC:0.5045, UR.AUC:0.6050 An-AUC:0.5861
[2023-09-08 11:37:51,669][main.py][line:217][INFO] [Epoch:16/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0000 loss2:0.0038 loss3:0.3342 co-loss:0.0001 | PEL.AUC:0.4535 An-AUC:0.5050, UR.AUC:0.6074 An-AUC:0.5869
[2023-09-08 11:38:19,014][main.py][line:217][INFO] [Epoch:17/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0000 loss2:0.0034 loss3:0.2885 co-loss:0.0001 | PEL.AUC:0.4518 An-AUC:0.5056, UR.AUC:0.6073 An-AUC:0.5873
[2023-09-08 11:38:46,062][main.py][line:217][INFO] [Epoch:18/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0000 loss2:0.0030 loss3:0.2176 co-loss:0.0000 | PEL.AUC:0.4587 An-AUC:0.5067, UR.AUC:0.5594 An-AUC:0.5488
[2023-09-08 11:39:12,747][main.py][line:217][INFO] [Epoch:19/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0000 loss2:0.0026 loss3:0.2050 co-loss:0.0000 | PEL.AUC:0.4596 An-AUC:0.5094, UR.AUC:0.4992 An-AUC:0.4977
[2023-09-08 11:39:39,856][main.py][line:217][INFO] [Epoch:20/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0000 loss2:0.0023 loss3:0.1919 co-loss:0.0000 | PEL.AUC:0.4662 An-AUC:0.5124, UR.AUC:0.5000 An-AUC:0.5000
[2023-09-08 11:40:07,280][main.py][line:217][INFO] [Epoch:21/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0000 loss2:0.0020 loss3:0.1784 co-loss:0.0000 | PEL.AUC:0.4680 An-AUC:0.5126, UR.AUC:0.5000 An-AUC:0.5000
[2023-09-08 11:40:34,276][main.py][line:217][INFO] [Epoch:22/100]: pel-lr:5.0000e-05 ur-lr:5.0000e-07| loss1:0.0000 loss2:0.0017 loss3:0.1648 co-loss:0.0000 | PEL.AUC:0.4660 An-AUC:0.5110, UR.AUC:0.5000 An-AUC:0.5000
Traceback (most recent call last):
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 336, in <module>
    main(cfg)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 302, in main
    train(pel_model, ur_model, train_nloader, train_aloader, test_loader, gt, logger)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 198, in train
    ur_auc, ur_ab_auc = test_func_ur(test_loader, ur_model, gt, cfg.dataset)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/test.py", line 77, in test_func_ur
    tmp = model(x.unsqueeze(0))
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/DR_DMU/model.py", line 64, in forward
    x = self.selfatt(x)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/DR_DMU/translayer.py", line 76, in forward
    x = attn(x) + x
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/DR_DMU/translayer.py", line 14, in forward
    return self.fn(self.norm(x), **kwargs)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/DR_DMU/translayer.py", line 58, in forward
    attn2 = torch.exp(-tg_tmp / torch.exp(torch.tensor(1.)))
KeyboardInterrupt