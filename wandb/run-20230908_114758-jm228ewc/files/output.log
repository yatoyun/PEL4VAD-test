[2023-09-08 11:48:00,865][main.py][line:299][INFO] total params:1.2091M
[2023-09-08 11:48:00,865][main.py][line:302][INFO] Training Mode
8000 8100 2900
[2023-09-08 11:48:05,769][main.py][line:162][INFO] Random initialize AUCAUC:0.4774 Anomaly AUC:0.48817
[2023-09-08 11:48:09,798][main.py][line:165][INFO] Random initialize AUCAUC:0.3413 Anomaly AUC:0.50247
Predict video 60 | num abnormal video:5:   1%|█▏                                                                                                                                                                 | 57/8100 [00:00<01:40, 80.22it/s]
len old train dataset : 8100
pred : torch.Size([170])
len index_list : 90
pred : torch.Size([54])
len index_list : 280
pred : torch.Size([231])
len index_list : 570
pred : torch.Size([1049])
len index_list : 960
pred : torch.Size([59])
Predict video 309 | num abnormal video:29:   4%|██████                                                                                                                                                         | 309/8100 [00:02<01:06, 116.39it/s]Exception in thread Thread-7 (_pin_memory_loop):
Traceback (most recent call last):
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/utils/data/_utils/pin_memory.py", line 51, in _pin_memory_loop
    do_one_step()
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in do_one_step
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 307, in rebuild_storage_fd
    fd = df.detach()
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/multiprocessing/connection.py", line 502, in Client
    c = SocketClient(address)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/multiprocessing/connection.py", line 630, in SocketClient
    s.connect(address)
FileNotFoundError: [Errno 2] No such file or directory
Predict video 309 | num abnormal video:29:   4%|██████                                                                                                                                                         | 309/8100 [00:02<01:12, 107.76it/s]
Traceback (most recent call last):
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 338, in <module>
    main(cfg)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 304, in main
    train(pel_model, ur_model, train_nloader, train_aloader, test_loader, gt, logger)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 171, in train
    index_list, frame_num_dict = make_new_dataset(pel_best_model_wts, ur_best_model_wts, train_aloader, 0.9)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 87, in make_new_dataset
    logits_pel, _ = pel_model(v_input, seq_len)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/model.py", line 34, in forward
    x_e, x_v = self.self_attention(x, seq_len)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/modules.py", line 23, in forward
    mask = self.get_mask(self.win_size, x.shape[1], seq_len)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/modules.py", line 44, in get_mask
    m[j, min(max(j - w_len // 2 + k, 0), temporal_scale - 1)] = 1.
KeyboardInterrupt
pred : torch.Size([273])
len index_list : 2040
pred : torch.Size([71])
len index_list : 2730
pred : torch.Size([525])
len index_list : 3520
pred : torch.Size([62])
len index_list : 4410
pred : torch.Size([70])
len index_list : 5400
pred : torch.Size([227])
len index_list : 6490
pred : torch.Size([320])
len index_list : 7680
pred : torch.Size([304])
len index_list : 8970
pred : torch.Size([161])
len index_list : 10360
pred : torch.Size([492])
len index_list : 11850
pred : torch.Size([87])
len index_list : 13440
pred : torch.Size([119])
len index_list : 15130
pred : torch.Size([151])
len index_list : 16920
pred : torch.Size([246])
len index_list : 18810
pred : torch.Size([193])
len index_list : 20800
pred : torch.Size([119])
len index_list : 22890
pred : torch.Size([176])
len index_list : 25080
pred : torch.Size([61])
len index_list : 27370
pred : torch.Size([63])
len index_list : 29760
pred : torch.Size([126])
len index_list : 32250
pred : torch.Size([124])
len index_list : 34840
pred : torch.Size([273])
len index_list : 37530
pred : torch.Size([18])
len index_list : 37530
pred : torch.Size([277])
len index_list : 40420
pred : torch.Size([296])
len index_list : 43410