
8000 8100 2900
[2023-09-08 11:51:12,364][main.py][line:299][INFO] total params:1.2091M
[2023-09-08 11:51:12,364][main.py][line:302][INFO] Training Mode
[2023-09-08 11:51:17,404][main.py][line:162][INFO] Random initialize AUCAUC:0.4774 Anomaly AUC:0.48817
len old train dataset : 8100
pred : torch.Size([170])
len index_list : 10
pred : torch.Size([54])
len index_list : 20
pred : torch.Size([231])
len index_list : 30
[2023-09-08 11:51:21,459][main.py][line:165][INFO] Random initialize AUCAUC:0.3413 Anomaly AUC:0.50247
Predict video 38 | num abnormal video:3:   0%|▋                                                                                                                                                                  | 32/8100 [00:00<01:28, 90.99it/s]
pred : torch.Size([1049])
len index_list : 40
pred : torch.Size([59])
len index_list : 50
pred : torch.Size([273])
len index_list : 60
pred : torch.Size([71])
len index_list : 70
pred : torch.Size([525])
len index_list : 80
pred : torch.Size([62])
len index_list : 90
pred : torch.Size([70])
len index_list : 100
pred : torch.Size([227])
len index_list : 110
pred : torch.Size([320])
len index_list : 120
pred : torch.Size([304])
len index_list : 130
pred : torch.Size([161])
len index_list : 140
pred : torch.Size([492])
len index_list : 150
pred : torch.Size([87])
len index_list : 160
pred : torch.Size([119])
Predict video 172 | num abnormal video:17:   2%|███▍                                                                                                                                                            | 172/8100 [00:01<01:26, 91.56it/s]
Traceback (most recent call last):
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 338, in <module>
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 304, in main
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 171, in train
    train_anomaly_data = Subset(train_anomaly_data, index_list)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 87, in make_new_dataset
    logits_pel, _ = pel_model(v_input, seq_len)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/model.py", line 34, in forward
    x_e, x_v = self.self_attention(x, seq_len)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/modules.py", line 23, in forward
    mask = self.get_mask(self.win_size, x.shape[1], seq_len)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/modules.py", line 44, in get_mask
    m[j, min(max(j - w_len // 2 + k, 0), temporal_scale - 1)] = 1.
KeyboardInterrupt