[2023-09-08 12:18:34,785][main.py][line:300][INFO] total params:1.2091M
[2023-09-08 12:18:34,785][main.py][line:303][INFO] Training Mode
8000 8100 2900
[2023-09-08 12:18:39,908][main.py][line:163][INFO] Random initialize AUCAUC:0.4774 Anomaly AUC:0.48817
len old train dataset : 8100
[2023-09-08 12:18:43,977][main.py][line:166][INFO] Random initialize AUCAUC:0.3413 Anomaly AUC:0.50247








































Predict video 8042 | num abnormal video:708:  99%|██████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▊ | 8039/8100 [01:20<00:00, 125.08it/s]
num videos : 7140
num frames : 23336

Predict video 8100 | num abnormal video:713: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8100/8100 [01:21<00:00, 99.44it/s]
[2023-09-08 12:20:29,483][main.py][line:220][INFO] [Epoch:1/100]: pel-lr:5.0000e-05 ur-lr:1.0000e-05| loss1:0.1811 loss2:0.9309 loss3:0.5204 co-loss:0.1679 | PEL.AUC:0.8021 An-AUC:0.6600, UR.AUC:0.7901 An-AUC:0.5993
[2023-09-08 12:20:53,214][main.py][line:220][INFO] [Epoch:2/100]: pel-lr:5.0000e-05 ur-lr:1.0000e-05| loss1:0.0477 loss2:0.7607 loss3:0.3204 co-loss:0.0365 | PEL.AUC:0.8034 An-AUC:0.6546, UR.AUC:0.7884 An-AUC:0.5984
[2023-09-08 12:21:17,564][main.py][line:220][INFO] [Epoch:3/100]: pel-lr:5.0000e-05 ur-lr:1.0000e-05| loss1:0.0252 loss2:0.7051 loss3:0.2533 co-loss:0.0208 | PEL.AUC:0.8065 An-AUC:0.6514, UR.AUC:0.7804 An-AUC:0.6041
[2023-09-08 12:21:41,526][main.py][line:220][INFO] [Epoch:4/100]: pel-lr:5.0000e-05 ur-lr:1.0000e-05| loss1:0.0135 loss2:0.6624 loss3:0.1798 co-loss:0.0141 | PEL.AUC:0.8102 An-AUC:0.6536, UR.AUC:0.7809 An-AUC:0.6025
[2023-09-08 12:22:05,261][main.py][line:220][INFO] [Epoch:5/100]: pel-lr:5.0000e-05 ur-lr:1.0000e-05| loss1:0.0072 loss2:0.6243 loss3:0.1070 co-loss:0.0110 | PEL.AUC:0.8078 An-AUC:0.6520, UR.AUC:0.6384 An-AUC:0.5540
[2023-09-08 12:22:29,189][main.py][line:220][INFO] [Epoch:6/100]: pel-lr:5.0000e-05 ur-lr:1.0000e-05| loss1:0.0053 loss2:0.5921 loss3:0.0585 co-loss:0.0069 | PEL.AUC:0.8072 An-AUC:0.6519, UR.AUC:0.6836 An-AUC:0.5694
[2023-09-08 12:22:52,978][main.py][line:220][INFO] [Epoch:7/100]: pel-lr:5.0000e-05 ur-lr:1.0000e-05| loss1:0.0041 loss2:0.5542 loss3:0.0355 co-loss:0.0064 | PEL.AUC:0.8104 An-AUC:0.6496, UR.AUC:0.6785 An-AUC:0.5695
[2023-09-08 12:23:17,116][main.py][line:220][INFO] [Epoch:8/100]: pel-lr:5.0000e-05 ur-lr:1.0000e-05| loss1:0.0037 loss2:0.5219 loss3:0.0231 co-loss:0.0025 | PEL.AUC:0.8162 An-AUC:0.6508, UR.AUC:0.6037 An-AUC:0.5534
[2023-09-08 12:23:40,953][main.py][line:220][INFO] [Epoch:9/100]: pel-lr:5.0000e-05 ur-lr:1.0000e-05| loss1:0.0029 loss2:0.4867 loss3:0.0222 co-loss:0.0052 | PEL.AUC:0.8068 An-AUC:0.6455, UR.AUC:0.6446 An-AUC:0.5571
[2023-09-08 12:24:04,968][main.py][line:220][INFO] [Epoch:10/100]: pel-lr:5.0000e-05 ur-lr:1.0000e-05| loss1:0.0027 loss2:0.4565 loss3:0.0143 co-loss:0.0009 | PEL.AUC:0.8164 An-AUC:0.6460, UR.AUC:0.5822 An-AUC:0.5515
Traceback (most recent call last):
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 339, in <module>
    main(cfg)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 305, in main
    train(pel_model, ur_model, train_nloader, train_aloader, test_loader, gt, logger)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 191, in train
    loss1, loss2, cost, co_loss = train_func(train_nloader, train_aloader, pel_model, pel_optimizer, ur_model, ur_optimizer, criterion, criterion2, criterion3, logger_wandb)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/train.py", line 38, in train_func
    x_k = ur_model(v_input)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/DR_DMU/model.py", line 64, in forward
    x = self.selfatt(x)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/DR_DMU/translayer.py", line 76, in forward
    x = attn(x) + x
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/DR_DMU/translayer.py", line 14, in forward
    return self.fn(self.norm(x), **kwargs)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/DR_DMU/translayer.py", line 63, in forward
    return self.to_out(out)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1495, in _call_impl
    forward_call = (self._slow_forward if torch._C._get_tracing_state() else self.forward)
KeyboardInterrupt