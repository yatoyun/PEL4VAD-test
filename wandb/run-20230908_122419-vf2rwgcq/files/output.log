
8000 8100 2900
[2023-09-08 12:24:21,150][main.py][line:300][INFO] total params:1.2091M
[2023-09-08 12:24:21,150][main.py][line:303][INFO] Training Mode
[2023-09-08 12:24:26,019][main.py][line:163][INFO] Random initialize AUCAUC:0.4774 Anomaly AUC:0.48817
len old train dataset : 8100
[2023-09-08 12:24:30,044][main.py][line:166][INFO] Random initialize AUCAUC:0.3413 Anomaly AUC:0.50247







































Predict video 7854 | num abnormal video:690:  97%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▏    | 7849/8100 [01:19<00:02, 90.40it/s]
num videos : 7140
num frames : 23336

Predict video 8100 | num abnormal video:713: 100%|████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8100/8100 [01:20<00:00, 100.23it/s]
[2023-09-08 12:26:14,792][main.py][line:220][INFO] [Epoch:1/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.4645 loss2:1.1487 loss3:0.6208 co-loss:0.2532 | PEL.AUC:0.7722 An-AUC:0.6494, UR.AUC:0.7817 An-AUC:0.5969
[2023-09-08 12:26:38,639][main.py][line:220][INFO] [Epoch:2/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.1647 loss2:0.9451 loss3:0.3831 co-loss:0.0518 | PEL.AUC:0.7882 An-AUC:0.6547, UR.AUC:0.7858 An-AUC:0.5979
[2023-09-08 12:27:02,561][main.py][line:220][INFO] [Epoch:3/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.1025 loss2:0.8746 loss3:0.3216 co-loss:0.0293 | PEL.AUC:0.7961 An-AUC:0.6564, UR.AUC:0.7857 An-AUC:0.5991
[2023-09-08 12:27:26,714][main.py][line:220][INFO] [Epoch:4/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0772 loss2:0.8346 loss3:0.2841 co-loss:0.0192 | PEL.AUC:0.7983 An-AUC:0.6559, UR.AUC:0.7805 An-AUC:0.6005
[2023-09-08 12:27:50,408][main.py][line:220][INFO] [Epoch:5/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0612 loss2:0.8061 loss3:0.2457 co-loss:0.0107 | PEL.AUC:0.7973 An-AUC:0.6546, UR.AUC:0.7763 An-AUC:0.5982
[2023-09-08 12:28:14,235][main.py][line:220][INFO] [Epoch:6/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0505 loss2:0.7876 loss3:0.2071 co-loss:0.0108 | PEL.AUC:0.7988 An-AUC:0.6552, UR.AUC:0.7718 An-AUC:0.6021
[2023-09-08 12:28:38,336][main.py][line:220][INFO] [Epoch:7/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0415 loss2:0.7639 loss3:0.1616 co-loss:0.0076 | PEL.AUC:0.8005 An-AUC:0.6544, UR.AUC:0.6778 An-AUC:0.5677
[2023-09-08 12:29:02,089][main.py][line:220][INFO] [Epoch:8/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0340 loss2:0.7494 loss3:0.1157 co-loss:0.0065 | PEL.AUC:0.8015 An-AUC:0.6551, UR.AUC:0.5974 An-AUC:0.5617
[2023-09-08 12:29:25,743][main.py][line:220][INFO] [Epoch:9/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0284 loss2:0.7320 loss3:0.0910 co-loss:0.0134 | PEL.AUC:0.8028 An-AUC:0.6537, UR.AUC:0.6172 An-AUC:0.5570
[2023-09-08 12:29:49,737][main.py][line:220][INFO] [Epoch:10/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0239 loss2:0.7207 loss3:0.0518 co-loss:0.0012 | PEL.AUC:0.8024 An-AUC:0.6531, UR.AUC:0.5933 An-AUC:0.5489
[2023-09-08 12:30:13,311][main.py][line:220][INFO] [Epoch:11/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0200 loss2:0.7073 loss3:0.0371 co-loss:0.0036 | PEL.AUC:0.8046 An-AUC:0.6536, UR.AUC:0.5677 An-AUC:0.5424
[2023-09-08 12:30:37,535][main.py][line:220][INFO] [Epoch:12/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0173 loss2:0.6967 loss3:0.0292 co-loss:0.0044 | PEL.AUC:0.8036 An-AUC:0.6533, UR.AUC:0.5993 An-AUC:0.5457
[2023-09-08 12:31:01,477][main.py][line:220][INFO] [Epoch:13/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0139 loss2:0.6862 loss3:0.0220 co-loss:0.0020 | PEL.AUC:0.8058 An-AUC:0.6536, UR.AUC:0.5580 An-AUC:0.5339
[2023-09-08 12:31:25,338][main.py][line:220][INFO] [Epoch:14/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0115 loss2:0.6800 loss3:0.0166 co-loss:0.0000 | PEL.AUC:0.8065 An-AUC:0.6532, UR.AUC:0.5295 An-AUC:0.5137
[2023-09-08 12:31:49,395][main.py][line:220][INFO] [Epoch:15/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0094 loss2:0.6631 loss3:0.0242 co-loss:0.0090 | PEL.AUC:0.8080 An-AUC:0.6528, UR.AUC:0.5881 An-AUC:0.5545
[2023-09-08 12:32:13,346][main.py][line:220][INFO] [Epoch:16/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0082 loss2:0.6550 loss3:0.0159 co-loss:0.0026 | PEL.AUC:0.8075 An-AUC:0.6512, UR.AUC:0.5742 An-AUC:0.5479
[2023-09-08 12:32:37,064][main.py][line:220][INFO] [Epoch:17/100]: pel-lr:1.0000e-05 ur-lr:5.0000e-06| loss1:0.0071 loss2:0.6408 loss3:0.0135 co-loss:0.0013 | PEL.AUC:0.8089 An-AUC:0.6513, UR.AUC:0.6108 An-AUC:0.5587
Traceback (most recent call last):
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 339, in <module>
    main(cfg)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 305, in main
    train(pel_model, ur_model, train_nloader, train_aloader, test_loader, gt, logger)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 191, in train
    loss1, loss2, cost, co_loss = train_func(train_nloader, train_aloader, pel_model, pel_optimizer, ur_model, ur_optimizer, criterion, criterion2, criterion3, logger_wandb)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/train.py", line 35, in train_func
    logits, v_feat = pel_model(v_input, seq_len)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/model.py", line 34, in forward
    x_e, x_v = self.self_attention(x, seq_len)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/modules.py", line 23, in forward
    mask = self.get_mask(self.win_size, x.shape[1], seq_len)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/modules.py", line 44, in get_mask
    m[j, min(max(j - w_len // 2 + k, 0), temporal_scale - 1)] = 1.
KeyboardInterrupt