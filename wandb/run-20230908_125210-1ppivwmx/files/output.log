[2023-09-08 12:52:13,389][main.py][line:44][INFO] loading pretrained checkpoint from ./ckpt/original__8636.pkl.
[2023-09-08 12:52:13,414][main.py][line:44][INFO] loading pretrained checkpoint from ./ckpt/ucf_trans_2022.pkl.
[2023-09-08 12:52:13,422][main.py][line:300][INFO] total params:1.2091M
[2023-09-08 12:52:13,422][main.py][line:303][INFO] Training Mode
8000 8100 2900
[2023-09-08 12:52:18,413][main.py][line:163][INFO] Random initialize AUCAUC:0.8636 Anomaly AUC:0.69742
len old train dataset : 8100
[2023-09-08 12:52:22,467][main.py][line:166][INFO] Random initialize AUCAUC:0.8695 Anomaly AUC:0.70773









































Predict video 8005 | num abnormal video:704:  99%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████▉  | 7990/8100 [01:22<00:00, 160.21it/s]
num videos : 7140
num frames : 23336

Predict video 8100 | num abnormal video:713: 100%|█████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████████| 8100/8100 [01:23<00:00, 96.79it/s]
[2023-09-08 12:54:09,867][main.py][line:220][INFO] [Epoch:1/100]: pel-lr:5.0000e-06 ur-lr:5.0000e-07| loss1:0.0242 loss2:0.5168 loss3:0.2215 co-loss:0.1038 | PEL.AUC:0.8596 An-AUC:0.6939, UR.AUC:0.8686 An-AUC:0.6962
[2023-09-08 12:54:33,510][main.py][line:220][INFO] [Epoch:2/100]: pel-lr:5.0000e-06 ur-lr:5.0000e-07| loss1:0.0064 loss2:0.4866 loss3:0.0615 co-loss:0.0444 | PEL.AUC:0.8584 An-AUC:0.6935, UR.AUC:0.8673 An-AUC:0.6919
[2023-09-08 12:54:57,232][main.py][line:220][INFO] [Epoch:3/100]: pel-lr:5.0000e-06 ur-lr:5.0000e-07| loss1:0.0040 loss2:0.4729 loss3:0.0407 co-loss:0.0296 | PEL.AUC:0.8574 An-AUC:0.6933, UR.AUC:0.8668 An-AUC:0.6904
Traceback (most recent call last):
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 339, in <module>
    main(cfg)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 305, in main
    train(pel_model, ur_model, train_nloader, train_aloader, test_loader, gt, logger)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 191, in train
    loss1, loss2, cost, co_loss = train_func(train_nloader, train_aloader, pel_model, pel_optimizer, ur_model, ur_optimizer, criterion, criterion2, criterion3, logger_wandb)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/train.py", line 35, in train_func
    logits, v_feat = pel_model(v_input, seq_len)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/model.py", line 34, in forward
    x_e, x_v = self.self_attention(x, seq_len)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/modules.py", line 23, in forward
    mask = self.get_mask(self.win_size, x.shape[1], seq_len)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/modules.py", line 44, in get_mask
    m[j, min(max(j - w_len // 2 + k, 0), temporal_scale - 1)] = 1.
KeyboardInterrupt