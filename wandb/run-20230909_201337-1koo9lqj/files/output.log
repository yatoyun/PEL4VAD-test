[2023-09-09 20:13:39,443][main.py][line:165][INFO] total params:1.2091M
[2023-09-09 20:13:39,443][main.py][line:168][INFO] Training Mode
[2023-09-09 20:13:39,443][main.py][line:78][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.1, inplace=False)
)
[2023-09-09 20:13:39,443][main.py][line:79][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 5e-05
)
8000 8100 2900
[2023-09-09 20:13:44,239][main.py][line:82][INFO] Random initialize AUCAUC:0.4774 Anomaly AUC:0.48817
[2023-09-09 20:13:56,368][main.py][line:106][INFO] [Epoch:1/100]: lr:0.00010 | loss1:1.0138 loss2:1.3435 loss3:0.0000 | AUC:0.7820 Anomaly AUC:0.6033
[2023-09-09 20:14:08,059][main.py][line:106][INFO] [Epoch:2/100]: lr:0.00010 | loss1:0.7158 loss2:1.1834 loss3:0.0000 | AUC:0.7995 Anomaly AUC:0.6157
[2023-09-09 20:14:20,524][main.py][line:106][INFO] [Epoch:3/100]: lr:0.00010 | loss1:0.5770 loss2:1.0859 loss3:0.0000 | AUC:0.8042 Anomaly AUC:0.6094
[2023-09-09 20:14:33,457][main.py][line:106][INFO] [Epoch:4/100]: lr:0.00010 | loss1:0.4558 loss2:1.0285 loss3:0.0000 | AUC:0.8190 Anomaly AUC:0.6296
[2023-09-09 20:14:46,141][main.py][line:106][INFO] [Epoch:5/100]: lr:0.00010 | loss1:0.3511 loss2:0.9910 loss3:0.0000 | AUC:0.8119 Anomaly AUC:0.6267
[2023-09-09 20:14:59,051][main.py][line:106][INFO] [Epoch:6/100]: lr:0.00010 | loss1:0.2697 loss2:0.9587 loss3:0.0000 | AUC:0.8269 Anomaly AUC:0.6292
[2023-09-09 20:15:11,835][main.py][line:106][INFO] [Epoch:7/100]: lr:0.00010 | loss1:0.2067 loss2:0.9341 loss3:0.0000 | AUC:0.8249 Anomaly AUC:0.6325
[2023-09-09 20:15:24,661][main.py][line:106][INFO] [Epoch:8/100]: lr:0.00010 | loss1:0.1684 loss2:0.9147 loss3:0.0000 | AUC:0.8241 Anomaly AUC:0.6369
[2023-09-09 20:15:37,637][main.py][line:106][INFO] [Epoch:9/100]: lr:0.00010 | loss1:0.1335 loss2:0.8918 loss3:0.0000 | AUC:0.8248 Anomaly AUC:0.6451
[2023-09-09 20:15:50,705][main.py][line:106][INFO] [Epoch:10/100]: lr:0.00010 | loss1:0.1148 loss2:0.8703 loss3:0.0000 | AUC:0.8278 Anomaly AUC:0.6426
[2023-09-09 20:16:03,636][main.py][line:106][INFO] [Epoch:11/100]: lr:0.00010 | loss1:0.0987 loss2:0.8489 loss3:0.0000 | AUC:0.8197 Anomaly AUC:0.6469
[2023-09-09 20:16:16,594][main.py][line:106][INFO] [Epoch:12/100]: lr:0.00010 | loss1:0.0867 loss2:0.8316 loss3:0.0000 | AUC:0.8172 Anomaly AUC:0.6444
[2023-09-09 20:16:29,560][main.py][line:106][INFO] [Epoch:13/100]: lr:0.00010 | loss1:0.0782 loss2:0.8112 loss3:0.0000 | AUC:0.8216 Anomaly AUC:0.6453
[2023-09-09 20:16:42,664][main.py][line:106][INFO] [Epoch:14/100]: lr:0.00010 | loss1:0.0761 loss2:0.7936 loss3:0.0000 | AUC:0.8217 Anomaly AUC:0.6389
[2023-09-09 20:16:55,794][main.py][line:106][INFO] [Epoch:15/100]: lr:0.00010 | loss1:0.0742 loss2:0.7769 loss3:0.0000 | AUC:0.8058 Anomaly AUC:0.6377
[2023-09-09 20:17:08,715][main.py][line:106][INFO] [Epoch:16/100]: lr:0.00010 | loss1:0.0672 loss2:0.7545 loss3:0.0000 | AUC:0.8226 Anomaly AUC:0.6477
[2023-09-09 20:17:21,422][main.py][line:106][INFO] [Epoch:17/100]: lr:0.00010 | loss1:0.0652 loss2:0.7385 loss3:0.0000 | AUC:0.8133 Anomaly AUC:0.6444
[2023-09-09 20:17:34,310][main.py][line:106][INFO] [Epoch:18/100]: lr:0.00010 | loss1:0.0659 loss2:0.7209 loss3:0.0000 | AUC:0.7975 Anomaly AUC:0.6348
[2023-09-09 20:17:47,083][main.py][line:106][INFO] [Epoch:19/100]: lr:0.00010 | loss1:0.0623 loss2:0.7050 loss3:0.0000 | AUC:0.8119 Anomaly AUC:0.6437
[2023-09-09 20:18:00,029][main.py][line:106][INFO] [Epoch:20/100]: lr:0.00010 | loss1:0.0579 loss2:0.6880 loss3:0.0000 | AUC:0.8125 Anomaly AUC:0.6444
[2023-09-09 20:18:13,133][main.py][line:106][INFO] [Epoch:21/100]: lr:0.00010 | loss1:0.0624 loss2:0.6723 loss3:0.0000 | AUC:0.8103 Anomaly AUC:0.6446
[2023-09-09 20:18:25,941][main.py][line:106][INFO] [Epoch:22/100]: lr:0.00010 | loss1:0.0653 loss2:0.6621 loss3:0.0000 | AUC:0.8053 Anomaly AUC:0.6527
[2023-09-09 20:18:38,952][main.py][line:106][INFO] [Epoch:23/100]: lr:0.00010 | loss1:0.0642 loss2:0.6435 loss3:0.0000 | AUC:0.8019 Anomaly AUC:0.6427
[2023-09-09 20:18:52,000][main.py][line:106][INFO] [Epoch:24/100]: lr:0.00010 | loss1:0.0659 loss2:0.6299 loss3:0.0000 | AUC:0.8015 Anomaly AUC:0.6454
[2023-09-09 20:19:04,835][main.py][line:106][INFO] [Epoch:25/100]: lr:0.00010 | loss1:0.0677 loss2:0.6183 loss3:0.0000 | AUC:0.8052 Anomaly AUC:0.6520
[2023-09-09 20:19:17,888][main.py][line:106][INFO] [Epoch:26/100]: lr:0.00010 | loss1:0.0711 loss2:0.6105 loss3:0.0000 | AUC:0.8088 Anomaly AUC:0.6470
[2023-09-09 20:19:30,948][main.py][line:106][INFO] [Epoch:27/100]: lr:0.00010 | loss1:0.0621 loss2:0.5943 loss3:0.0000 | AUC:0.7942 Anomaly AUC:0.6286
[2023-09-09 20:19:44,009][main.py][line:106][INFO] [Epoch:28/100]: lr:0.00010 | loss1:0.0625 loss2:0.5820 loss3:0.0000 | AUC:0.7962 Anomaly AUC:0.6370
[2023-09-09 20:19:56,956][main.py][line:106][INFO] [Epoch:29/100]: lr:0.00010 | loss1:0.0717 loss2:0.5717 loss3:0.0000 | AUC:0.7943 Anomaly AUC:0.6297
[2023-09-09 20:20:10,063][main.py][line:106][INFO] [Epoch:30/100]: lr:0.00010 | loss1:0.0539 loss2:0.5528 loss3:0.0000 | AUC:0.7940 Anomaly AUC:0.6301
[2023-09-09 20:20:22,986][main.py][line:106][INFO] [Epoch:31/100]: lr:0.00010 | loss1:0.0599 loss2:0.5415 loss3:0.0000 | AUC:0.8017 Anomaly AUC:0.6362
[2023-09-09 20:20:36,175][main.py][line:106][INFO] [Epoch:32/100]: lr:0.00010 | loss1:0.0525 loss2:0.5242 loss3:0.0000 | AUC:0.7883 Anomaly AUC:0.6289
[2023-09-09 20:20:49,199][main.py][line:106][INFO] [Epoch:33/100]: lr:0.00010 | loss1:0.0688 loss2:0.5212 loss3:0.0000 | AUC:0.7955 Anomaly AUC:0.6446
[2023-09-09 20:21:02,137][main.py][line:106][INFO] [Epoch:34/100]: lr:0.00010 | loss1:0.0585 loss2:0.5078 loss3:0.0000 | AUC:0.8032 Anomaly AUC:0.6392
[2023-09-09 20:21:15,143][main.py][line:106][INFO] [Epoch:35/100]: lr:0.00010 | loss1:0.0649 loss2:0.4982 loss3:0.0000 | AUC:0.7851 Anomaly AUC:0.6268
[2023-09-09 20:21:28,155][main.py][line:106][INFO] [Epoch:36/100]: lr:0.00010 | loss1:0.0583 loss2:0.4872 loss3:0.0000 | AUC:0.7975 Anomaly AUC:0.6327
[2023-09-09 20:21:41,239][main.py][line:106][INFO] [Epoch:37/100]: lr:0.00010 | loss1:0.0513 loss2:0.4703 loss3:0.0000 | AUC:0.7985 Anomaly AUC:0.6362
[2023-09-09 20:21:54,317][main.py][line:106][INFO] [Epoch:38/100]: lr:0.00010 | loss1:0.0530 loss2:0.4591 loss3:0.0000 | AUC:0.7930 Anomaly AUC:0.6276
[2023-09-09 20:22:07,217][main.py][line:106][INFO] [Epoch:39/100]: lr:0.00010 | loss1:0.0452 loss2:0.4452 loss3:0.0000 | AUC:0.7934 Anomaly AUC:0.6300
Traceback (most recent call last):
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 203, in <module>
    main(cfg)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 170, in main
    train(model, train_nloader, train_aloader, test_loader, gt, logger)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 90, in train
    loss1, loss2, cost = train_func(train_nloader, train_aloader, model, optimizer, criterion, criterion2, criterion3, logger_wandb, args.lamda, args.alpha)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/train.py", line 37, in train_func
    video_feat, token_feat, video_labels = get_cas(v_feat, t_input, logits, multi_label)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/utils.py", line 105, in get_cas
    bg_label = torch.tensor([0]).cuda()
KeyboardInterrupt