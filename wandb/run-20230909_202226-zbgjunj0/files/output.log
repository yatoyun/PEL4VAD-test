
8000 8100 2900
[2023-09-09 20:22:28,716][main.py][line:165][INFO] total params:1.2091M
[2023-09-09 20:22:28,716][main.py][line:168][INFO] Training Mode
[2023-09-09 20:22:28,716][main.py][line:78][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.1, inplace=False)
)
[2023-09-09 20:22:28,716][main.py][line:79][INFO] Optimizer:Adam (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0005
    lr: 0.0005
    maximize: False
    weight_decay: 0
)
[2023-09-09 20:22:33,694][main.py][line:82][INFO] Random initialize AUCAUC:0.4774 Anomaly AUC:0.48817
[2023-09-09 20:22:45,908][main.py][line:106][INFO] [Epoch:1/100]: lr:0.00050 | loss1:0.8101 loss2:1.1707 loss3:0.0000 | AUC:0.8154 Anomaly AUC:0.6377
[2023-09-09 20:22:58,351][main.py][line:106][INFO] [Epoch:2/100]: lr:0.00050 | loss1:0.4469 loss2:0.9560 loss3:0.0000 | AUC:0.8197 Anomaly AUC:0.6300
[2023-09-09 20:23:11,170][main.py][line:106][INFO] [Epoch:3/100]: lr:0.00050 | loss1:0.2443 loss2:0.8711 loss3:0.0000 | AUC:0.8047 Anomaly AUC:0.6087
[2023-09-09 20:23:23,876][main.py][line:106][INFO] [Epoch:4/100]: lr:0.00050 | loss1:0.1435 loss2:0.8075 loss3:0.0000 | AUC:0.8168 Anomaly AUC:0.6286
[2023-09-09 20:23:36,774][main.py][line:106][INFO] [Epoch:5/100]: lr:0.00050 | loss1:0.1066 loss2:0.7491 loss3:0.0000 | AUC:0.8170 Anomaly AUC:0.6315
[2023-09-09 20:23:49,605][main.py][line:106][INFO] [Epoch:6/100]: lr:0.00050 | loss1:0.0877 loss2:0.6865 loss3:0.0000 | AUC:0.8089 Anomaly AUC:0.6311
[2023-09-09 20:24:02,420][main.py][line:106][INFO] [Epoch:7/100]: lr:0.00050 | loss1:0.0818 loss2:0.6348 loss3:0.0000 | AUC:0.8075 Anomaly AUC:0.6309
[2023-09-09 20:24:15,450][main.py][line:106][INFO] [Epoch:8/100]: lr:0.00050 | loss1:0.0841 loss2:0.5810 loss3:0.0000 | AUC:0.8080 Anomaly AUC:0.6252
[2023-09-09 20:24:28,247][main.py][line:106][INFO] [Epoch:9/100]: lr:0.00050 | loss1:0.0744 loss2:0.5278 loss3:0.0000 | AUC:0.8207 Anomaly AUC:0.6283
[2023-09-09 20:24:41,204][main.py][line:106][INFO] [Epoch:10/100]: lr:0.00050 | loss1:0.0718 loss2:0.4778 loss3:0.0000 | AUC:0.8148 Anomaly AUC:0.6261
[2023-09-09 20:24:54,318][main.py][line:106][INFO] [Epoch:11/100]: lr:0.00050 | loss1:0.0706 loss2:0.4308 loss3:0.0000 | AUC:0.7966 Anomaly AUC:0.6133
[2023-09-09 20:25:07,313][main.py][line:106][INFO] [Epoch:12/100]: lr:0.00050 | loss1:0.0593 loss2:0.3875 loss3:0.0000 | AUC:0.8095 Anomaly AUC:0.6222
[2023-09-09 20:25:20,371][main.py][line:106][INFO] [Epoch:13/100]: lr:0.00050 | loss1:0.0607 loss2:0.3445 loss3:0.0000 | AUC:0.8081 Anomaly AUC:0.6124
[2023-09-09 20:25:33,399][main.py][line:106][INFO] [Epoch:14/100]: lr:0.00050 | loss1:0.0609 loss2:0.3095 loss3:0.0000 | AUC:0.8181 Anomaly AUC:0.6287
[2023-09-09 20:25:46,349][main.py][line:106][INFO] [Epoch:15/100]: lr:0.00050 | loss1:0.0416 loss2:0.2599 loss3:0.0000 | AUC:0.8213 Anomaly AUC:0.6167
[2023-09-09 20:25:59,566][main.py][line:106][INFO] [Epoch:16/100]: lr:0.00050 | loss1:0.0440 loss2:0.2285 loss3:0.0000 | AUC:0.8209 Anomaly AUC:0.6252
[2023-09-09 20:26:12,540][main.py][line:106][INFO] [Epoch:17/100]: lr:0.00050 | loss1:0.0724 loss2:0.2164 loss3:0.0000 | AUC:0.8080 Anomaly AUC:0.6141
[2023-09-09 20:26:25,419][main.py][line:106][INFO] [Epoch:18/100]: lr:0.00050 | loss1:0.0649 loss2:0.1995 loss3:0.0000 | AUC:0.8301 Anomaly AUC:0.6366
[2023-09-09 20:26:38,230][main.py][line:106][INFO] [Epoch:19/100]: lr:0.00050 | loss1:0.0397 loss2:0.1633 loss3:0.0000 | AUC:0.8380 Anomaly AUC:0.6483
[2023-09-09 20:26:51,256][main.py][line:106][INFO] [Epoch:20/100]: lr:0.00050 | loss1:0.0316 loss2:0.1308 loss3:0.0000 | AUC:0.8355 Anomaly AUC:0.6481
[2023-09-09 20:27:04,335][main.py][line:106][INFO] [Epoch:21/100]: lr:0.00050 | loss1:0.0218 loss2:0.1053 loss3:0.0000 | AUC:0.8304 Anomaly AUC:0.6418
[2023-09-09 20:27:17,384][main.py][line:106][INFO] [Epoch:22/100]: lr:0.00050 | loss1:0.0226 loss2:0.0891 loss3:0.0000 | AUC:0.8277 Anomaly AUC:0.6417
[2023-09-09 20:27:30,437][main.py][line:106][INFO] [Epoch:23/100]: lr:0.00050 | loss1:0.0209 loss2:0.0781 loss3:0.0000 | AUC:0.8148 Anomaly AUC:0.6278
[2023-09-09 20:27:43,462][main.py][line:106][INFO] [Epoch:24/100]: lr:0.00050 | loss1:0.0448 loss2:0.0964 loss3:0.0000 | AUC:0.8173 Anomaly AUC:0.6307
[2023-09-09 20:27:56,451][main.py][line:106][INFO] [Epoch:25/100]: lr:0.00050 | loss1:0.0638 loss2:0.1019 loss3:0.0000 | AUC:0.7991 Anomaly AUC:0.6228
[2023-09-09 20:28:09,530][main.py][line:106][INFO] [Epoch:26/100]: lr:0.00050 | loss1:0.0317 loss2:0.0723 loss3:0.0000 | AUC:0.8106 Anomaly AUC:0.6391
[2023-09-09 20:28:22,364][main.py][line:106][INFO] [Epoch:27/100]: lr:0.00050 | loss1:0.0371 loss2:0.0719 loss3:0.0000 | AUC:0.8103 Anomaly AUC:0.6222
[2023-09-09 20:28:35,451][main.py][line:106][INFO] [Epoch:28/100]: lr:0.00050 | loss1:0.0378 loss2:0.0637 loss3:0.0000 | AUC:0.7916 Anomaly AUC:0.6165
[2023-09-09 20:28:48,190][main.py][line:106][INFO] [Epoch:29/100]: lr:0.00050 | loss1:0.0235 loss2:0.0490 loss3:0.0000 | AUC:0.8109 Anomaly AUC:0.6370
[2023-09-09 20:29:01,287][main.py][line:106][INFO] [Epoch:30/100]: lr:0.00050 | loss1:0.0168 loss2:0.0426 loss3:0.0000 | AUC:0.7975 Anomaly AUC:0.6145
[2023-09-09 20:29:14,362][main.py][line:106][INFO] [Epoch:31/100]: lr:0.00050 | loss1:0.0138 loss2:0.0340 loss3:0.0000 | AUC:0.8226 Anomaly AUC:0.6290
[2023-09-09 20:29:27,553][main.py][line:106][INFO] [Epoch:32/100]: lr:0.00050 | loss1:0.0111 loss2:0.0265 loss3:0.0000 | AUC:0.8252 Anomaly AUC:0.6341
[2023-09-09 20:29:40,505][main.py][line:106][INFO] [Epoch:33/100]: lr:0.00050 | loss1:0.0118 loss2:0.0237 loss3:0.0000 | AUC:0.8164 Anomaly AUC:0.6349
[2023-09-09 20:29:53,578][main.py][line:106][INFO] [Epoch:34/100]: lr:0.00050 | loss1:0.0098 loss2:0.0218 loss3:0.0000 | AUC:0.8099 Anomaly AUC:0.6296
[2023-09-09 20:30:06,521][main.py][line:106][INFO] [Epoch:35/100]: lr:0.00050 | loss1:0.0135 loss2:0.0242 loss3:0.0000 | AUC:0.8172 Anomaly AUC:0.6553
[2023-09-09 20:30:19,578][main.py][line:106][INFO] [Epoch:36/100]: lr:0.00050 | loss1:0.0690 loss2:0.0529 loss3:0.0000 | AUC:0.7953 Anomaly AUC:0.6171
[2023-09-09 20:30:32,643][main.py][line:106][INFO] [Epoch:37/100]: lr:0.00050 | loss1:0.0443 loss2:0.0479 loss3:0.0000 | AUC:0.7989 Anomaly AUC:0.6287
[2023-09-09 20:30:45,610][main.py][line:106][INFO] [Epoch:38/100]: lr:0.00050 | loss1:0.0347 loss2:0.0397 loss3:0.0000 | AUC:0.8118 Anomaly AUC:0.6270
[2023-09-09 20:30:58,513][main.py][line:106][INFO] [Epoch:39/100]: lr:0.00050 | loss1:0.0171 loss2:0.0232 loss3:0.0000 | AUC:0.8071 Anomaly AUC:0.6170
[2023-09-09 20:31:11,491][main.py][line:106][INFO] [Epoch:40/100]: lr:0.00050 | loss1:0.0109 loss2:0.0182 loss3:0.0000 | AUC:0.8079 Anomaly AUC:0.6297
Traceback (most recent call last):
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 203, in <module>
    main(cfg)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 170, in main
    train(model, train_nloader, train_aloader, test_loader, gt, logger)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 90, in train
    loss1, loss2, cost = train_func(train_nloader, train_aloader, model, optimizer, criterion, criterion2, criterion3, logger_wandb, args.lamda, args.alpha)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/train.py", line 37, in train_func
    video_feat, token_feat, video_labels = get_cas(v_feat, t_input, logits, multi_label)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/utils.py", line 132, in get_cas
    video_labels = torch.cat((video_labels, bg_label.view(1)))
KeyboardInterrupt