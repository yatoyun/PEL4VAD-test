
8000 8100 2900
[2023-09-09 21:26:00,415][main.py][line:165][INFO] total params:7.5400M
[2023-09-09 21:26:00,415][main.py][line:168][INFO] Training Mode
[2023-09-09 21:26:00,416][main.py][line:78][INFO] Model:XModel(
  (self_attention): XEncoder(
    (self_attn): TCA(
      (q): Linear(in_features=1024, out_features=128, bias=True)
      (k): Linear(in_features=1024, out_features=128, bias=True)
      (v): Linear(in_features=1024, out_features=128, bias=True)
      (o): Linear(in_features=128, out_features=1024, bias=True)
      (act): Softmax(dim=-1)
    )
    (linear1): Conv1d(1024, 512, kernel_size=(1,), stride=(1,))
    (linear2): Conv1d(512, 300, kernel_size=(1,), stride=(1,))
    (dropout1): Dropout(p=0.1, inplace=False)
    (dropout2): Dropout(p=0.1, inplace=False)
    (norm): LayerNorm((1024,), eps=1e-05, elementwise_affine=True)
    (loc_adj): DistanceAdj()
    (DR_DMU): WSAD(
      (embedding): Temporal(
        (conv_1): Sequential(
          (0): Conv1d(1024, 512, kernel_size=(3,), stride=(1,), padding=(1,))
          (1): ReLU()
        )
      )
      (triplet): TripletMarginLoss()
      (Amemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (Nmemory): Memory_Unit(
        (sig): Sigmoid()
      )
      (selfatt): Transformer(
        (layers): ModuleList(
          (0-1): 2 x ModuleList(
            (0): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): Attention(
                (attend): Softmax(dim=-1)
                (to_qkv): Linear(in_features=512, out_features=2048, bias=False)
                (to_out): Sequential(
                  (0): Linear(in_features=1024, out_features=512, bias=True)
                  (1): Dropout(p=0.1, inplace=False)
                )
              )
            )
            (1): PreNorm(
              (norm): LayerNorm((512,), eps=1e-05, elementwise_affine=True)
              (fn): FeedForward(
                (net): Sequential(
                  (0): Linear(in_features=512, out_features=512, bias=True)
                  (1): GELU(approximate='none')
                  (2): Dropout(p=0.1, inplace=False)
                  (3): Linear(in_features=512, out_features=512, bias=True)
                  (4): Dropout(p=0.1, inplace=False)
                )
              )
            )
          )
        )
      )
      (encoder_mu): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (encoder_var): Sequential(
        (0): Linear(in_features=512, out_features=512, bias=True)
      )
      (relu): ReLU()
    )
  )
  (classifier): Conv1d(300, 1, kernel_size=(9,), stride=(1,))
  (dropout): Dropout(p=0.1, inplace=False)
)
[2023-09-09 21:26:00,416][main.py][line:79][INFO] Optimizer:AdamW (
Parameter Group 0
    amsgrad: True
    betas: (0.9, 0.999)
    capturable: False
    differentiable: False
    eps: 1e-08
    foreach: None
    fused: None
    initial_lr: 0.0001
    lr: 0.0001
    maximize: False
    weight_decay: 5e-06
)
[2023-09-09 21:26:08,386][main.py][line:82][INFO] Random initialize AUCAUC:0.5802 Anomaly AUC:0.50318
[2023-09-09 21:26:26,849][main.py][line:106][INFO] [Epoch:1/100]: lr:0.00010 | loss1:0.3515 loss2:1.1702 loss3:0.3474 | AUC:0.8121 Anomaly AUC:0.6675
[2023-09-09 21:26:45,043][main.py][line:106][INFO] [Epoch:2/100]: lr:0.00010 | loss1:0.0507 loss2:0.8262 loss3:0.2585 | AUC:0.8175 Anomaly AUC:0.6690
[2023-09-09 21:27:03,669][main.py][line:106][INFO] [Epoch:3/100]: lr:0.00010 | loss1:0.0277 loss2:0.7198 loss3:0.1998 | AUC:0.8121 Anomaly AUC:0.6693
[2023-09-09 21:27:22,335][main.py][line:106][INFO] [Epoch:4/100]: lr:0.00010 | loss1:0.0197 loss2:0.6336 loss3:0.1410 | AUC:0.8288 Anomaly AUC:0.6624
[2023-09-09 21:27:41,008][main.py][line:106][INFO] [Epoch:5/100]: lr:0.00010 | loss1:0.0151 loss2:0.5697 loss3:0.1017 | AUC:0.8229 Anomaly AUC:0.6595
[2023-09-09 21:27:59,793][main.py][line:106][INFO] [Epoch:6/100]: lr:0.00010 | loss1:0.0267 loss2:0.5909 loss3:0.1023 | AUC:0.8124 Anomaly AUC:0.6683
[2023-09-09 21:28:18,824][main.py][line:106][INFO] [Epoch:7/100]: lr:0.00010 | loss1:0.0094 loss2:0.5106 loss3:0.0817 | AUC:0.8383 Anomaly AUC:0.6711
[2023-09-09 21:28:37,898][main.py][line:106][INFO] [Epoch:8/100]: lr:0.00010 | loss1:0.0067 loss2:0.4485 loss3:0.0539 | AUC:0.8397 Anomaly AUC:0.6665
[2023-09-09 21:28:56,695][main.py][line:106][INFO] [Epoch:9/100]: lr:0.00010 | loss1:0.0131 loss2:0.4422 loss3:0.0570 | AUC:0.8152 Anomaly AUC:0.6722
[2023-09-09 21:29:15,578][main.py][line:106][INFO] [Epoch:10/100]: lr:0.00010 | loss1:0.0090 loss2:0.4454 loss3:0.0659 | AUC:0.8213 Anomaly AUC:0.6795
[2023-09-09 21:29:34,435][main.py][line:106][INFO] [Epoch:11/100]: lr:0.00010 | loss1:0.0060 loss2:0.3780 loss3:0.0450 | AUC:0.8385 Anomaly AUC:0.6738
[2023-09-09 21:29:53,431][main.py][line:106][INFO] [Epoch:12/100]: lr:0.00010 | loss1:0.0061 loss2:0.3526 loss3:0.0373 | AUC:0.8352 Anomaly AUC:0.6737
[2023-09-09 21:30:12,413][main.py][line:106][INFO] [Epoch:13/100]: lr:0.00010 | loss1:0.0038 loss2:0.3195 loss3:0.0267 | AUC:0.8397 Anomaly AUC:0.6699
[2023-09-09 21:30:31,497][main.py][line:106][INFO] [Epoch:14/100]: lr:0.00010 | loss1:0.0033 loss2:0.2997 loss3:0.0220 | AUC:0.8448 Anomaly AUC:0.6742
[2023-09-09 21:30:50,416][main.py][line:106][INFO] [Epoch:15/100]: lr:0.00010 | loss1:0.0074 loss2:0.3066 loss3:0.0256 | AUC:0.8362 Anomaly AUC:0.6634
[2023-09-09 21:31:09,431][main.py][line:106][INFO] [Epoch:16/100]: lr:0.00010 | loss1:0.0026 loss2:0.2723 loss3:0.0191 | AUC:0.8423 Anomaly AUC:0.6658
[2023-09-09 21:31:28,421][main.py][line:106][INFO] [Epoch:17/100]: lr:0.00010 | loss1:0.0023 loss2:0.2554 loss3:0.0165 | AUC:0.8439 Anomaly AUC:0.6717
[2023-09-09 21:31:47,379][main.py][line:106][INFO] [Epoch:18/100]: lr:0.00010 | loss1:0.0057 loss2:0.2502 loss3:0.0168 | AUC:0.8291 Anomaly AUC:0.6591
[2023-09-09 21:32:06,261][main.py][line:106][INFO] [Epoch:19/100]: lr:0.00010 | loss1:0.0204 loss2:0.3742 loss3:0.0533 | AUC:0.8350 Anomaly AUC:0.6719
[2023-09-09 21:32:25,252][main.py][line:106][INFO] [Epoch:20/100]: lr:0.00010 | loss1:0.0024 loss2:0.2539 loss3:0.0208 | AUC:0.8399 Anomaly AUC:0.6694
[2023-09-09 21:32:44,307][main.py][line:106][INFO] [Epoch:21/100]: lr:0.00010 | loss1:0.0021 loss2:0.2281 loss3:0.0159 | AUC:0.8449 Anomaly AUC:0.6768
[2023-09-09 21:33:03,350][main.py][line:106][INFO] [Epoch:22/100]: lr:0.00010 | loss1:0.0014 loss2:0.2149 loss3:0.0134 | AUC:0.8419 Anomaly AUC:0.6723
[2023-09-09 21:33:22,408][main.py][line:106][INFO] [Epoch:23/100]: lr:0.00010 | loss1:0.0012 loss2:0.2038 loss3:0.0122 | AUC:0.8404 Anomaly AUC:0.6730
[2023-09-09 21:33:41,601][main.py][line:106][INFO] [Epoch:24/100]: lr:0.00010 | loss1:0.0012 loss2:0.1960 loss3:0.0115 | AUC:0.8435 Anomaly AUC:0.6734
[2023-09-09 21:34:00,665][main.py][line:106][INFO] [Epoch:25/100]: lr:0.00010 | loss1:0.0011 loss2:0.1888 loss3:0.0108 | AUC:0.8451 Anomaly AUC:0.6739
[2023-09-09 21:34:19,619][main.py][line:106][INFO] [Epoch:26/100]: lr:0.00010 | loss1:0.0009 loss2:0.1804 loss3:0.0103 | AUC:0.8431 Anomaly AUC:0.6725
Exception in thread Thread-85 (_pin_memory_loop):
Traceback (most recent call last):
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/threading.py", line 1016, in _bootstrap_inner
    self.run()
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/threading.py", line 953, in run
    self._target(*self._args, **self._kwargs)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/utils/data/_utils/pin_memory.py", line 51, in _pin_memory_loop
    do_one_step()
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/utils/data/_utils/pin_memory.py", line 28, in do_one_step
    r = in_queue.get(timeout=MP_STATUS_CHECK_INTERVAL)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/multiprocessing/queues.py", line 122, in get
    return _ForkingPickler.loads(res)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/multiprocessing/reductions.py", line 307, in rebuild_storage_fd
    fd = df.detach()
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/multiprocessing/resource_sharer.py", line 57, in detach
    with _resource_sharer.get_connection(self._id) as conn:
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/multiprocessing/resource_sharer.py", line 86, in get_connection
    c = Client(address, authkey=process.current_process().authkey)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/multiprocessing/connection.py", line 502, in Client
    c = SocketClient(address)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/multiprocessing/connection.py", line 630, in SocketClient
    s.connect(address)
FileNotFoundError: [Errno 2] No such file or directory
Traceback (most recent call last):
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 203, in <module>
    main(cfg)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 170, in main
    train(model, train_nloader, train_aloader, test_loader, gt, logger)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/main.py", line 97, in train
    auc, ab_auc = test_func(test_loader, model, gt, cfg.dataset)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/test.py", line 37, in test_func
    logits, _ = model(v_input, seq_len)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/model.py", line 37, in forward
    x_e, x_v = self.self_attention(x, seq_len)
  File "/home/yukaneko/miniconda3/envs/detection/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1501, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/modules.py", line 26, in forward
    mask = self.get_mask(self.win_size, x.shape[1], seq_len)
  File "/home/yukaneko/dev/AbnormalDetection/PEL4VAD/modules.py", line 66, in get_mask
    m[j, min(max(j - w_len // 2 + k, 0), temporal_scale - 1)] = 1.
KeyboardInterrupt